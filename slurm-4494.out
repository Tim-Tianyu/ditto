Selected optimization level O2:  FP16 training with FP32 batchnorm and FP32 master weights.

Defaults for this optimization level are:
enabled                : True
opt_level              : O2
cast_model_type        : torch.float16
patch_torch_functions  : False
keep_batchnorm_fp32    : True
master_weights         : True
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O2
cast_model_type        : torch.float16
patch_torch_functions  : False
keep_batchnorm_fp32    : True
master_weights         : True
loss_scale             : dynamic
Warning:  multi_tensor_applier fused unscale kernel is unavailable, possibly because apex was installed without --cuda_ext --cpp_ext. Using Python fallback.  Original ImportError was: ModuleNotFoundError("No module named 'amp_C'")
Gradient overflow.  Skipping step, loss scaler 0 reducing loss scale to 32768.0
=====sanity check======
words: COL name VAL sony silver cyber-shot digital camera dscs750 COL description VAL sony silver cyber-shot digital camera dscs750 7.2 megapixel super had ccd 2.5 ' lcd display 3x optical zoom high sensitivity mode auto focus 22 mb internal memory face detection burst mode convenient photo modes beginner-friendly function guide silver finish COL price VAL   [SEP] COL name VAL sony infolithium d-type np-fd1 digital camera battery npfd1 COL description VAL lithium ion ( li-ion ) 4.2 v dc photo battery COL price VAL 41.72 
x: [    0 18047   766 27445   579  6119  4334  5381    12 10393  1778  2280
   385  3866    29 10569 14857  8194 27445   579  6119  4334  5381    12
 10393  1778  2280   385  3866    29 10569   262     4   176 10721 21424
  2422    56   740 28690   132     4   245   128   784 28690  2332   155
  1178 17547 21762   239 15608  5745  4485  1056   820   475   428  3425
  3783   652 12673 10084  5745 12148  1345 19180 37239    12  6928  5043
  4704  4334  2073 14857   425 27445  1437  1437     2     2 18047   766
 27445   579  6119  4047 41894  4031   385    12 12528 46446    12 37379
   134  1778  2280  3822 46446 37379   134 14857  8194 27445 16904 31973
    36 16787    12  1499  4839   204     4   176   748 46773  1345  3822
 14857   425 27445  3492     4  4956  1437     2]
tokens: ['<s>', 'COL', 'Ġname', 'ĠVAL', 'Ġs', 'ony', 'Ġsilver', 'Ġcyber', '-', 'shot', 'Ġdigital', 'Ġcamera', 'Ġd', 'sc', 's', '750', 'ĠCOL', 'Ġdescription', 'ĠVAL', 'Ġs', 'ony', 'Ġsilver', 'Ġcyber', '-', 'shot', 'Ġdigital', 'Ġcamera', 'Ġd', 'sc', 's', '750', 'Ġ7', '.', '2', 'Ġmeg', 'apixel', 'Ġsuper', 'Ġhad', 'Ġc', 'cd', 'Ġ2', '.', '5', "Ġ'", 'Ġl', 'cd', 'Ġdisplay', 'Ġ3', 'x', 'Ġoptical', 'Ġzoom', 'Ġhigh', 'Ġsensitivity', 'Ġmode', 'Ġauto', 'Ġfocus', 'Ġ22', 'Ġm', 'b', 'Ġinternal', 'Ġmemory', 'Ġface', 'Ġdetection', 'Ġburst', 'Ġmode', 'Ġconvenient', 'Ġphoto', 'Ġmodes', 'Ġbeginner', '-', 'friendly', 'Ġfunction', 'Ġguide', 'Ġsilver', 'Ġfinish', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ', 'Ġ', '</s>', '</s>', 'COL', 'Ġname', 'ĠVAL', 'Ġs', 'ony', 'Ġinf', 'olith', 'ium', 'Ġd', '-', 'type', 'Ġnp', '-', 'fd', '1', 'Ġdigital', 'Ġcamera', 'Ġbattery', 'Ġnp', 'fd', '1', 'ĠCOL', 'Ġdescription', 'ĠVAL', 'Ġlithium', 'Ġion', 'Ġ(', 'Ġli', '-', 'ion', 'Ġ)', 'Ġ4', '.', '2', 'Ġv', 'Ġdc', 'Ġphoto', 'Ġbattery', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ41', '.', '72', 'Ġ', '</s>']
is_heads: [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
y: 0
tags: 0
mask: tensor([1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1])
seqlen: 128
task_name: Textual/Abt-Buy
=======================
step: 0, task: Textual/Abt-Buy, loss: 0.7438956499099731
Gradient overflow.  Skipping step, loss scaler 0 reducing loss scale to 16384.0
Gradient overflow.  Skipping step, loss scaler 0 reducing loss scale to 8192.0
step: 10, task: Textual/Abt-Buy, loss: 0.7469868659973145
step: 20, task: Textual/Abt-Buy, loss: 0.649830162525177
step: 30, task: Textual/Abt-Buy, loss: 0.48480355739593506
step: 40, task: Textual/Abt-Buy, loss: 0.11749918758869171
step: 50, task: Textual/Abt-Buy, loss: 0.524884045124054
step: 60, task: Textual/Abt-Buy, loss: 0.4133884906768799
step: 70, task: Textual/Abt-Buy, loss: 0.3929923474788666
step: 80, task: Textual/Abt-Buy, loss: 0.542246401309967
step: 90, task: Textual/Abt-Buy, loss: 0.6188391447067261
step: 100, task: Textual/Abt-Buy, loss: 0.7849375009536743
step: 110, task: Textual/Abt-Buy, loss: 0.3667437434196472
step: 120, task: Textual/Abt-Buy, loss: 0.8489028811454773
step: 130, task: Textual/Abt-Buy, loss: 0.3677203059196472
step: 140, task: Textual/Abt-Buy, loss: 0.267459899187088
step: 150, task: Textual/Abt-Buy, loss: 0.4912113547325134
step: 160, task: Textual/Abt-Buy, loss: 0.5836808681488037
step: 170, task: Textual/Abt-Buy, loss: 0.12350402772426605
step: 180, task: Textual/Abt-Buy, loss: 0.47835734486579895
step: 190, task: Textual/Abt-Buy, loss: 0.5353105664253235
step: 200, task: Textual/Abt-Buy, loss: 0.5552891492843628
step: 210, task: Textual/Abt-Buy, loss: 0.35983848571777344
step: 220, task: Textual/Abt-Buy, loss: 0.41150325536727905
step: 230, task: Textual/Abt-Buy, loss: 0.17048516869544983
step: 240, task: Textual/Abt-Buy, loss: 0.6981676816940308
step: 250, task: Textual/Abt-Buy, loss: 0.4259694218635559
step: 260, task: Textual/Abt-Buy, loss: 0.1484972983598709
step: 270, task: Textual/Abt-Buy, loss: 0.19571571052074432
step: 280, task: Textual/Abt-Buy, loss: 0.3817843496799469
step: 290, task: Textual/Abt-Buy, loss: 0.2219613939523697
step: 300, task: Textual/Abt-Buy, loss: 0.25751349329948425
step: 310, task: Textual/Abt-Buy, loss: 0.6287585496902466
step: 320, task: Textual/Abt-Buy, loss: 0.4863385856151581
step: 330, task: Textual/Abt-Buy, loss: 0.21124865114688873
step: 340, task: Textual/Abt-Buy, loss: 0.32226622104644775
step: 350, task: Textual/Abt-Buy, loss: 0.2911219000816345
=========eval at epoch=1=========
Validation:
=============Textual/Abt-Buy==================
accuracy=0.892
precision=0.000
recall=0.000
f1=0.000
======================================
Test:
=============Textual/Abt-Buy==================
accuracy=0.892
precision=0.000
recall=0.000
f1=0.000
======================================
/w/246/tianyu2020/miniconda2/envs/ditto/lib/python3.7/site-packages/apex/amp/_initialize.py:24: UserWarning: An input tensor was not cuda.
  warnings.warn("An input tensor was not cuda.")
/w/246/tianyu2020/miniconda2/envs/ditto/lib/python3.7/site-packages/torch/optim/lr_scheduler.py:122: UserWarning: Detected call of `lr_scheduler.step()` before `optimizer.step()`. In PyTorch 1.1.0 and later, you should call them in the opposite order: `optimizer.step()` before `lr_scheduler.step()`.  Failure to do this will result in PyTorch skipping the first value of the learning rate schedule. See more details at https://pytorch.org/docs/stable/optim.html#how-to-adjust-learning-rate
  "https://pytorch.org/docs/stable/optim.html#how-to-adjust-learning-rate", UserWarning)
/w/246/tianyu2020/miniconda2/envs/ditto/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1221: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
=====sanity check======
words: COL name VAL canon silver 8.0 megapixel powershot digital camera sd1100is COL description VAL canon silver 8.0 megapixel powershot digital camera sd1100is 8.0 megapixel 3x optical zoom 2.5 ' color lcd 18 shooting modes red-eye correction face detection technology isaps technology swing silver finish COL price VAL   [SEP] COL name VAL canon powershot sd880 is digital camera silver 3197b001 COL description VAL canon powershot sd880 is 10 megapixel digital camera w / ua lens , 4x optical zoom , 28mm wide lens , optical image stabilizer , & purecolor ii 3 ' lcd silver COL price VAL 246.88 
x: [    0 18047   766 27445 32839  4334   290     4   288 10721 21424  4361
 10120  1778  2280 46409 40830   354 14857  8194 27445 32839  4334   290
     4   288 10721 21424  4361 10120  1778  2280 46409 40830   354   290
     4   288 10721 21424   155  1178 17547 21762   132     4   245   128
  3195   784 28690   504  1094 19180  1275    12 20668 14921   652 12673
   806    16  7527   806  7021  4334  2073 14857   425 27445  1437  1437
     2     2 18047   766 27445 32839  4361 10120 46409 32954    16  1778
  2280  4334   155 30586   428 19089 14857  8194 27445 32839  4361 10120
 46409 32954    16   158 10721 21424  1778  2280   885  1589  1717   102
 10373  2156   204  1178 17547 21762  2156   971  5471  1810 10373  2156
 17547  2274 12964  6315  2156   359  8309 21685 42661   155   128   784
 28690  4334 14857   425 27445 35303     4  4652  1437     2]
tokens: ['<s>', 'COL', 'Ġname', 'ĠVAL', 'Ġcanon', 'Ġsilver', 'Ġ8', '.', '0', 'Ġmeg', 'apixel', 'Ġpowers', 'hot', 'Ġdigital', 'Ġcamera', 'Ġsd', '1100', 'is', 'ĠCOL', 'Ġdescription', 'ĠVAL', 'Ġcanon', 'Ġsilver', 'Ġ8', '.', '0', 'Ġmeg', 'apixel', 'Ġpowers', 'hot', 'Ġdigital', 'Ġcamera', 'Ġsd', '1100', 'is', 'Ġ8', '.', '0', 'Ġmeg', 'apixel', 'Ġ3', 'x', 'Ġoptical', 'Ġzoom', 'Ġ2', '.', '5', "Ġ'", 'Ġcolor', 'Ġl', 'cd', 'Ġ18', 'Ġshooting', 'Ġmodes', 'Ġred', '-', 'eye', 'Ġcorrection', 'Ġface', 'Ġdetection', 'Ġtechnology', 'Ġis', 'aps', 'Ġtechnology', 'Ġswing', 'Ġsilver', 'Ġfinish', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ', 'Ġ', '</s>', '</s>', 'COL', 'Ġname', 'ĠVAL', 'Ġcanon', 'Ġpowers', 'hot', 'Ġsd', '880', 'Ġis', 'Ġdigital', 'Ġcamera', 'Ġsilver', 'Ġ3', '197', 'b', '001', 'ĠCOL', 'Ġdescription', 'ĠVAL', 'Ġcanon', 'Ġpowers', 'hot', 'Ġsd', '880', 'Ġis', 'Ġ10', 'Ġmeg', 'apixel', 'Ġdigital', 'Ġcamera', 'Ġw', 'Ġ/', 'Ġu', 'a', 'Ġlens', 'Ġ,', 'Ġ4', 'x', 'Ġoptical', 'Ġzoom', 'Ġ,', 'Ġ28', 'mm', 'Ġwide', 'Ġlens', 'Ġ,', 'Ġoptical', 'Ġimage', 'Ġstabil', 'izer', 'Ġ,', 'Ġ&', 'Ġpure', 'color', 'Ġii', 'Ġ3', "Ġ'", 'Ġl', 'cd', 'Ġsilver', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ246', '.', '88', 'Ġ', '</s>']
is_heads: [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
y: 0
tags: 0
mask: tensor([1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1])
seqlen: 142
task_name: Textual/Abt-Buy
=======================
step: 0, task: Textual/Abt-Buy, loss: 0.2059735655784607
step: 10, task: Textual/Abt-Buy, loss: 0.19898153841495514
step: 20, task: Textual/Abt-Buy, loss: 0.12904861569404602
step: 30, task: Textual/Abt-Buy, loss: 0.43300214409828186
step: 40, task: Textual/Abt-Buy, loss: 0.23952150344848633
step: 50, task: Textual/Abt-Buy, loss: 0.13732968270778656
step: 60, task: Textual/Abt-Buy, loss: 0.30411428213119507
step: 70, task: Textual/Abt-Buy, loss: 0.34852439165115356
step: 80, task: Textual/Abt-Buy, loss: 0.0852188766002655
step: 90, task: Textual/Abt-Buy, loss: 0.060366008430719376
step: 100, task: Textual/Abt-Buy, loss: 0.03295265510678291
step: 110, task: Textual/Abt-Buy, loss: 0.1071942150592804
step: 120, task: Textual/Abt-Buy, loss: 0.08588121831417084
step: 130, task: Textual/Abt-Buy, loss: 0.11222481727600098
step: 140, task: Textual/Abt-Buy, loss: 0.14058256149291992
step: 150, task: Textual/Abt-Buy, loss: 0.16875222325325012
step: 160, task: Textual/Abt-Buy, loss: 0.027831386774778366
step: 170, task: Textual/Abt-Buy, loss: 0.09555672109127045
step: 180, task: Textual/Abt-Buy, loss: 0.12844392657279968
step: 190, task: Textual/Abt-Buy, loss: 0.10154882073402405
step: 200, task: Textual/Abt-Buy, loss: 0.13574066758155823
step: 210, task: Textual/Abt-Buy, loss: 0.05830949917435646
step: 220, task: Textual/Abt-Buy, loss: 0.10060262680053711
step: 230, task: Textual/Abt-Buy, loss: 0.040605220943689346
step: 240, task: Textual/Abt-Buy, loss: 0.2038397639989853
step: 250, task: Textual/Abt-Buy, loss: 0.00269414484500885
step: 260, task: Textual/Abt-Buy, loss: 0.26060473918914795
step: 270, task: Textual/Abt-Buy, loss: 0.24756838381290436
step: 280, task: Textual/Abt-Buy, loss: 0.06405387818813324
step: 290, task: Textual/Abt-Buy, loss: 0.043199263513088226
step: 300, task: Textual/Abt-Buy, loss: 0.034288521856069565
step: 310, task: Textual/Abt-Buy, loss: 0.11716565489768982
step: 320, task: Textual/Abt-Buy, loss: 0.057159870862960815
step: 330, task: Textual/Abt-Buy, loss: 0.3511132001876831
step: 340, task: Textual/Abt-Buy, loss: 0.07776273787021637
step: 350, task: Textual/Abt-Buy, loss: 0.2806599736213684
=========eval at epoch=1=========
Validation:
=============Textual/Abt-Buy==================
accuracy=0.957
precision=0.860
recall=0.718
f1=0.783
======================================
Test:
=============Textual/Abt-Buy==================
accuracy=0.962
precision=0.881
recall=0.752
f1=0.812
======================================
=====sanity check======
words: COL name VAL nikon d700 digital slr digital camera d700body COL description VAL nikon d700 digital slr digital camera d700body 12.1 megapixels fx-format cmos sensor continuous shooting up to 5 frames per second 3 ' super-density 920,000-dot vga color monitor two live view shooting modes rugged magnesium-alloy construction 51-point af with 3d focus tracking dynamic integrated dust reduction system 1,005-pixel 3d color matrix metering ii scene recognition system black finish body only COL price VAL   [SEP] COL name VAL nikon d300 digital slr camera 25432 COL description VAL 12.3 megapixel 3 ' active matrix tft color lcd COL price VAL 1521.09 
x: [    0 18047   766 27445   295   967   261   385  5987  1778  3369   338
  1778  2280   385  5987  9773 14857  8194 27445   295   967   261   385
  5987  1778  3369   338  1778  2280   385  5987  9773   316     4   134
 10721  1115 41699   856  1178    12 34609 25434   366  9626 11152  1094
    62     7   195 16420   228   200   155   128  2422    12 37373 37543
     6   151    12 33369   748  2538  3195  5271    80   697  1217  1094
 19180 21937 36165    12  1250  2160  1663  4074    12  2300  9724    19
   155   417  1056  6779  6878  6818  8402  4878   467   112     6 31866
    12 44546   155   417  3195 36173  1145  2961 42661  1310  4972   467
   909  2073   809   129 14857   425 27445  1437  1437     2     2 18047
   766 27445   295   967   261   385  2965  1778  3369   338  2280 35381
  2881 14857  8194 27445   316     4   246 10721 21424   155   128  2171
 36173   326  2543  3195   784 28690 14857   425 27445   379  2146     4
  3546  1437     2]
tokens: ['<s>', 'COL', 'Ġname', 'ĠVAL', 'Ġn', 'ik', 'on', 'Ġd', '700', 'Ġdigital', 'Ġsl', 'r', 'Ġdigital', 'Ġcamera', 'Ġd', '700', 'body', 'ĠCOL', 'Ġdescription', 'ĠVAL', 'Ġn', 'ik', 'on', 'Ġd', '700', 'Ġdigital', 'Ġsl', 'r', 'Ġdigital', 'Ġcamera', 'Ġd', '700', 'body', 'Ġ12', '.', '1', 'Ġmeg', 'ap', 'ixels', 'Ġf', 'x', '-', 'format', 'Ġcm', 'os', 'Ġsensor', 'Ġcontinuous', 'Ġshooting', 'Ġup', 'Ġto', 'Ġ5', 'Ġframes', 'Ġper', 'Ġsecond', 'Ġ3', "Ġ'", 'Ġsuper', '-', 'density', 'Ġ920', ',', '000', '-', 'dot', 'Ġv', 'ga', 'Ġcolor', 'Ġmonitor', 'Ġtwo', 'Ġlive', 'Ġview', 'Ġshooting', 'Ġmodes', 'Ġrugged', 'Ġmagnesium', '-', 'all', 'oy', 'Ġconstruction', 'Ġ51', '-', 'point', 'Ġaf', 'Ġwith', 'Ġ3', 'd', 'Ġfocus', 'Ġtracking', 'Ġdynamic', 'Ġintegrated', 'Ġdust', 'Ġreduction', 'Ġsystem', 'Ġ1', ',', '005', '-', 'pixel', 'Ġ3', 'd', 'Ġcolor', 'Ġmatrix', 'Ġmet', 'ering', 'Ġii', 'Ġscene', 'Ġrecognition', 'Ġsystem', 'Ġblack', 'Ġfinish', 'Ġbody', 'Ġonly', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ', 'Ġ', '</s>', '</s>', 'COL', 'Ġname', 'ĠVAL', 'Ġn', 'ik', 'on', 'Ġd', '300', 'Ġdigital', 'Ġsl', 'r', 'Ġcamera', 'Ġ254', '32', 'ĠCOL', 'Ġdescription', 'ĠVAL', 'Ġ12', '.', '3', 'Ġmeg', 'apixel', 'Ġ3', "Ġ'", 'Ġactive', 'Ġmatrix', 'Ġt', 'ft', 'Ġcolor', 'Ġl', 'cd', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ15', '21', '.', '09', 'Ġ', '</s>']
is_heads: [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
y: 0
tags: 0
mask: tensor([1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1])
seqlen: 159
task_name: Textual/Abt-Buy
=======================
step: 0, task: Textual/Abt-Buy, loss: 0.09280148148536682
step: 10, task: Textual/Abt-Buy, loss: 0.14736121892929077
step: 20, task: Textual/Abt-Buy, loss: 0.03325611725449562
step: 30, task: Textual/Abt-Buy, loss: 0.013842903077602386
step: 40, task: Textual/Abt-Buy, loss: 0.00368519127368927
step: 50, task: Textual/Abt-Buy, loss: 0.3652760982513428
step: 60, task: Textual/Abt-Buy, loss: 0.24765247106552124
step: 70, task: Textual/Abt-Buy, loss: 0.2290990650653839
step: 80, task: Textual/Abt-Buy, loss: 0.02094760537147522
step: 90, task: Textual/Abt-Buy, loss: 0.1472899168729782
step: 100, task: Textual/Abt-Buy, loss: 0.16582678258419037
step: 110, task: Textual/Abt-Buy, loss: 0.01247406005859375
step: 120, task: Textual/Abt-Buy, loss: 0.009460948407649994
step: 130, task: Textual/Abt-Buy, loss: 0.00616069883108139
step: 140, task: Textual/Abt-Buy, loss: 0.02114788070321083
step: 150, task: Textual/Abt-Buy, loss: 0.14048771560192108
step: 160, task: Textual/Abt-Buy, loss: 0.07781193405389786
step: 170, task: Textual/Abt-Buy, loss: 0.06663583219051361
step: 180, task: Textual/Abt-Buy, loss: 0.08462637662887573
step: 190, task: Textual/Abt-Buy, loss: 0.006296120584011078
step: 200, task: Textual/Abt-Buy, loss: 0.027962490916252136
step: 210, task: Textual/Abt-Buy, loss: 0.0259987935423851
step: 220, task: Textual/Abt-Buy, loss: 0.013108998537063599
step: 230, task: Textual/Abt-Buy, loss: 0.010990656912326813
step: 240, task: Textual/Abt-Buy, loss: 0.051797688007354736
step: 250, task: Textual/Abt-Buy, loss: 0.0016105473041534424
step: 260, task: Textual/Abt-Buy, loss: 0.07533538341522217
step: 270, task: Textual/Abt-Buy, loss: 0.05941259115934372
step: 280, task: Textual/Abt-Buy, loss: 0.08514295518398285
step: 290, task: Textual/Abt-Buy, loss: 0.0036574676632881165
step: 300, task: Textual/Abt-Buy, loss: 0.006478019058704376
step: 310, task: Textual/Abt-Buy, loss: 0.020761381834745407
step: 320, task: Textual/Abt-Buy, loss: 0.056048937141895294
step: 330, task: Textual/Abt-Buy, loss: 0.024442903697490692
step: 340, task: Textual/Abt-Buy, loss: 0.14580076932907104
step: 350, task: Textual/Abt-Buy, loss: 0.0032501816749572754
=========eval at epoch=2=========
Validation:
=============Textual/Abt-Buy==================
accuracy=0.966
precision=0.873
recall=0.801
f1=0.835
======================================
Test:
=============Textual/Abt-Buy==================
accuracy=0.977
precision=0.965
recall=0.811
f1=0.881
======================================
=====sanity check======
words: COL name VAL d-link wireless n usb adapter dwa130 COL description VAL d-link wireless n usb adapter dwa130 complies with draft 802.11 n standards and is backward compatible with 802.11 b/g up to 300 mbps data transfer rates , delivers up to 12x the speed and 4x the range of wireless-g led lights include link and activity wep ( wired equivalent privacy ) , wpa and wpa2 ( wi-fi protected access ) usb 2.0 COL price VAL   [SEP] COL name VAL linksys wga600n wireless gaming adapter COL description VAL 54mbps COL price VAL  
x: [    0 18047   766 27445   385    12 12139  6955   295 49030 36007   385
  2739 11343 14857  8194 27445   385    12 12139  6955   295 49030 36007
   385  2739 11343 13000   918    19  2479 31551     4  1225   295  2820
     8    16 18173 16632    19 31551     4  1225   741    73   571    62
     7  2993   475 27072   414  2937  1162  2156  8806    62     7   316
  1178     5  2078     8   204  1178     5  1186     9  6955    12   571
   669  4666   680  3104     8  1940    52   642    36 26977  6305  4144
  4839  2156   885  6709     8   885  6709   176    36 33755    12  9169
  4371   899  4839 49030   132     4   288 14857   425 27445  1437  1437
     2     2 18047   766 27445  5678  2459   885  2538  4697   282  6955
  6548 36007 14857  8194 27445  4431  6648  3275 14857   425 27445  1437
  1437     2]
tokens: ['<s>', 'COL', 'Ġname', 'ĠVAL', 'Ġd', '-', 'link', 'Ġwireless', 'Ġn', 'Ġusb', 'Ġadapter', 'Ġd', 'wa', '130', 'ĠCOL', 'Ġdescription', 'ĠVAL', 'Ġd', '-', 'link', 'Ġwireless', 'Ġn', 'Ġusb', 'Ġadapter', 'Ġd', 'wa', '130', 'Ġcompl', 'ies', 'Ġwith', 'Ġdraft', 'Ġ802', '.', '11', 'Ġn', 'Ġstandards', 'Ġand', 'Ġis', 'Ġbackward', 'Ġcompatible', 'Ġwith', 'Ġ802', '.', '11', 'Ġb', '/', 'g', 'Ġup', 'Ġto', 'Ġ300', 'Ġm', 'bps', 'Ġdata', 'Ġtransfer', 'Ġrates', 'Ġ,', 'Ġdelivers', 'Ġup', 'Ġto', 'Ġ12', 'x', 'Ġthe', 'Ġspeed', 'Ġand', 'Ġ4', 'x', 'Ġthe', 'Ġrange', 'Ġof', 'Ġwireless', '-', 'g', 'Ġled', 'Ġlights', 'Ġinclude', 'Ġlink', 'Ġand', 'Ġactivity', 'Ġwe', 'p', 'Ġ(', 'Ġwired', 'Ġequivalent', 'Ġprivacy', 'Ġ)', 'Ġ,', 'Ġw', 'pa', 'Ġand', 'Ġw', 'pa', '2', 'Ġ(', 'Ġwi', '-', 'fi', 'Ġprotected', 'Ġaccess', 'Ġ)', 'Ġusb', 'Ġ2', '.', '0', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ', 'Ġ', '</s>', '</s>', 'COL', 'Ġname', 'ĠVAL', 'Ġlinks', 'ys', 'Ġw', 'ga', '600', 'n', 'Ġwireless', 'Ġgaming', 'Ġadapter', 'ĠCOL', 'Ġdescription', 'ĠVAL', 'Ġ54', 'mb', 'ps', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ', 'Ġ', '</s>']
is_heads: [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
y: 0
tags: 0
mask: tensor([1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1])
seqlen: 134
task_name: Textual/Abt-Buy
=======================
step: 0, task: Textual/Abt-Buy, loss: 0.015721451491117477
step: 10, task: Textual/Abt-Buy, loss: 0.0012283623218536377
step: 20, task: Textual/Abt-Buy, loss: 0.0032948702573776245
step: 30, task: Textual/Abt-Buy, loss: 0.0557769276201725
step: 40, task: Textual/Abt-Buy, loss: 0.12379472702741623
step: 50, task: Textual/Abt-Buy, loss: 0.13780748844146729
step: 60, task: Textual/Abt-Buy, loss: 0.04493964836001396
step: 70, task: Textual/Abt-Buy, loss: 0.011171642690896988
step: 80, task: Textual/Abt-Buy, loss: 0.01984543725848198
step: 90, task: Textual/Abt-Buy, loss: 0.008857261389493942
step: 100, task: Textual/Abt-Buy, loss: 0.025529563426971436
step: 110, task: Textual/Abt-Buy, loss: 0.01617945358157158
step: 120, task: Textual/Abt-Buy, loss: 0.04309585317969322
step: 130, task: Textual/Abt-Buy, loss: 0.03568723052740097
step: 140, task: Textual/Abt-Buy, loss: 0.0030899792909622192
step: 150, task: Textual/Abt-Buy, loss: 0.010289710015058517
step: 160, task: Textual/Abt-Buy, loss: 0.045148830860853195
step: 170, task: Textual/Abt-Buy, loss: 0.06375312805175781
step: 180, task: Textual/Abt-Buy, loss: 0.2137814313173294
step: 190, task: Textual/Abt-Buy, loss: 0.02267564833164215
step: 200, task: Textual/Abt-Buy, loss: 0.002906814217567444
step: 210, task: Textual/Abt-Buy, loss: 0.0009457021951675415
step: 220, task: Textual/Abt-Buy, loss: 0.0067960843443870544
step: 230, task: Textual/Abt-Buy, loss: 0.1364176720380783
step: 240, task: Textual/Abt-Buy, loss: 0.0006693899631500244
step: 250, task: Textual/Abt-Buy, loss: 0.004321053624153137
step: 260, task: Textual/Abt-Buy, loss: 0.14935222268104553
step: 270, task: Textual/Abt-Buy, loss: 0.026675483211874962
step: 280, task: Textual/Abt-Buy, loss: 0.0006990730762481689
step: 290, task: Textual/Abt-Buy, loss: 0.2865002453327179
step: 300, task: Textual/Abt-Buy, loss: 0.0033097639679908752
step: 310, task: Textual/Abt-Buy, loss: 0.00189121812582016
step: 320, task: Textual/Abt-Buy, loss: 0.06506019085645676
step: 330, task: Textual/Abt-Buy, loss: 0.001070849597454071
step: 340, task: Textual/Abt-Buy, loss: 0.0004518777132034302
step: 350, task: Textual/Abt-Buy, loss: 0.011035338044166565
=========eval at epoch=3=========
Validation:
=============Textual/Abt-Buy==================
accuracy=0.971
precision=0.847
recall=0.888
f1=0.867
======================================
Test:
=============Textual/Abt-Buy==================
accuracy=0.981
precision=0.952
recall=0.864
f1=0.906
======================================
=====sanity check======
words: COL name VAL panasonic dect 6.0 black expandable digital cordless phone kxtg9361b COL description VAL panasonic dect 6.0 black expandable digital cordless phone kxtg9361b drop and splash resistant multi-handset capability ringer id call waiting caller id voicemail hold mute clock alarm led lighting night mode call block speakerphone 11 days standby 5 hours talk time black finish COL price VAL 48.0  [SEP] COL name VAL panasonic kx-tga820b cordless handset COL description VAL black COL price VAL 39.76 
x: [    0 18047   766 27445  5730 38703   263  3894   231     4   288   909
  3003   868  1778 13051  1672  1028   449 11483   571   466 33736   428
 14857  8194 27445  5730 38703   263  3894   231     4   288   909  3003
   868  1778 13051  1672  1028   449 11483   571   466 33736   428  1874
     8 17158 19152  3228    12 34055   594  9388   910  6082 13561   486
  2445 17017 13561 30118 10555   946 33758  6700  8054   669  7526   363
  5745   486  1803  5385 17283   365   360 28611   195   722  1067    86
   909  2073 14857   425 27445  2929     4   288  1437     2     2 18047
   766 27445  5730 38703   449  1178    12    90  2538 34212   428 13051
  1672 17621 14857  8194 27445   909 14857   425 27445  3191     4  5067
  1437     2]
tokens: ['<s>', 'COL', 'Ġname', 'ĠVAL', 'Ġpan', 'asonic', 'Ġde', 'ct', 'Ġ6', '.', '0', 'Ġblack', 'Ġexpand', 'able', 'Ġdigital', 'Ġcord', 'less', 'Ġphone', 'Ġk', 'xt', 'g', '9', '361', 'b', 'ĠCOL', 'Ġdescription', 'ĠVAL', 'Ġpan', 'asonic', 'Ġde', 'ct', 'Ġ6', '.', '0', 'Ġblack', 'Ġexpand', 'able', 'Ġdigital', 'Ġcord', 'less', 'Ġphone', 'Ġk', 'xt', 'g', '9', '361', 'b', 'Ġdrop', 'Ġand', 'Ġsplash', 'Ġresistant', 'Ġmulti', '-', 'hands', 'et', 'Ġcapability', 'Ġr', 'inger', 'Ġid', 'Ġcall', 'Ġwaiting', 'Ġcaller', 'Ġid', 'Ġvoic', 'email', 'Ġhold', 'Ġmute', 'Ġclock', 'Ġalarm', 'Ġled', 'Ġlighting', 'Ġnight', 'Ġmode', 'Ġcall', 'Ġblock', 'Ġspeaker', 'phone', 'Ġ11', 'Ġdays', 'Ġstandby', 'Ġ5', 'Ġhours', 'Ġtalk', 'Ġtime', 'Ġblack', 'Ġfinish', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ48', '.', '0', 'Ġ', '</s>', '</s>', 'COL', 'Ġname', 'ĠVAL', 'Ġpan', 'asonic', 'Ġk', 'x', '-', 't', 'ga', '820', 'b', 'Ġcord', 'less', 'Ġhandset', 'ĠCOL', 'Ġdescription', 'ĠVAL', 'Ġblack', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ39', '.', '76', 'Ġ', '</s>']
is_heads: [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
y: 0
tags: 0
mask: tensor([1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1])
seqlen: 122
task_name: Textual/Abt-Buy
=======================
step: 0, task: Textual/Abt-Buy, loss: 0.0342034213244915
step: 10, task: Textual/Abt-Buy, loss: 0.012671764940023422
step: 20, task: Textual/Abt-Buy, loss: 0.014120031148195267
step: 30, task: Textual/Abt-Buy, loss: 0.00045271217823028564
step: 40, task: Textual/Abt-Buy, loss: 0.013255611062049866
step: 50, task: Textual/Abt-Buy, loss: 0.0022161006927490234
step: 60, task: Textual/Abt-Buy, loss: 0.01326705515384674
step: 70, task: Textual/Abt-Buy, loss: 0.00025331974029541016
step: 80, task: Textual/Abt-Buy, loss: 0.0007268041372299194
step: 90, task: Textual/Abt-Buy, loss: 0.01615750417113304
step: 100, task: Textual/Abt-Buy, loss: 0.006637804210186005
step: 110, task: Textual/Abt-Buy, loss: 0.00033070147037506104
step: 120, task: Textual/Abt-Buy, loss: 0.006982676684856415
step: 130, task: Textual/Abt-Buy, loss: 0.00024193525314331055
step: 140, task: Textual/Abt-Buy, loss: 0.00019443035125732422
step: 150, task: Textual/Abt-Buy, loss: 0.0392153225839138
step: 160, task: Textual/Abt-Buy, loss: 0.0005094408988952637
step: 170, task: Textual/Abt-Buy, loss: 0.0013524293899536133
step: 180, task: Textual/Abt-Buy, loss: 0.13628196716308594
step: 190, task: Textual/Abt-Buy, loss: 0.0010203719139099121
step: 200, task: Textual/Abt-Buy, loss: 0.08668272197246552
step: 210, task: Textual/Abt-Buy, loss: 0.023090675473213196
step: 220, task: Textual/Abt-Buy, loss: 0.0025862082839012146
step: 230, task: Textual/Abt-Buy, loss: 0.00047457218170166016
step: 240, task: Textual/Abt-Buy, loss: 0.001594342291355133
step: 250, task: Textual/Abt-Buy, loss: 0.0005549341440200806
step: 260, task: Textual/Abt-Buy, loss: 0.0006906688213348389
step: 270, task: Textual/Abt-Buy, loss: 0.34739619493484497
step: 280, task: Textual/Abt-Buy, loss: 0.004946254193782806
step: 290, task: Textual/Abt-Buy, loss: 0.0008884072303771973
step: 300, task: Textual/Abt-Buy, loss: 0.0008209496736526489
step: 310, task: Textual/Abt-Buy, loss: 0.031158454716205597
step: 320, task: Textual/Abt-Buy, loss: 0.038887590169906616
step: 330, task: Textual/Abt-Buy, loss: 0.0008526220917701721
step: 340, task: Textual/Abt-Buy, loss: 0.0003216564655303955
step: 350, task: Textual/Abt-Buy, loss: 0.0005130171775817871
=========eval at epoch=4=========
Validation:
=============Textual/Abt-Buy==================
accuracy=0.972
precision=0.904
recall=0.825
f1=0.863
======================================
Test:
=============Textual/Abt-Buy==================
accuracy=0.978
precision=0.906
recall=0.888
f1=0.897
======================================
=====sanity check======
words: COL name VAL toshiba 22 ' lcd hdtv with built in dvd player in white 22lv506 COL description VAL toshiba 22 ' lcd hdtv with built in dvd player in white 22lv506 built-in slot loading dvd player built-in atsc/ntsc/qam digital tuning official divx certified pc input space saving design bottom mount stereo speakers glossy white finish COL price VAL   [SEP] COL name VAL toshiba d-r410 dvd player/recorder COL description VAL toshiba d-r410 dvd recorder w / 1080p upconversion COL price VAL  
x: [    0 18047   766 27445     7  1193 15577   820   128   784 28690  1368
   417 18724    19  1490    11   385 40311   869    11  1104   820 25091
 36647 14857  8194 27445     7  1193 15577   820   128   784 28690  1368
   417 18724    19  1490    11   385 40311   869    11  1104   820 25091
 36647  1490    12   179  8534 16761   385 40311   869  1490    12   179
    23  3866    73  3999  3866    73  1343   424  1778 28927   781 14445
  1178  9785 46213  8135   980  6549  1521  2576 14206 31436  6864 29282
  1104  2073 14857   425 27445  1437  1437     2     2 18047   766 27445
     7  1193 15577   385    12   338 31132   385 40311   869    73 13139
 10337 14857  8194 27445     7  1193 15577   385    12   338 31132   385
 40311 32017   885  1589 21083   642    62  3865 21747 14857   425 27445
  1437  1437     2]
tokens: ['<s>', 'COL', 'Ġname', 'ĠVAL', 'Ġto', 'sh', 'iba', 'Ġ22', "Ġ'", 'Ġl', 'cd', 'Ġh', 'd', 'tv', 'Ġwith', 'Ġbuilt', 'Ġin', 'Ġd', 'vd', 'Ġplayer', 'Ġin', 'Ġwhite', 'Ġ22', 'lv', '506', 'ĠCOL', 'Ġdescription', 'ĠVAL', 'Ġto', 'sh', 'iba', 'Ġ22', "Ġ'", 'Ġl', 'cd', 'Ġh', 'd', 'tv', 'Ġwith', 'Ġbuilt', 'Ġin', 'Ġd', 'vd', 'Ġplayer', 'Ġin', 'Ġwhite', 'Ġ22', 'lv', '506', 'Ġbuilt', '-', 'in', 'Ġslot', 'Ġloading', 'Ġd', 'vd', 'Ġplayer', 'Ġbuilt', '-', 'in', 'Ġat', 'sc', '/', 'nt', 'sc', '/', 'q', 'am', 'Ġdigital', 'Ġtuning', 'Ġofficial', 'Ġdiv', 'x', 'Ġcertified', 'Ġpc', 'Ġinput', 'Ġspace', 'Ġsaving', 'Ġdesign', 'Ġbottom', 'Ġmount', 'Ġstereo', 'Ġspeakers', 'Ġglossy', 'Ġwhite', 'Ġfinish', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ', 'Ġ', '</s>', '</s>', 'COL', 'Ġname', 'ĠVAL', 'Ġto', 'sh', 'iba', 'Ġd', '-', 'r', '410', 'Ġd', 'vd', 'Ġplayer', '/', 'rec', 'order', 'ĠCOL', 'Ġdescription', 'ĠVAL', 'Ġto', 'sh', 'iba', 'Ġd', '-', 'r', '410', 'Ġd', 'vd', 'Ġrecorder', 'Ġw', 'Ġ/', 'Ġ1080', 'p', 'Ġup', 'con', 'version', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ', 'Ġ', '</s>']
is_heads: [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
y: 0
tags: 0
mask: tensor([1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1])
seqlen: 135
task_name: Textual/Abt-Buy
=======================
step: 0, task: Textual/Abt-Buy, loss: 0.02001902461051941
step: 10, task: Textual/Abt-Buy, loss: 0.003344208002090454
step: 20, task: Textual/Abt-Buy, loss: 0.0025128647685050964
step: 30, task: Textual/Abt-Buy, loss: 0.0009708032011985779
step: 40, task: Textual/Abt-Buy, loss: 0.0002892911434173584
step: 50, task: Textual/Abt-Buy, loss: 0.0002116560935974121
step: 60, task: Textual/Abt-Buy, loss: 0.0002809464931488037
step: 70, task: Textual/Abt-Buy, loss: 0.0004688352346420288
step: 80, task: Textual/Abt-Buy, loss: 0.00017884373664855957
step: 90, task: Textual/Abt-Buy, loss: 0.0001821070909500122
step: 100, task: Textual/Abt-Buy, loss: 0.00017088651657104492
step: 110, task: Textual/Abt-Buy, loss: 0.0005400180816650391
step: 120, task: Textual/Abt-Buy, loss: 0.014838337898254395
step: 130, task: Textual/Abt-Buy, loss: 0.3666132092475891
step: 140, task: Textual/Abt-Buy, loss: 0.0011620894074440002
step: 150, task: Textual/Abt-Buy, loss: 0.055224306881427765
step: 160, task: Textual/Abt-Buy, loss: 0.004020102322101593
step: 170, task: Textual/Abt-Buy, loss: 0.07391612231731415
step: 180, task: Textual/Abt-Buy, loss: 0.0007399767637252808
step: 190, task: Textual/Abt-Buy, loss: 0.0024747923016548157
step: 200, task: Textual/Abt-Buy, loss: 0.0009884834289550781
step: 210, task: Textual/Abt-Buy, loss: 0.004701852798461914
step: 220, task: Textual/Abt-Buy, loss: 0.1567714661359787
step: 230, task: Textual/Abt-Buy, loss: 0.002446964383125305
step: 240, task: Textual/Abt-Buy, loss: 0.0008008331060409546
step: 250, task: Textual/Abt-Buy, loss: 0.00043372809886932373
step: 260, task: Textual/Abt-Buy, loss: 0.0006035566329956055
step: 270, task: Textual/Abt-Buy, loss: 0.002989061176776886
step: 280, task: Textual/Abt-Buy, loss: 0.00198325514793396
step: 290, task: Textual/Abt-Buy, loss: 0.0008934140205383301
step: 300, task: Textual/Abt-Buy, loss: 0.001107543706893921
step: 310, task: Textual/Abt-Buy, loss: 0.30034637451171875
step: 320, task: Textual/Abt-Buy, loss: 0.003965854644775391
step: 330, task: Textual/Abt-Buy, loss: 0.00031951069831848145
step: 340, task: Textual/Abt-Buy, loss: 0.029510710388422012
step: 350, task: Textual/Abt-Buy, loss: 0.004930995404720306
=========eval at epoch=5=========
Validation:
=============Textual/Abt-Buy==================
accuracy=0.973
precision=0.905
recall=0.835
f1=0.869
======================================
Test:
=============Textual/Abt-Buy==================
accuracy=0.979
precision=0.915
recall=0.888
f1=0.901
======================================
=====sanity check======
words: COL name VAL sanus sc1a black visionmount series ceiling mount for small lcd flat panels sc1ab COL description VAL sanus sc1a black visionmount series ceiling mount for small lcd flat panels sc1ab fits most 13 ' 26 ' lcd flat panel televisions vesa compatible tv bracket smoothlock technology built-in wire management system 50 lbs capacity black finish COL price VAL 99.99  [SEP] COL name VAL sanus flat panel tv wall mount vmpl50-b COL description VAL steel 130 lb COL price VAL  
x: [    0 18047   766 27445 15610   687  2850   134   102   909  3360 17336
   651  9920 14206    13   650   784 28690  3269  9217  2850   134   873
 14857  8194 27445 15610   687  2850   134   102   909  3360 17336   651
  9920 14206    13   650   784 28690  3269  9217  2850   134   873 10698
   144   508   128   973   128   784 28690  3269  2798 20928 12545   748
 18382 16632 30016 16871  6921  8292   806  1490    12   179  8869  1052
   467   654 23246  2148   909  2073 14857   425 27445  6705     4  2831
  1437     2     2 18047   766 27445 15610   687  3269  2798 30016  2204
 14206 48643  2911  1096    12   428 14857  8194 27445  3689  8325 19821
 14857   425 27445  1437  1437     2]
tokens: ['<s>', 'COL', 'Ġname', 'ĠVAL', 'Ġsan', 'us', 'Ġsc', '1', 'a', 'Ġblack', 'Ġvision', 'mount', 'Ġseries', 'Ġceiling', 'Ġmount', 'Ġfor', 'Ġsmall', 'Ġl', 'cd', 'Ġflat', 'Ġpanels', 'Ġsc', '1', 'ab', 'ĠCOL', 'Ġdescription', 'ĠVAL', 'Ġsan', 'us', 'Ġsc', '1', 'a', 'Ġblack', 'Ġvision', 'mount', 'Ġseries', 'Ġceiling', 'Ġmount', 'Ġfor', 'Ġsmall', 'Ġl', 'cd', 'Ġflat', 'Ġpanels', 'Ġsc', '1', 'ab', 'Ġfits', 'Ġmost', 'Ġ13', "Ġ'", 'Ġ26', "Ġ'", 'Ġl', 'cd', 'Ġflat', 'Ġpanel', 'Ġtelev', 'isions', 'Ġv', 'esa', 'Ġcompatible', 'Ġtv', 'Ġbracket', 'Ġsmooth', 'lock', 'Ġtechnology', 'Ġbuilt', '-', 'in', 'Ġwire', 'Ġmanagement', 'Ġsystem', 'Ġ50', 'Ġlbs', 'Ġcapacity', 'Ġblack', 'Ġfinish', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ99', '.', '99', 'Ġ', '</s>', '</s>', 'COL', 'Ġname', 'ĠVAL', 'Ġsan', 'us', 'Ġflat', 'Ġpanel', 'Ġtv', 'Ġwall', 'Ġmount', 'Ġvm', 'pl', '50', '-', 'b', 'ĠCOL', 'Ġdescription', 'ĠVAL', 'Ġsteel', 'Ġ130', 'Ġlb', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ', 'Ġ', '</s>']
is_heads: [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
y: 0
tags: 0
mask: tensor([1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1])
seqlen: 114
task_name: Textual/Abt-Buy
=======================
step: 0, task: Textual/Abt-Buy, loss: 0.003053322434425354
step: 10, task: Textual/Abt-Buy, loss: 0.0004913061857223511
step: 20, task: Textual/Abt-Buy, loss: 0.0077245235443115234
step: 30, task: Textual/Abt-Buy, loss: 0.00046256184577941895
step: 40, task: Textual/Abt-Buy, loss: 0.001751542091369629
step: 50, task: Textual/Abt-Buy, loss: 0.032657332718372345
step: 60, task: Textual/Abt-Buy, loss: 0.0009032338857650757
step: 70, task: Textual/Abt-Buy, loss: 0.028971701860427856
step: 80, task: Textual/Abt-Buy, loss: 0.0003116428852081299
step: 90, task: Textual/Abt-Buy, loss: 0.09219248592853546
step: 100, task: Textual/Abt-Buy, loss: 0.00025741755962371826
step: 110, task: Textual/Abt-Buy, loss: 0.0006357282400131226
step: 120, task: Textual/Abt-Buy, loss: 0.00036916136741638184
step: 130, task: Textual/Abt-Buy, loss: 0.00016489624977111816
step: 140, task: Textual/Abt-Buy, loss: 0.00026683509349823
step: 150, task: Textual/Abt-Buy, loss: 0.00013281404972076416
step: 160, task: Textual/Abt-Buy, loss: 0.0006897971034049988
step: 170, task: Textual/Abt-Buy, loss: 0.00015527009963989258
step: 180, task: Textual/Abt-Buy, loss: 0.003590628504753113
step: 190, task: Textual/Abt-Buy, loss: 0.00018462538719177246
step: 200, task: Textual/Abt-Buy, loss: 0.02104116976261139
step: 210, task: Textual/Abt-Buy, loss: 0.00011913478374481201
step: 220, task: Textual/Abt-Buy, loss: 0.0007544234395027161
step: 230, task: Textual/Abt-Buy, loss: 0.00013180077075958252
step: 240, task: Textual/Abt-Buy, loss: 0.02394861914217472
step: 250, task: Textual/Abt-Buy, loss: 0.00013816356658935547
step: 260, task: Textual/Abt-Buy, loss: 0.0003797262907028198
step: 270, task: Textual/Abt-Buy, loss: 0.00019846856594085693
step: 280, task: Textual/Abt-Buy, loss: 0.0003634840250015259
step: 290, task: Textual/Abt-Buy, loss: 0.00014659762382507324
step: 300, task: Textual/Abt-Buy, loss: 0.00014790892601013184
step: 310, task: Textual/Abt-Buy, loss: 0.44089579582214355
step: 320, task: Textual/Abt-Buy, loss: 0.010497517883777618
step: 330, task: Textual/Abt-Buy, loss: 0.0031177252531051636
step: 340, task: Textual/Abt-Buy, loss: 0.001153796911239624
step: 350, task: Textual/Abt-Buy, loss: 0.0005258768796920776
=========eval at epoch=6=========
Validation:
=============Textual/Abt-Buy==================
accuracy=0.971
precision=0.883
recall=0.845
f1=0.864
======================================
Test:
=============Textual/Abt-Buy==================
accuracy=0.982
precision=0.938
recall=0.888
f1=0.913
======================================
=====sanity check======
words: COL name VAL sony 4gb memory stick pro duo mark 2 media card msmt4g COL description VAL sony 4gb memory stick pro duo mark 2 media card msmt4g 160 mbps transfer speed ideal for avchd recording 3.66 gb actual capacity COL price VAL   [SEP] COL name VAL sony 2gb memory stick micro ( m2 ) msa2gd COL description VAL 2 gb COL price VAL  
x: [    0 18047   766 27445   579  6119   204 19562  3783  4757  1759  6458
  2458   132   433  1886   475  9426    90   306   571 14857  8194 27445
   579  6119   204 19562  3783  4757  1759  6458  2458   132   433  1886
   475  9426    90   306   571 10572   475 27072  2937  2078  5631    13
  6402   611   417  5492   155     4  4280   821   428  3031  2148 14857
   425 27445  1437  1437     2     2 18047   766 27445   579  6119   132
 19562  3783  4757  5177    36   475   176  4839   475 11146   176 27122
 14857  8194 27445   132   821   428 14857   425 27445  1437  1437     2]
tokens: ['<s>', 'COL', 'Ġname', 'ĠVAL', 'Ġs', 'ony', 'Ġ4', 'gb', 'Ġmemory', 'Ġstick', 'Ġpro', 'Ġduo', 'Ġmark', 'Ġ2', 'Ġmedia', 'Ġcard', 'Ġm', 'sm', 't', '4', 'g', 'ĠCOL', 'Ġdescription', 'ĠVAL', 'Ġs', 'ony', 'Ġ4', 'gb', 'Ġmemory', 'Ġstick', 'Ġpro', 'Ġduo', 'Ġmark', 'Ġ2', 'Ġmedia', 'Ġcard', 'Ġm', 'sm', 't', '4', 'g', 'Ġ160', 'Ġm', 'bps', 'Ġtransfer', 'Ġspeed', 'Ġideal', 'Ġfor', 'Ġav', 'ch', 'd', 'Ġrecording', 'Ġ3', '.', '66', 'Ġg', 'b', 'Ġactual', 'Ġcapacity', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ', 'Ġ', '</s>', '</s>', 'COL', 'Ġname', 'ĠVAL', 'Ġs', 'ony', 'Ġ2', 'gb', 'Ġmemory', 'Ġstick', 'Ġmicro', 'Ġ(', 'Ġm', '2', 'Ġ)', 'Ġm', 'sa', '2', 'gd', 'ĠCOL', 'Ġdescription', 'ĠVAL', 'Ġ2', 'Ġg', 'b', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ', 'Ġ', '</s>']
is_heads: [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
y: 0
tags: 0
mask: tensor([1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1])
seqlen: 96
task_name: Textual/Abt-Buy
=======================
step: 0, task: Textual/Abt-Buy, loss: 0.00018669664859771729
step: 10, task: Textual/Abt-Buy, loss: 0.0002192854881286621
step: 20, task: Textual/Abt-Buy, loss: 0.00019547343254089355
step: 30, task: Textual/Abt-Buy, loss: 0.00016216933727264404
step: 40, task: Textual/Abt-Buy, loss: 0.00016379356384277344
step: 50, task: Textual/Abt-Buy, loss: 0.0001332014799118042
step: 60, task: Textual/Abt-Buy, loss: 0.00040647387504577637
step: 70, task: Textual/Abt-Buy, loss: 0.0023202523589134216
step: 80, task: Textual/Abt-Buy, loss: 0.00018133223056793213
step: 90, task: Textual/Abt-Buy, loss: 0.016674838960170746
step: 100, task: Textual/Abt-Buy, loss: 0.0002605020999908447
step: 110, task: Textual/Abt-Buy, loss: 0.00039631128311157227
step: 120, task: Textual/Abt-Buy, loss: 0.00041663646697998047
step: 130, task: Textual/Abt-Buy, loss: 0.00017309188842773438
step: 140, task: Textual/Abt-Buy, loss: 0.1475045531988144
step: 150, task: Textual/Abt-Buy, loss: 0.00019988417625427246
step: 160, task: Textual/Abt-Buy, loss: 0.00033912062644958496
step: 170, task: Textual/Abt-Buy, loss: 0.004482846707105637
step: 180, task: Textual/Abt-Buy, loss: 0.00022658705711364746
step: 190, task: Textual/Abt-Buy, loss: 0.00026141107082366943
step: 200, task: Textual/Abt-Buy, loss: 0.0005512535572052002
step: 210, task: Textual/Abt-Buy, loss: 0.00043107569217681885
step: 220, task: Textual/Abt-Buy, loss: 0.005294736474752426
step: 230, task: Textual/Abt-Buy, loss: 0.0003248751163482666
step: 240, task: Textual/Abt-Buy, loss: 0.00023250281810760498
step: 250, task: Textual/Abt-Buy, loss: 0.001063413918018341
step: 260, task: Textual/Abt-Buy, loss: 0.10188739746809006
step: 270, task: Textual/Abt-Buy, loss: 0.00037807226181030273
step: 280, task: Textual/Abt-Buy, loss: 0.0005313903093338013
step: 290, task: Textual/Abt-Buy, loss: 0.0008667856454849243
step: 300, task: Textual/Abt-Buy, loss: 0.0002336651086807251
step: 310, task: Textual/Abt-Buy, loss: 0.0002149045467376709
step: 320, task: Textual/Abt-Buy, loss: 0.00034987926483154297
step: 330, task: Textual/Abt-Buy, loss: 0.004775315523147583
step: 340, task: Textual/Abt-Buy, loss: 0.00021885335445404053
step: 350, task: Textual/Abt-Buy, loss: 0.0003182440996170044
=========eval at epoch=7=========
Validation:
=============Textual/Abt-Buy==================
accuracy=0.971
precision=0.872
recall=0.859
f1=0.866
======================================
Test:
=============Textual/Abt-Buy==================
accuracy=0.980
precision=0.920
recall=0.893
f1=0.906
======================================
=====sanity check======
words: COL name VAL toshiba 22 ' lcd hdtv with built in dvd player in black 22lv505 COL description VAL toshiba 22 ' lcd hdtv with built in dvd player in black 22lv505 built-in slot loading dvd player built-in atsc/ntsc/qam digital tuning official divx ® certified pc input space saving design bottom mount stereo speakers black finish COL price VAL   [SEP] COL name VAL toshiba d-r410 dvd player/recorder COL description VAL toshiba d-r410 dvd recorder w / 1080p upconversion COL price VAL  
x: [    0 18047   766 27445     7  1193 15577   820   128   784 28690  1368
   417 18724    19  1490    11   385 40311   869    11   909   820 25091
 35255 14857  8194 27445     7  1193 15577   820   128   784 28690  1368
   417 18724    19  1490    11   385 40311   869    11   909   820 25091
 35255  1490    12   179  8534 16761   385 40311   869  1490    12   179
    23  3866    73  3999  3866    73  1343   424  1778 28927   781 14445
  1178 39110  9785 46213  8135   980  6549  1521  2576 14206 31436  6864
   909  2073 14857   425 27445  1437  1437     2     2 18047   766 27445
     7  1193 15577   385    12   338 31132   385 40311   869    73 13139
 10337 14857  8194 27445     7  1193 15577   385    12   338 31132   385
 40311 32017   885  1589 21083   642    62  3865 21747 14857   425 27445
  1437  1437     2]
tokens: ['<s>', 'COL', 'Ġname', 'ĠVAL', 'Ġto', 'sh', 'iba', 'Ġ22', "Ġ'", 'Ġl', 'cd', 'Ġh', 'd', 'tv', 'Ġwith', 'Ġbuilt', 'Ġin', 'Ġd', 'vd', 'Ġplayer', 'Ġin', 'Ġblack', 'Ġ22', 'lv', '505', 'ĠCOL', 'Ġdescription', 'ĠVAL', 'Ġto', 'sh', 'iba', 'Ġ22', "Ġ'", 'Ġl', 'cd', 'Ġh', 'd', 'tv', 'Ġwith', 'Ġbuilt', 'Ġin', 'Ġd', 'vd', 'Ġplayer', 'Ġin', 'Ġblack', 'Ġ22', 'lv', '505', 'Ġbuilt', '-', 'in', 'Ġslot', 'Ġloading', 'Ġd', 'vd', 'Ġplayer', 'Ġbuilt', '-', 'in', 'Ġat', 'sc', '/', 'nt', 'sc', '/', 'q', 'am', 'Ġdigital', 'Ġtuning', 'Ġofficial', 'Ġdiv', 'x', 'ĠÂ®', 'Ġcertified', 'Ġpc', 'Ġinput', 'Ġspace', 'Ġsaving', 'Ġdesign', 'Ġbottom', 'Ġmount', 'Ġstereo', 'Ġspeakers', 'Ġblack', 'Ġfinish', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ', 'Ġ', '</s>', '</s>', 'COL', 'Ġname', 'ĠVAL', 'Ġto', 'sh', 'iba', 'Ġd', '-', 'r', '410', 'Ġd', 'vd', 'Ġplayer', '/', 'rec', 'order', 'ĠCOL', 'Ġdescription', 'ĠVAL', 'Ġto', 'sh', 'iba', 'Ġd', '-', 'r', '410', 'Ġd', 'vd', 'Ġrecorder', 'Ġw', 'Ġ/', 'Ġ1080', 'p', 'Ġup', 'con', 'version', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ', 'Ġ', '</s>']
is_heads: [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
y: 0
tags: 0
mask: tensor([1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1])
seqlen: 135
task_name: Textual/Abt-Buy
=======================
step: 0, task: Textual/Abt-Buy, loss: 0.0003808438777923584
step: 10, task: Textual/Abt-Buy, loss: 0.0003441125154495239
step: 20, task: Textual/Abt-Buy, loss: 0.00021417438983917236
step: 30, task: Textual/Abt-Buy, loss: 0.002173803746700287
step: 40, task: Textual/Abt-Buy, loss: 0.00021164119243621826
step: 50, task: Textual/Abt-Buy, loss: 0.0073732659220695496
step: 60, task: Textual/Abt-Buy, loss: 0.0008168742060661316
step: 70, task: Textual/Abt-Buy, loss: 0.05764816701412201
Gradient overflow.  Skipping step, loss scaler 0 reducing loss scale to 8192.0
step: 80, task: Textual/Abt-Buy, loss: 0.004335746169090271
step: 90, task: Textual/Abt-Buy, loss: 0.00046068429946899414
step: 100, task: Textual/Abt-Buy, loss: 0.00025416910648345947
step: 110, task: Textual/Abt-Buy, loss: 0.006952978670597076
step: 120, task: Textual/Abt-Buy, loss: 0.010726232081651688
step: 130, task: Textual/Abt-Buy, loss: 0.0001811385154724121
step: 140, task: Textual/Abt-Buy, loss: 0.00029884278774261475
step: 150, task: Textual/Abt-Buy, loss: 0.00023157894611358643
step: 160, task: Textual/Abt-Buy, loss: 0.00027433037757873535
step: 170, task: Textual/Abt-Buy, loss: 0.009756043553352356
step: 180, task: Textual/Abt-Buy, loss: 0.018717896193265915
step: 190, task: Textual/Abt-Buy, loss: 0.0032298527657985687
step: 200, task: Textual/Abt-Buy, loss: 0.00014922022819519043
step: 210, task: Textual/Abt-Buy, loss: 0.00048516690731048584
step: 220, task: Textual/Abt-Buy, loss: 0.0002107173204421997
step: 230, task: Textual/Abt-Buy, loss: 0.03579682111740112
step: 240, task: Textual/Abt-Buy, loss: 0.0001744776964187622
step: 250, task: Textual/Abt-Buy, loss: 0.00019814074039459229
step: 260, task: Textual/Abt-Buy, loss: 0.0001858919858932495
step: 270, task: Textual/Abt-Buy, loss: 0.00047895312309265137
step: 280, task: Textual/Abt-Buy, loss: 0.0004092007875442505
step: 290, task: Textual/Abt-Buy, loss: 0.0002383589744567871
step: 300, task: Textual/Abt-Buy, loss: 0.00025121867656707764
step: 310, task: Textual/Abt-Buy, loss: 0.002679482102394104
step: 320, task: Textual/Abt-Buy, loss: 0.00027123093605041504
step: 330, task: Textual/Abt-Buy, loss: 0.00026647746562957764
step: 340, task: Textual/Abt-Buy, loss: 0.007855992764234543
step: 350, task: Textual/Abt-Buy, loss: 0.010374918580055237
=========eval at epoch=8=========
Validation:
=============Textual/Abt-Buy==================
accuracy=0.971
precision=0.872
recall=0.859
f1=0.866
======================================
Test:
=============Textual/Abt-Buy==================
accuracy=0.980
precision=0.920
recall=0.893
f1=0.906
======================================
Selected optimization level O2:  FP16 training with FP32 batchnorm and FP32 master weights.

Defaults for this optimization level are:
enabled                : True
opt_level              : O2
cast_model_type        : torch.float16
patch_torch_functions  : False
keep_batchnorm_fp32    : True
master_weights         : True
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O2
cast_model_type        : torch.float16
patch_torch_functions  : False
keep_batchnorm_fp32    : True
master_weights         : True
loss_scale             : dynamic
Warning:  multi_tensor_applier fused unscale kernel is unavailable, possibly because apex was installed without --cuda_ext --cpp_ext. Using Python fallback.  Original ImportError was: ModuleNotFoundError("No module named 'amp_C'")
Gradient overflow.  Skipping step, loss scaler 0 reducing loss scale to 32768.0
=====sanity check======
words: COL name VAL linksys wireless n access point wap4400n COL description VAL linksys wireless n access point wap4400n full backwards compatibility for 802.11 b and 802.11 g easy installation and configuration gigabit ethernet lan interface supports power over ethernet wmm wireless qos support COL price VAL   [SEP] COL name VAL linksys wrv54g wireless-g vpn broadband router COL description VAL  COL price VAL  
x: [    0 18047   766 27445  5678  2459  6955   295   899   477   885  1115
  3305   612   282 14857  8194 27445  5678  2459  6955   295   899   477
   885  1115  3305   612   282   455 19312 29988    13 31551     4  1225
   741     8 31551     4  1225   821  1365  8809     8 20393 10196 30820
 41014  4135 33532 12332  4548   476    81 41014  4135   885  5471  6955
  2231   366   323 14857   425 27445  1437  1437     2     2 18047   766
 27445  5678  2459 14902   705  4283   571  6955    12   571   748 35857
 11451 30577 14857  8194 27445  1437 14857   425 27445  1437  1437     2]
tokens: ['<s>', 'COL', 'Ġname', 'ĠVAL', 'Ġlinks', 'ys', 'Ġwireless', 'Ġn', 'Ġaccess', 'Ġpoint', 'Ġw', 'ap', '44', '00', 'n', 'ĠCOL', 'Ġdescription', 'ĠVAL', 'Ġlinks', 'ys', 'Ġwireless', 'Ġn', 'Ġaccess', 'Ġpoint', 'Ġw', 'ap', '44', '00', 'n', 'Ġfull', 'Ġbackwards', 'Ġcompatibility', 'Ġfor', 'Ġ802', '.', '11', 'Ġb', 'Ġand', 'Ġ802', '.', '11', 'Ġg', 'Ġeasy', 'Ġinstallation', 'Ġand', 'Ġconfiguration', 'Ġgig', 'abit', 'Ġether', 'net', 'Ġlan', 'Ġinterface', 'Ġsupports', 'Ġpower', 'Ġover', 'Ġether', 'net', 'Ġw', 'mm', 'Ġwireless', 'Ġq', 'os', 'Ġsupport', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ', 'Ġ', '</s>', '</s>', 'COL', 'Ġname', 'ĠVAL', 'Ġlinks', 'ys', 'Ġwr', 'v', '54', 'g', 'Ġwireless', '-', 'g', 'Ġv', 'pn', 'Ġbroadband', 'Ġrouter', 'ĠCOL', 'Ġdescription', 'ĠVAL', 'Ġ', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ', 'Ġ', '</s>']
is_heads: [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
y: 0
tags: 0
mask: tensor([1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1])
seqlen: 96
task_name: Textual/Abt-Buy
=======================
step: 0, task: Textual/Abt-Buy, loss: 0.6931143999099731
Gradient overflow.  Skipping step, loss scaler 0 reducing loss scale to 16384.0
Gradient overflow.  Skipping step, loss scaler 0 reducing loss scale to 8192.0
Gradient overflow.  Skipping step, loss scaler 0 reducing loss scale to 4096.0
step: 10, task: Textual/Abt-Buy, loss: 0.6572545766830444
step: 20, task: Textual/Abt-Buy, loss: 0.5735180377960205
step: 30, task: Textual/Abt-Buy, loss: 0.49520838260650635
step: 40, task: Textual/Abt-Buy, loss: 0.3022446632385254
step: 50, task: Textual/Abt-Buy, loss: 0.25873780250549316
step: 60, task: Textual/Abt-Buy, loss: 0.09847880899906158
step: 70, task: Textual/Abt-Buy, loss: 0.3086192011833191
step: 80, task: Textual/Abt-Buy, loss: 0.2509258985519409
step: 90, task: Textual/Abt-Buy, loss: 0.2527959942817688
step: 100, task: Textual/Abt-Buy, loss: 0.315940260887146
step: 110, task: Textual/Abt-Buy, loss: 0.4745287299156189
step: 120, task: Textual/Abt-Buy, loss: 0.6817874312400818
step: 130, task: Textual/Abt-Buy, loss: 0.12195803225040436
step: 140, task: Textual/Abt-Buy, loss: 0.21480900049209595
step: 150, task: Textual/Abt-Buy, loss: 0.27538812160491943
step: 160, task: Textual/Abt-Buy, loss: 0.25108233094215393
step: 170, task: Textual/Abt-Buy, loss: 0.14226087927818298
step: 180, task: Textual/Abt-Buy, loss: 0.46943578124046326
step: 190, task: Textual/Abt-Buy, loss: 0.12334354966878891
step: 200, task: Textual/Abt-Buy, loss: 0.08804749697446823
step: 210, task: Textual/Abt-Buy, loss: 0.2676217257976532
step: 220, task: Textual/Abt-Buy, loss: 0.2115228772163391
step: 230, task: Textual/Abt-Buy, loss: 0.49512436985969543
step: 240, task: Textual/Abt-Buy, loss: 0.29163628816604614
step: 250, task: Textual/Abt-Buy, loss: 0.40957367420196533
step: 260, task: Textual/Abt-Buy, loss: 0.15749192237854004
step: 270, task: Textual/Abt-Buy, loss: 0.2685317099094391
step: 280, task: Textual/Abt-Buy, loss: 0.06649111956357956
step: 290, task: Textual/Abt-Buy, loss: 0.885743260383606
step: 300, task: Textual/Abt-Buy, loss: 0.20840878784656525
step: 310, task: Textual/Abt-Buy, loss: 0.36424362659454346
step: 320, task: Textual/Abt-Buy, loss: 0.615665853023529
step: 330, task: Textual/Abt-Buy, loss: 0.17499324679374695
step: 340, task: Textual/Abt-Buy, loss: 0.3811807632446289
step: 350, task: Textual/Abt-Buy, loss: 0.40667033195495605
=========eval at epoch=1=========
Validation:
=============Textual/Abt-Buy==================
accuracy=0.892
precision=0.000
recall=0.000
f1=0.000
======================================
Test:
=============Textual/Abt-Buy==================
accuracy=0.892
precision=0.000
recall=0.000
f1=0.000
======================================
/w/246/tianyu2020/miniconda2/envs/ditto/lib/python3.7/site-packages/apex/amp/_initialize.py:24: UserWarning: An input tensor was not cuda.
  warnings.warn("An input tensor was not cuda.")
/w/246/tianyu2020/miniconda2/envs/ditto/lib/python3.7/site-packages/torch/optim/lr_scheduler.py:122: UserWarning: Detected call of `lr_scheduler.step()` before `optimizer.step()`. In PyTorch 1.1.0 and later, you should call them in the opposite order: `optimizer.step()` before `lr_scheduler.step()`.  Failure to do this will result in PyTorch skipping the first value of the learning rate schedule. See more details at https://pytorch.org/docs/stable/optim.html#how-to-adjust-learning-rate
  "https://pytorch.org/docs/stable/optim.html#how-to-adjust-learning-rate", UserWarning)
/w/246/tianyu2020/miniconda2/envs/ditto/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1221: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
=====sanity check======
words: COL name VAL sony 46 ' bravia s-series black lcd flat panel hdtv kdl46s4100 COL description VAL sony 46 ' bravia s-series black lcd flat panel hdtv kdl46s4100 1920 x 1080 full hd resolution 24p true cinema atsctm/ntsc tuner with qam 2,500:1 contrast ratio cinemotion reverse 3:2 pulldown technology 3d comb filter mpeg noise reduction black finish COL price VAL   [SEP] COL name VAL sony bravia xbr series kdl-52xbr6 52 ' lcd tv kdl52xbr6 COL description VAL 52 ' active matrix tft atsc , ntsc 16:9 1920 x 1080 dolby , surround hdtv 480i , 480p , 720p , 1080i , 1080p COL price VAL 2573.72 
x: [    0 18047   766 27445   579  6119  4059   128 35977   493   579    12
 22760   909   784 28690  3269  2798  1368   417 18724   449 30469  3761
    29   306  1866 14857  8194 27445   579  6119  4059   128 35977   493
   579    12 22760   909   784 28690  3269  2798  1368   417 18724   449
 30469  3761    29   306  1866 18283  3023 21083   455  1368   417  3547
   706   642  1528 11605    23    29  3894   119    73  3999  3866 27115
   254    19  2231   424   132     6  1497    35   134  5709  1750 18535
 19187  7213   155    35   176  2999  3955   806   155   417 14960 14929
   475 41191  6496  4878   909  2073 14857   425 27445  1437  1437     2
     2 18047   766 27445   579  6119 35977   493  3023  3809   651   449
 30469    12  4429  1178  3809   401  3135   128   784 28690 30016   449
 30469  4429  1178  3809   401 14857  8194 27445  3135   128  2171 36173
   326  2543    23  3866  2156   295  1872   438   545    35   466 18283
  3023 21083   385  1168  1409  2156 21104  1368   417 18724 26754   118
  2156 26754   642  2156 26180   642  2156 21083   118  2156 21083   642
 14857   425 27445   564  5352     4  4956  1437     2]
tokens: ['<s>', 'COL', 'Ġname', 'ĠVAL', 'Ġs', 'ony', 'Ġ46', "Ġ'", 'Ġbrav', 'ia', 'Ġs', '-', 'series', 'Ġblack', 'Ġl', 'cd', 'Ġflat', 'Ġpanel', 'Ġh', 'd', 'tv', 'Ġk', 'dl', '46', 's', '4', '100', 'ĠCOL', 'Ġdescription', 'ĠVAL', 'Ġs', 'ony', 'Ġ46', "Ġ'", 'Ġbrav', 'ia', 'Ġs', '-', 'series', 'Ġblack', 'Ġl', 'cd', 'Ġflat', 'Ġpanel', 'Ġh', 'd', 'tv', 'Ġk', 'dl', '46', 's', '4', '100', 'Ġ1920', 'Ġx', 'Ġ1080', 'Ġfull', 'Ġh', 'd', 'Ġresolution', 'Ġ24', 'p', 'Ġtrue', 'Ġcinema', 'Ġat', 's', 'ct', 'm', '/', 'nt', 'sc', 'Ġtun', 'er', 'Ġwith', 'Ġq', 'am', 'Ġ2', ',', '500', ':', '1', 'Ġcontrast', 'Ġratio', 'Ġcinem', 'otion', 'Ġreverse', 'Ġ3', ':', '2', 'Ġpull', 'down', 'Ġtechnology', 'Ġ3', 'd', 'Ġcomb', 'Ġfilter', 'Ġm', 'peg', 'Ġnoise', 'Ġreduction', 'Ġblack', 'Ġfinish', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ', 'Ġ', '</s>', '</s>', 'COL', 'Ġname', 'ĠVAL', 'Ġs', 'ony', 'Ġbrav', 'ia', 'Ġx', 'br', 'Ġseries', 'Ġk', 'dl', '-', '52', 'x', 'br', '6', 'Ġ52', "Ġ'", 'Ġl', 'cd', 'Ġtv', 'Ġk', 'dl', '52', 'x', 'br', '6', 'ĠCOL', 'Ġdescription', 'ĠVAL', 'Ġ52', "Ġ'", 'Ġactive', 'Ġmatrix', 'Ġt', 'ft', 'Ġat', 'sc', 'Ġ,', 'Ġn', 'ts', 'c', 'Ġ16', ':', '9', 'Ġ1920', 'Ġx', 'Ġ1080', 'Ġd', 'ol', 'by', 'Ġ,', 'Ġsurround', 'Ġh', 'd', 'tv', 'Ġ480', 'i', 'Ġ,', 'Ġ480', 'p', 'Ġ,', 'Ġ720', 'p', 'Ġ,', 'Ġ1080', 'i', 'Ġ,', 'Ġ1080', 'p', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ25', '73', '.', '72', 'Ġ', '</s>']
is_heads: [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
y: 0
tags: 0
mask: tensor([1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1])
seqlen: 189
task_name: Textual/Abt-Buy
=======================
step: 0, task: Textual/Abt-Buy, loss: 0.3896917700767517
step: 10, task: Textual/Abt-Buy, loss: 0.05176273733377457
step: 20, task: Textual/Abt-Buy, loss: 0.4560536742210388
step: 30, task: Textual/Abt-Buy, loss: 0.3849485516548157
step: 40, task: Textual/Abt-Buy, loss: 0.011649861931800842
step: 50, task: Textual/Abt-Buy, loss: 0.22177229821681976
step: 60, task: Textual/Abt-Buy, loss: 0.16517774760723114
step: 70, task: Textual/Abt-Buy, loss: 0.2734115719795227
step: 80, task: Textual/Abt-Buy, loss: 0.12756754457950592
step: 90, task: Textual/Abt-Buy, loss: 0.21364127099514008
step: 100, task: Textual/Abt-Buy, loss: 0.01726394146680832
step: 110, task: Textual/Abt-Buy, loss: 0.15615661442279816
step: 120, task: Textual/Abt-Buy, loss: 0.2633002996444702
step: 130, task: Textual/Abt-Buy, loss: 0.5051339864730835
step: 140, task: Textual/Abt-Buy, loss: 0.1011548712849617
step: 150, task: Textual/Abt-Buy, loss: 0.029267288744449615
step: 160, task: Textual/Abt-Buy, loss: 0.07411137223243713
step: 170, task: Textual/Abt-Buy, loss: 0.17088396847248077
step: 180, task: Textual/Abt-Buy, loss: 0.21566550433635712
step: 190, task: Textual/Abt-Buy, loss: 0.23156021535396576
step: 200, task: Textual/Abt-Buy, loss: 0.005138665437698364
step: 210, task: Textual/Abt-Buy, loss: 0.015003830194473267
step: 220, task: Textual/Abt-Buy, loss: 0.05093126744031906
step: 230, task: Textual/Abt-Buy, loss: 0.01045949012041092
step: 240, task: Textual/Abt-Buy, loss: 0.02948901802301407
step: 250, task: Textual/Abt-Buy, loss: 0.12647047638893127
step: 260, task: Textual/Abt-Buy, loss: 0.11140792071819305
step: 270, task: Textual/Abt-Buy, loss: 0.3385472893714905
step: 280, task: Textual/Abt-Buy, loss: 0.1553623527288437
step: 290, task: Textual/Abt-Buy, loss: 0.028359748423099518
step: 300, task: Textual/Abt-Buy, loss: 0.2662115693092346
step: 310, task: Textual/Abt-Buy, loss: 0.053905729204416275
step: 320, task: Textual/Abt-Buy, loss: 0.028615090996026993
step: 330, task: Textual/Abt-Buy, loss: 0.01531672477722168
step: 340, task: Textual/Abt-Buy, loss: 0.23251669108867645
step: 350, task: Textual/Abt-Buy, loss: 0.054637569934129715
=========eval at epoch=1=========
Validation:
=============Textual/Abt-Buy==================
accuracy=0.946
precision=0.683
recall=0.932
f1=0.789
======================================
Test:
=============Textual/Abt-Buy==================
accuracy=0.965
precision=0.954
recall=0.709
f1=0.813
======================================
=====sanity check======
words: COL name VAL sony silver cyber-shot digital camera dscw150 COL description VAL sony silver cyber-shot digital camera dscw150 8.1 megapixels 2.7 ' lcd display 15 mb internal memory carl zeiss 5x optical zoom lens 16:9 high-resolution mode 9-point auto focus automatic macro shooting high sensitivity mode burst mode face detection intelligent scene recognition mode in-camera retouching super steadyshot optical image stabilization with anti-blur solution music slideshow hdtv compatibility beginner-friendly function guide silver finish COL price VAL   [SEP] COL name VAL sony dpfd80 digital photo frame COL description VAL photo viewer 8 ' lcd COL price VAL  
x: [    0 18047   766 27445   579  6119  4334  5381    12 10393  1778  2280
   385  3866   605  6115 14857  8194 27445   579  6119  4334  5381    12
 10393  1778  2280   385  3866   605  6115   290     4   134 10721  1115
 41699   132     4   406   128   784 28690  2332   379   475   428  3425
  3783   512   462 20025  3006   195  1178 17547 21762 10373   545    35
   466   239    12 29646  5745   361    12  2300  4485  1056  8408 12303
  1094   239 15608  5745 10084  5745   652 12673 12038  1310  4972  5745
    11    12 25092  5494 12746   154  2422 23789  2459 10120 17547  2274
 29632    19  1475    12  3662   710  2472   930 13150  1368   417 18724
 29988 37239    12  6928  5043  4704  4334  2073 14857   425 27445  1437
  1437     2     2 18047   766 27445   579  6119   385   642 37379  2940
  1778  1345  5120 14857  8194 27445  1345 18754   290   128   784 28690
 14857   425 27445  1437  1437     2]
tokens: ['<s>', 'COL', 'Ġname', 'ĠVAL', 'Ġs', 'ony', 'Ġsilver', 'Ġcyber', '-', 'shot', 'Ġdigital', 'Ġcamera', 'Ġd', 'sc', 'w', '150', 'ĠCOL', 'Ġdescription', 'ĠVAL', 'Ġs', 'ony', 'Ġsilver', 'Ġcyber', '-', 'shot', 'Ġdigital', 'Ġcamera', 'Ġd', 'sc', 'w', '150', 'Ġ8', '.', '1', 'Ġmeg', 'ap', 'ixels', 'Ġ2', '.', '7', "Ġ'", 'Ġl', 'cd', 'Ġdisplay', 'Ġ15', 'Ġm', 'b', 'Ġinternal', 'Ġmemory', 'Ġcar', 'l', 'Ġze', 'iss', 'Ġ5', 'x', 'Ġoptical', 'Ġzoom', 'Ġlens', 'Ġ16', ':', '9', 'Ġhigh', '-', 'resolution', 'Ġmode', 'Ġ9', '-', 'point', 'Ġauto', 'Ġfocus', 'Ġautomatic', 'Ġmacro', 'Ġshooting', 'Ġhigh', 'Ġsensitivity', 'Ġmode', 'Ġburst', 'Ġmode', 'Ġface', 'Ġdetection', 'Ġintelligent', 'Ġscene', 'Ġrecognition', 'Ġmode', 'Ġin', '-', 'camera', 'Ġret', 'ouch', 'ing', 'Ġsuper', 'Ġstead', 'ys', 'hot', 'Ġoptical', 'Ġimage', 'Ġstabilization', 'Ġwith', 'Ġanti', '-', 'bl', 'ur', 'Ġsolution', 'Ġmusic', 'Ġslideshow', 'Ġh', 'd', 'tv', 'Ġcompatibility', 'Ġbeginner', '-', 'friendly', 'Ġfunction', 'Ġguide', 'Ġsilver', 'Ġfinish', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ', 'Ġ', '</s>', '</s>', 'COL', 'Ġname', 'ĠVAL', 'Ġs', 'ony', 'Ġd', 'p', 'fd', '80', 'Ġdigital', 'Ġphoto', 'Ġframe', 'ĠCOL', 'Ġdescription', 'ĠVAL', 'Ġphoto', 'Ġviewer', 'Ġ8', "Ġ'", 'Ġl', 'cd', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ', 'Ġ', '</s>']
is_heads: [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
y: 0
tags: 0
mask: tensor([1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1])
seqlen: 150
task_name: Textual/Abt-Buy
=======================
step: 0, task: Textual/Abt-Buy, loss: 0.12278595566749573
step: 10, task: Textual/Abt-Buy, loss: 0.02653368189930916
step: 20, task: Textual/Abt-Buy, loss: 0.2225610911846161
step: 30, task: Textual/Abt-Buy, loss: 0.03621692210435867
step: 40, task: Textual/Abt-Buy, loss: 0.14979687333106995
step: 50, task: Textual/Abt-Buy, loss: 0.20137596130371094
step: 60, task: Textual/Abt-Buy, loss: 0.16870969533920288
step: 70, task: Textual/Abt-Buy, loss: 0.08955416083335876
step: 80, task: Textual/Abt-Buy, loss: 0.1138305589556694
step: 90, task: Textual/Abt-Buy, loss: 0.006904482841491699
step: 100, task: Textual/Abt-Buy, loss: 0.13999059796333313
step: 110, task: Textual/Abt-Buy, loss: 0.42766571044921875
step: 120, task: Textual/Abt-Buy, loss: 0.34524407982826233
step: 130, task: Textual/Abt-Buy, loss: 0.021562308073043823
step: 140, task: Textual/Abt-Buy, loss: 0.19469529390335083
step: 150, task: Textual/Abt-Buy, loss: 0.10649916529655457
step: 160, task: Textual/Abt-Buy, loss: 0.013574011623859406
step: 170, task: Textual/Abt-Buy, loss: 0.007960140705108643
step: 180, task: Textual/Abt-Buy, loss: 0.0032542049884796143
step: 190, task: Textual/Abt-Buy, loss: 0.05582886189222336
step: 200, task: Textual/Abt-Buy, loss: 0.043071337044239044
step: 210, task: Textual/Abt-Buy, loss: 0.04981689527630806
step: 220, task: Textual/Abt-Buy, loss: 0.028712376952171326
step: 230, task: Textual/Abt-Buy, loss: 0.0032954588532447815
step: 240, task: Textual/Abt-Buy, loss: 0.14307230710983276
step: 250, task: Textual/Abt-Buy, loss: 0.04274062067270279
step: 260, task: Textual/Abt-Buy, loss: 0.035344310104846954
step: 270, task: Textual/Abt-Buy, loss: 0.04891841858625412
step: 280, task: Textual/Abt-Buy, loss: 0.02941560000181198
step: 290, task: Textual/Abt-Buy, loss: 0.004734039306640625
step: 300, task: Textual/Abt-Buy, loss: 0.006959900259971619
step: 310, task: Textual/Abt-Buy, loss: 0.029036223888397217
step: 320, task: Textual/Abt-Buy, loss: 0.05012956261634827
step: 330, task: Textual/Abt-Buy, loss: 0.03223181515932083
step: 340, task: Textual/Abt-Buy, loss: 0.008613459765911102
step: 350, task: Textual/Abt-Buy, loss: 0.24562886357307434
=========eval at epoch=2=========
Validation:
=============Textual/Abt-Buy==================
accuracy=0.971
precision=0.908
recall=0.816
f1=0.859
======================================
Test:
=============Textual/Abt-Buy==================
accuracy=0.977
precision=0.885
recall=0.898
f1=0.892
======================================
=====sanity check======
words: COL name VAL speck seethru red hard shell case for 13 ' macbook mb13redseev2 COL description VAL speck seethru red hard shell case for 13 ' macbook mb13redseev2 translucent hard plastic shell gives great protection full access to all controls rubber feet for added support red finish COL price VAL   [SEP] COL name VAL speck products seethru case for apple 13 ' macbook mb13-aqu-see-v2 COL description VAL plastic aqua COL price VAL  
x: [    0 18047   766 27445 25227  2420   842  4774  2070  1275   543 10785
   403    13   508   128 13418  6298   475   428  1558  2050  1090  3623
   176 14857  8194 27445 25227  2420   842  4774  2070  1275   543 10785
   403    13   508   128 13418  6298   475   428  1558  2050  1090  3623
   176 42026   543  4136 10785  2029   372  2591   455   899     7    70
  5656 11283  1730    13   355   323  1275  2073 14857   425 27445  1437
  1437     2     2 18047   766 27445 25227  2420   785   842  4774  2070
   403    13 15162   508   128 13418  6298   475   428  1558    12 25930
    12  7048    12   705   176 14857  8194 27445  4136 16690   102 14857
   425 27445  1437  1437     2]
tokens: ['<s>', 'COL', 'Ġname', 'ĠVAL', 'Ġspe', 'ck', 'Ġse', 'eth', 'ru', 'Ġred', 'Ġhard', 'Ġshell', 'Ġcase', 'Ġfor', 'Ġ13', "Ġ'", 'Ġmac', 'book', 'Ġm', 'b', '13', 'red', 'se', 'ev', '2', 'ĠCOL', 'Ġdescription', 'ĠVAL', 'Ġspe', 'ck', 'Ġse', 'eth', 'ru', 'Ġred', 'Ġhard', 'Ġshell', 'Ġcase', 'Ġfor', 'Ġ13', "Ġ'", 'Ġmac', 'book', 'Ġm', 'b', '13', 'red', 'se', 'ev', '2', 'Ġtranslucent', 'Ġhard', 'Ġplastic', 'Ġshell', 'Ġgives', 'Ġgreat', 'Ġprotection', 'Ġfull', 'Ġaccess', 'Ġto', 'Ġall', 'Ġcontrols', 'Ġrubber', 'Ġfeet', 'Ġfor', 'Ġadded', 'Ġsupport', 'Ġred', 'Ġfinish', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ', 'Ġ', '</s>', '</s>', 'COL', 'Ġname', 'ĠVAL', 'Ġspe', 'ck', 'Ġproducts', 'Ġse', 'eth', 'ru', 'Ġcase', 'Ġfor', 'Ġapple', 'Ġ13', "Ġ'", 'Ġmac', 'book', 'Ġm', 'b', '13', '-', 'aqu', '-', 'see', '-', 'v', '2', 'ĠCOL', 'Ġdescription', 'ĠVAL', 'Ġplastic', 'Ġaqu', 'a', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ', 'Ġ', '</s>']
is_heads: [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
y: 0
tags: 0
mask: tensor([1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1])
seqlen: 113
task_name: Textual/Abt-Buy
=======================
step: 0, task: Textual/Abt-Buy, loss: 0.057798899710178375
step: 10, task: Textual/Abt-Buy, loss: 0.025200724601745605
step: 20, task: Textual/Abt-Buy, loss: 0.08047422766685486
step: 30, task: Textual/Abt-Buy, loss: 0.05197543650865555
step: 40, task: Textual/Abt-Buy, loss: 0.1595865786075592
step: 50, task: Textual/Abt-Buy, loss: 0.11429254710674286
step: 60, task: Textual/Abt-Buy, loss: 0.05166994407773018
step: 70, task: Textual/Abt-Buy, loss: 0.04337048903107643
step: 80, task: Textual/Abt-Buy, loss: 0.004605390131473541
step: 90, task: Textual/Abt-Buy, loss: 0.0018134862184524536
step: 100, task: Textual/Abt-Buy, loss: 0.4984878897666931
step: 110, task: Textual/Abt-Buy, loss: 0.011656291782855988
step: 120, task: Textual/Abt-Buy, loss: 0.0523357018828392
step: 130, task: Textual/Abt-Buy, loss: 0.03424554690718651
step: 140, task: Textual/Abt-Buy, loss: 0.042924799025058746
step: 150, task: Textual/Abt-Buy, loss: 0.0025273263454437256
step: 160, task: Textual/Abt-Buy, loss: 0.00534714013338089
step: 170, task: Textual/Abt-Buy, loss: 0.01837030053138733
step: 180, task: Textual/Abt-Buy, loss: 0.004941537976264954
step: 190, task: Textual/Abt-Buy, loss: 0.1399063915014267
step: 200, task: Textual/Abt-Buy, loss: 0.018184445798397064
step: 210, task: Textual/Abt-Buy, loss: 0.003646060824394226
step: 220, task: Textual/Abt-Buy, loss: 0.011695556342601776
step: 230, task: Textual/Abt-Buy, loss: 0.013243980705738068
step: 240, task: Textual/Abt-Buy, loss: 0.015483930706977844
step: 250, task: Textual/Abt-Buy, loss: 0.10351041704416275
step: 260, task: Textual/Abt-Buy, loss: 0.017343193292617798
step: 270, task: Textual/Abt-Buy, loss: 0.0015841424465179443
step: 280, task: Textual/Abt-Buy, loss: 0.0004891902208328247
step: 290, task: Textual/Abt-Buy, loss: 0.013500958681106567
step: 300, task: Textual/Abt-Buy, loss: 0.0029507428407669067
step: 310, task: Textual/Abt-Buy, loss: 0.1923379898071289
step: 320, task: Textual/Abt-Buy, loss: 0.008543625473976135
step: 330, task: Textual/Abt-Buy, loss: 0.04083899408578873
step: 340, task: Textual/Abt-Buy, loss: 0.004321888089179993
step: 350, task: Textual/Abt-Buy, loss: 0.0024121925234794617
=========eval at epoch=3=========
Validation:
=============Textual/Abt-Buy==================
accuracy=0.974
precision=0.934
recall=0.820
f1=0.873
======================================
Test:
=============Textual/Abt-Buy==================
accuracy=0.979
precision=0.928
recall=0.874
f1=0.900
======================================
=====sanity check======
words: COL name VAL garmin 010-10723-02 carrying case 0101072302 COL description VAL garmin 010-10723-02 carrying case 0101072302 compatible with garmin nuvi 350 black finish COL price VAL   [SEP] COL name VAL garmin suction cup mount 010-10823-00 COL description VAL  COL price VAL 24.84 
x: [    0 18047   766 27445 15475  4691  9465   288    12 19000  1922    12
  4197  3406   403  9465  2663  3570 20352   176 14857  8194 27445 15475
  4691  9465   288    12 19000  1922    12  4197  3406   403  9465  2663
  3570 20352   176 16632    19 15475  4691  6505  6873 10088   909  2073
 14857   425 27445  1437  1437     2     2 18047   766 27445 15475  4691
  2628 14970  4946 14206  9465   288    12 18844  1922    12   612 14857
  8194 27445  1437 14857   425 27445   706     4  6232  1437     2]
tokens: ['<s>', 'COL', 'Ġname', 'ĠVAL', 'Ġgar', 'min', 'Ġ01', '0', '-', '107', '23', '-', '02', 'Ġcarrying', 'Ġcase', 'Ġ01', '01', '07', '230', '2', 'ĠCOL', 'Ġdescription', 'ĠVAL', 'Ġgar', 'min', 'Ġ01', '0', '-', '107', '23', '-', '02', 'Ġcarrying', 'Ġcase', 'Ġ01', '01', '07', '230', '2', 'Ġcompatible', 'Ġwith', 'Ġgar', 'min', 'Ġnu', 'vi', 'Ġ350', 'Ġblack', 'Ġfinish', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ', 'Ġ', '</s>', '</s>', 'COL', 'Ġname', 'ĠVAL', 'Ġgar', 'min', 'Ġsu', 'ction', 'Ġcup', 'Ġmount', 'Ġ01', '0', '-', '108', '23', '-', '00', 'ĠCOL', 'Ġdescription', 'ĠVAL', 'Ġ', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ24', '.', '84', 'Ġ', '</s>']
is_heads: [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
y: 0
tags: 0
mask: tensor([1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1])
seqlen: 83
task_name: Textual/Abt-Buy
=======================
step: 0, task: Textual/Abt-Buy, loss: 0.00702366977930069
step: 10, task: Textual/Abt-Buy, loss: 0.0035735443234443665
step: 20, task: Textual/Abt-Buy, loss: 0.003241509199142456
step: 30, task: Textual/Abt-Buy, loss: 0.0019233524799346924
step: 40, task: Textual/Abt-Buy, loss: 0.00106106698513031
step: 50, task: Textual/Abt-Buy, loss: 0.00469786673784256
step: 60, task: Textual/Abt-Buy, loss: 0.07704015076160431
step: 70, task: Textual/Abt-Buy, loss: 0.01340288296341896
step: 80, task: Textual/Abt-Buy, loss: 0.002386122941970825
step: 90, task: Textual/Abt-Buy, loss: 0.014542803168296814
step: 100, task: Textual/Abt-Buy, loss: 0.00371474027633667
step: 110, task: Textual/Abt-Buy, loss: 0.006681747734546661
step: 120, task: Textual/Abt-Buy, loss: 0.060338035225868225
step: 130, task: Textual/Abt-Buy, loss: 0.0009841769933700562
step: 140, task: Textual/Abt-Buy, loss: 0.0014918223023414612
step: 150, task: Textual/Abt-Buy, loss: 0.01993190497159958
step: 160, task: Textual/Abt-Buy, loss: 0.0008758306503295898
step: 170, task: Textual/Abt-Buy, loss: 0.014360867440700531
step: 180, task: Textual/Abt-Buy, loss: 0.0037848353385925293
step: 190, task: Textual/Abt-Buy, loss: 0.018089506775140762
step: 200, task: Textual/Abt-Buy, loss: 0.0012898743152618408
step: 210, task: Textual/Abt-Buy, loss: 0.10137628018856049
step: 220, task: Textual/Abt-Buy, loss: 0.14056231081485748
step: 230, task: Textual/Abt-Buy, loss: 0.0031281784176826477
step: 240, task: Textual/Abt-Buy, loss: 0.00025576353073120117
step: 250, task: Textual/Abt-Buy, loss: 0.0005788803100585938
step: 260, task: Textual/Abt-Buy, loss: 0.021854236721992493
step: 270, task: Textual/Abt-Buy, loss: 0.013703905045986176
step: 280, task: Textual/Abt-Buy, loss: 0.013929210603237152
step: 290, task: Textual/Abt-Buy, loss: 0.009204737842082977
step: 300, task: Textual/Abt-Buy, loss: 0.02942030131816864
step: 310, task: Textual/Abt-Buy, loss: 0.15009921789169312
step: 320, task: Textual/Abt-Buy, loss: 0.004997089505195618
step: 330, task: Textual/Abt-Buy, loss: 0.011200420558452606
step: 340, task: Textual/Abt-Buy, loss: 0.019173502922058105
step: 350, task: Textual/Abt-Buy, loss: 0.005010418593883514
=========eval at epoch=4=========
Validation:
=============Textual/Abt-Buy==================
accuracy=0.973
precision=0.923
recall=0.820
f1=0.869
======================================
Test:
=============Textual/Abt-Buy==================
accuracy=0.981
precision=0.938
recall=0.879
f1=0.907
======================================
=====sanity check======
words: COL name VAL sony universal remote commander remote control rmv310 COL description VAL sony universal remote commander remote control rmv310 controls up to 7 av components compatible with most of major brands comfortable ergonomic design silver finish COL price VAL   [SEP] COL name VAL sony universal remote control rm-ez4 COL description VAL tv , cable box universal remote COL price VAL 12.72 
x: [    0 18047   766 27445   579  6119 10547  6063  8501  6063   797 45900
   705 23417 14857  8194 27445   579  6119 10547  6063  8501  6063   797
 45900   705 23417  5656    62     7   262  6402  6411 16632    19   144
     9   538  3595  3473 35389 42141  1521  4334  2073 14857   425 27445
  1437  1437     2     2 18047   766 27445   579  6119 10547  6063   797
 45900    12  5841   306 14857  8194 27445 30016  2156  6129  2233 10547
  6063 14857   425 27445   316     4  4956  1437     2]
tokens: ['<s>', 'COL', 'Ġname', 'ĠVAL', 'Ġs', 'ony', 'Ġuniversal', 'Ġremote', 'Ġcommander', 'Ġremote', 'Ġcontrol', 'Ġrm', 'v', '310', 'ĠCOL', 'Ġdescription', 'ĠVAL', 'Ġs', 'ony', 'Ġuniversal', 'Ġremote', 'Ġcommander', 'Ġremote', 'Ġcontrol', 'Ġrm', 'v', '310', 'Ġcontrols', 'Ġup', 'Ġto', 'Ġ7', 'Ġav', 'Ġcomponents', 'Ġcompatible', 'Ġwith', 'Ġmost', 'Ġof', 'Ġmajor', 'Ġbrands', 'Ġcomfortable', 'Ġerg', 'onomic', 'Ġdesign', 'Ġsilver', 'Ġfinish', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ', 'Ġ', '</s>', '</s>', 'COL', 'Ġname', 'ĠVAL', 'Ġs', 'ony', 'Ġuniversal', 'Ġremote', 'Ġcontrol', 'Ġrm', '-', 'ez', '4', 'ĠCOL', 'Ġdescription', 'ĠVAL', 'Ġtv', 'Ġ,', 'Ġcable', 'Ġbox', 'Ġuniversal', 'Ġremote', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ12', '.', '72', 'Ġ', '</s>']
is_heads: [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
y: 0
tags: 0
mask: tensor([1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1])
seqlen: 81
task_name: Textual/Abt-Buy
=======================
step: 0, task: Textual/Abt-Buy, loss: 0.008664898574352264
step: 10, task: Textual/Abt-Buy, loss: 0.26884981989860535
step: 20, task: Textual/Abt-Buy, loss: 0.00027686357498168945
step: 30, task: Textual/Abt-Buy, loss: 0.009438872337341309
step: 40, task: Textual/Abt-Buy, loss: 0.0003228187561035156
step: 50, task: Textual/Abt-Buy, loss: 0.006465457379817963
step: 60, task: Textual/Abt-Buy, loss: 0.0003809332847595215
step: 70, task: Textual/Abt-Buy, loss: 0.003553152084350586
step: 80, task: Textual/Abt-Buy, loss: 0.00010329484939575195
step: 90, task: Textual/Abt-Buy, loss: 0.0008542686700820923
step: 100, task: Textual/Abt-Buy, loss: 0.0001782625913619995
step: 110, task: Textual/Abt-Buy, loss: 0.0001730024814605713
step: 120, task: Textual/Abt-Buy, loss: 0.0010875165462493896
step: 130, task: Textual/Abt-Buy, loss: 0.12802594900131226
step: 140, task: Textual/Abt-Buy, loss: 0.0019382238388061523
step: 150, task: Textual/Abt-Buy, loss: 0.00040835142135620117
step: 160, task: Textual/Abt-Buy, loss: 0.0015491396188735962
step: 170, task: Textual/Abt-Buy, loss: 0.0027838870882987976
step: 180, task: Textual/Abt-Buy, loss: 0.06472333520650864
step: 190, task: Textual/Abt-Buy, loss: 0.00359480082988739
step: 200, task: Textual/Abt-Buy, loss: 0.00035025179386138916
step: 210, task: Textual/Abt-Buy, loss: 0.1440047174692154
step: 220, task: Textual/Abt-Buy, loss: 0.0007092058658599854
step: 230, task: Textual/Abt-Buy, loss: 0.0019882842898368835
step: 240, task: Textual/Abt-Buy, loss: 0.023877408355474472
step: 250, task: Textual/Abt-Buy, loss: 0.0015219300985336304
step: 260, task: Textual/Abt-Buy, loss: 0.00036178529262542725
step: 270, task: Textual/Abt-Buy, loss: 0.0009127557277679443
step: 280, task: Textual/Abt-Buy, loss: 0.001008555293083191
step: 290, task: Textual/Abt-Buy, loss: 0.00015115737915039062
step: 300, task: Textual/Abt-Buy, loss: 0.010250497609376907
step: 310, task: Textual/Abt-Buy, loss: 0.0002654343843460083
step: 320, task: Textual/Abt-Buy, loss: 0.00039993226528167725
step: 330, task: Textual/Abt-Buy, loss: 0.01690693572163582
step: 340, task: Textual/Abt-Buy, loss: 0.00014854967594146729
step: 350, task: Textual/Abt-Buy, loss: 0.00029496848583221436
=========eval at epoch=5=========
Validation:
=============Textual/Abt-Buy==================
accuracy=0.973
precision=0.928
recall=0.811
f1=0.865
======================================
Test:
=============Textual/Abt-Buy==================
accuracy=0.980
precision=0.977
recall=0.835
f1=0.901
======================================
=====sanity check======
words: COL name VAL canon pixma photo all-in-one printer mp980 COL description VAL canon pixma photo all-in-one printer mp980 high performance wireless printer , copier and scanner easy scroll wheel 3.5 ' high definition lcd display maximum 9600 x 2400 color dpi six individual inks tanks auto duplex print smart copying automatic image optimization no warm-up energy star qualified COL price VAL 299.0  [SEP] COL name VAL canon cl-52 photo ink cartridge for pixma ip6210d and pixma ip6220d printers 0619b002 COL description VAL color COL price VAL 18.16 
x: [    0 18047   766 27445 32839   181  3181  1916  1345    70    12   179
    12  1264 24079 44857 36824 14857  8194 27445 32839   181  3181  1916
  1345    70    12   179    12  1264 24079 44857 36824   239   819  6955
 24079  2156  9212   906     8 22373  1365 25715  5964   155     4   245
   128   239  8515   784 28690  2332  4532   361  4697  3023 40977  3195
   385 19581   411  1736    11  2258 12039  4485 17073 14726  5780  2793
 34236  8408  2274 25212   117  3279    12   658  1007   999  6048 14857
   425 27445 35768     4   288  1437     2     2 18047   766 27445 32839
  3741    12  4429  1345 16019 41785    13   181  3181  1916 36180  5379
   698   417     8   181  3181  1916 36180  5379   844   417 29379 15007
  1646   428 19130 14857  8194 27445  3195 14857   425 27445   504     4
  1549  1437     2]
tokens: ['<s>', 'COL', 'Ġname', 'ĠVAL', 'Ġcanon', 'Ġp', 'ix', 'ma', 'Ġphoto', 'Ġall', '-', 'in', '-', 'one', 'Ġprinter', 'Ġmp', '980', 'ĠCOL', 'Ġdescription', 'ĠVAL', 'Ġcanon', 'Ġp', 'ix', 'ma', 'Ġphoto', 'Ġall', '-', 'in', '-', 'one', 'Ġprinter', 'Ġmp', '980', 'Ġhigh', 'Ġperformance', 'Ġwireless', 'Ġprinter', 'Ġ,', 'Ġcop', 'ier', 'Ġand', 'Ġscanner', 'Ġeasy', 'Ġscroll', 'Ġwheel', 'Ġ3', '.', '5', "Ġ'", 'Ġhigh', 'Ġdefinition', 'Ġl', 'cd', 'Ġdisplay', 'Ġmaximum', 'Ġ9', '600', 'Ġx', 'Ġ2400', 'Ġcolor', 'Ġd', 'pi', 'Ġsix', 'Ġindividual', 'Ġin', 'ks', 'Ġtanks', 'Ġauto', 'Ġdup', 'lex', 'Ġprint', 'Ġsmart', 'Ġcopying', 'Ġautomatic', 'Ġimage', 'Ġoptimization', 'Ġno', 'Ġwarm', '-', 'up', 'Ġenergy', 'Ġstar', 'Ġqualified', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ299', '.', '0', 'Ġ', '</s>', '</s>', 'COL', 'Ġname', 'ĠVAL', 'Ġcanon', 'Ġcl', '-', '52', 'Ġphoto', 'Ġink', 'Ġcartridge', 'Ġfor', 'Ġp', 'ix', 'ma', 'Ġip', '62', '10', 'd', 'Ġand', 'Ġp', 'ix', 'ma', 'Ġip', '62', '20', 'd', 'Ġprinters', 'Ġ06', '19', 'b', '002', 'ĠCOL', 'Ġdescription', 'ĠVAL', 'Ġcolor', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ18', '.', '16', 'Ġ', '</s>']
is_heads: [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
y: 0
tags: 0
mask: tensor([1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1])
seqlen: 135
task_name: Textual/Abt-Buy
=======================
step: 0, task: Textual/Abt-Buy, loss: 0.03906138241291046
step: 10, task: Textual/Abt-Buy, loss: 0.0007940679788589478
step: 20, task: Textual/Abt-Buy, loss: 0.0017658770084381104
step: 30, task: Textual/Abt-Buy, loss: 0.00041350722312927246
step: 40, task: Textual/Abt-Buy, loss: 0.0003036707639694214
step: 50, task: Textual/Abt-Buy, loss: 0.0002691894769668579
step: 60, task: Textual/Abt-Buy, loss: 0.0028205662965774536
step: 70, task: Textual/Abt-Buy, loss: 0.0002015829086303711
step: 80, task: Textual/Abt-Buy, loss: 0.009830936789512634
step: 90, task: Textual/Abt-Buy, loss: 0.00020566582679748535
step: 100, task: Textual/Abt-Buy, loss: 0.019053056836128235
step: 110, task: Textual/Abt-Buy, loss: 0.051798079162836075
step: 120, task: Textual/Abt-Buy, loss: 0.00018677115440368652
step: 130, task: Textual/Abt-Buy, loss: 0.00012952089309692383
step: 140, task: Textual/Abt-Buy, loss: 0.00015969574451446533
step: 150, task: Textual/Abt-Buy, loss: 0.000229761004447937
step: 160, task: Textual/Abt-Buy, loss: 0.0003803074359893799
step: 170, task: Textual/Abt-Buy, loss: 0.0005041211843490601
step: 180, task: Textual/Abt-Buy, loss: 0.00022903084754943848
step: 190, task: Textual/Abt-Buy, loss: 0.00022135674953460693
step: 200, task: Textual/Abt-Buy, loss: 0.015661150217056274
step: 210, task: Textual/Abt-Buy, loss: 0.00021544098854064941
step: 220, task: Textual/Abt-Buy, loss: 0.00019282102584838867
step: 230, task: Textual/Abt-Buy, loss: 0.001773737370967865
step: 240, task: Textual/Abt-Buy, loss: 0.174332857131958
step: 250, task: Textual/Abt-Buy, loss: 0.1264306902885437
Gradient overflow.  Skipping step, loss scaler 0 reducing loss scale to 4096.0
step: 260, task: Textual/Abt-Buy, loss: 0.24255040287971497
step: 270, task: Textual/Abt-Buy, loss: 0.0005223304033279419
step: 280, task: Textual/Abt-Buy, loss: 0.0007705986499786377
step: 290, task: Textual/Abt-Buy, loss: 0.00036984682083129883
step: 300, task: Textual/Abt-Buy, loss: 0.0017149075865745544
step: 310, task: Textual/Abt-Buy, loss: 0.0003698766231536865
step: 320, task: Textual/Abt-Buy, loss: 0.005700543522834778
step: 330, task: Textual/Abt-Buy, loss: 0.0001236945390701294
step: 340, task: Textual/Abt-Buy, loss: 0.0001856088638305664
step: 350, task: Textual/Abt-Buy, loss: 0.0076025500893592834
=========eval at epoch=6=========
Validation:
=============Textual/Abt-Buy==================
accuracy=0.978
precision=0.927
recall=0.859
f1=0.892
======================================
Test:
=============Textual/Abt-Buy==================
accuracy=0.981
precision=0.952
recall=0.869
f1=0.909
======================================
=====sanity check======
words: COL name VAL peerless black flat panel tv stand ss550pbk COL description VAL peerless black flat panel tv stand ss550pbk supports 32 ' to 50 ' flat panel tvs vertical screen adjustment feature internal cable management adjustable glass shelving black finish COL price VAL   [SEP] COL name VAL peerless sglb01 flat panel tv stand COL description VAL glass black COL price VAL  
x: [    0 18047   766 27445 10995  1672   909  3269  2798 30016  1413 43987
 17953 45306   330 14857  8194 27445 10995  1672   909  3269  2798 30016
  1413 43987 17953 45306   330  4548  2107   128     7   654   128  3269
  2798   326 15597 12194  2441 13380  1905  3425  6129  1052 29861  4049
 26282  6645   909  2073 14857   425 27445  1437  1437     2     2 18047
   766 27445 10995  1672   579  7210   428  2663  3269  2798 30016  1413
 14857  8194 27445  4049   909 14857   425 27445  1437  1437     2]
tokens: ['<s>', 'COL', 'Ġname', 'ĠVAL', 'Ġpeer', 'less', 'Ġblack', 'Ġflat', 'Ġpanel', 'Ġtv', 'Ġstand', 'Ġss', '550', 'pb', 'k', 'ĠCOL', 'Ġdescription', 'ĠVAL', 'Ġpeer', 'less', 'Ġblack', 'Ġflat', 'Ġpanel', 'Ġtv', 'Ġstand', 'Ġss', '550', 'pb', 'k', 'Ġsupports', 'Ġ32', "Ġ'", 'Ġto', 'Ġ50', "Ġ'", 'Ġflat', 'Ġpanel', 'Ġt', 'vs', 'Ġvertical', 'Ġscreen', 'Ġadjustment', 'Ġfeature', 'Ġinternal', 'Ġcable', 'Ġmanagement', 'Ġadjustable', 'Ġglass', 'Ġshel', 'ving', 'Ġblack', 'Ġfinish', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ', 'Ġ', '</s>', '</s>', 'COL', 'Ġname', 'ĠVAL', 'Ġpeer', 'less', 'Ġs', 'gl', 'b', '01', 'Ġflat', 'Ġpanel', 'Ġtv', 'Ġstand', 'ĠCOL', 'Ġdescription', 'ĠVAL', 'Ġglass', 'Ġblack', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ', 'Ġ', '</s>']
is_heads: [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
y: 0
tags: 0
mask: tensor([1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1])
seqlen: 83
task_name: Textual/Abt-Buy
=======================
step: 0, task: Textual/Abt-Buy, loss: 0.008164964616298676
step: 10, task: Textual/Abt-Buy, loss: 0.0003602057695388794
step: 20, task: Textual/Abt-Buy, loss: 0.00011403858661651611
step: 30, task: Textual/Abt-Buy, loss: 0.00031988322734832764
step: 40, task: Textual/Abt-Buy, loss: 0.0001891106367111206
step: 50, task: Textual/Abt-Buy, loss: 0.002240113914012909
step: 60, task: Textual/Abt-Buy, loss: 0.00012375414371490479
step: 70, task: Textual/Abt-Buy, loss: 0.00017088651657104492
step: 80, task: Textual/Abt-Buy, loss: 0.011305481195449829
step: 90, task: Textual/Abt-Buy, loss: 0.00022755563259124756
step: 100, task: Textual/Abt-Buy, loss: 0.00017330050468444824
step: 110, task: Textual/Abt-Buy, loss: 0.00015698373317718506
step: 120, task: Textual/Abt-Buy, loss: 0.001293174922466278
step: 130, task: Textual/Abt-Buy, loss: 0.009835593402385712
step: 140, task: Textual/Abt-Buy, loss: 9.804964065551758e-05
step: 150, task: Textual/Abt-Buy, loss: 9.284913539886475e-05
step: 160, task: Textual/Abt-Buy, loss: 9.973347187042236e-05
step: 170, task: Textual/Abt-Buy, loss: 0.01322001963853836
step: 180, task: Textual/Abt-Buy, loss: 0.0002272874116897583
step: 190, task: Textual/Abt-Buy, loss: 0.0006188452243804932
step: 200, task: Textual/Abt-Buy, loss: 9.179115295410156e-05
step: 210, task: Textual/Abt-Buy, loss: 0.032065458595752716
step: 220, task: Textual/Abt-Buy, loss: 0.0001153796911239624
step: 230, task: Textual/Abt-Buy, loss: 8.779764175415039e-05
step: 240, task: Textual/Abt-Buy, loss: 0.022746488451957703
step: 250, task: Textual/Abt-Buy, loss: 0.00012831389904022217
step: 260, task: Textual/Abt-Buy, loss: 0.00011467933654785156
step: 270, task: Textual/Abt-Buy, loss: 0.00014448165893554688
step: 280, task: Textual/Abt-Buy, loss: 6.923079490661621e-05
step: 290, task: Textual/Abt-Buy, loss: 0.001481756567955017
step: 300, task: Textual/Abt-Buy, loss: 0.0010730177164077759
step: 310, task: Textual/Abt-Buy, loss: 0.00195254385471344
step: 320, task: Textual/Abt-Buy, loss: 0.09572998434305191
step: 330, task: Textual/Abt-Buy, loss: 0.04170369729399681
step: 340, task: Textual/Abt-Buy, loss: 0.029516179114580154
step: 350, task: Textual/Abt-Buy, loss: 8.860230445861816e-05
=========eval at epoch=7=========
Validation:
=============Textual/Abt-Buy==================
accuracy=0.975
precision=0.934
recall=0.830
f1=0.879
======================================
Test:
=============Textual/Abt-Buy==================
accuracy=0.982
precision=0.962
recall=0.864
f1=0.910
======================================
=====sanity check======
words: COL name VAL apple 8gb pink 4th generation ipod nano mb735lla COL description VAL apple 8gb pink 4th generation ipod nano mb735lla holds up to 2,000 songs in 128-kbps aac format , 7,000 ipod-viewable photos and 8 hours of video 2 ' ( diagonal ) liquid crystal display with blue-white led backlight 320-by-240-pixel resolution give it a shake to shuffle your music turn it sideways to view cover flow mac and windows compatible pink finish COL price VAL 144.0  [SEP] COL name VAL apple 8gb ipod nano blue ( 4th generation ) mb732ll/a COL description VAL  COL price VAL 146.75 
x: [    0 18047   766 27445 15162   290 19562  6907   204   212  2706 36180
  1630 36924   475   428   406  2022  5104 14857  8194 27445 15162   290
 19562  6907   204   212  2706 36180  1630 36924   475   428   406  2022
  5104  3106    62     7   132     6   151  3686    11 13950    12   330
 27072    10  1043  7390  2156   262     6   151 36180  1630    12  5877
   868  2356     8   290   722     9   569   132   128    36 42539  4839
  6936 16155  2332    19  2440    12  9830   669   124  6991 21947    12
  1409    12 18847    12 44546  3547   492    24    10  8559     7 34321
   110   930  1004    24 29445     7  1217  1719  3041 13418     8  6410
 16632  6907  2073 14857   425 27445 19641     4   288  1437     2     2
 18047   766 27445 15162   290 19562 36180  1630 36924  2440    36   204
   212  2706  4839   475   428   406  2881   890    73   102 14857  8194
 27445  1437 14857   425 27445 24543     4  2545  1437     2]
tokens: ['<s>', 'COL', 'Ġname', 'ĠVAL', 'Ġapple', 'Ġ8', 'gb', 'Ġpink', 'Ġ4', 'th', 'Ġgeneration', 'Ġip', 'od', 'Ġnano', 'Ġm', 'b', '7', '35', 'lla', 'ĠCOL', 'Ġdescription', 'ĠVAL', 'Ġapple', 'Ġ8', 'gb', 'Ġpink', 'Ġ4', 'th', 'Ġgeneration', 'Ġip', 'od', 'Ġnano', 'Ġm', 'b', '7', '35', 'lla', 'Ġholds', 'Ġup', 'Ġto', 'Ġ2', ',', '000', 'Ġsongs', 'Ġin', 'Ġ128', '-', 'k', 'bps', 'Ġa', 'ac', 'Ġformat', 'Ġ,', 'Ġ7', ',', '000', 'Ġip', 'od', '-', 'view', 'able', 'Ġphotos', 'Ġand', 'Ġ8', 'Ġhours', 'Ġof', 'Ġvideo', 'Ġ2', "Ġ'", 'Ġ(', 'Ġdiagonal', 'Ġ)', 'Ġliquid', 'Ġcrystal', 'Ġdisplay', 'Ġwith', 'Ġblue', '-', 'white', 'Ġled', 'Ġback', 'light', 'Ġ320', '-', 'by', '-', '240', '-', 'pixel', 'Ġresolution', 'Ġgive', 'Ġit', 'Ġa', 'Ġshake', 'Ġto', 'Ġshuffle', 'Ġyour', 'Ġmusic', 'Ġturn', 'Ġit', 'Ġsideways', 'Ġto', 'Ġview', 'Ġcover', 'Ġflow', 'Ġmac', 'Ġand', 'Ġwindows', 'Ġcompatible', 'Ġpink', 'Ġfinish', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ144', '.', '0', 'Ġ', '</s>', '</s>', 'COL', 'Ġname', 'ĠVAL', 'Ġapple', 'Ġ8', 'gb', 'Ġip', 'od', 'Ġnano', 'Ġblue', 'Ġ(', 'Ġ4', 'th', 'Ġgeneration', 'Ġ)', 'Ġm', 'b', '7', '32', 'll', '/', 'a', 'ĠCOL', 'Ġdescription', 'ĠVAL', 'Ġ', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ146', '.', '75', 'Ġ', '</s>']
is_heads: [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
y: 0
tags: 0
mask: tensor([1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1])
seqlen: 154
task_name: Textual/Abt-Buy
=======================
step: 0, task: Textual/Abt-Buy, loss: 0.004956074059009552
step: 10, task: Textual/Abt-Buy, loss: 0.1502528190612793
step: 20, task: Textual/Abt-Buy, loss: 0.0011704415082931519
step: 30, task: Textual/Abt-Buy, loss: 0.0002066195011138916
step: 40, task: Textual/Abt-Buy, loss: 0.013017512857913971
step: 50, task: Textual/Abt-Buy, loss: 0.0012585371732711792
step: 60, task: Textual/Abt-Buy, loss: 7.739663124084473e-05
step: 70, task: Textual/Abt-Buy, loss: 0.0001637786626815796
step: 80, task: Textual/Abt-Buy, loss: 0.00020672380924224854
step: 90, task: Textual/Abt-Buy, loss: 0.00018891692161560059
step: 100, task: Textual/Abt-Buy, loss: 9.830296039581299e-05
step: 110, task: Textual/Abt-Buy, loss: 0.0004734247922897339
step: 120, task: Textual/Abt-Buy, loss: 0.00010682642459869385
step: 130, task: Textual/Abt-Buy, loss: 0.00019963085651397705
step: 140, task: Textual/Abt-Buy, loss: 0.000675201416015625
step: 150, task: Textual/Abt-Buy, loss: 0.0006554275751113892
step: 160, task: Textual/Abt-Buy, loss: 0.00015285611152648926
step: 170, task: Textual/Abt-Buy, loss: 0.02572949230670929
step: 180, task: Textual/Abt-Buy, loss: 0.00013008713722229004
step: 190, task: Textual/Abt-Buy, loss: 0.00013293325901031494
step: 200, task: Textual/Abt-Buy, loss: 8.156895637512207e-05
step: 210, task: Textual/Abt-Buy, loss: 0.009622007608413696
step: 220, task: Textual/Abt-Buy, loss: 8.934736251831055e-05
step: 230, task: Textual/Abt-Buy, loss: 0.0030442625284194946
step: 240, task: Textual/Abt-Buy, loss: 0.10017596185207367
step: 250, task: Textual/Abt-Buy, loss: 0.00015228986740112305
step: 260, task: Textual/Abt-Buy, loss: 0.0004245936870574951
step: 270, task: Textual/Abt-Buy, loss: 0.006272740662097931
step: 280, task: Textual/Abt-Buy, loss: 0.00010693073272705078
step: 290, task: Textual/Abt-Buy, loss: 0.0006620287895202637
step: 300, task: Textual/Abt-Buy, loss: 0.00012534856796264648
step: 310, task: Textual/Abt-Buy, loss: 0.00020350515842437744
step: 320, task: Textual/Abt-Buy, loss: 0.0011970549821853638
step: 330, task: Textual/Abt-Buy, loss: 7.829070091247559e-05
step: 340, task: Textual/Abt-Buy, loss: 0.00019732117652893066
step: 350, task: Textual/Abt-Buy, loss: 0.00014761090278625488
=========eval at epoch=8=========
Validation:
=============Textual/Abt-Buy==================
accuracy=0.975
precision=0.934
recall=0.830
f1=0.879
======================================
Test:
=============Textual/Abt-Buy==================
accuracy=0.982
precision=0.962
recall=0.864
f1=0.910
======================================
Selected optimization level O2:  FP16 training with FP32 batchnorm and FP32 master weights.

Defaults for this optimization level are:
enabled                : True
opt_level              : O2
cast_model_type        : torch.float16
patch_torch_functions  : False
keep_batchnorm_fp32    : True
master_weights         : True
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O2
cast_model_type        : torch.float16
patch_torch_functions  : False
keep_batchnorm_fp32    : True
master_weights         : True
loss_scale             : dynamic
Warning:  multi_tensor_applier fused unscale kernel is unavailable, possibly because apex was installed without --cuda_ext --cpp_ext. Using Python fallback.  Original ImportError was: ModuleNotFoundError("No module named 'amp_C'")
Gradient overflow.  Skipping step, loss scaler 0 reducing loss scale to 32768.0
=====sanity check======
words: COL name VAL samsung 67 ' black widescreen series 7 led dlp hdtv hl67a750 COL description VAL samsung 67 ' black widescreen series 7 led dlp hdtv hl67a750 1920 x 1080p resolution 10,000:1 contrast ratio digital noise reduction cinemapure color engine get the full effect of 3d led backlight ntsc/atsc/clear qam built-in tuners 60,000 hours lamp life black finish COL price VAL   [SEP] COL name VAL samsung 6 series hl61a650 61 ' projection tv COL description VAL samsung hl61a650 61 ' widescreen 1080p dlp hdtv w / built in ntsc/atsc tuner piano black COL price VAL 1076.94 
x: [    0 18047   766 27445   579 48545  5545   128   909   885  4376 37346
   651   262   669   385 39031  1368   417 18724  1368   462  4111   102
 10569 14857  8194 27445   579 48545  5545   128   909   885  4376 37346
   651   262   669   385 39031  1368   417 18724  1368   462  4111   102
 10569 18283  3023 21083   642  3547   158     6   151    35   134  5709
  1750  1778  6496  4878 18535  1115  2407  3195  3819   120     5   455
  1683     9   155   417   669   124  6991   295  1872   438    73  2923
   438    73 18763  2231   424  1490    12   179 27115   268  1191     6
   151   722 24272   301   909  2073 14857   425 27445  1437  1437     2
     2 18047   766 27445   579 48545   231   651  1368   462  5606   102
 16316  5659   128 18144 30016 14857  8194 27445   579 48545  1368   462
  5606   102 16316  5659   128   885  4376 37346 21083   642   385 39031
  1368   417 18724   885  1589  1490    11   295  1872   438    73  2923
   438 27115   254 13305   909 14857   425 27445   158  5067     4  6405
  1437     2]
tokens: ['<s>', 'COL', 'Ġname', 'ĠVAL', 'Ġs', 'amsung', 'Ġ67', "Ġ'", 'Ġblack', 'Ġw', 'ides', 'creen', 'Ġseries', 'Ġ7', 'Ġled', 'Ġd', 'lp', 'Ġh', 'd', 'tv', 'Ġh', 'l', '67', 'a', '750', 'ĠCOL', 'Ġdescription', 'ĠVAL', 'Ġs', 'amsung', 'Ġ67', "Ġ'", 'Ġblack', 'Ġw', 'ides', 'creen', 'Ġseries', 'Ġ7', 'Ġled', 'Ġd', 'lp', 'Ġh', 'd', 'tv', 'Ġh', 'l', '67', 'a', '750', 'Ġ1920', 'Ġx', 'Ġ1080', 'p', 'Ġresolution', 'Ġ10', ',', '000', ':', '1', 'Ġcontrast', 'Ġratio', 'Ġdigital', 'Ġnoise', 'Ġreduction', 'Ġcinem', 'ap', 'ure', 'Ġcolor', 'Ġengine', 'Ġget', 'Ġthe', 'Ġfull', 'Ġeffect', 'Ġof', 'Ġ3', 'd', 'Ġled', 'Ġback', 'light', 'Ġn', 'ts', 'c', '/', 'ats', 'c', '/', 'clear', 'Ġq', 'am', 'Ġbuilt', '-', 'in', 'Ġtun', 'ers', 'Ġ60', ',', '000', 'Ġhours', 'Ġlamp', 'Ġlife', 'Ġblack', 'Ġfinish', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ', 'Ġ', '</s>', '</s>', 'COL', 'Ġname', 'ĠVAL', 'Ġs', 'amsung', 'Ġ6', 'Ġseries', 'Ġh', 'l', '61', 'a', '650', 'Ġ61', "Ġ'", 'Ġprojection', 'Ġtv', 'ĠCOL', 'Ġdescription', 'ĠVAL', 'Ġs', 'amsung', 'Ġh', 'l', '61', 'a', '650', 'Ġ61', "Ġ'", 'Ġw', 'ides', 'creen', 'Ġ1080', 'p', 'Ġd', 'lp', 'Ġh', 'd', 'tv', 'Ġw', 'Ġ/', 'Ġbuilt', 'Ġin', 'Ġn', 'ts', 'c', '/', 'ats', 'c', 'Ġtun', 'er', 'Ġpiano', 'Ġblack', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ10', '76', '.', '94', 'Ġ', '</s>']
is_heads: [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
y: 0
tags: 0
mask: tensor([1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1])
seqlen: 170
task_name: Textual/Abt-Buy
=======================
step: 0, task: Textual/Abt-Buy, loss: 0.7512860894203186
Gradient overflow.  Skipping step, loss scaler 0 reducing loss scale to 16384.0
Gradient overflow.  Skipping step, loss scaler 0 reducing loss scale to 8192.0
Gradient overflow.  Skipping step, loss scaler 0 reducing loss scale to 4096.0
step: 10, task: Textual/Abt-Buy, loss: 0.6865032315254211
step: 20, task: Textual/Abt-Buy, loss: 0.6934542655944824
step: 30, task: Textual/Abt-Buy, loss: 0.5369892120361328
step: 40, task: Textual/Abt-Buy, loss: 0.34450361132621765
step: 50, task: Textual/Abt-Buy, loss: 0.11844606697559357
step: 60, task: Textual/Abt-Buy, loss: 0.5330352187156677
step: 70, task: Textual/Abt-Buy, loss: 0.4061790406703949
step: 80, task: Textual/Abt-Buy, loss: 0.534392237663269
step: 90, task: Textual/Abt-Buy, loss: 0.24157562851905823
step: 100, task: Textual/Abt-Buy, loss: 0.20586103200912476
step: 110, task: Textual/Abt-Buy, loss: 0.3901578485965729
step: 120, task: Textual/Abt-Buy, loss: 0.16714343428611755
step: 130, task: Textual/Abt-Buy, loss: 0.24435031414031982
step: 140, task: Textual/Abt-Buy, loss: 0.22043466567993164
step: 150, task: Textual/Abt-Buy, loss: 0.3651440739631653
step: 160, task: Textual/Abt-Buy, loss: 0.12010423839092255
step: 170, task: Textual/Abt-Buy, loss: 0.17732369899749756
step: 180, task: Textual/Abt-Buy, loss: 0.22479228675365448
step: 190, task: Textual/Abt-Buy, loss: 0.1432003378868103
step: 200, task: Textual/Abt-Buy, loss: 0.2493107169866562
step: 210, task: Textual/Abt-Buy, loss: 0.3510032594203949
step: 220, task: Textual/Abt-Buy, loss: 0.4472638964653015
step: 230, task: Textual/Abt-Buy, loss: 0.34369155764579773
step: 240, task: Textual/Abt-Buy, loss: 0.3548508286476135
step: 250, task: Textual/Abt-Buy, loss: 0.1199004203081131
step: 260, task: Textual/Abt-Buy, loss: 0.12239371985197067
step: 270, task: Textual/Abt-Buy, loss: 0.7210347652435303
step: 280, task: Textual/Abt-Buy, loss: 0.41238611936569214
step: 290, task: Textual/Abt-Buy, loss: 0.3603457808494568
step: 300, task: Textual/Abt-Buy, loss: 0.4580707550048828
step: 310, task: Textual/Abt-Buy, loss: 0.2432524859905243
step: 320, task: Textual/Abt-Buy, loss: 0.08275648951530457
step: 330, task: Textual/Abt-Buy, loss: 0.3228115439414978
step: 340, task: Textual/Abt-Buy, loss: 0.09273600578308105
step: 350, task: Textual/Abt-Buy, loss: 0.3171173334121704
=========eval at epoch=1=========
Validation:
=============Textual/Abt-Buy==================
accuracy=0.892
precision=0.000
recall=0.000
f1=0.000
======================================
Test:
=============Textual/Abt-Buy==================
accuracy=0.892
precision=0.000
recall=0.000
f1=0.000
======================================
/w/246/tianyu2020/miniconda2/envs/ditto/lib/python3.7/site-packages/apex/amp/_initialize.py:24: UserWarning: An input tensor was not cuda.
  warnings.warn("An input tensor was not cuda.")
/w/246/tianyu2020/miniconda2/envs/ditto/lib/python3.7/site-packages/torch/optim/lr_scheduler.py:122: UserWarning: Detected call of `lr_scheduler.step()` before `optimizer.step()`. In PyTorch 1.1.0 and later, you should call them in the opposite order: `optimizer.step()` before `lr_scheduler.step()`.  Failure to do this will result in PyTorch skipping the first value of the learning rate schedule. See more details at https://pytorch.org/docs/stable/optim.html#how-to-adjust-learning-rate
  "https://pytorch.org/docs/stable/optim.html#how-to-adjust-learning-rate", UserWarning)
/w/246/tianyu2020/miniconda2/envs/ditto/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1221: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
=====sanity check======
words: COL name VAL panasonic 2gb sd memory card sdv02gu1a COL description VAL panasonic 2gb sd memory card sdv02gu1a class 6 performance pro high speed series up to 20mb per second yellow finish COL price VAL   [SEP] COL name VAL playstation 2 memory card 8mb COL description VAL  COL price VAL  
x: [    0 18047   766 27445  5730 38703   132 19562 46409  3783  1886 46409
   705  4197  5521   134   102 14857  8194 27445  5730 38703   132 19562
 46409  3783  1886 46409   705  4197  5521   134   102  1380   231   819
  1759   239  2078   651    62     7   291  6648   228   200  5718  2073
 14857   425 27445  1437  1437     2     2 18047   766 27445   310 30650
   132  3783  1886   290  6648 14857  8194 27445  1437 14857   425 27445
  1437  1437     2]
tokens: ['<s>', 'COL', 'Ġname', 'ĠVAL', 'Ġpan', 'asonic', 'Ġ2', 'gb', 'Ġsd', 'Ġmemory', 'Ġcard', 'Ġsd', 'v', '02', 'gu', '1', 'a', 'ĠCOL', 'Ġdescription', 'ĠVAL', 'Ġpan', 'asonic', 'Ġ2', 'gb', 'Ġsd', 'Ġmemory', 'Ġcard', 'Ġsd', 'v', '02', 'gu', '1', 'a', 'Ġclass', 'Ġ6', 'Ġperformance', 'Ġpro', 'Ġhigh', 'Ġspeed', 'Ġseries', 'Ġup', 'Ġto', 'Ġ20', 'mb', 'Ġper', 'Ġsecond', 'Ġyellow', 'Ġfinish', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ', 'Ġ', '</s>', '</s>', 'COL', 'Ġname', 'ĠVAL', 'Ġplay', 'station', 'Ġ2', 'Ġmemory', 'Ġcard', 'Ġ8', 'mb', 'ĠCOL', 'Ġdescription', 'ĠVAL', 'Ġ', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ', 'Ġ', '</s>']
is_heads: [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
y: 0
tags: 0
mask: tensor([1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1])
seqlen: 75
task_name: Textual/Abt-Buy
=======================
step: 0, task: Textual/Abt-Buy, loss: 0.09304574131965637
step: 10, task: Textual/Abt-Buy, loss: 0.4265047013759613
step: 20, task: Textual/Abt-Buy, loss: 0.24391496181488037
step: 30, task: Textual/Abt-Buy, loss: 0.08716271817684174
step: 40, task: Textual/Abt-Buy, loss: 0.27738669514656067
step: 50, task: Textual/Abt-Buy, loss: 0.251581072807312
step: 60, task: Textual/Abt-Buy, loss: 0.23472154140472412
step: 70, task: Textual/Abt-Buy, loss: 0.029563475400209427
step: 80, task: Textual/Abt-Buy, loss: 0.262393057346344
step: 90, task: Textual/Abt-Buy, loss: 0.08997650444507599
step: 100, task: Textual/Abt-Buy, loss: 0.22212445735931396
step: 110, task: Textual/Abt-Buy, loss: 0.43112269043922424
step: 120, task: Textual/Abt-Buy, loss: 0.20303384959697723
step: 130, task: Textual/Abt-Buy, loss: 0.12608247995376587
step: 140, task: Textual/Abt-Buy, loss: 0.23159316182136536
step: 150, task: Textual/Abt-Buy, loss: 0.2847783863544464
step: 160, task: Textual/Abt-Buy, loss: 0.07204260677099228
step: 170, task: Textual/Abt-Buy, loss: 0.3128085136413574
step: 180, task: Textual/Abt-Buy, loss: 0.2007918506860733
step: 190, task: Textual/Abt-Buy, loss: 0.24190911650657654
step: 200, task: Textual/Abt-Buy, loss: 0.11722895503044128
step: 210, task: Textual/Abt-Buy, loss: 0.30094683170318604
step: 220, task: Textual/Abt-Buy, loss: 0.025507261976599693
step: 230, task: Textual/Abt-Buy, loss: 0.17922568321228027
step: 240, task: Textual/Abt-Buy, loss: 0.16446305811405182
step: 250, task: Textual/Abt-Buy, loss: 0.29963964223861694
step: 260, task: Textual/Abt-Buy, loss: 0.5532194375991821
step: 270, task: Textual/Abt-Buy, loss: 0.6957844495773315
step: 280, task: Textual/Abt-Buy, loss: 0.1740613728761673
step: 290, task: Textual/Abt-Buy, loss: 0.12445656955242157
step: 300, task: Textual/Abt-Buy, loss: 0.026242893189191818
step: 310, task: Textual/Abt-Buy, loss: 0.10445553809404373
step: 320, task: Textual/Abt-Buy, loss: 0.4573112726211548
step: 330, task: Textual/Abt-Buy, loss: 0.09211614727973938
step: 340, task: Textual/Abt-Buy, loss: 0.04707144573330879
step: 350, task: Textual/Abt-Buy, loss: 0.0034032464027404785
=========eval at epoch=1=========
Validation:
=============Textual/Abt-Buy==================
accuracy=0.939
precision=0.661
recall=0.888
f1=0.758
======================================
Test:
=============Textual/Abt-Buy==================
accuracy=0.927
precision=0.609
recall=0.893
f1=0.724
======================================
=====sanity check======
words: COL name VAL panasonic black expandable digital cordless dect 6.0 phone system kxtg9348t COL description VAL panasonic black expandable digital cordless dect 6.0 phone system kxtg9348t automatic clarity booster 5 hours talk time 11 days standby white backlit lcd 6-step speakerphone volume 1 drop & splash resistant phone 1.9 ghz frequency range night mode black finish COL price VAL   [SEP] COL name VAL panasonic kx-tg9344t expandable digital cordless phone COL description VAL 1 x phone line ( s ) COL price VAL 116.21 
x: [    0 18047   766 27445  5730 38703   909  3003   868  1778 13051  1672
   263  3894   231     4   288  1028   467   449 11483   571   466 27765
    90 14857  8194 27445  5730 38703   909  3003   868  1778 13051  1672
   263  3894   231     4   288  1028   467   449 11483   571   466 27765
    90  8408 10498 27028   195   722  1067    86   365   360 28611  1104
   124 13534   784 28690   231    12 13975  5385 17283  3149   112  1874
   359 17158 19152  1028   112     4   466 34648   329 13135  1186   363
  5745   909  2073 14857   425 27445  1437  1437     2     2 18047   766
 27445  5730 38703   449  1178    12 42698  6478  3305    90  3003   868
  1778 13051  1672  1028 14857  8194 27445   112  3023  1028   516    36
   579  4839 14857   425 27445 15966     4  2146  1437     2]
tokens: ['<s>', 'COL', 'Ġname', 'ĠVAL', 'Ġpan', 'asonic', 'Ġblack', 'Ġexpand', 'able', 'Ġdigital', 'Ġcord', 'less', 'Ġde', 'ct', 'Ġ6', '.', '0', 'Ġphone', 'Ġsystem', 'Ġk', 'xt', 'g', '9', '348', 't', 'ĠCOL', 'Ġdescription', 'ĠVAL', 'Ġpan', 'asonic', 'Ġblack', 'Ġexpand', 'able', 'Ġdigital', 'Ġcord', 'less', 'Ġde', 'ct', 'Ġ6', '.', '0', 'Ġphone', 'Ġsystem', 'Ġk', 'xt', 'g', '9', '348', 't', 'Ġautomatic', 'Ġclarity', 'Ġbooster', 'Ġ5', 'Ġhours', 'Ġtalk', 'Ġtime', 'Ġ11', 'Ġdays', 'Ġstandby', 'Ġwhite', 'Ġback', 'lit', 'Ġl', 'cd', 'Ġ6', '-', 'step', 'Ġspeaker', 'phone', 'Ġvolume', 'Ġ1', 'Ġdrop', 'Ġ&', 'Ġsplash', 'Ġresistant', 'Ġphone', 'Ġ1', '.', '9', 'Ġgh', 'z', 'Ġfrequency', 'Ġrange', 'Ġnight', 'Ġmode', 'Ġblack', 'Ġfinish', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ', 'Ġ', '</s>', '</s>', 'COL', 'Ġname', 'ĠVAL', 'Ġpan', 'asonic', 'Ġk', 'x', '-', 'tg', '93', '44', 't', 'Ġexpand', 'able', 'Ġdigital', 'Ġcord', 'less', 'Ġphone', 'ĠCOL', 'Ġdescription', 'ĠVAL', 'Ġ1', 'Ġx', 'Ġphone', 'Ġline', 'Ġ(', 'Ġs', 'Ġ)', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ116', '.', '21', 'Ġ', '</s>']
is_heads: [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
y: 0
tags: 0
mask: tensor([1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1])
seqlen: 130
task_name: Textual/Abt-Buy
=======================
step: 0, task: Textual/Abt-Buy, loss: 0.12522107362747192
step: 10, task: Textual/Abt-Buy, loss: 0.13464131951332092
step: 20, task: Textual/Abt-Buy, loss: 0.048845283687114716
step: 30, task: Textual/Abt-Buy, loss: 0.10546685755252838
step: 40, task: Textual/Abt-Buy, loss: 0.09381823241710663
step: 50, task: Textual/Abt-Buy, loss: 0.0877026841044426
step: 60, task: Textual/Abt-Buy, loss: 0.17366129159927368
step: 70, task: Textual/Abt-Buy, loss: 0.15854622423648834
step: 80, task: Textual/Abt-Buy, loss: 0.06711434572935104
step: 90, task: Textual/Abt-Buy, loss: 0.06385937333106995
step: 100, task: Textual/Abt-Buy, loss: 0.04809259995818138
step: 110, task: Textual/Abt-Buy, loss: 0.02547779306769371
step: 120, task: Textual/Abt-Buy, loss: 0.2571070194244385
step: 130, task: Textual/Abt-Buy, loss: 0.2348608374595642
step: 140, task: Textual/Abt-Buy, loss: 0.05049091577529907
step: 150, task: Textual/Abt-Buy, loss: 0.10605677962303162
step: 160, task: Textual/Abt-Buy, loss: 0.14161784946918488
step: 170, task: Textual/Abt-Buy, loss: 0.0060676634311676025
step: 180, task: Textual/Abt-Buy, loss: 0.15242578089237213
step: 190, task: Textual/Abt-Buy, loss: 0.17593222856521606
step: 200, task: Textual/Abt-Buy, loss: 0.10303717106580734
step: 210, task: Textual/Abt-Buy, loss: 0.49947455525398254
step: 220, task: Textual/Abt-Buy, loss: 0.31425243616104126
step: 230, task: Textual/Abt-Buy, loss: 0.1164664775133133
step: 240, task: Textual/Abt-Buy, loss: 0.4652714133262634
step: 250, task: Textual/Abt-Buy, loss: 0.026038214564323425
step: 260, task: Textual/Abt-Buy, loss: 0.13320456445217133
step: 270, task: Textual/Abt-Buy, loss: 0.41050952672958374
step: 280, task: Textual/Abt-Buy, loss: 0.17162665724754333
step: 290, task: Textual/Abt-Buy, loss: 0.019076872617006302
step: 300, task: Textual/Abt-Buy, loss: 0.07259389758110046
step: 310, task: Textual/Abt-Buy, loss: 0.01293136551976204
step: 320, task: Textual/Abt-Buy, loss: 0.1456032246351242
step: 330, task: Textual/Abt-Buy, loss: 0.225986510515213
step: 340, task: Textual/Abt-Buy, loss: 0.008957095444202423
step: 350, task: Textual/Abt-Buy, loss: 0.08703548461198807
=========eval at epoch=2=========
Validation:
=============Textual/Abt-Buy==================
accuracy=0.951
precision=0.889
recall=0.621
f1=0.731
======================================
Test:
=============Textual/Abt-Buy==================
accuracy=0.964
precision=0.936
recall=0.714
f1=0.810
======================================
=====sanity check======
words: COL name VAL polk audio 5.1 channel black home theater speaker system rm705bk COL description VAL polk audio 5.1 channel black home theater speaker system rm705bk heavy-duty non-resonant composite enclosures downward firing powered 8 ' subwoofer built-in subwoofer power amp with active crossover three-sided cabinet design magnetically shielded black finish COL price VAL 499.95  [SEP] COL name VAL onkyo hts5100 home theater system hts5100b COL description VAL , a/v receiver , 7.1 speakers 1200w rms dolby pro logic iix , dolby digital , dolby digital ex , dts , dts-es , dts neo :6 , dts 96/24 black COL price VAL 478.72 
x: [    0 18047   766 27445  8385   330  6086   195     4   134  4238   909
   184  7364  5385   467 45900 35278   428   330 14857  8194 27445  8385
   330  6086   195     4   134  4238   909   184  7364  5385   467 45900
 35278   428   330  2016    12 15593   786    12  1535   261   927 14464
 33390 28838 14659  5834  8852   290   128  2849 14869 20779  1490    12
   179  2849 14869 20779   476 28127    19  2171 20129   130    12 17376
  5892  1521 22396  3435 33855   909  2073 14857   425 27445 43071     4
  4015  1437     2     2 18047   766 27445    15  4122   139  1368  1872
   245  1866   184  7364   467  1368  1872   245  1866   428 14857  8194
 27445  2156    10    73   705  4797  2156   262     4   134  6864 23777
   605   910  4339   385  1168  1409  1759 14578   939  3181  2156   385
  1168  1409  1778  2156   385  1168  1409  1778  1931  2156   385  1872
  2156   385  1872    12   293  2156   385  1872 17863  4832   401  2156
   385  1872  8971    73  1978   909 14857   425 27445   204  5479     4
  4956  1437     2]
tokens: ['<s>', 'COL', 'Ġname', 'ĠVAL', 'Ġpol', 'k', 'Ġaudio', 'Ġ5', '.', '1', 'Ġchannel', 'Ġblack', 'Ġhome', 'Ġtheater', 'Ġspeaker', 'Ġsystem', 'Ġrm', '705', 'b', 'k', 'ĠCOL', 'Ġdescription', 'ĠVAL', 'Ġpol', 'k', 'Ġaudio', 'Ġ5', '.', '1', 'Ġchannel', 'Ġblack', 'Ġhome', 'Ġtheater', 'Ġspeaker', 'Ġsystem', 'Ġrm', '705', 'b', 'k', 'Ġheavy', '-', 'duty', 'Ġnon', '-', 'res', 'on', 'ant', 'Ġcomposite', 'Ġencl', 'osures', 'Ġdownward', 'Ġfiring', 'Ġpowered', 'Ġ8', "Ġ'", 'Ġsub', 'wo', 'ofer', 'Ġbuilt', '-', 'in', 'Ġsub', 'wo', 'ofer', 'Ġpower', 'Ġamp', 'Ġwith', 'Ġactive', 'Ġcrossover', 'Ġthree', '-', 'sided', 'Ġcabinet', 'Ġdesign', 'Ġmagnet', 'ically', 'Ġshielded', 'Ġblack', 'Ġfinish', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ499', '.', '95', 'Ġ', '</s>', '</s>', 'COL', 'Ġname', 'ĠVAL', 'Ġon', 'ky', 'o', 'Ġh', 'ts', '5', '100', 'Ġhome', 'Ġtheater', 'Ġsystem', 'Ġh', 'ts', '5', '100', 'b', 'ĠCOL', 'Ġdescription', 'ĠVAL', 'Ġ,', 'Ġa', '/', 'v', 'Ġreceiver', 'Ġ,', 'Ġ7', '.', '1', 'Ġspeakers', 'Ġ1200', 'w', 'Ġr', 'ms', 'Ġd', 'ol', 'by', 'Ġpro', 'Ġlogic', 'Ġi', 'ix', 'Ġ,', 'Ġd', 'ol', 'by', 'Ġdigital', 'Ġ,', 'Ġd', 'ol', 'by', 'Ġdigital', 'Ġex', 'Ġ,', 'Ġd', 'ts', 'Ġ,', 'Ġd', 'ts', '-', 'es', 'Ġ,', 'Ġd', 'ts', 'Ġneo', 'Ġ:', '6', 'Ġ,', 'Ġd', 'ts', 'Ġ96', '/', '24', 'Ġblack', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ4', '78', '.', '72', 'Ġ', '</s>']
is_heads: [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
y: 0
tags: 0
mask: tensor([1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1])
seqlen: 171
task_name: Textual/Abt-Buy
=======================
step: 0, task: Textual/Abt-Buy, loss: 0.0019234493374824524
step: 10, task: Textual/Abt-Buy, loss: 0.012983076274394989
step: 20, task: Textual/Abt-Buy, loss: 0.09662758558988571
step: 30, task: Textual/Abt-Buy, loss: 0.02860220894217491
step: 40, task: Textual/Abt-Buy, loss: 0.04567403718829155
step: 50, task: Textual/Abt-Buy, loss: 0.03465930372476578
step: 60, task: Textual/Abt-Buy, loss: 0.013146854937076569
step: 70, task: Textual/Abt-Buy, loss: 0.04294037073850632
step: 80, task: Textual/Abt-Buy, loss: 0.2010977566242218
step: 90, task: Textual/Abt-Buy, loss: 0.007364824414253235
step: 100, task: Textual/Abt-Buy, loss: 0.010344438254833221
step: 110, task: Textual/Abt-Buy, loss: 0.032891999930143356
step: 120, task: Textual/Abt-Buy, loss: 0.012559961527585983
step: 130, task: Textual/Abt-Buy, loss: 0.001195758581161499
step: 140, task: Textual/Abt-Buy, loss: 0.024430207908153534
step: 150, task: Textual/Abt-Buy, loss: 0.04800796881318092
step: 160, task: Textual/Abt-Buy, loss: 0.13272199034690857
step: 170, task: Textual/Abt-Buy, loss: 0.037923265248537064
step: 180, task: Textual/Abt-Buy, loss: 0.0037842169404029846
step: 190, task: Textual/Abt-Buy, loss: 0.13337349891662598
step: 200, task: Textual/Abt-Buy, loss: 0.04739732667803764
step: 210, task: Textual/Abt-Buy, loss: 0.0015957579016685486
step: 220, task: Textual/Abt-Buy, loss: 0.0005188733339309692
step: 230, task: Textual/Abt-Buy, loss: 0.042235344648361206
step: 240, task: Textual/Abt-Buy, loss: 0.04849017411470413
step: 250, task: Textual/Abt-Buy, loss: 0.06063700094819069
step: 260, task: Textual/Abt-Buy, loss: 0.08621469140052795
step: 270, task: Textual/Abt-Buy, loss: 0.08319762349128723
step: 280, task: Textual/Abt-Buy, loss: 0.043976105749607086
step: 290, task: Textual/Abt-Buy, loss: 0.12122946977615356
step: 300, task: Textual/Abt-Buy, loss: 0.03472260758280754
step: 310, task: Textual/Abt-Buy, loss: 0.29668599367141724
step: 320, task: Textual/Abt-Buy, loss: 0.1518157720565796
step: 330, task: Textual/Abt-Buy, loss: 0.01453562080860138
step: 340, task: Textual/Abt-Buy, loss: 0.009569253772497177
step: 350, task: Textual/Abt-Buy, loss: 0.0032763928174972534
=========eval at epoch=3=========
Validation:
=============Textual/Abt-Buy==================
accuracy=0.966
precision=0.843
recall=0.835
f1=0.839
======================================
Test:
=============Textual/Abt-Buy==================
accuracy=0.971
precision=0.851
recall=0.888
f1=0.869
======================================
=====sanity check======
words: COL name VAL canon eos 40d digital slr camera in black eos40dbody COL description VAL canon eos 40d digital slr camera in black eos40dbody body only 10.1 megapixel cmos sensor digic iii image processor auto pop-up , retractable , built-in flash 3.0 ' tft color liquid-crystal monitor af system with 9 cross-type sensors black finish lens sold separately COL price VAL   [SEP] COL name VAL canon powershot a1000 is digital camera gray 3210b001 COL description VAL canon powershot a1000 is 10 megapixel digital camera w / 4x optical zoom , 2.5 lcd , optical image stabilizer , & face detection gray COL price VAL  
x: [    0 18047   766 27445 32839   364   366   843   417  1778  3369   338
  2280    11   909   364   366  1749   417  9773 14857  8194 27445 32839
   364   366   843   417  1778  3369   338  2280    11   909   364   366
  1749   417  9773   809   129   158     4   134 10721 21424 25434   366
  9626  8512   636 46814  2274 10655  4485  3495    12   658  2156 31914
   868  2156  1490    12   179  7462   155     4   288   128   326  2543
  3195  6936    12 36896 24370  5271  9724   467    19   361  2116    12
 12528 10075   909  2073 10373  1088 12712 14857   425 27445  1437  1437
     2     2 18047   766 27445 32839  4361 10120    10 20078    16  1778
  2280 12339  2107   698   428 19089 14857  8194 27445 32839  4361 10120
    10 20078    16   158 10721 21424  1778  2280   885  1589   204  1178
 17547 21762  2156   132     4   245   784 28690  2156 17547  2274 12964
  6315  2156   359   652 12673 12339 14857   425 27445  1437  1437     2]
tokens: ['<s>', 'COL', 'Ġname', 'ĠVAL', 'Ġcanon', 'Ġe', 'os', 'Ġ40', 'd', 'Ġdigital', 'Ġsl', 'r', 'Ġcamera', 'Ġin', 'Ġblack', 'Ġe', 'os', '40', 'd', 'body', 'ĠCOL', 'Ġdescription', 'ĠVAL', 'Ġcanon', 'Ġe', 'os', 'Ġ40', 'd', 'Ġdigital', 'Ġsl', 'r', 'Ġcamera', 'Ġin', 'Ġblack', 'Ġe', 'os', '40', 'd', 'body', 'Ġbody', 'Ġonly', 'Ġ10', '.', '1', 'Ġmeg', 'apixel', 'Ġcm', 'os', 'Ġsensor', 'Ġdig', 'ic', 'Ġiii', 'Ġimage', 'Ġprocessor', 'Ġauto', 'Ġpop', '-', 'up', 'Ġ,', 'Ġretract', 'able', 'Ġ,', 'Ġbuilt', '-', 'in', 'Ġflash', 'Ġ3', '.', '0', "Ġ'", 'Ġt', 'ft', 'Ġcolor', 'Ġliquid', '-', 'cry', 'stal', 'Ġmonitor', 'Ġaf', 'Ġsystem', 'Ġwith', 'Ġ9', 'Ġcross', '-', 'type', 'Ġsensors', 'Ġblack', 'Ġfinish', 'Ġlens', 'Ġsold', 'Ġseparately', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ', 'Ġ', '</s>', '</s>', 'COL', 'Ġname', 'ĠVAL', 'Ġcanon', 'Ġpowers', 'hot', 'Ġa', '1000', 'Ġis', 'Ġdigital', 'Ġcamera', 'Ġgray', 'Ġ32', '10', 'b', '001', 'ĠCOL', 'Ġdescription', 'ĠVAL', 'Ġcanon', 'Ġpowers', 'hot', 'Ġa', '1000', 'Ġis', 'Ġ10', 'Ġmeg', 'apixel', 'Ġdigital', 'Ġcamera', 'Ġw', 'Ġ/', 'Ġ4', 'x', 'Ġoptical', 'Ġzoom', 'Ġ,', 'Ġ2', '.', '5', 'Ġl', 'cd', 'Ġ,', 'Ġoptical', 'Ġimage', 'Ġstabil', 'izer', 'Ġ,', 'Ġ&', 'Ġface', 'Ġdetection', 'Ġgray', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ', 'Ġ', '</s>']
is_heads: [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
y: 0
tags: 0
mask: tensor([1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1])
seqlen: 156
task_name: Textual/Abt-Buy
=======================
step: 0, task: Textual/Abt-Buy, loss: 0.0290030837059021
step: 10, task: Textual/Abt-Buy, loss: 0.0302480086684227
step: 20, task: Textual/Abt-Buy, loss: 0.003564007580280304
step: 30, task: Textual/Abt-Buy, loss: 0.0041426196694374084
step: 40, task: Textual/Abt-Buy, loss: 0.0040439218282699585
step: 50, task: Textual/Abt-Buy, loss: 0.0012673288583755493
step: 60, task: Textual/Abt-Buy, loss: 0.03866172581911087
step: 70, task: Textual/Abt-Buy, loss: 0.08095104992389679
step: 80, task: Textual/Abt-Buy, loss: 0.016242627054452896
step: 90, task: Textual/Abt-Buy, loss: 0.0008753538131713867
step: 100, task: Textual/Abt-Buy, loss: 0.005696341395378113
step: 110, task: Textual/Abt-Buy, loss: 0.002282649278640747
step: 120, task: Textual/Abt-Buy, loss: 0.0012679696083068848
step: 130, task: Textual/Abt-Buy, loss: 0.022932128980755806
step: 140, task: Textual/Abt-Buy, loss: 0.00042936205863952637
step: 150, task: Textual/Abt-Buy, loss: 0.0017604976892471313
step: 160, task: Textual/Abt-Buy, loss: 0.03450813144445419
step: 170, task: Textual/Abt-Buy, loss: 0.015271611511707306
step: 180, task: Textual/Abt-Buy, loss: 0.029261626303195953
step: 190, task: Textual/Abt-Buy, loss: 0.04316017031669617
step: 200, task: Textual/Abt-Buy, loss: 0.002329319715499878
step: 210, task: Textual/Abt-Buy, loss: 0.06686504185199738
step: 220, task: Textual/Abt-Buy, loss: 0.01087641716003418
step: 230, task: Textual/Abt-Buy, loss: 0.0015338435769081116
step: 240, task: Textual/Abt-Buy, loss: 0.09790840744972229
step: 250, task: Textual/Abt-Buy, loss: 0.15811540186405182
step: 260, task: Textual/Abt-Buy, loss: 0.02990376204252243
step: 270, task: Textual/Abt-Buy, loss: 0.1223907619714737
step: 280, task: Textual/Abt-Buy, loss: 0.0011273473501205444
step: 290, task: Textual/Abt-Buy, loss: 0.0009163767099380493
step: 300, task: Textual/Abt-Buy, loss: 0.18539677560329437
step: 310, task: Textual/Abt-Buy, loss: 0.0017009451985359192
step: 320, task: Textual/Abt-Buy, loss: 0.18836428225040436
step: 330, task: Textual/Abt-Buy, loss: 0.01590600237250328
step: 340, task: Textual/Abt-Buy, loss: 0.0006097108125686646
step: 350, task: Textual/Abt-Buy, loss: 0.018672484904527664
=========eval at epoch=4=========
Validation:
=============Textual/Abt-Buy==================
accuracy=0.963
precision=0.925
recall=0.714
f1=0.805
======================================
Test:
=============Textual/Abt-Buy==================
accuracy=0.973
precision=0.923
recall=0.816
f1=0.866
======================================
=====sanity check======
words: COL name VAL tivo series2 dual tuner digital video recorder tcd649080 COL description VAL tivo series2 dual tuner digital video recorder tcd649080 up to 80-hours of digital recording time pause and create instant replays of live tv supports recording from cable and satellite sources only usb connectivity remote control tivo service required and sold separately COL price VAL   [SEP] COL name VAL sony vrdmc5 digital video recorder COL description VAL dvd + rw , dvd-rw , dvd + r , memory stick , memory stick duo , secure digital ( sd ) card , xd-picture card , compactflash ( cf ) dvd video , mp3 1 disc 12hour recording COL price VAL 166.29 
x: [    0 18047   766 27445   326  9697   651   176  6594 27115   254  1778
   569 32017   326 28690  4027  3248  2940 14857  8194 27445   326  9697
   651   176  6594 27115   254  1778   569 32017   326 28690  4027  3248
  2940    62     7  1812    12 21719     9  1778  5492    86 13787     8
  1045 10062 19236  4113     9   697 30016  4548  5492    31  6129     8
  7595  1715   129 49030 10335  6063   797   326  9697   544  1552     8
  1088 12712 14857   425 27445  1437  1437     2     2 18047   766 27445
   579  6119   748  2586 29297   245  1778   569 32017 14857  8194 27445
   385 40311  2055   910   605  2156   385 40311    12 43926  2156   385
 40311  2055   910  2156  3783  4757  2156  3783  4757  6458  2156  2823
  1778    36 46409  4839  1886  2156  3023   417    12 37587  1886  2156
 12549 39837    36 46470  4839   385 40311   569  2156 44857   246   112
  9553   316  4509  5492 14857   425 27445 27459     4  2890  1437     2]
tokens: ['<s>', 'COL', 'Ġname', 'ĠVAL', 'Ġt', 'ivo', 'Ġseries', '2', 'Ġdual', 'Ġtun', 'er', 'Ġdigital', 'Ġvideo', 'Ġrecorder', 'Ġt', 'cd', '64', '90', '80', 'ĠCOL', 'Ġdescription', 'ĠVAL', 'Ġt', 'ivo', 'Ġseries', '2', 'Ġdual', 'Ġtun', 'er', 'Ġdigital', 'Ġvideo', 'Ġrecorder', 'Ġt', 'cd', '64', '90', '80', 'Ġup', 'Ġto', 'Ġ80', '-', 'hours', 'Ġof', 'Ġdigital', 'Ġrecording', 'Ġtime', 'Ġpause', 'Ġand', 'Ġcreate', 'Ġinstant', 'Ġrepl', 'ays', 'Ġof', 'Ġlive', 'Ġtv', 'Ġsupports', 'Ġrecording', 'Ġfrom', 'Ġcable', 'Ġand', 'Ġsatellite', 'Ġsources', 'Ġonly', 'Ġusb', 'Ġconnectivity', 'Ġremote', 'Ġcontrol', 'Ġt', 'ivo', 'Ġservice', 'Ġrequired', 'Ġand', 'Ġsold', 'Ġseparately', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ', 'Ġ', '</s>', '</s>', 'COL', 'Ġname', 'ĠVAL', 'Ġs', 'ony', 'Ġv', 'rd', 'mc', '5', 'Ġdigital', 'Ġvideo', 'Ġrecorder', 'ĠCOL', 'Ġdescription', 'ĠVAL', 'Ġd', 'vd', 'Ġ+', 'Ġr', 'w', 'Ġ,', 'Ġd', 'vd', '-', 'rw', 'Ġ,', 'Ġd', 'vd', 'Ġ+', 'Ġr', 'Ġ,', 'Ġmemory', 'Ġstick', 'Ġ,', 'Ġmemory', 'Ġstick', 'Ġduo', 'Ġ,', 'Ġsecure', 'Ġdigital', 'Ġ(', 'Ġsd', 'Ġ)', 'Ġcard', 'Ġ,', 'Ġx', 'd', '-', 'picture', 'Ġcard', 'Ġ,', 'Ġcompact', 'flash', 'Ġ(', 'Ġcf', 'Ġ)', 'Ġd', 'vd', 'Ġvideo', 'Ġ,', 'Ġmp', '3', 'Ġ1', 'Ġdisc', 'Ġ12', 'hour', 'Ġrecording', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ166', '.', '29', 'Ġ', '</s>']
is_heads: [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
y: 0
tags: 0
mask: tensor([1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1])
seqlen: 156
task_name: Textual/Abt-Buy
=======================
step: 0, task: Textual/Abt-Buy, loss: 0.01370726153254509
step: 10, task: Textual/Abt-Buy, loss: 0.022072020918130875
step: 20, task: Textual/Abt-Buy, loss: 0.00023837387561798096
step: 30, task: Textual/Abt-Buy, loss: 0.004171900451183319
step: 40, task: Textual/Abt-Buy, loss: 0.002289190888404846
step: 50, task: Textual/Abt-Buy, loss: 0.001302368938922882
step: 60, task: Textual/Abt-Buy, loss: 0.0008091926574707031
step: 70, task: Textual/Abt-Buy, loss: 0.0009527057409286499
step: 80, task: Textual/Abt-Buy, loss: 0.0016085058450698853
step: 90, task: Textual/Abt-Buy, loss: 0.005125425755977631
step: 100, task: Textual/Abt-Buy, loss: 0.0041290633380413055
step: 110, task: Textual/Abt-Buy, loss: 0.013061340898275375
step: 120, task: Textual/Abt-Buy, loss: 0.06614649295806885
step: 130, task: Textual/Abt-Buy, loss: 0.06294777989387512
step: 140, task: Textual/Abt-Buy, loss: 0.005058005452156067
step: 150, task: Textual/Abt-Buy, loss: 0.0001989305019378662
step: 160, task: Textual/Abt-Buy, loss: 0.008600085973739624
step: 170, task: Textual/Abt-Buy, loss: 0.02557244896888733
step: 180, task: Textual/Abt-Buy, loss: 0.004891224205493927
step: 190, task: Textual/Abt-Buy, loss: 0.07477189600467682
step: 200, task: Textual/Abt-Buy, loss: 0.016423381865024567
step: 210, task: Textual/Abt-Buy, loss: 0.06426507234573364
step: 220, task: Textual/Abt-Buy, loss: 0.0010782107710838318
step: 230, task: Textual/Abt-Buy, loss: 0.018869072198867798
step: 240, task: Textual/Abt-Buy, loss: 0.00034765899181365967
step: 250, task: Textual/Abt-Buy, loss: 0.04312596470117569
step: 260, task: Textual/Abt-Buy, loss: 0.0003796815872192383
step: 270, task: Textual/Abt-Buy, loss: 0.005970098078250885
step: 280, task: Textual/Abt-Buy, loss: 0.21247324347496033
step: 290, task: Textual/Abt-Buy, loss: 0.0410531684756279
step: 300, task: Textual/Abt-Buy, loss: 0.009280025959014893
step: 310, task: Textual/Abt-Buy, loss: 0.003528378903865814
step: 320, task: Textual/Abt-Buy, loss: 0.01092955470085144
step: 330, task: Textual/Abt-Buy, loss: 0.012747544795274734
step: 340, task: Textual/Abt-Buy, loss: 0.2465919703245163
step: 350, task: Textual/Abt-Buy, loss: 0.0014282390475273132
=========eval at epoch=5=========
Validation:
=============Textual/Abt-Buy==================
accuracy=0.972
precision=0.942
recall=0.791
f1=0.860
======================================
Test:
=============Textual/Abt-Buy==================
accuracy=0.978
precision=0.936
recall=0.854
f1=0.893
======================================
=====sanity check======
words: COL name VAL samsung 32 ' black flat panel series 4 lcd hdtv ln32a450 COL description VAL samsung 32 ' black flat panel series 4 lcd hdtv ln32a450 10,000:1 dynamic contrast ratio 1366 x 768 true 720p resolution 6ms response time cold cathode fluorescent lamp ( ccfl ) hidden bottom speakers srs trusurround xt built-in atsc/clear qam tuner v-chip system swivel stand black finish COL price VAL   [SEP] COL name VAL samsung 4 series ln32a450 32 ' lcd tv COL description VAL samsung ln32a450 32 ' widescreen 720p lcd hdtv 10000:1 dynamic contrast ratio 6ms response time piano black COL price VAL 578.0 
x: [    0 18047   766 27445   579 48545  2107   128   909  3269  2798   651
   204   784 28690  1368   417 18724   784   282  2881   102 13872 14857
  8194 27445   579 48545  2107   128   909  3269  2798   651   204   784
 28690  1368   417 18724   784   282  2881   102 13872   158     6   151
    35   134  6878  5709  1750   508  4280  3023 43751  1528 26180   642
  3547   231  4339  1263    86  2569 31420  4636 38006 24272    36 41754
  4825  4839  7397  2576  6864   579  4926  2664   687   710  3431  1437
 11483  1490    12   179    23  3866    73 18763  2231   424 27115   254
   748    12 16142   467  3514  2088   462  1413   909  2073 14857   425
 27445  1437  1437     2     2 18047   766 27445   579 48545   204   651
   784   282  2881   102 13872  2107   128   784 28690 30016 14857  8194
 27445   579 48545   784   282  2881   102 13872  2107   128   885  4376
 37346 26180   642   784 28690  1368   417 18724 45563    35   134  6878
  5709  1750   231  4339  1263    86 13305   909 14857   425 27445   195
  5479     4   288  1437     2]
tokens: ['<s>', 'COL', 'Ġname', 'ĠVAL', 'Ġs', 'amsung', 'Ġ32', "Ġ'", 'Ġblack', 'Ġflat', 'Ġpanel', 'Ġseries', 'Ġ4', 'Ġl', 'cd', 'Ġh', 'd', 'tv', 'Ġl', 'n', '32', 'a', '450', 'ĠCOL', 'Ġdescription', 'ĠVAL', 'Ġs', 'amsung', 'Ġ32', "Ġ'", 'Ġblack', 'Ġflat', 'Ġpanel', 'Ġseries', 'Ġ4', 'Ġl', 'cd', 'Ġh', 'd', 'tv', 'Ġl', 'n', '32', 'a', '450', 'Ġ10', ',', '000', ':', '1', 'Ġdynamic', 'Ġcontrast', 'Ġratio', 'Ġ13', '66', 'Ġx', 'Ġ768', 'Ġtrue', 'Ġ720', 'p', 'Ġresolution', 'Ġ6', 'ms', 'Ġresponse', 'Ġtime', 'Ġcold', 'Ġcath', 'ode', 'Ġfluorescent', 'Ġlamp', 'Ġ(', 'Ġcc', 'fl', 'Ġ)', 'Ġhidden', 'Ġbottom', 'Ġspeakers', 'Ġs', 'rs', 'Ġtr', 'us', 'ur', 'round', 'Ġ', 'xt', 'Ġbuilt', '-', 'in', 'Ġat', 'sc', '/', 'clear', 'Ġq', 'am', 'Ġtun', 'er', 'Ġv', '-', 'chip', 'Ġsystem', 'Ġsw', 'ive', 'l', 'Ġstand', 'Ġblack', 'Ġfinish', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ', 'Ġ', '</s>', '</s>', 'COL', 'Ġname', 'ĠVAL', 'Ġs', 'amsung', 'Ġ4', 'Ġseries', 'Ġl', 'n', '32', 'a', '450', 'Ġ32', "Ġ'", 'Ġl', 'cd', 'Ġtv', 'ĠCOL', 'Ġdescription', 'ĠVAL', 'Ġs', 'amsung', 'Ġl', 'n', '32', 'a', '450', 'Ġ32', "Ġ'", 'Ġw', 'ides', 'creen', 'Ġ720', 'p', 'Ġl', 'cd', 'Ġh', 'd', 'tv', 'Ġ10000', ':', '1', 'Ġdynamic', 'Ġcontrast', 'Ġratio', 'Ġ6', 'ms', 'Ġresponse', 'Ġtime', 'Ġpiano', 'Ġblack', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ5', '78', '.', '0', 'Ġ', '</s>']
is_heads: [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
y: 1
tags: 1
mask: tensor([1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1])
seqlen: 173
task_name: Textual/Abt-Buy
=======================
step: 0, task: Textual/Abt-Buy, loss: 0.004816912114620209
step: 10, task: Textual/Abt-Buy, loss: 0.0006537735462188721
step: 20, task: Textual/Abt-Buy, loss: 0.016735412180423737
Gradient overflow.  Skipping step, loss scaler 0 reducing loss scale to 4096.0
step: 30, task: Textual/Abt-Buy, loss: 0.00031979382038116455
step: 40, task: Textual/Abt-Buy, loss: 0.00043098628520965576
step: 50, task: Textual/Abt-Buy, loss: 0.00161038339138031
step: 60, task: Textual/Abt-Buy, loss: 0.023219838738441467
step: 70, task: Textual/Abt-Buy, loss: 0.001460157334804535
step: 80, task: Textual/Abt-Buy, loss: 0.05325751379132271
step: 90, task: Textual/Abt-Buy, loss: 0.00027120113372802734
step: 100, task: Textual/Abt-Buy, loss: 8.121132850646973e-05
step: 110, task: Textual/Abt-Buy, loss: 0.0006622374057769775
step: 120, task: Textual/Abt-Buy, loss: 0.0003097057342529297
step: 130, task: Textual/Abt-Buy, loss: 0.07293190062046051
step: 140, task: Textual/Abt-Buy, loss: 0.007315635681152344
step: 150, task: Textual/Abt-Buy, loss: 0.09903189539909363
step: 160, task: Textual/Abt-Buy, loss: 0.004601709544658661
step: 170, task: Textual/Abt-Buy, loss: 0.002258770167827606
step: 180, task: Textual/Abt-Buy, loss: 0.00043848156929016113
step: 190, task: Textual/Abt-Buy, loss: 0.00013321638107299805
step: 200, task: Textual/Abt-Buy, loss: 0.0008214041590690613
step: 210, task: Textual/Abt-Buy, loss: 0.0003053396940231323
step: 220, task: Textual/Abt-Buy, loss: 0.00019066035747528076
step: 230, task: Textual/Abt-Buy, loss: 0.014316409826278687
step: 240, task: Textual/Abt-Buy, loss: 0.009188942611217499
step: 250, task: Textual/Abt-Buy, loss: 0.0005351006984710693
step: 260, task: Textual/Abt-Buy, loss: 0.00032213330268859863
step: 270, task: Textual/Abt-Buy, loss: 0.0006095319986343384
step: 280, task: Textual/Abt-Buy, loss: 0.011243652552366257
step: 290, task: Textual/Abt-Buy, loss: 0.004142705351114273
step: 300, task: Textual/Abt-Buy, loss: 0.009256906807422638
step: 310, task: Textual/Abt-Buy, loss: 0.26116594672203064
step: 320, task: Textual/Abt-Buy, loss: 0.02069704979658127
step: 330, task: Textual/Abt-Buy, loss: 0.0003272145986557007
step: 340, task: Textual/Abt-Buy, loss: 0.00025887787342071533
step: 350, task: Textual/Abt-Buy, loss: 0.02285950817167759
=========eval at epoch=6=========
Validation:
=============Textual/Abt-Buy==================
accuracy=0.970
precision=0.936
recall=0.777
f1=0.849
======================================
Test:
=============Textual/Abt-Buy==================
accuracy=0.976
precision=0.940
recall=0.830
f1=0.881
======================================
=====sanity check======
words: COL name VAL transcend 2gb micro sd memory card ts2gusd COL description VAL transcend 2gb micro sd secure digital memory card ts2gusd good with cell phones and mobile devices mechanical write protection switch uses microsd adapter compliant with secure digital music initiative COL price VAL   [SEP] COL name VAL sony 2gb memory stick micro ( m2 ) msa2gd COL description VAL 2 gb COL price VAL  
x: [    0 18047   766 27445 32539   132 19562  5177 46409  3783  1886 42270
   176   571   687   417 14857  8194 27445 32539   132 19562  5177 46409
  2823  1778  3783  1886 42270   176   571   687   417   205    19  3551
  4247     8  1830  2110 12418  3116  2591  5405  2939  5177 28045 36007
 22624    19  2823  1778   930  3893 14857   425 27445  1437  1437     2
     2 18047   766 27445   579  6119   132 19562  3783  4757  5177    36
   475   176  4839   475 11146   176 27122 14857  8194 27445   132   821
   428 14857   425 27445  1437  1437     2]
tokens: ['<s>', 'COL', 'Ġname', 'ĠVAL', 'Ġtranscend', 'Ġ2', 'gb', 'Ġmicro', 'Ġsd', 'Ġmemory', 'Ġcard', 'Ġts', '2', 'g', 'us', 'd', 'ĠCOL', 'Ġdescription', 'ĠVAL', 'Ġtranscend', 'Ġ2', 'gb', 'Ġmicro', 'Ġsd', 'Ġsecure', 'Ġdigital', 'Ġmemory', 'Ġcard', 'Ġts', '2', 'g', 'us', 'd', 'Ġgood', 'Ġwith', 'Ġcell', 'Ġphones', 'Ġand', 'Ġmobile', 'Ġdevices', 'Ġmechanical', 'Ġwrite', 'Ġprotection', 'Ġswitch', 'Ġuses', 'Ġmicro', 'sd', 'Ġadapter', 'Ġcompliant', 'Ġwith', 'Ġsecure', 'Ġdigital', 'Ġmusic', 'Ġinitiative', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ', 'Ġ', '</s>', '</s>', 'COL', 'Ġname', 'ĠVAL', 'Ġs', 'ony', 'Ġ2', 'gb', 'Ġmemory', 'Ġstick', 'Ġmicro', 'Ġ(', 'Ġm', '2', 'Ġ)', 'Ġm', 'sa', '2', 'gd', 'ĠCOL', 'Ġdescription', 'ĠVAL', 'Ġ2', 'Ġg', 'b', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ', 'Ġ', '</s>']
is_heads: [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
y: 0
tags: 0
mask: tensor([1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1])
seqlen: 91
task_name: Textual/Abt-Buy
=======================
step: 0, task: Textual/Abt-Buy, loss: 0.0005262196063995361
step: 10, task: Textual/Abt-Buy, loss: 0.0023150593042373657
step: 20, task: Textual/Abt-Buy, loss: 0.10561724007129669
step: 30, task: Textual/Abt-Buy, loss: 0.0002215951681137085
step: 40, task: Textual/Abt-Buy, loss: 0.01162753626704216
step: 50, task: Textual/Abt-Buy, loss: 0.0034594833850860596
step: 60, task: Textual/Abt-Buy, loss: 0.0010617822408676147
step: 70, task: Textual/Abt-Buy, loss: 0.00015810132026672363
step: 80, task: Textual/Abt-Buy, loss: 0.004981420934200287
step: 90, task: Textual/Abt-Buy, loss: 0.00047121942043304443
step: 100, task: Textual/Abt-Buy, loss: 0.003875322639942169
step: 110, task: Textual/Abt-Buy, loss: 0.00894474983215332
step: 120, task: Textual/Abt-Buy, loss: 0.00021637976169586182
step: 130, task: Textual/Abt-Buy, loss: 0.0010861307382583618
step: 140, task: Textual/Abt-Buy, loss: 0.00016094744205474854
step: 150, task: Textual/Abt-Buy, loss: 0.0001520216464996338
step: 160, task: Textual/Abt-Buy, loss: 0.13223962485790253
step: 170, task: Textual/Abt-Buy, loss: 0.023978542536497116
step: 180, task: Textual/Abt-Buy, loss: 0.000287473201751709
step: 190, task: Textual/Abt-Buy, loss: 0.012054845690727234
step: 200, task: Textual/Abt-Buy, loss: 0.0002876967191696167
step: 210, task: Textual/Abt-Buy, loss: 0.00026132166385650635
step: 220, task: Textual/Abt-Buy, loss: 0.005825415253639221
step: 230, task: Textual/Abt-Buy, loss: 0.0010011717677116394
step: 240, task: Textual/Abt-Buy, loss: 0.00010484457015991211
step: 250, task: Textual/Abt-Buy, loss: 7.75754451751709e-05
step: 260, task: Textual/Abt-Buy, loss: 0.00019216537475585938
step: 270, task: Textual/Abt-Buy, loss: 0.09699585288763046
step: 280, task: Textual/Abt-Buy, loss: 0.0009700879454612732
step: 290, task: Textual/Abt-Buy, loss: 0.0002899169921875
step: 300, task: Textual/Abt-Buy, loss: 0.00014321506023406982
step: 310, task: Textual/Abt-Buy, loss: 0.0005760043859481812
step: 320, task: Textual/Abt-Buy, loss: 0.00010344386100769043
step: 330, task: Textual/Abt-Buy, loss: 0.00033365190029144287
step: 340, task: Textual/Abt-Buy, loss: 0.00017379224300384521
step: 350, task: Textual/Abt-Buy, loss: 0.000409930944442749
=========eval at epoch=7=========
Validation:
=============Textual/Abt-Buy==================
accuracy=0.975
precision=0.911
recall=0.850
f1=0.879
======================================
Test:
=============Textual/Abt-Buy==================
accuracy=0.979
precision=0.915
recall=0.888
f1=0.901
======================================
=====sanity check======
words: COL name VAL logitech driving force pro steering wheel with pedals set for sony playstation 2 9632930403 COL description VAL logitech driving force pro steering wheel with pedals set for sony playstation 2 9632930403 comfortable soft full rubber wheel realistically turn through 2.5 times wheel rotation 900 degrees of wheel steering state-of-the-art force feedback technology stick shifter responsive gas and brake pedals black finish COL price VAL 129.0  [SEP] COL name VAL logitech driving force pro for playstation 2 963293-0403 COL description VAL  COL price VAL  
x: [    0 18047   766 27445  7425 30051  1428  1370  1759 12216  5964    19
 40280   278    13   579  6119   310 30650   132   361  5449  2890   541
 34030 14857  8194 27445  7425 30051  1428  1370  1759 12216  5964    19
 40280   278    13   579  6119   310 30650   132   361  5449  2890   541
 34030  3473  3793   455 11283  5964 33539  1004   149   132     4   245
   498  5964 10134 10742  4176     9  5964 12216   194    12  1116    12
   627    12  2013  1370  6456   806  4757 37503  1334 20666  1123     8
 18507 40280   909  2073 14857   425 27445 21234     4   288  1437     2
     2 18047   766 27445  7425 30051  1428  1370  1759    13   310 30650
   132   361  5449 32329    12   288 34030 14857  8194 27445  1437 14857
   425 27445  1437  1437     2]
tokens: ['<s>', 'COL', 'Ġname', 'ĠVAL', 'Ġlog', 'itech', 'Ġdriving', 'Ġforce', 'Ġpro', 'Ġsteering', 'Ġwheel', 'Ġwith', 'Ġpedals', 'Ġset', 'Ġfor', 'Ġs', 'ony', 'Ġplay', 'station', 'Ġ2', 'Ġ9', '63', '29', '30', '403', 'ĠCOL', 'Ġdescription', 'ĠVAL', 'Ġlog', 'itech', 'Ġdriving', 'Ġforce', 'Ġpro', 'Ġsteering', 'Ġwheel', 'Ġwith', 'Ġpedals', 'Ġset', 'Ġfor', 'Ġs', 'ony', 'Ġplay', 'station', 'Ġ2', 'Ġ9', '63', '29', '30', '403', 'Ġcomfortable', 'Ġsoft', 'Ġfull', 'Ġrubber', 'Ġwheel', 'Ġrealistically', 'Ġturn', 'Ġthrough', 'Ġ2', '.', '5', 'Ġtimes', 'Ġwheel', 'Ġrotation', 'Ġ900', 'Ġdegrees', 'Ġof', 'Ġwheel', 'Ġsteering', 'Ġstate', '-', 'of', '-', 'the', '-', 'art', 'Ġforce', 'Ġfeedback', 'Ġtechnology', 'Ġstick', 'Ġshif', 'ter', 'Ġresponsive', 'Ġgas', 'Ġand', 'Ġbrake', 'Ġpedals', 'Ġblack', 'Ġfinish', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ129', '.', '0', 'Ġ', '</s>', '</s>', 'COL', 'Ġname', 'ĠVAL', 'Ġlog', 'itech', 'Ġdriving', 'Ġforce', 'Ġpro', 'Ġfor', 'Ġplay', 'station', 'Ġ2', 'Ġ9', '63', '293', '-', '0', '403', 'ĠCOL', 'Ġdescription', 'ĠVAL', 'Ġ', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ', 'Ġ', '</s>']
is_heads: [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
y: 1
tags: 1
mask: tensor([1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1])
seqlen: 125
task_name: Textual/Abt-Buy
=======================
step: 0, task: Textual/Abt-Buy, loss: 0.005317758768796921
step: 10, task: Textual/Abt-Buy, loss: 0.01739584095776081
step: 20, task: Textual/Abt-Buy, loss: 0.015325535088777542
step: 30, task: Textual/Abt-Buy, loss: 0.0008372068405151367
step: 40, task: Textual/Abt-Buy, loss: 0.0010759159922599792
step: 50, task: Textual/Abt-Buy, loss: 0.0007901042699813843
step: 60, task: Textual/Abt-Buy, loss: 0.0014967471361160278
step: 70, task: Textual/Abt-Buy, loss: 0.00015434622764587402
step: 80, task: Textual/Abt-Buy, loss: 0.00017224252223968506
step: 90, task: Textual/Abt-Buy, loss: 0.11723296344280243
step: 100, task: Textual/Abt-Buy, loss: 0.01640501618385315
step: 110, task: Textual/Abt-Buy, loss: 0.00027573108673095703
step: 120, task: Textual/Abt-Buy, loss: 0.0006912723183631897
step: 130, task: Textual/Abt-Buy, loss: 0.00011177361011505127
step: 140, task: Textual/Abt-Buy, loss: 0.10178955644369125
step: 150, task: Textual/Abt-Buy, loss: 0.008859328925609589
step: 160, task: Textual/Abt-Buy, loss: 0.01498323678970337
step: 170, task: Textual/Abt-Buy, loss: 0.009098589420318604
step: 180, task: Textual/Abt-Buy, loss: 0.009978942573070526
step: 190, task: Textual/Abt-Buy, loss: 0.003818891942501068
step: 200, task: Textual/Abt-Buy, loss: 0.00034096837043762207
step: 210, task: Textual/Abt-Buy, loss: 0.0003632456064224243
step: 220, task: Textual/Abt-Buy, loss: 0.0002476423978805542
step: 230, task: Textual/Abt-Buy, loss: 0.00017559528350830078
step: 240, task: Textual/Abt-Buy, loss: 0.0001595616340637207
step: 250, task: Textual/Abt-Buy, loss: 0.001764059066772461
step: 260, task: Textual/Abt-Buy, loss: 0.0001634359359741211
step: 270, task: Textual/Abt-Buy, loss: 0.006341170519590378
step: 280, task: Textual/Abt-Buy, loss: 0.0023355409502983093
step: 290, task: Textual/Abt-Buy, loss: 0.0006468147039413452
step: 300, task: Textual/Abt-Buy, loss: 0.0003059804439544678
step: 310, task: Textual/Abt-Buy, loss: 0.00024102628231048584
step: 320, task: Textual/Abt-Buy, loss: 0.06474195420742035
step: 330, task: Textual/Abt-Buy, loss: 0.020044386386871338
step: 340, task: Textual/Abt-Buy, loss: 0.11146016418933868
step: 350, task: Textual/Abt-Buy, loss: 0.008734583854675293
=========eval at epoch=8=========
Validation:
=============Textual/Abt-Buy==================
accuracy=0.975
precision=0.911
recall=0.850
f1=0.879
======================================
Test:
=============Textual/Abt-Buy==================
accuracy=0.979
precision=0.915
recall=0.888
f1=0.901
======================================
Selected optimization level O2:  FP16 training with FP32 batchnorm and FP32 master weights.

Defaults for this optimization level are:
enabled                : True
opt_level              : O2
cast_model_type        : torch.float16
patch_torch_functions  : False
keep_batchnorm_fp32    : True
master_weights         : True
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O2
cast_model_type        : torch.float16
patch_torch_functions  : False
keep_batchnorm_fp32    : True
master_weights         : True
loss_scale             : dynamic
Warning:  multi_tensor_applier fused unscale kernel is unavailable, possibly because apex was installed without --cuda_ext --cpp_ext. Using Python fallback.  Original ImportError was: ModuleNotFoundError("No module named 'amp_C'")
Gradient overflow.  Skipping step, loss scaler 0 reducing loss scale to 32768.0
=====sanity check======
words: COL name VAL kitchenaid 5-speed blender red finish ksb560er COL description VAL kitchenaid 5-speed blender ksb560er 56-oz . polycarbonate pitcher .9 horsepower motor intelli-speed controls automatic crush ice button electronic mixing sensor empire red finish COL price VAL   [SEP] COL name VAL kitchenaid 5-speed blender red finish ksb560er COL description VAL  COL price VAL 106.98 
x: [    0 18047   766 27445  4647  5526   195    12  8619 37086  1275  2073
   449 37844 30207   254 14857  8194 27445  4647  5526   195    12  8619
 37086   449 37844 30207   254  4772    12  3979   479 11424 23612   877
  7659   479   466 22325  4243  6979 13750    12  8619  5656  8408 18229
  2480  6148  5175 17793  9626 15167  1275  2073 14857   425 27445  1437
  1437     2     2 18047   766 27445  4647  5526   195    12  8619 37086
  1275  2073   449 37844 30207   254 14857  8194 27445  1437 14857   425
 27445 13442     4  5208  1437     2]
tokens: ['<s>', 'COL', 'Ġname', 'ĠVAL', 'Ġkitchen', 'aid', 'Ġ5', '-', 'speed', 'Ġblender', 'Ġred', 'Ġfinish', 'Ġk', 'sb', '560', 'er', 'ĠCOL', 'Ġdescription', 'ĠVAL', 'Ġkitchen', 'aid', 'Ġ5', '-', 'speed', 'Ġblender', 'Ġk', 'sb', '560', 'er', 'Ġ56', '-', 'oz', 'Ġ.', 'Ġpoly', 'carbon', 'ate', 'Ġpitcher', 'Ġ.', '9', 'Ġhorsepower', 'Ġmotor', 'Ġint', 'elli', '-', 'speed', 'Ġcontrols', 'Ġautomatic', 'Ġcrush', 'Ġice', 'Ġbutton', 'Ġelectronic', 'Ġmixing', 'Ġsensor', 'Ġempire', 'Ġred', 'Ġfinish', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ', 'Ġ', '</s>', '</s>', 'COL', 'Ġname', 'ĠVAL', 'Ġkitchen', 'aid', 'Ġ5', '-', 'speed', 'Ġblender', 'Ġred', 'Ġfinish', 'Ġk', 'sb', '560', 'er', 'ĠCOL', 'Ġdescription', 'ĠVAL', 'Ġ', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ106', '.', '98', 'Ġ', '</s>']
is_heads: [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
y: 1
tags: 1
mask: tensor([1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1])
seqlen: 90
task_name: Textual/Abt-Buy
=======================
step: 0, task: Textual/Abt-Buy, loss: 0.4726279377937317
Gradient overflow.  Skipping step, loss scaler 0 reducing loss scale to 16384.0
step: 10, task: Textual/Abt-Buy, loss: 0.4217956066131592
step: 20, task: Textual/Abt-Buy, loss: 0.43335869908332825
step: 30, task: Textual/Abt-Buy, loss: 0.4379163980484009
step: 40, task: Textual/Abt-Buy, loss: 0.6836500763893127
step: 50, task: Textual/Abt-Buy, loss: 0.48199427127838135
step: 60, task: Textual/Abt-Buy, loss: 0.421220064163208
step: 70, task: Textual/Abt-Buy, loss: 0.17228567600250244
step: 80, task: Textual/Abt-Buy, loss: 0.28058937191963196
step: 90, task: Textual/Abt-Buy, loss: 0.13865144550800323
step: 100, task: Textual/Abt-Buy, loss: 0.05244843661785126
step: 110, task: Textual/Abt-Buy, loss: 0.3938024640083313
step: 120, task: Textual/Abt-Buy, loss: 0.23690053820610046
step: 130, task: Textual/Abt-Buy, loss: 0.2335643470287323
step: 140, task: Textual/Abt-Buy, loss: 0.263163685798645
step: 150, task: Textual/Abt-Buy, loss: 0.28069034218788147
step: 160, task: Textual/Abt-Buy, loss: 0.431691974401474
step: 170, task: Textual/Abt-Buy, loss: 0.48913976550102234
step: 180, task: Textual/Abt-Buy, loss: 0.4880555272102356
step: 190, task: Textual/Abt-Buy, loss: 0.40544676780700684
step: 200, task: Textual/Abt-Buy, loss: 0.07903891801834106
step: 210, task: Textual/Abt-Buy, loss: 0.38210389018058777
step: 220, task: Textual/Abt-Buy, loss: 0.2754099369049072
step: 230, task: Textual/Abt-Buy, loss: 0.3101854920387268
step: 240, task: Textual/Abt-Buy, loss: 0.6275222897529602
step: 250, task: Textual/Abt-Buy, loss: 0.18965914845466614
step: 260, task: Textual/Abt-Buy, loss: 0.025149822235107422
step: 270, task: Textual/Abt-Buy, loss: 0.15741999447345734
step: 280, task: Textual/Abt-Buy, loss: 1.0555944442749023
step: 290, task: Textual/Abt-Buy, loss: 0.28177380561828613
step: 300, task: Textual/Abt-Buy, loss: 0.22435808181762695
Gradient overflow.  Skipping step, loss scaler 0 reducing loss scale to 8192.0
step: 310, task: Textual/Abt-Buy, loss: 0.08050011098384857
step: 320, task: Textual/Abt-Buy, loss: 0.0633309930562973
step: 330, task: Textual/Abt-Buy, loss: 0.6333320140838623
step: 340, task: Textual/Abt-Buy, loss: 0.24013730883598328
step: 350, task: Textual/Abt-Buy, loss: 0.04451746121048927
=========eval at epoch=1=========
Validation:
=============Textual/Abt-Buy==================
accuracy=0.953
precision=0.745
recall=0.850
f1=0.794
======================================
Test:
=============Textual/Abt-Buy==================
accuracy=0.955
precision=0.732
recall=0.913
f1=0.812
======================================
/w/246/tianyu2020/miniconda2/envs/ditto/lib/python3.7/site-packages/apex/amp/_initialize.py:24: UserWarning: An input tensor was not cuda.
  warnings.warn("An input tensor was not cuda.")
/w/246/tianyu2020/miniconda2/envs/ditto/lib/python3.7/site-packages/torch/optim/lr_scheduler.py:122: UserWarning: Detected call of `lr_scheduler.step()` before `optimizer.step()`. In PyTorch 1.1.0 and later, you should call them in the opposite order: `optimizer.step()` before `lr_scheduler.step()`.  Failure to do this will result in PyTorch skipping the first value of the learning rate schedule. See more details at https://pytorch.org/docs/stable/optim.html#how-to-adjust-learning-rate
  "https://pytorch.org/docs/stable/optim.html#how-to-adjust-learning-rate", UserWarning)
=====sanity check======
words: COL name VAL linksys simultaneous dual-n band wireless router wrt610n COL description VAL linksys simultaneous dual-n band wireless router wrt610n internet-sharing router and 4-port gigabit switch built-in dual-band speed and range enhanced wireless access point two simultaneous , separate radio bands wireless-n technology advanced wireless security and spi firewall COL price VAL 179.0  [SEP] COL name VAL linksys wireless-g wrt54gl broadband router COL description VAL linksys wrt54gl wireless-g broadband router COL price VAL  
x: [    0 18047   766 27445  5678  2459 30444  6594    12   282  1971  6955
 30577 14902    90 33375   282 14857  8194 27445  5678  2459 30444  6594
    12   282  1971  6955 30577 14902    90 33375   282  2888    12 12828
 30577     8   204    12  3427 10196 30820  5405  1490    12   179  6594
    12  9484  2078     8  1186  9094  6955   899   477    80 30444  2156
  2559  3188  8577  6955    12   282   806  3319  6955   573     8  2292
   118 38956 14857   425 27445 29189     4   288  1437     2     2 18047
   766 27445  5678  2459  6955    12   571 14902    90  4283  7210 11451
 30577 14857  8194 27445  5678  2459 14902    90  4283  7210  6955    12
   571 11451 30577 14857   425 27445  1437  1437     2]
tokens: ['<s>', 'COL', 'Ġname', 'ĠVAL', 'Ġlinks', 'ys', 'Ġsimultaneous', 'Ġdual', '-', 'n', 'Ġband', 'Ġwireless', 'Ġrouter', 'Ġwr', 't', '610', 'n', 'ĠCOL', 'Ġdescription', 'ĠVAL', 'Ġlinks', 'ys', 'Ġsimultaneous', 'Ġdual', '-', 'n', 'Ġband', 'Ġwireless', 'Ġrouter', 'Ġwr', 't', '610', 'n', 'Ġinternet', '-', 'sharing', 'Ġrouter', 'Ġand', 'Ġ4', '-', 'port', 'Ġgig', 'abit', 'Ġswitch', 'Ġbuilt', '-', 'in', 'Ġdual', '-', 'band', 'Ġspeed', 'Ġand', 'Ġrange', 'Ġenhanced', 'Ġwireless', 'Ġaccess', 'Ġpoint', 'Ġtwo', 'Ġsimultaneous', 'Ġ,', 'Ġseparate', 'Ġradio', 'Ġbands', 'Ġwireless', '-', 'n', 'Ġtechnology', 'Ġadvanced', 'Ġwireless', 'Ġsecurity', 'Ġand', 'Ġsp', 'i', 'Ġfirewall', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ179', '.', '0', 'Ġ', '</s>', '</s>', 'COL', 'Ġname', 'ĠVAL', 'Ġlinks', 'ys', 'Ġwireless', '-', 'g', 'Ġwr', 't', '54', 'gl', 'Ġbroadband', 'Ġrouter', 'ĠCOL', 'Ġdescription', 'ĠVAL', 'Ġlinks', 'ys', 'Ġwr', 't', '54', 'gl', 'Ġwireless', '-', 'g', 'Ġbroadband', 'Ġrouter', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ', 'Ġ', '</s>']
is_heads: [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
y: 0
tags: 0
mask: tensor([1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1])
seqlen: 117
task_name: Textual/Abt-Buy
=======================
step: 0, task: Textual/Abt-Buy, loss: 0.027518898248672485
step: 10, task: Textual/Abt-Buy, loss: 0.04792037606239319
step: 20, task: Textual/Abt-Buy, loss: 0.1268548220396042
step: 30, task: Textual/Abt-Buy, loss: 0.187585711479187
step: 40, task: Textual/Abt-Buy, loss: 0.3021622598171234
step: 50, task: Textual/Abt-Buy, loss: 0.024914219975471497
step: 60, task: Textual/Abt-Buy, loss: 0.0780290961265564
step: 70, task: Textual/Abt-Buy, loss: 0.02536984533071518
step: 80, task: Textual/Abt-Buy, loss: 0.1645309180021286
step: 90, task: Textual/Abt-Buy, loss: 0.05256495624780655
step: 100, task: Textual/Abt-Buy, loss: 0.006155937910079956
step: 110, task: Textual/Abt-Buy, loss: 0.011240527033805847
step: 120, task: Textual/Abt-Buy, loss: 0.0037373900413513184
step: 130, task: Textual/Abt-Buy, loss: 0.02337658405303955
step: 140, task: Textual/Abt-Buy, loss: 0.24721944332122803
step: 150, task: Textual/Abt-Buy, loss: 0.2841016352176666
step: 160, task: Textual/Abt-Buy, loss: 0.3438263535499573
step: 170, task: Textual/Abt-Buy, loss: 0.019922763109207153
step: 180, task: Textual/Abt-Buy, loss: 0.0561409518122673
step: 190, task: Textual/Abt-Buy, loss: 0.03972978889942169
step: 200, task: Textual/Abt-Buy, loss: 0.19200700521469116
step: 210, task: Textual/Abt-Buy, loss: 0.30206841230392456
step: 220, task: Textual/Abt-Buy, loss: 0.23707200586795807
step: 230, task: Textual/Abt-Buy, loss: 0.19546334445476532
step: 240, task: Textual/Abt-Buy, loss: 0.39996594190597534
step: 250, task: Textual/Abt-Buy, loss: 0.22919513285160065
step: 260, task: Textual/Abt-Buy, loss: 0.04287742078304291
step: 270, task: Textual/Abt-Buy, loss: 0.08590067923069
step: 280, task: Textual/Abt-Buy, loss: 0.4470919966697693
step: 290, task: Textual/Abt-Buy, loss: 0.0667843446135521
step: 300, task: Textual/Abt-Buy, loss: 0.06245095282793045
step: 310, task: Textual/Abt-Buy, loss: 0.14041545987129211
step: 320, task: Textual/Abt-Buy, loss: 0.03120800107717514
step: 330, task: Textual/Abt-Buy, loss: 0.04750494658946991
step: 340, task: Textual/Abt-Buy, loss: 0.1474316418170929
Gradient overflow.  Skipping step, loss scaler 0 reducing loss scale to 4096.0
step: 350, task: Textual/Abt-Buy, loss: 0.1042625829577446
=========eval at epoch=2=========
Validation:
=============Textual/Abt-Buy==================
accuracy=0.964
precision=0.931
recall=0.718
f1=0.811
======================================
Test:
=============Textual/Abt-Buy==================
accuracy=0.970
precision=0.890
recall=0.825
f1=0.856
======================================
=====sanity check======
words: COL name VAL panasonic 5.8 ghz black expandable digital cordless phone kxtg4321b COL description VAL panasonic 5.8 ghz black expandable digital cordless phone kxtg4321b multi-handset capability digital answering machine system ringer id call waiting caller id voicemail hold mute clock alarm led lighting speakerphone intercom 11 days standby 5 hours talk time black finish COL price VAL   [SEP] COL name VAL panasonic kx-tg9372b expandable digital cordless phone COL description VAL 1 x phone line ( s ) black COL price VAL 86.54 
x: [    0 18047   766 27445  5730 38703   195     4   398 34648   329   909
  3003   868  1778 13051  1672  1028   449 11483   571  3897  2146   428
 14857  8194 27445  5730 38703   195     4   398 34648   329   909  3003
   868  1778 13051  1672  1028   449 11483   571  3897  2146   428  3228
    12 34055   594  9388  1778 15635  3563   467   910  6082 13561   486
  2445 17017 13561 30118 10555   946 33758  6700  8054   669  7526  5385
 17283  3222   175   365   360 28611   195   722  1067    86   909  2073
 14857   425 27445  1437  1437     2     2 18047   766 27445  5730 38703
   449  1178    12 42698   466 34322   428  3003   868  1778 13051  1672
  1028 14857  8194 27445   112  3023  1028   516    36   579  4839   909
 14857   425 27445  8162     4  4283  1437     2]
tokens: ['<s>', 'COL', 'Ġname', 'ĠVAL', 'Ġpan', 'asonic', 'Ġ5', '.', '8', 'Ġgh', 'z', 'Ġblack', 'Ġexpand', 'able', 'Ġdigital', 'Ġcord', 'less', 'Ġphone', 'Ġk', 'xt', 'g', '43', '21', 'b', 'ĠCOL', 'Ġdescription', 'ĠVAL', 'Ġpan', 'asonic', 'Ġ5', '.', '8', 'Ġgh', 'z', 'Ġblack', 'Ġexpand', 'able', 'Ġdigital', 'Ġcord', 'less', 'Ġphone', 'Ġk', 'xt', 'g', '43', '21', 'b', 'Ġmulti', '-', 'hands', 'et', 'Ġcapability', 'Ġdigital', 'Ġanswering', 'Ġmachine', 'Ġsystem', 'Ġr', 'inger', 'Ġid', 'Ġcall', 'Ġwaiting', 'Ġcaller', 'Ġid', 'Ġvoic', 'email', 'Ġhold', 'Ġmute', 'Ġclock', 'Ġalarm', 'Ġled', 'Ġlighting', 'Ġspeaker', 'phone', 'Ġinter', 'com', 'Ġ11', 'Ġdays', 'Ġstandby', 'Ġ5', 'Ġhours', 'Ġtalk', 'Ġtime', 'Ġblack', 'Ġfinish', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ', 'Ġ', '</s>', '</s>', 'COL', 'Ġname', 'ĠVAL', 'Ġpan', 'asonic', 'Ġk', 'x', '-', 'tg', '9', '372', 'b', 'Ġexpand', 'able', 'Ġdigital', 'Ġcord', 'less', 'Ġphone', 'ĠCOL', 'Ġdescription', 'ĠVAL', 'Ġ1', 'Ġx', 'Ġphone', 'Ġline', 'Ġ(', 'Ġs', 'Ġ)', 'Ġblack', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ86', '.', '54', 'Ġ', '</s>']
is_heads: [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
y: 0
tags: 0
mask: tensor([1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1])
seqlen: 128
task_name: Textual/Abt-Buy
=======================
step: 0, task: Textual/Abt-Buy, loss: 0.31079572439193726
step: 10, task: Textual/Abt-Buy, loss: 0.03430456668138504
step: 20, task: Textual/Abt-Buy, loss: 0.1541220247745514
step: 30, task: Textual/Abt-Buy, loss: 0.14177851378917694
step: 40, task: Textual/Abt-Buy, loss: 0.01938772201538086
step: 50, task: Textual/Abt-Buy, loss: 0.0026431679725646973
step: 60, task: Textual/Abt-Buy, loss: 0.005677230656147003
step: 70, task: Textual/Abt-Buy, loss: 0.41097772121429443
step: 80, task: Textual/Abt-Buy, loss: 0.06155695021152496
step: 90, task: Textual/Abt-Buy, loss: 0.006548941135406494
step: 100, task: Textual/Abt-Buy, loss: 0.008846476674079895
step: 110, task: Textual/Abt-Buy, loss: 0.02557947486639023
step: 120, task: Textual/Abt-Buy, loss: 0.0023399293422698975
step: 130, task: Textual/Abt-Buy, loss: 0.00529007613658905
step: 140, task: Textual/Abt-Buy, loss: 0.023041553795337677
step: 150, task: Textual/Abt-Buy, loss: 0.015155263245105743
step: 160, task: Textual/Abt-Buy, loss: 0.022712357342243195
step: 170, task: Textual/Abt-Buy, loss: 0.13342924416065216
step: 180, task: Textual/Abt-Buy, loss: 0.2021130621433258
step: 190, task: Textual/Abt-Buy, loss: 0.015102922916412354
step: 200, task: Textual/Abt-Buy, loss: 0.01910499483346939
step: 210, task: Textual/Abt-Buy, loss: 0.005428723990917206
step: 220, task: Textual/Abt-Buy, loss: 0.0016188323497772217
step: 230, task: Textual/Abt-Buy, loss: 0.002421349287033081
step: 240, task: Textual/Abt-Buy, loss: 0.143580362200737
step: 250, task: Textual/Abt-Buy, loss: 0.2193809300661087
step: 260, task: Textual/Abt-Buy, loss: 0.09788154810667038
step: 270, task: Textual/Abt-Buy, loss: 0.008859269320964813
step: 280, task: Textual/Abt-Buy, loss: 0.17406471073627472
step: 290, task: Textual/Abt-Buy, loss: 0.04322884976863861
step: 300, task: Textual/Abt-Buy, loss: 0.017899364233016968
step: 310, task: Textual/Abt-Buy, loss: 0.002832561731338501
step: 320, task: Textual/Abt-Buy, loss: 0.03344389796257019
step: 330, task: Textual/Abt-Buy, loss: 0.003378733992576599
step: 340, task: Textual/Abt-Buy, loss: 0.01952291652560234
step: 350, task: Textual/Abt-Buy, loss: 0.03590468317270279
=========eval at epoch=3=========
Validation:
=============Textual/Abt-Buy==================
accuracy=0.975
precision=0.899
recall=0.864
f1=0.881
======================================
Test:
=============Textual/Abt-Buy==================
accuracy=0.978
precision=0.898
recall=0.893
f1=0.895
======================================
=====sanity check======
words: COL name VAL canon printer color ink cartridge cl211 COL description VAL canon printer color ink cartridge cl211 fine technology for exceptional sharpness and detail new inks improve coloring , color gamut , and color fastness compatible with pixma mp480 COL price VAL 20.99  [SEP] COL name VAL canon cli-8pc photo cyan ink cartridge 0624b002 COL description VAL photo cyan COL price VAL 13.99 
x: [    0 18047   766 27445 32839 24079  3195 16019 41785  3741 30050 14857
  8194 27445 32839 24079  3195 16019 41785  3741 30050  2051   806    13
  9297  4406  1825     8  4617    92    11  2258  1477 35314  2156  3195
 20577  1182  2156     8  3195  1769  1825 16632    19   181  3181  1916
 44857 27018 14857   425 27445   291     4  2831  1437     2     2 18047
   766 27445 32839  3741   118    12   398 17426  1345 39493 16019 41785
 15007  1978   428 19130 14857  8194 27445  1345 39493 14857   425 27445
   508     4  2831  1437     2]
tokens: ['<s>', 'COL', 'Ġname', 'ĠVAL', 'Ġcanon', 'Ġprinter', 'Ġcolor', 'Ġink', 'Ġcartridge', 'Ġcl', '211', 'ĠCOL', 'Ġdescription', 'ĠVAL', 'Ġcanon', 'Ġprinter', 'Ġcolor', 'Ġink', 'Ġcartridge', 'Ġcl', '211', 'Ġfine', 'Ġtechnology', 'Ġfor', 'Ġexceptional', 'Ġsharp', 'ness', 'Ġand', 'Ġdetail', 'Ġnew', 'Ġin', 'ks', 'Ġimprove', 'Ġcoloring', 'Ġ,', 'Ġcolor', 'Ġgam', 'ut', 'Ġ,', 'Ġand', 'Ġcolor', 'Ġfast', 'ness', 'Ġcompatible', 'Ġwith', 'Ġp', 'ix', 'ma', 'Ġmp', '480', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ20', '.', '99', 'Ġ', '</s>', '</s>', 'COL', 'Ġname', 'ĠVAL', 'Ġcanon', 'Ġcl', 'i', '-', '8', 'pc', 'Ġphoto', 'Ġcyan', 'Ġink', 'Ġcartridge', 'Ġ06', '24', 'b', '002', 'ĠCOL', 'Ġdescription', 'ĠVAL', 'Ġphoto', 'Ġcyan', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ13', '.', '99', 'Ġ', '</s>']
is_heads: [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
y: 0
tags: 0
mask: tensor([1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1])
seqlen: 89
task_name: Textual/Abt-Buy
=======================
step: 0, task: Textual/Abt-Buy, loss: 0.05877949669957161
step: 10, task: Textual/Abt-Buy, loss: 0.012964680790901184
step: 20, task: Textual/Abt-Buy, loss: 0.012007929384708405
step: 30, task: Textual/Abt-Buy, loss: 0.003337368369102478
step: 40, task: Textual/Abt-Buy, loss: 0.00591152161359787
step: 50, task: Textual/Abt-Buy, loss: 0.0012010633945465088
step: 60, task: Textual/Abt-Buy, loss: 0.4294424057006836
step: 70, task: Textual/Abt-Buy, loss: 0.0016241520643234253
step: 80, task: Textual/Abt-Buy, loss: 0.09691508114337921
step: 90, task: Textual/Abt-Buy, loss: 0.3543905019760132
step: 100, task: Textual/Abt-Buy, loss: 0.07152840495109558
step: 110, task: Textual/Abt-Buy, loss: 0.009363554418087006
step: 120, task: Textual/Abt-Buy, loss: 0.013679668307304382
step: 130, task: Textual/Abt-Buy, loss: 0.004269741475582123
step: 140, task: Textual/Abt-Buy, loss: 0.04472380876541138
step: 150, task: Textual/Abt-Buy, loss: 0.001078784465789795
step: 160, task: Textual/Abt-Buy, loss: 0.15446718037128448
step: 170, task: Textual/Abt-Buy, loss: 0.015302792191505432
step: 180, task: Textual/Abt-Buy, loss: 0.06406082212924957
step: 190, task: Textual/Abt-Buy, loss: 0.061910755932331085
step: 200, task: Textual/Abt-Buy, loss: 0.0018285959959030151
step: 210, task: Textual/Abt-Buy, loss: 0.12193924188613892
step: 220, task: Textual/Abt-Buy, loss: 0.0014103502035140991
step: 230, task: Textual/Abt-Buy, loss: 0.007699020206928253
step: 240, task: Textual/Abt-Buy, loss: 0.02377770096063614
step: 250, task: Textual/Abt-Buy, loss: 0.047745320945978165
step: 260, task: Textual/Abt-Buy, loss: 0.007636271417140961
step: 270, task: Textual/Abt-Buy, loss: 0.0319349467754364
step: 280, task: Textual/Abt-Buy, loss: 0.003293350338935852
step: 290, task: Textual/Abt-Buy, loss: 0.00411573052406311
step: 300, task: Textual/Abt-Buy, loss: 0.004049196839332581
step: 310, task: Textual/Abt-Buy, loss: 0.0061560943722724915
step: 320, task: Textual/Abt-Buy, loss: 0.004158616065979004
step: 330, task: Textual/Abt-Buy, loss: 0.0018080174922943115
step: 340, task: Textual/Abt-Buy, loss: 0.013663291931152344
step: 350, task: Textual/Abt-Buy, loss: 0.10026366263628006
=========eval at epoch=4=========
Validation:
=============Textual/Abt-Buy==================
accuracy=0.974
precision=0.907
recall=0.850
f1=0.877
======================================
Test:
=============Textual/Abt-Buy==================
accuracy=0.980
precision=0.972
recall=0.835
f1=0.898
======================================
=====sanity check======
words: COL name VAL sony black 13.6 megapixel cyber-shot digital camera dscw300 COL description VAL sony black 13.6 megapixel cyber-shot digital camera dscw300 13.6 megapixel carl zeiss 3x optical zoom lens 2.7 ' clear photo lcd display in-camera retouching 15 mb internal memory in-camera red-eye correction super steadyshot optical image stabilization double anti-blur solution black finish COL price VAL   [SEP] COL name VAL sony cyber-shot dsc-t300 digital camera black dsct300/b COL description VAL 10.1 megapixel 16:9 2x digital zoom 3.5 ' active matrix tft color lcd COL price VAL 273.95 
x: [    0 18047   766 27445   579  6119   909   508     4   401 10721 21424
  5381    12 10393  1778  2280   385  3866   605  2965 14857  8194 27445
   579  6119   909   508     4   401 10721 21424  5381    12 10393  1778
  2280   385  3866   605  2965   508     4   401 10721 21424   512   462
 20025  3006   155  1178 17547 21762 10373   132     4   406   128   699
  1345   784 28690  2332    11    12 25092  5494 12746   154   379   475
   428  3425  3783    11    12 25092  1275    12 20668 14921  2422 23789
  2459 10120 17547  2274 29632  1457  1475    12  3662   710  2472   909
  2073 14857   425 27445  1437  1437     2     2 18047   766 27445   579
  6119  5381    12 10393   385  3866    12    90  2965  1778  2280   909
   385    29  3894  2965    73   428 14857  8194 27445   158     4   134
 10721 21424   545    35   466   132  1178  1778 21762   155     4   245
   128  2171 36173   326  2543  3195   784 28690 14857   425 27445 37593
     4  4015  1437     2]
tokens: ['<s>', 'COL', 'Ġname', 'ĠVAL', 'Ġs', 'ony', 'Ġblack', 'Ġ13', '.', '6', 'Ġmeg', 'apixel', 'Ġcyber', '-', 'shot', 'Ġdigital', 'Ġcamera', 'Ġd', 'sc', 'w', '300', 'ĠCOL', 'Ġdescription', 'ĠVAL', 'Ġs', 'ony', 'Ġblack', 'Ġ13', '.', '6', 'Ġmeg', 'apixel', 'Ġcyber', '-', 'shot', 'Ġdigital', 'Ġcamera', 'Ġd', 'sc', 'w', '300', 'Ġ13', '.', '6', 'Ġmeg', 'apixel', 'Ġcar', 'l', 'Ġze', 'iss', 'Ġ3', 'x', 'Ġoptical', 'Ġzoom', 'Ġlens', 'Ġ2', '.', '7', "Ġ'", 'Ġclear', 'Ġphoto', 'Ġl', 'cd', 'Ġdisplay', 'Ġin', '-', 'camera', 'Ġret', 'ouch', 'ing', 'Ġ15', 'Ġm', 'b', 'Ġinternal', 'Ġmemory', 'Ġin', '-', 'camera', 'Ġred', '-', 'eye', 'Ġcorrection', 'Ġsuper', 'Ġstead', 'ys', 'hot', 'Ġoptical', 'Ġimage', 'Ġstabilization', 'Ġdouble', 'Ġanti', '-', 'bl', 'ur', 'Ġsolution', 'Ġblack', 'Ġfinish', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ', 'Ġ', '</s>', '</s>', 'COL', 'Ġname', 'ĠVAL', 'Ġs', 'ony', 'Ġcyber', '-', 'shot', 'Ġd', 'sc', '-', 't', '300', 'Ġdigital', 'Ġcamera', 'Ġblack', 'Ġd', 's', 'ct', '300', '/', 'b', 'ĠCOL', 'Ġdescription', 'ĠVAL', 'Ġ10', '.', '1', 'Ġmeg', 'apixel', 'Ġ16', ':', '9', 'Ġ2', 'x', 'Ġdigital', 'Ġzoom', 'Ġ3', '.', '5', "Ġ'", 'Ġactive', 'Ġmatrix', 'Ġt', 'ft', 'Ġcolor', 'Ġl', 'cd', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ273', '.', '95', 'Ġ', '</s>']
is_heads: [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
y: 0
tags: 0
mask: tensor([1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1])
seqlen: 160
task_name: Textual/Abt-Buy
=======================
step: 0, task: Textual/Abt-Buy, loss: 0.013874400407075882
step: 10, task: Textual/Abt-Buy, loss: 0.0009625852108001709
step: 20, task: Textual/Abt-Buy, loss: 0.0030994564294815063
step: 30, task: Textual/Abt-Buy, loss: 0.0014138668775558472
step: 40, task: Textual/Abt-Buy, loss: 0.0008188486099243164
step: 50, task: Textual/Abt-Buy, loss: 0.000949665904045105
step: 60, task: Textual/Abt-Buy, loss: 0.002058684825897217
step: 70, task: Textual/Abt-Buy, loss: 0.0025500506162643433
step: 80, task: Textual/Abt-Buy, loss: 0.0032054781913757324
step: 90, task: Textual/Abt-Buy, loss: 0.003977201879024506
step: 100, task: Textual/Abt-Buy, loss: 0.002726331353187561
step: 110, task: Textual/Abt-Buy, loss: 0.027945447713136673
step: 120, task: Textual/Abt-Buy, loss: 0.000990554690361023
step: 130, task: Textual/Abt-Buy, loss: 0.0005400031805038452
step: 140, task: Textual/Abt-Buy, loss: 0.0018116012215614319
step: 150, task: Textual/Abt-Buy, loss: 0.0006513446569442749
step: 160, task: Textual/Abt-Buy, loss: 0.012305781245231628
step: 170, task: Textual/Abt-Buy, loss: 0.0023050904273986816
step: 180, task: Textual/Abt-Buy, loss: 0.00504148006439209
step: 190, task: Textual/Abt-Buy, loss: 0.003068484365940094
step: 200, task: Textual/Abt-Buy, loss: 0.00038261711597442627
step: 210, task: Textual/Abt-Buy, loss: 0.03179720789194107
step: 220, task: Textual/Abt-Buy, loss: 0.0003714561462402344
step: 230, task: Textual/Abt-Buy, loss: 0.0006625354290008545
step: 240, task: Textual/Abt-Buy, loss: 0.012212343513965607
step: 250, task: Textual/Abt-Buy, loss: 0.03391372784972191
step: 260, task: Textual/Abt-Buy, loss: 0.007969848811626434
step: 270, task: Textual/Abt-Buy, loss: 0.00389089435338974
step: 280, task: Textual/Abt-Buy, loss: 0.0036407634615898132
step: 290, task: Textual/Abt-Buy, loss: 0.13832126557826996
step: 300, task: Textual/Abt-Buy, loss: 0.0037165209650993347
step: 310, task: Textual/Abt-Buy, loss: 0.05255551636219025
step: 320, task: Textual/Abt-Buy, loss: 0.08065884560346603
step: 330, task: Textual/Abt-Buy, loss: 0.01941664144396782
step: 340, task: Textual/Abt-Buy, loss: 0.0007935613393783569
step: 350, task: Textual/Abt-Buy, loss: 0.010762002319097519
=========eval at epoch=5=========
Validation:
=============Textual/Abt-Buy==================
accuracy=0.973
precision=0.933
recall=0.806
f1=0.865
======================================
Test:
=============Textual/Abt-Buy==================
accuracy=0.974
precision=0.891
recall=0.869
f1=0.880
======================================
=====sanity check======
words: COL name VAL sony 7 ' digital photo frame in black dpfd70 COL description VAL sony 7 ' digital photo frame dpfd70 7 ' lcd with 800 x 480 resolution 15:9 aspect ratio 256mb internal memory supports most memory cards variety of display modes auto image rotation feature view mode button fast digital picture decoding handles large data files usb b-type connection remote control black finish COL price VAL 139.0  [SEP] COL name VAL sony cyber-shot dsc-w150 digital camera black dscw150/b COL description VAL 8.1 megapixel 16:9 2x digital zoom 2.7 ' active matrix tft color lcd COL price VAL 129.99 
x: [    0 18047   766 27445   579  6119   262   128  1778  1345  5120    11
   909   385   642 37379  3083 14857  8194 27445   579  6119   262   128
  1778  1345  5120   385   642 37379  3083   262   128   784 28690    19
  5735  3023 26754  3547   379    35   466  6659  1750 22078  6648  3425
  3783  4548   144  3783  3591  3143     9  2332 19180  4485  2274 10134
  1905  1217  5745  6148  1769  1778  2170 46133 14617   739   414  6773
 49030   741    12 12528  2748  6063   797   909  2073 14857   425 27445
 24404     4   288  1437     2     2 18047   766 27445   579  6119  5381
    12 10393   385  3866    12   605  6115  1778  2280   909   385  3866
   605  6115    73   428 14857  8194 27445   290     4   134 10721 21424
   545    35   466   132  1178  1778 21762   132     4   406   128  2171
 36173   326  2543  3195   784 28690 14857   425 27445 21234     4  2831
  1437     2]
tokens: ['<s>', 'COL', 'Ġname', 'ĠVAL', 'Ġs', 'ony', 'Ġ7', "Ġ'", 'Ġdigital', 'Ġphoto', 'Ġframe', 'Ġin', 'Ġblack', 'Ġd', 'p', 'fd', '70', 'ĠCOL', 'Ġdescription', 'ĠVAL', 'Ġs', 'ony', 'Ġ7', "Ġ'", 'Ġdigital', 'Ġphoto', 'Ġframe', 'Ġd', 'p', 'fd', '70', 'Ġ7', "Ġ'", 'Ġl', 'cd', 'Ġwith', 'Ġ800', 'Ġx', 'Ġ480', 'Ġresolution', 'Ġ15', ':', '9', 'Ġaspect', 'Ġratio', 'Ġ256', 'mb', 'Ġinternal', 'Ġmemory', 'Ġsupports', 'Ġmost', 'Ġmemory', 'Ġcards', 'Ġvariety', 'Ġof', 'Ġdisplay', 'Ġmodes', 'Ġauto', 'Ġimage', 'Ġrotation', 'Ġfeature', 'Ġview', 'Ġmode', 'Ġbutton', 'Ġfast', 'Ġdigital', 'Ġpicture', 'Ġdecoding', 'Ġhandles', 'Ġlarge', 'Ġdata', 'Ġfiles', 'Ġusb', 'Ġb', '-', 'type', 'Ġconnection', 'Ġremote', 'Ġcontrol', 'Ġblack', 'Ġfinish', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ139', '.', '0', 'Ġ', '</s>', '</s>', 'COL', 'Ġname', 'ĠVAL', 'Ġs', 'ony', 'Ġcyber', '-', 'shot', 'Ġd', 'sc', '-', 'w', '150', 'Ġdigital', 'Ġcamera', 'Ġblack', 'Ġd', 'sc', 'w', '150', '/', 'b', 'ĠCOL', 'Ġdescription', 'ĠVAL', 'Ġ8', '.', '1', 'Ġmeg', 'apixel', 'Ġ16', ':', '9', 'Ġ2', 'x', 'Ġdigital', 'Ġzoom', 'Ġ2', '.', '7', "Ġ'", 'Ġactive', 'Ġmatrix', 'Ġt', 'ft', 'Ġcolor', 'Ġl', 'cd', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ129', '.', '99', 'Ġ', '</s>']
is_heads: [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
y: 0
tags: 0
mask: tensor([1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1])
seqlen: 146
task_name: Textual/Abt-Buy
=======================
step: 0, task: Textual/Abt-Buy, loss: 0.005388408899307251
step: 10, task: Textual/Abt-Buy, loss: 0.05574199557304382
step: 20, task: Textual/Abt-Buy, loss: 0.005901716649532318
step: 30, task: Textual/Abt-Buy, loss: 0.00042228400707244873
step: 40, task: Textual/Abt-Buy, loss: 0.007602564990520477
step: 50, task: Textual/Abt-Buy, loss: 0.0037464946508407593
step: 60, task: Textual/Abt-Buy, loss: 0.0005432069301605225
step: 70, task: Textual/Abt-Buy, loss: 0.005609184503555298
step: 80, task: Textual/Abt-Buy, loss: 0.0006186068058013916
step: 90, task: Textual/Abt-Buy, loss: 0.001074180006980896
step: 100, task: Textual/Abt-Buy, loss: 0.0007231980562210083
step: 110, task: Textual/Abt-Buy, loss: 0.000607609748840332
step: 120, task: Textual/Abt-Buy, loss: 0.0939287468791008
step: 130, task: Textual/Abt-Buy, loss: 0.00023652613162994385
step: 140, task: Textual/Abt-Buy, loss: 0.0018801763653755188
step: 150, task: Textual/Abt-Buy, loss: 0.0008769482374191284
step: 160, task: Textual/Abt-Buy, loss: 0.0004203617572784424
step: 170, task: Textual/Abt-Buy, loss: 0.007887430489063263
step: 180, task: Textual/Abt-Buy, loss: 0.04538819566369057
step: 190, task: Textual/Abt-Buy, loss: 0.0022599399089813232
step: 200, task: Textual/Abt-Buy, loss: 0.017510365694761276
step: 210, task: Textual/Abt-Buy, loss: 0.0578211285173893
step: 220, task: Textual/Abt-Buy, loss: 0.0017839521169662476
step: 230, task: Textual/Abt-Buy, loss: 0.10104504227638245
step: 240, task: Textual/Abt-Buy, loss: 0.00030185282230377197
step: 250, task: Textual/Abt-Buy, loss: 0.03325040638446808
step: 260, task: Textual/Abt-Buy, loss: 0.0001850426197052002
step: 270, task: Textual/Abt-Buy, loss: 0.03159399703145027
step: 280, task: Textual/Abt-Buy, loss: 0.00018747150897979736
step: 290, task: Textual/Abt-Buy, loss: 0.09939552843570709
step: 300, task: Textual/Abt-Buy, loss: 0.15645986795425415
step: 310, task: Textual/Abt-Buy, loss: 0.02277822047472
step: 320, task: Textual/Abt-Buy, loss: 0.00013205409049987793
step: 330, task: Textual/Abt-Buy, loss: 0.0008892416954040527
step: 340, task: Textual/Abt-Buy, loss: 0.00035497546195983887
step: 350, task: Textual/Abt-Buy, loss: 0.01382262259721756
=========eval at epoch=6=========
Validation:
=============Textual/Abt-Buy==================
accuracy=0.970
precision=0.907
recall=0.806
f1=0.853
======================================
Test:
=============Textual/Abt-Buy==================
accuracy=0.981
precision=0.972
recall=0.845
f1=0.904
======================================
=====sanity check======
words: COL name VAL canon powershot silver digital camera sx110is COL description VAL canon powershot sx110 is silver digital camera sx110is 9.0 megapixel 10x optical zoom lens with optical image stabilizer technology 3.0 ' lcd display digic iii image processor face detection motion detection 20 shooting modes including 8 special scene modes red-eye correction automatic iso settings print-share button power by aa batteries for convenient silver finish COL price VAL   [SEP] COL name VAL canon powershot sd990 is 14 megapixel digital camera w / 3.7 x optical zoom , ua len , face detection , 2.5 lcd , & iso 1600 silver 3191b001 COL description VAL  COL price VAL 299.88 
x: [    0 18047   766 27445 32839  4361 10120  4334  1778  2280   579  1178
 11670   354 14857  8194 27445 32839  4361 10120   579  1178 11670    16
  4334  1778  2280   579  1178 11670   354   361     4   288 10721 21424
   158  1178 17547 21762 10373    19 17547  2274 12964  6315   806   155
     4   288   128   784 28690  2332  8512   636 46814  2274 10655   652
 12673  4298 12673   291  1094 19180   217   290   780  1310 19180  1275
    12 20668 14921  8408 47191  9629  5780    12 12689  6148   476    30
    10   102 10535    13 12148  4334  2073 14857   425 27445  1437  1437
     2     2 18047   766 27445 32839  4361 10120 46409 27204    16   501
 10721 21424  1778  2280   885  1589   155     4   406  3023 17547 21762
  2156  1717   102 25528  2156   652 12673  2156   132     4   245   784
 28690  2156   359 47191 25183  4334   155 31080   428 19089 14857  8194
 27445  1437 14857   425 27445 35768     4  4652  1437     2]
tokens: ['<s>', 'COL', 'Ġname', 'ĠVAL', 'Ġcanon', 'Ġpowers', 'hot', 'Ġsilver', 'Ġdigital', 'Ġcamera', 'Ġs', 'x', '110', 'is', 'ĠCOL', 'Ġdescription', 'ĠVAL', 'Ġcanon', 'Ġpowers', 'hot', 'Ġs', 'x', '110', 'Ġis', 'Ġsilver', 'Ġdigital', 'Ġcamera', 'Ġs', 'x', '110', 'is', 'Ġ9', '.', '0', 'Ġmeg', 'apixel', 'Ġ10', 'x', 'Ġoptical', 'Ġzoom', 'Ġlens', 'Ġwith', 'Ġoptical', 'Ġimage', 'Ġstabil', 'izer', 'Ġtechnology', 'Ġ3', '.', '0', "Ġ'", 'Ġl', 'cd', 'Ġdisplay', 'Ġdig', 'ic', 'Ġiii', 'Ġimage', 'Ġprocessor', 'Ġface', 'Ġdetection', 'Ġmotion', 'Ġdetection', 'Ġ20', 'Ġshooting', 'Ġmodes', 'Ġincluding', 'Ġ8', 'Ġspecial', 'Ġscene', 'Ġmodes', 'Ġred', '-', 'eye', 'Ġcorrection', 'Ġautomatic', 'Ġiso', 'Ġsettings', 'Ġprint', '-', 'share', 'Ġbutton', 'Ġpower', 'Ġby', 'Ġa', 'a', 'Ġbatteries', 'Ġfor', 'Ġconvenient', 'Ġsilver', 'Ġfinish', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ', 'Ġ', '</s>', '</s>', 'COL', 'Ġname', 'ĠVAL', 'Ġcanon', 'Ġpowers', 'hot', 'Ġsd', '990', 'Ġis', 'Ġ14', 'Ġmeg', 'apixel', 'Ġdigital', 'Ġcamera', 'Ġw', 'Ġ/', 'Ġ3', '.', '7', 'Ġx', 'Ġoptical', 'Ġzoom', 'Ġ,', 'Ġu', 'a', 'Ġlen', 'Ġ,', 'Ġface', 'Ġdetection', 'Ġ,', 'Ġ2', '.', '5', 'Ġl', 'cd', 'Ġ,', 'Ġ&', 'Ġiso', 'Ġ1600', 'Ġsilver', 'Ġ3', '191', 'b', '001', 'ĠCOL', 'Ġdescription', 'ĠVAL', 'Ġ', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ299', '.', '88', 'Ġ', '</s>']
is_heads: [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
y: 0
tags: 0
mask: tensor([1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1])
seqlen: 154
task_name: Textual/Abt-Buy
=======================
step: 0, task: Textual/Abt-Buy, loss: 0.014033474028110504
step: 10, task: Textual/Abt-Buy, loss: 0.061423465609550476
step: 20, task: Textual/Abt-Buy, loss: 0.0006734281778335571
step: 30, task: Textual/Abt-Buy, loss: 0.0006140321493148804
step: 40, task: Textual/Abt-Buy, loss: 0.0004342794418334961
step: 50, task: Textual/Abt-Buy, loss: 0.0004216432571411133
step: 60, task: Textual/Abt-Buy, loss: 0.008457139134407043
step: 70, task: Textual/Abt-Buy, loss: 0.0003996342420578003
step: 80, task: Textual/Abt-Buy, loss: 0.006599098443984985
step: 90, task: Textual/Abt-Buy, loss: 0.08227760344743729
step: 100, task: Textual/Abt-Buy, loss: 0.001672014594078064
step: 110, task: Textual/Abt-Buy, loss: 0.00036197900772094727
step: 120, task: Textual/Abt-Buy, loss: 0.00874783843755722
step: 130, task: Textual/Abt-Buy, loss: 0.0001935213804244995
step: 140, task: Textual/Abt-Buy, loss: 0.0009605437517166138
step: 150, task: Textual/Abt-Buy, loss: 0.003399476408958435
step: 160, task: Textual/Abt-Buy, loss: 0.10733823478221893
step: 170, task: Textual/Abt-Buy, loss: 0.0022944584488868713
step: 180, task: Textual/Abt-Buy, loss: 0.00022393465042114258
step: 190, task: Textual/Abt-Buy, loss: 0.03287128359079361
step: 200, task: Textual/Abt-Buy, loss: 0.000434190034866333
step: 210, task: Textual/Abt-Buy, loss: 0.0010380148887634277
step: 220, task: Textual/Abt-Buy, loss: 0.0001684427261352539
step: 230, task: Textual/Abt-Buy, loss: 0.49226129055023193
step: 240, task: Textual/Abt-Buy, loss: 0.00020310282707214355
step: 250, task: Textual/Abt-Buy, loss: 0.050219617784023285
step: 260, task: Textual/Abt-Buy, loss: 0.00023122131824493408
step: 270, task: Textual/Abt-Buy, loss: 0.000565752387046814
step: 280, task: Textual/Abt-Buy, loss: 0.00018355250358581543
step: 290, task: Textual/Abt-Buy, loss: 0.0015954822301864624
step: 300, task: Textual/Abt-Buy, loss: 0.0008395165205001831
step: 310, task: Textual/Abt-Buy, loss: 0.00022146105766296387
step: 320, task: Textual/Abt-Buy, loss: 0.017467226833105087
step: 330, task: Textual/Abt-Buy, loss: 0.0001062154769897461
step: 340, task: Textual/Abt-Buy, loss: 0.00011369585990905762
step: 350, task: Textual/Abt-Buy, loss: 0.00048485398292541504
=========eval at epoch=7=========
Validation:
=============Textual/Abt-Buy==================
accuracy=0.977
precision=0.909
recall=0.869
f1=0.888
======================================
Test:
=============Textual/Abt-Buy==================
accuracy=0.981
precision=0.962
recall=0.859
f1=0.908
======================================
=====sanity check======
words: COL name VAL sony lcs-twa/b black soft leather carrying case lcstwab COL description VAL sony lcs-twa/b black soft leather carrying case lcstwab genuine leather construction compatible with cyber-shot w and t series digital cameras integrated belt loop and magnetic closure black finish COL price VAL   [SEP] COL name VAL sony lcs-x20 camcorder case lcsx20 COL description VAL nylon , polyamide black COL price VAL  
x: [    0 18047   766 27445   579  6119   784 11365    12 17137   102    73
   428   909  3793  9219  3406   403   784   438   620   605   873 14857
  8194 27445   579  6119   784 11365    12 17137   102    73   428   909
  3793  9219  3406   403   784   438   620   605   873  8916  9219  1663
 16632    19  5381    12 10393   885     8   326   651  1778  4387  6818
  7494 14018     8 17512  6803   909  2073 14857   425 27445  1437  1437
     2     2 18047   766 27445   579  6119   784 11365    12  1178   844
 11021   438 10337   403   784 11365  1178   844 14857  8194 27445 38874
  2156 11424 39522   909 14857   425 27445  1437  1437     2]
tokens: ['<s>', 'COL', 'Ġname', 'ĠVAL', 'Ġs', 'ony', 'Ġl', 'cs', '-', 'tw', 'a', '/', 'b', 'Ġblack', 'Ġsoft', 'Ġleather', 'Ġcarrying', 'Ġcase', 'Ġl', 'c', 'st', 'w', 'ab', 'ĠCOL', 'Ġdescription', 'ĠVAL', 'Ġs', 'ony', 'Ġl', 'cs', '-', 'tw', 'a', '/', 'b', 'Ġblack', 'Ġsoft', 'Ġleather', 'Ġcarrying', 'Ġcase', 'Ġl', 'c', 'st', 'w', 'ab', 'Ġgenuine', 'Ġleather', 'Ġconstruction', 'Ġcompatible', 'Ġwith', 'Ġcyber', '-', 'shot', 'Ġw', 'Ġand', 'Ġt', 'Ġseries', 'Ġdigital', 'Ġcameras', 'Ġintegrated', 'Ġbelt', 'Ġloop', 'Ġand', 'Ġmagnetic', 'Ġclosure', 'Ġblack', 'Ġfinish', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ', 'Ġ', '</s>', '</s>', 'COL', 'Ġname', 'ĠVAL', 'Ġs', 'ony', 'Ġl', 'cs', '-', 'x', '20', 'Ġcam', 'c', 'order', 'Ġcase', 'Ġl', 'cs', 'x', '20', 'ĠCOL', 'Ġdescription', 'ĠVAL', 'Ġnylon', 'Ġ,', 'Ġpoly', 'amide', 'Ġblack', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ', 'Ġ', '</s>']
is_heads: [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
y: 0
tags: 0
mask: tensor([1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1])
seqlen: 106
task_name: Textual/Abt-Buy
=======================
step: 0, task: Textual/Abt-Buy, loss: 0.006230644881725311
step: 10, task: Textual/Abt-Buy, loss: 0.00025294721126556396
step: 20, task: Textual/Abt-Buy, loss: 0.00012080371379852295
step: 30, task: Textual/Abt-Buy, loss: 0.04614681378006935
step: 40, task: Textual/Abt-Buy, loss: 0.004665397107601166
step: 50, task: Textual/Abt-Buy, loss: 0.0003283172845840454
step: 60, task: Textual/Abt-Buy, loss: 0.0058269202709198
step: 70, task: Textual/Abt-Buy, loss: 0.0017087161540985107
step: 80, task: Textual/Abt-Buy, loss: 0.0003087073564529419
step: 90, task: Textual/Abt-Buy, loss: 0.001064106822013855
step: 100, task: Textual/Abt-Buy, loss: 0.00021031498908996582
step: 110, task: Textual/Abt-Buy, loss: 0.0001835078001022339
step: 120, task: Textual/Abt-Buy, loss: 0.00044046342372894287
step: 130, task: Textual/Abt-Buy, loss: 0.00010628998279571533
step: 140, task: Textual/Abt-Buy, loss: 0.0011314451694488525
step: 150, task: Textual/Abt-Buy, loss: 0.013767614960670471
step: 160, task: Textual/Abt-Buy, loss: 0.00017634034156799316
step: 170, task: Textual/Abt-Buy, loss: 0.022142834961414337
step: 180, task: Textual/Abt-Buy, loss: 0.0001421719789505005
step: 190, task: Textual/Abt-Buy, loss: 0.0003774017095565796
step: 200, task: Textual/Abt-Buy, loss: 0.0002939850091934204
step: 210, task: Textual/Abt-Buy, loss: 0.004986010491847992
step: 220, task: Textual/Abt-Buy, loss: 0.0001706331968307495
step: 230, task: Textual/Abt-Buy, loss: 0.00021135807037353516
step: 240, task: Textual/Abt-Buy, loss: 0.00034274160861968994
step: 250, task: Textual/Abt-Buy, loss: 0.004660695791244507
step: 260, task: Textual/Abt-Buy, loss: 0.01586931198835373
step: 270, task: Textual/Abt-Buy, loss: 0.0010731518268585205
step: 280, task: Textual/Abt-Buy, loss: 0.005201488733291626
step: 290, task: Textual/Abt-Buy, loss: 0.0007711499929428101
step: 300, task: Textual/Abt-Buy, loss: 0.0002447664737701416
step: 310, task: Textual/Abt-Buy, loss: 0.011453770101070404
step: 320, task: Textual/Abt-Buy, loss: 0.00011989474296569824
step: 330, task: Textual/Abt-Buy, loss: 0.00019820034503936768
step: 340, task: Textual/Abt-Buy, loss: 0.0004801452159881592
step: 350, task: Textual/Abt-Buy, loss: 0.00047998130321502686
=========eval at epoch=8=========
Validation:
=============Textual/Abt-Buy==================
accuracy=0.973
precision=0.928
recall=0.816
f1=0.868
======================================
Test:
=============Textual/Abt-Buy==================
accuracy=0.979
precision=0.937
recall=0.864
f1=0.899
======================================
Selected optimization level O2:  FP16 training with FP32 batchnorm and FP32 master weights.

Defaults for this optimization level are:
enabled                : True
opt_level              : O2
cast_model_type        : torch.float16
patch_torch_functions  : False
keep_batchnorm_fp32    : True
master_weights         : True
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O2
cast_model_type        : torch.float16
patch_torch_functions  : False
keep_batchnorm_fp32    : True
master_weights         : True
loss_scale             : dynamic
Warning:  multi_tensor_applier fused unscale kernel is unavailable, possibly because apex was installed without --cuda_ext --cpp_ext. Using Python fallback.  Original ImportError was: ModuleNotFoundError("No module named 'amp_C'")
Gradient overflow.  Skipping step, loss scaler 0 reducing loss scale to 32768.0
=====sanity check======
words: COL name VAL sony lithium-ion rechargeable battery pack npfd1 COL description VAL sony lithium-ion rechargeable battery pack npfd1 infolithium long-lasting lithium-ion battery compatilble with sony cyber-shot dsct2 series , dsc-t70 series , and dsc-t200 series COL price VAL   [SEP] COL name VAL nikon en-el10 no-mem lithium-ion camera battery 25752 COL description VAL lithium ion ( li-ion ) 3.7 v dc photo battery COL price VAL 21.26 
x: [    0 18047   766 27445   579  6119 16904    12  1499 25850   868  3822
  6356 46446 37379   134 14857  8194 27445   579  6119 16904    12  1499
 25850   868  3822  6356 46446 37379   134  4047 41894  4031   251    12
 25179 16904    12  1499  3822 20840   718  5225    19   579  6119  5381
    12 10393   385    29  3894   176   651  2156   385  3866    12    90
  3083   651  2156     8   385  3866    12    90  2619   651 14857   425
 27445  1437  1437     2     2 18047   766 27445   295   967   261  1177
    12   523   698   117    12 25683 16904    12  1499  2280  3822   564
 39738 14857  8194 27445 16904 31973    36 16787    12  1499  4839   155
     4   406   748 46773  1345  3822 14857   425 27445   733     4  2481
  1437     2]
tokens: ['<s>', 'COL', 'Ġname', 'ĠVAL', 'Ġs', 'ony', 'Ġlithium', '-', 'ion', 'Ġrecharge', 'able', 'Ġbattery', 'Ġpack', 'Ġnp', 'fd', '1', 'ĠCOL', 'Ġdescription', 'ĠVAL', 'Ġs', 'ony', 'Ġlithium', '-', 'ion', 'Ġrecharge', 'able', 'Ġbattery', 'Ġpack', 'Ġnp', 'fd', '1', 'Ġinf', 'olith', 'ium', 'Ġlong', '-', 'lasting', 'Ġlithium', '-', 'ion', 'Ġbattery', 'Ġcompat', 'il', 'ble', 'Ġwith', 'Ġs', 'ony', 'Ġcyber', '-', 'shot', 'Ġd', 's', 'ct', '2', 'Ġseries', 'Ġ,', 'Ġd', 'sc', '-', 't', '70', 'Ġseries', 'Ġ,', 'Ġand', 'Ġd', 'sc', '-', 't', '200', 'Ġseries', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ', 'Ġ', '</s>', '</s>', 'COL', 'Ġname', 'ĠVAL', 'Ġn', 'ik', 'on', 'Ġen', '-', 'el', '10', 'Ġno', '-', 'mem', 'Ġlithium', '-', 'ion', 'Ġcamera', 'Ġbattery', 'Ġ25', '752', 'ĠCOL', 'Ġdescription', 'ĠVAL', 'Ġlithium', 'Ġion', 'Ġ(', 'Ġli', '-', 'ion', 'Ġ)', 'Ġ3', '.', '7', 'Ġv', 'Ġdc', 'Ġphoto', 'Ġbattery', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ21', '.', '26', 'Ġ', '</s>']
is_heads: [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
y: 0
tags: 0
mask: tensor([1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1])
seqlen: 122
task_name: Textual/Abt-Buy
=======================
step: 0, task: Textual/Abt-Buy, loss: 0.5465518832206726
Gradient overflow.  Skipping step, loss scaler 0 reducing loss scale to 16384.0
Gradient overflow.  Skipping step, loss scaler 0 reducing loss scale to 8192.0
step: 10, task: Textual/Abt-Buy, loss: 0.4278692305088043
step: 20, task: Textual/Abt-Buy, loss: 0.4658969044685364
step: 30, task: Textual/Abt-Buy, loss: 0.6427154541015625
step: 40, task: Textual/Abt-Buy, loss: 0.5036752223968506
step: 50, task: Textual/Abt-Buy, loss: 0.11744597554206848
step: 60, task: Textual/Abt-Buy, loss: 0.4569477438926697
step: 70, task: Textual/Abt-Buy, loss: 0.10781443119049072
step: 80, task: Textual/Abt-Buy, loss: 0.2680820822715759
step: 90, task: Textual/Abt-Buy, loss: 0.17593488097190857
step: 100, task: Textual/Abt-Buy, loss: 0.04638107866048813
step: 110, task: Textual/Abt-Buy, loss: 0.4252004623413086
step: 120, task: Textual/Abt-Buy, loss: 0.8116897344589233
step: 130, task: Textual/Abt-Buy, loss: 0.46333080530166626
step: 140, task: Textual/Abt-Buy, loss: 0.21733719110488892
step: 150, task: Textual/Abt-Buy, loss: 0.3962423801422119
step: 160, task: Textual/Abt-Buy, loss: 0.4545125961303711
step: 170, task: Textual/Abt-Buy, loss: 0.6720704436302185
step: 180, task: Textual/Abt-Buy, loss: 0.6653509140014648
step: 190, task: Textual/Abt-Buy, loss: 0.5128880739212036
step: 200, task: Textual/Abt-Buy, loss: 0.5047662258148193
step: 210, task: Textual/Abt-Buy, loss: 0.4810461401939392
step: 220, task: Textual/Abt-Buy, loss: 0.11888770759105682
step: 230, task: Textual/Abt-Buy, loss: 0.5102198719978333
step: 240, task: Textual/Abt-Buy, loss: 0.5119903683662415
step: 250, task: Textual/Abt-Buy, loss: 0.1143496185541153
step: 260, task: Textual/Abt-Buy, loss: 0.7826143503189087
step: 270, task: Textual/Abt-Buy, loss: 0.6431481838226318
step: 280, task: Textual/Abt-Buy, loss: 0.5077552795410156
step: 290, task: Textual/Abt-Buy, loss: 0.6415868997573853
step: 300, task: Textual/Abt-Buy, loss: 0.49910974502563477
step: 310, task: Textual/Abt-Buy, loss: 0.26102563738822937
step: 320, task: Textual/Abt-Buy, loss: 0.28636592626571655
step: 330, task: Textual/Abt-Buy, loss: 0.46651771664619446
step: 340, task: Textual/Abt-Buy, loss: 0.21743375062942505
step: 350, task: Textual/Abt-Buy, loss: 0.35122689604759216
=========eval at epoch=1=========
Validation:
=============Textual/Abt-Buy==================
accuracy=0.892
precision=0.000
recall=0.000
f1=0.000
======================================
Test:
=============Textual/Abt-Buy==================
accuracy=0.892
precision=0.000
recall=0.000
f1=0.000
======================================
/w/246/tianyu2020/miniconda2/envs/ditto/lib/python3.7/site-packages/apex/amp/_initialize.py:24: UserWarning: An input tensor was not cuda.
  warnings.warn("An input tensor was not cuda.")
/w/246/tianyu2020/miniconda2/envs/ditto/lib/python3.7/site-packages/torch/optim/lr_scheduler.py:122: UserWarning: Detected call of `lr_scheduler.step()` before `optimizer.step()`. In PyTorch 1.1.0 and later, you should call them in the opposite order: `optimizer.step()` before `lr_scheduler.step()`.  Failure to do this will result in PyTorch skipping the first value of the learning rate schedule. See more details at https://pytorch.org/docs/stable/optim.html#how-to-adjust-learning-rate
  "https://pytorch.org/docs/stable/optim.html#how-to-adjust-learning-rate", UserWarning)
/w/246/tianyu2020/miniconda2/envs/ditto/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1221: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
=====sanity check======
words: COL name VAL canon pixma ip2600 photo printer ip2600 COL description VAL canon pixma photo printer ip2600 4800 x 1200 color dpi spectacular resolution fast photo printing fine technology 1,472 precision nozzles auto image fix easy-photoprint ex software 4 in 1 or 2 in 1 printing energy star qualified borderless 4 ' x 6 ' print approx. 55 seconds windows and mac compatible COL price VAL 49.0  [SEP] COL name VAL canon pixma mp980 wireless all-in-one color photo inkjet printer 2922b002 COL description VAL  COL price VAL  
x: [    0 18047   766 27445 32839   181  3181  1916 36180  2481   612  1345
 24079 36180  2481   612 14857  8194 27445 32839   181  3181  1916  1345
 24079 36180  2481   612  2929   612  3023 23777  3195   385 19581  8694
  3547  1769  1345 12168  2051   806   112     6 37401 15339   117  7399
  1634  4485  2274  4190  1365    12 36051  1517 39907  1931  2257   204
    11   112    50   132    11   112 12168  1007   999  6048  1424  1672
   204   128  3023   231   128  5780 36612     4  3490  2397  6410     8
 13418 16632 14857   425 27445  2766     4   288  1437     2     2 18047
   766 27445 32839   181  3181  1916 44857 36824  6955    70    12   179
    12  1264  3195  1345 16019  6622 24079  1132  2036   428 19130 14857
  8194 27445  1437 14857   425 27445  1437  1437     2]
tokens: ['<s>', 'COL', 'Ġname', 'ĠVAL', 'Ġcanon', 'Ġp', 'ix', 'ma', 'Ġip', '26', '00', 'Ġphoto', 'Ġprinter', 'Ġip', '26', '00', 'ĠCOL', 'Ġdescription', 'ĠVAL', 'Ġcanon', 'Ġp', 'ix', 'ma', 'Ġphoto', 'Ġprinter', 'Ġip', '26', '00', 'Ġ48', '00', 'Ġx', 'Ġ1200', 'Ġcolor', 'Ġd', 'pi', 'Ġspectacular', 'Ġresolution', 'Ġfast', 'Ġphoto', 'Ġprinting', 'Ġfine', 'Ġtechnology', 'Ġ1', ',', '472', 'Ġprecision', 'Ġno', 'zz', 'les', 'Ġauto', 'Ġimage', 'Ġfix', 'Ġeasy', '-', 'phot', 'op', 'rint', 'Ġex', 'Ġsoftware', 'Ġ4', 'Ġin', 'Ġ1', 'Ġor', 'Ġ2', 'Ġin', 'Ġ1', 'Ġprinting', 'Ġenergy', 'Ġstar', 'Ġqualified', 'Ġborder', 'less', 'Ġ4', "Ġ'", 'Ġx', 'Ġ6', "Ġ'", 'Ġprint', 'Ġapprox', '.', 'Ġ55', 'Ġseconds', 'Ġwindows', 'Ġand', 'Ġmac', 'Ġcompatible', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ49', '.', '0', 'Ġ', '</s>', '</s>', 'COL', 'Ġname', 'ĠVAL', 'Ġcanon', 'Ġp', 'ix', 'ma', 'Ġmp', '980', 'Ġwireless', 'Ġall', '-', 'in', '-', 'one', 'Ġcolor', 'Ġphoto', 'Ġink', 'jet', 'Ġprinter', 'Ġ29', '22', 'b', '002', 'ĠCOL', 'Ġdescription', 'ĠVAL', 'Ġ', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ', 'Ġ', '</s>']
is_heads: [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
y: 0
tags: 0
mask: tensor([1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1])
seqlen: 129
task_name: Textual/Abt-Buy
=======================
step: 0, task: Textual/Abt-Buy, loss: 0.2368049919605255
step: 10, task: Textual/Abt-Buy, loss: 0.12471439689397812
step: 20, task: Textual/Abt-Buy, loss: 0.04241544008255005
step: 30, task: Textual/Abt-Buy, loss: 0.12360730767250061
step: 40, task: Textual/Abt-Buy, loss: 0.19023574888706207
step: 50, task: Textual/Abt-Buy, loss: 0.11735327541828156
step: 60, task: Textual/Abt-Buy, loss: 0.00350053608417511
step: 70, task: Textual/Abt-Buy, loss: 0.4105052351951599
step: 80, task: Textual/Abt-Buy, loss: 0.06241475045681
step: 90, task: Textual/Abt-Buy, loss: 0.4515218734741211
step: 100, task: Textual/Abt-Buy, loss: 0.4271585941314697
step: 110, task: Textual/Abt-Buy, loss: 0.34988099336624146
step: 120, task: Textual/Abt-Buy, loss: 0.1033758595585823
step: 130, task: Textual/Abt-Buy, loss: 0.1621914505958557
step: 140, task: Textual/Abt-Buy, loss: 0.24607549607753754
step: 150, task: Textual/Abt-Buy, loss: 0.23960387706756592
step: 160, task: Textual/Abt-Buy, loss: 0.5259561538696289
step: 170, task: Textual/Abt-Buy, loss: 0.4331713616847992
step: 180, task: Textual/Abt-Buy, loss: 0.44977396726608276
step: 190, task: Textual/Abt-Buy, loss: 0.41397738456726074
step: 200, task: Textual/Abt-Buy, loss: 0.4941135048866272
step: 210, task: Textual/Abt-Buy, loss: 0.2609863579273224
step: 220, task: Textual/Abt-Buy, loss: 0.4567983150482178
step: 230, task: Textual/Abt-Buy, loss: 0.11464613676071167
step: 240, task: Textual/Abt-Buy, loss: 0.24339395761489868
step: 250, task: Textual/Abt-Buy, loss: 0.6687756776809692
step: 260, task: Textual/Abt-Buy, loss: 0.49117547273635864
step: 270, task: Textual/Abt-Buy, loss: 0.11607523262500763
step: 280, task: Textual/Abt-Buy, loss: 0.38600242137908936
step: 290, task: Textual/Abt-Buy, loss: 0.13064295053482056
step: 300, task: Textual/Abt-Buy, loss: 0.3724367022514343
step: 310, task: Textual/Abt-Buy, loss: 0.9114586114883423
step: 320, task: Textual/Abt-Buy, loss: 0.43446940183639526
step: 330, task: Textual/Abt-Buy, loss: 0.13955694437026978
step: 340, task: Textual/Abt-Buy, loss: 0.11201027780771255
step: 350, task: Textual/Abt-Buy, loss: 0.23847614228725433
=========eval at epoch=1=========
Validation:
=============Textual/Abt-Buy==================
accuracy=0.892
precision=0.000
recall=0.000
f1=0.000
======================================
Test:
=============Textual/Abt-Buy==================
accuracy=0.892
precision=0.000
recall=0.000
f1=0.000
======================================
=====sanity check======
words: COL name VAL olympus black 10 megapixels digital camera sp565uz COL description VAL olympus black 10 megapixels digital camera sp565uz dual image stabilization 10 megapixels 20x wide-angle zoom lens pre-capture face detection 33 shooting modes 48mb internal memory black finish COL price VAL   [SEP] COL name VAL olympus stylus 1050 sw 10 megapixel digital camera w / 3x optical zoom , 2.7 ' lcd , waterproof , shockproof & freezeproof , tap control , & face detection black 226455 COL description VAL  COL price VAL 228.95 
x: [    0 18047   766 27445  1021 31434   687   909   158 10721  1115 41699
  1778  2280  2292 37402  4987 14857  8194 27445  1021 31434   687   909
   158 10721  1115 41699  1778  2280  2292 37402  4987  6594  2274 29632
   158 10721  1115 41699   291  1178  1810    12 14982 21762 10373  1198
    12 18543  2407   652 12673  2357  1094 19180  2929  6648  3425  3783
   909  2073 14857   425 27445  1437  1437     2     2 18047   766 27445
  1021 31434   687 15240   687 43504  3514   158 10721 21424  1778  2280
   885  1589   155  1178 17547 21762  2156   132     4   406   128   784
 28690  2156 28126  2156  4817 13319   359   481   329  2462  1001  1116
  2156  5797   797  2156   359   652 12673   909 30527 31546 14857  8194
 27445  1437 14857   425 27445 27012     4  4015  1437     2]
tokens: ['<s>', 'COL', 'Ġname', 'ĠVAL', 'Ġo', 'lymp', 'us', 'Ġblack', 'Ġ10', 'Ġmeg', 'ap', 'ixels', 'Ġdigital', 'Ġcamera', 'Ġsp', '565', 'uz', 'ĠCOL', 'Ġdescription', 'ĠVAL', 'Ġo', 'lymp', 'us', 'Ġblack', 'Ġ10', 'Ġmeg', 'ap', 'ixels', 'Ġdigital', 'Ġcamera', 'Ġsp', '565', 'uz', 'Ġdual', 'Ġimage', 'Ġstabilization', 'Ġ10', 'Ġmeg', 'ap', 'ixels', 'Ġ20', 'x', 'Ġwide', '-', 'angle', 'Ġzoom', 'Ġlens', 'Ġpre', '-', 'capt', 'ure', 'Ġface', 'Ġdetection', 'Ġ33', 'Ġshooting', 'Ġmodes', 'Ġ48', 'mb', 'Ġinternal', 'Ġmemory', 'Ġblack', 'Ġfinish', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ', 'Ġ', '</s>', '</s>', 'COL', 'Ġname', 'ĠVAL', 'Ġo', 'lymp', 'us', 'Ġstyl', 'us', 'Ġ1050', 'Ġsw', 'Ġ10', 'Ġmeg', 'apixel', 'Ġdigital', 'Ġcamera', 'Ġw', 'Ġ/', 'Ġ3', 'x', 'Ġoptical', 'Ġzoom', 'Ġ,', 'Ġ2', '.', '7', "Ġ'", 'Ġl', 'cd', 'Ġ,', 'Ġwaterproof', 'Ġ,', 'Ġshock', 'proof', 'Ġ&', 'Ġfree', 'z', 'ep', 'ro', 'of', 'Ġ,', 'Ġtap', 'Ġcontrol', 'Ġ,', 'Ġ&', 'Ġface', 'Ġdetection', 'Ġblack', 'Ġ226', '455', 'ĠCOL', 'Ġdescription', 'ĠVAL', 'Ġ', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ228', '.', '95', 'Ġ', '</s>']
is_heads: [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
y: 0
tags: 0
mask: tensor([1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1])
seqlen: 130
task_name: Textual/Abt-Buy
=======================
step: 0, task: Textual/Abt-Buy, loss: 0.23056060075759888
step: 10, task: Textual/Abt-Buy, loss: 0.3880033493041992
step: 20, task: Textual/Abt-Buy, loss: 0.2442522644996643
step: 30, task: Textual/Abt-Buy, loss: 0.08593962341547012
step: 40, task: Textual/Abt-Buy, loss: 0.28322577476501465
step: 50, task: Textual/Abt-Buy, loss: 0.2521779537200928
step: 60, task: Textual/Abt-Buy, loss: 0.5607949495315552
step: 70, task: Textual/Abt-Buy, loss: 0.2463579624891281
step: 80, task: Textual/Abt-Buy, loss: 0.5499790906906128
step: 90, task: Textual/Abt-Buy, loss: 0.2831069231033325
step: 100, task: Textual/Abt-Buy, loss: 0.12786206603050232
step: 110, task: Textual/Abt-Buy, loss: 0.261257141828537
step: 120, task: Textual/Abt-Buy, loss: 0.23437702655792236
step: 130, task: Textual/Abt-Buy, loss: 0.24095621705055237
step: 140, task: Textual/Abt-Buy, loss: 0.23750582337379456
step: 150, task: Textual/Abt-Buy, loss: 0.4163814187049866
step: 160, task: Textual/Abt-Buy, loss: 0.2538412809371948
step: 170, task: Textual/Abt-Buy, loss: 0.10120220482349396
step: 180, task: Textual/Abt-Buy, loss: 0.3040362000465393
step: 190, task: Textual/Abt-Buy, loss: 0.6314277052879333
step: 200, task: Textual/Abt-Buy, loss: 0.1110665500164032
step: 210, task: Textual/Abt-Buy, loss: 0.48637717962265015
step: 220, task: Textual/Abt-Buy, loss: 0.38705527782440186
step: 230, task: Textual/Abt-Buy, loss: 0.39263349771499634
step: 240, task: Textual/Abt-Buy, loss: 0.0963204950094223
step: 250, task: Textual/Abt-Buy, loss: 0.10765340924263
step: 260, task: Textual/Abt-Buy, loss: 0.4071328341960907
step: 270, task: Textual/Abt-Buy, loss: 0.3799201250076294
step: 280, task: Textual/Abt-Buy, loss: 0.09919470548629761
step: 290, task: Textual/Abt-Buy, loss: 0.7246294021606445
step: 300, task: Textual/Abt-Buy, loss: 0.13370901346206665
step: 310, task: Textual/Abt-Buy, loss: 0.15666957199573517
step: 320, task: Textual/Abt-Buy, loss: 0.3748618960380554
step: 330, task: Textual/Abt-Buy, loss: 0.6794050335884094
step: 340, task: Textual/Abt-Buy, loss: 0.3840896487236023
step: 350, task: Textual/Abt-Buy, loss: 0.23906202614307404
=========eval at epoch=1=========
Validation:
=============Textual/Abt-Buy==================
accuracy=0.892
precision=0.000
recall=0.000
f1=0.000
======================================
Test:
=============Textual/Abt-Buy==================
accuracy=0.892
precision=0.000
recall=0.000
f1=0.000
======================================
=====sanity check======
words: COL name VAL canon black photo ink cartridge cli8b COL description VAL canon black photo ink cartridge cli8b fine technology for exceptional sharpness & detail compatible with canon pixma printers COL price VAL 16.0  [SEP] COL name VAL canon cli-221 black ink cartridge 2946b001 COL description VAL black COL price VAL 11.99 
x: [    0 18047   766 27445 32839   909  1345 16019 41785  3741   118   398
   428 14857  8194 27445 32839   909  1345 16019 41785  3741   118   398
   428  2051   806    13  9297  4406  1825   359  4617 16632    19 32839
   181  3181  1916 29379 14857   425 27445   545     4   288  1437     2
     2 18047   766 27445 32839  3741   118    12 28730   909 16019 41785
  1132  3761   428 19089 14857  8194 27445   909 14857   425 27445   365
     4  2831  1437     2]
tokens: ['<s>', 'COL', 'Ġname', 'ĠVAL', 'Ġcanon', 'Ġblack', 'Ġphoto', 'Ġink', 'Ġcartridge', 'Ġcl', 'i', '8', 'b', 'ĠCOL', 'Ġdescription', 'ĠVAL', 'Ġcanon', 'Ġblack', 'Ġphoto', 'Ġink', 'Ġcartridge', 'Ġcl', 'i', '8', 'b', 'Ġfine', 'Ġtechnology', 'Ġfor', 'Ġexceptional', 'Ġsharp', 'ness', 'Ġ&', 'Ġdetail', 'Ġcompatible', 'Ġwith', 'Ġcanon', 'Ġp', 'ix', 'ma', 'Ġprinters', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ16', '.', '0', 'Ġ', '</s>', '</s>', 'COL', 'Ġname', 'ĠVAL', 'Ġcanon', 'Ġcl', 'i', '-', '221', 'Ġblack', 'Ġink', 'Ġcartridge', 'Ġ29', '46', 'b', '001', 'ĠCOL', 'Ġdescription', 'ĠVAL', 'Ġblack', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ11', '.', '99', 'Ġ', '</s>']
is_heads: [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
y: 0
tags: 0
mask: tensor([1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1])
seqlen: 76
task_name: Textual/Abt-Buy
=======================
step: 0, task: Textual/Abt-Buy, loss: 0.08631426095962524
step: 10, task: Textual/Abt-Buy, loss: 0.38021641969680786
step: 20, task: Textual/Abt-Buy, loss: 0.2522755563259125
step: 30, task: Textual/Abt-Buy, loss: 0.49215826392173767
step: 40, task: Textual/Abt-Buy, loss: 0.24311213195323944
step: 50, task: Textual/Abt-Buy, loss: 0.27126723527908325
step: 60, task: Textual/Abt-Buy, loss: 0.3731706142425537
step: 70, task: Textual/Abt-Buy, loss: 0.23530784249305725
step: 80, task: Textual/Abt-Buy, loss: 0.40910619497299194
step: 90, task: Textual/Abt-Buy, loss: 0.9453607797622681
step: 100, task: Textual/Abt-Buy, loss: 0.37322112917900085
step: 110, task: Textual/Abt-Buy, loss: 0.42725086212158203
step: 120, task: Textual/Abt-Buy, loss: 0.23039573431015015
step: 130, task: Textual/Abt-Buy, loss: 0.38765251636505127
step: 140, task: Textual/Abt-Buy, loss: 0.39086154103279114
step: 150, task: Textual/Abt-Buy, loss: 0.48581406474113464
step: 160, task: Textual/Abt-Buy, loss: 0.28183966875076294
step: 170, task: Textual/Abt-Buy, loss: 0.1069316640496254
step: 180, task: Textual/Abt-Buy, loss: 0.5464260578155518
step: 190, task: Textual/Abt-Buy, loss: 0.33591485023498535
step: 200, task: Textual/Abt-Buy, loss: 0.3810064196586609
step: 210, task: Textual/Abt-Buy, loss: 0.6251085996627808
step: 220, task: Textual/Abt-Buy, loss: 0.38848286867141724
step: 230, task: Textual/Abt-Buy, loss: 0.557365894317627
step: 240, task: Textual/Abt-Buy, loss: 0.5021215081214905
step: 250, task: Textual/Abt-Buy, loss: 0.7807585597038269
step: 260, task: Textual/Abt-Buy, loss: 0.5217502117156982
step: 270, task: Textual/Abt-Buy, loss: 0.5493205785751343
step: 280, task: Textual/Abt-Buy, loss: 0.5037586092948914
step: 290, task: Textual/Abt-Buy, loss: 0.385381817817688
step: 300, task: Textual/Abt-Buy, loss: 0.1307346522808075
step: 310, task: Textual/Abt-Buy, loss: 0.24551479518413544
step: 320, task: Textual/Abt-Buy, loss: 0.5445314049720764
step: 330, task: Textual/Abt-Buy, loss: 0.27825573086738586
step: 340, task: Textual/Abt-Buy, loss: 0.6979818940162659
step: 350, task: Textual/Abt-Buy, loss: 0.40331387519836426
=========eval at epoch=1=========
Validation:
=============Textual/Abt-Buy==================
accuracy=0.892
precision=0.000
recall=0.000
f1=0.000
======================================
Test:
=============Textual/Abt-Buy==================
accuracy=0.892
precision=0.000
recall=0.000
f1=0.000
======================================
=====sanity check======
words: COL name VAL sanus 30 ' 50 ' full-motion flat panel tv black wall mount lrf118b1 COL description VAL sanus 30 ' 50 ' full-motion flat panel tv black wall mount lrf118b1 swivel motion low profile virtual axis technology easy access to wires universal mounting brackets black finish COL price VAL 349.0  [SEP] COL name VAL sanus visionmount flat panel tv wall mount vmpl3b COL description VAL steel 280 lb COL price VAL 144.05 
x: [    0 18047   766 27445 15610   687   389   128   654   128   455    12
 35474  3269  2798 30016   909  2204 14206   784 29898 21369   428   134
 14857  8194 27445 15610   687   389   128   654   128   455    12 35474
  3269  2798 30016   909  2204 14206   784 29898 21369   428   134  3514
  2088   462  4298   614  4392  6229 31799   806  1365   899     7 22893
 10547 12033 29617   909  2073 14857   425 27445 41091     4   288  1437
     2     2 18047   766 27445 15610   687  3360 17336  3269  2798 30016
  2204 14206 48643  2911   246   428 14857  8194 27445  3689 20688 19821
 14857   425 27445 19641     4  2546  1437     2]
tokens: ['<s>', 'COL', 'Ġname', 'ĠVAL', 'Ġsan', 'us', 'Ġ30', "Ġ'", 'Ġ50', "Ġ'", 'Ġfull', '-', 'motion', 'Ġflat', 'Ġpanel', 'Ġtv', 'Ġblack', 'Ġwall', 'Ġmount', 'Ġl', 'rf', '118', 'b', '1', 'ĠCOL', 'Ġdescription', 'ĠVAL', 'Ġsan', 'us', 'Ġ30', "Ġ'", 'Ġ50', "Ġ'", 'Ġfull', '-', 'motion', 'Ġflat', 'Ġpanel', 'Ġtv', 'Ġblack', 'Ġwall', 'Ġmount', 'Ġl', 'rf', '118', 'b', '1', 'Ġsw', 'ive', 'l', 'Ġmotion', 'Ġlow', 'Ġprofile', 'Ġvirtual', 'Ġaxis', 'Ġtechnology', 'Ġeasy', 'Ġaccess', 'Ġto', 'Ġwires', 'Ġuniversal', 'Ġmounting', 'Ġbrackets', 'Ġblack', 'Ġfinish', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ349', '.', '0', 'Ġ', '</s>', '</s>', 'COL', 'Ġname', 'ĠVAL', 'Ġsan', 'us', 'Ġvision', 'mount', 'Ġflat', 'Ġpanel', 'Ġtv', 'Ġwall', 'Ġmount', 'Ġvm', 'pl', '3', 'b', 'ĠCOL', 'Ġdescription', 'ĠVAL', 'Ġsteel', 'Ġ280', 'Ġlb', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ144', '.', '05', 'Ġ', '</s>']
is_heads: [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
y: 0
tags: 0
mask: tensor([1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1])
seqlen: 104
task_name: Textual/Abt-Buy
=======================
step: 0, task: Textual/Abt-Buy, loss: 0.14864325523376465
step: 10, task: Textual/Abt-Buy, loss: 0.12006647884845734
step: 20, task: Textual/Abt-Buy, loss: 0.4054774343967438
step: 30, task: Textual/Abt-Buy, loss: 0.23513808846473694
step: 40, task: Textual/Abt-Buy, loss: 0.3326909840106964
step: 50, task: Textual/Abt-Buy, loss: 0.37586915493011475
step: 60, task: Textual/Abt-Buy, loss: 0.2616743743419647
step: 70, task: Textual/Abt-Buy, loss: 0.4402182996273041
step: 80, task: Textual/Abt-Buy, loss: 0.43054941296577454
step: 90, task: Textual/Abt-Buy, loss: 0.5179741382598877
step: 100, task: Textual/Abt-Buy, loss: 0.6661363244056702
step: 110, task: Textual/Abt-Buy, loss: 0.4883456826210022
step: 120, task: Textual/Abt-Buy, loss: 0.36776891350746155
step: 130, task: Textual/Abt-Buy, loss: 0.1440282166004181
step: 140, task: Textual/Abt-Buy, loss: 0.24558985233306885
step: 150, task: Textual/Abt-Buy, loss: 0.3833531439304352
step: 160, task: Textual/Abt-Buy, loss: 0.5958853363990784
step: 170, task: Textual/Abt-Buy, loss: 0.25433552265167236
step: 180, task: Textual/Abt-Buy, loss: 0.6662064790725708
step: 190, task: Textual/Abt-Buy, loss: 0.27684304118156433
step: 200, task: Textual/Abt-Buy, loss: 0.3881121575832367
step: 210, task: Textual/Abt-Buy, loss: 0.2484578937292099
step: 220, task: Textual/Abt-Buy, loss: 0.3741697669029236
step: 230, task: Textual/Abt-Buy, loss: 0.8137128949165344
step: 240, task: Textual/Abt-Buy, loss: 0.23984786868095398
step: 250, task: Textual/Abt-Buy, loss: 0.23322543501853943
step: 260, task: Textual/Abt-Buy, loss: 0.2359302043914795
step: 270, task: Textual/Abt-Buy, loss: 0.5259313583374023
step: 280, task: Textual/Abt-Buy, loss: 0.4854363203048706
step: 290, task: Textual/Abt-Buy, loss: 0.5186666250228882
step: 300, task: Textual/Abt-Buy, loss: 0.12143666297197342
step: 310, task: Textual/Abt-Buy, loss: 0.5478916764259338
step: 320, task: Textual/Abt-Buy, loss: 0.6498576402664185
step: 330, task: Textual/Abt-Buy, loss: 0.6934714317321777
step: 340, task: Textual/Abt-Buy, loss: 0.2617550194263458
step: 350, task: Textual/Abt-Buy, loss: 0.5909522175788879
=========eval at epoch=1=========
Validation:
=============Textual/Abt-Buy==================
accuracy=0.892
precision=0.000
recall=0.000
f1=0.000
======================================
Test:
=============Textual/Abt-Buy==================
accuracy=0.892
precision=0.000
recall=0.000
f1=0.000
======================================
=====sanity check======
words: COL name VAL panasonic blue 8.1 megapixel digital camera dmcfs3a COL description VAL panasonic blue 8.1 megapixel digital camera dmcfs3a 8.1 megapixel 33mm lens 3x optical zoom intelligent auto mode 2.5 ' diagonal intelligent lcd mega optical image stabilization intelligent iso control face detection hi-speed burst mode blue finish COL price VAL   [SEP] COL name VAL panasonic palmcorder sdr-h60 digital camcorder sdr-h60s COL description VAL panasonic sdr-h60 60gb hard disk drive/sd hybrid camcorder with 50x optical zoom , advanced optical image stabilization , one-touch dvd copy , anti-shock shield and one-touch navigation , records to internal hard drive or sd card COL price VAL  
x: [    0 18047   766 27445  5730 38703  2440   290     4   134 10721 21424
  1778  2280   385 29297 17884   246   102 14857  8194 27445  5730 38703
  2440   290     4   134 10721 21424  1778  2280   385 29297 17884   246
   102   290     4   134 10721 21424  2357  5471 10373   155  1178 17547
 21762 12038  4485  5745   132     4   245   128 42539 12038   784 28690
 14251 17547  2274 29632 12038 47191   797   652 12673 20280    12  8619
 10084  5745  2440  2073 14857   425 27445  1437  1437     2     2 18047
   766 27445  5730 38703 14262   438 10337   579 10232    12   298  2466
  1778 11021   438 10337   579 10232    12   298  2466    29 14857  8194
 27445  5730 38703   579 10232    12   298  2466  1191 19562   543 21675
  1305    73 28045  9284 11021   438 10337    19   654  1178 17547 21762
  2156  3319 17547  2274 29632  2156    65    12 26673   385 40311  5375
  2156  1475    12 37316 15978     8    65    12 26673 14461  2156  2189
     7  3425   543  1305    50 46409  1886 14857   425 27445  1437  1437
     2]
tokens: ['<s>', 'COL', 'Ġname', 'ĠVAL', 'Ġpan', 'asonic', 'Ġblue', 'Ġ8', '.', '1', 'Ġmeg', 'apixel', 'Ġdigital', 'Ġcamera', 'Ġd', 'mc', 'fs', '3', 'a', 'ĠCOL', 'Ġdescription', 'ĠVAL', 'Ġpan', 'asonic', 'Ġblue', 'Ġ8', '.', '1', 'Ġmeg', 'apixel', 'Ġdigital', 'Ġcamera', 'Ġd', 'mc', 'fs', '3', 'a', 'Ġ8', '.', '1', 'Ġmeg', 'apixel', 'Ġ33', 'mm', 'Ġlens', 'Ġ3', 'x', 'Ġoptical', 'Ġzoom', 'Ġintelligent', 'Ġauto', 'Ġmode', 'Ġ2', '.', '5', "Ġ'", 'Ġdiagonal', 'Ġintelligent', 'Ġl', 'cd', 'Ġmega', 'Ġoptical', 'Ġimage', 'Ġstabilization', 'Ġintelligent', 'Ġiso', 'Ġcontrol', 'Ġface', 'Ġdetection', 'Ġhi', '-', 'speed', 'Ġburst', 'Ġmode', 'Ġblue', 'Ġfinish', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ', 'Ġ', '</s>', '</s>', 'COL', 'Ġname', 'ĠVAL', 'Ġpan', 'asonic', 'Ġpalm', 'c', 'order', 'Ġs', 'dr', '-', 'h', '60', 'Ġdigital', 'Ġcam', 'c', 'order', 'Ġs', 'dr', '-', 'h', '60', 's', 'ĠCOL', 'Ġdescription', 'ĠVAL', 'Ġpan', 'asonic', 'Ġs', 'dr', '-', 'h', '60', 'Ġ60', 'gb', 'Ġhard', 'Ġdisk', 'Ġdrive', '/', 'sd', 'Ġhybrid', 'Ġcam', 'c', 'order', 'Ġwith', 'Ġ50', 'x', 'Ġoptical', 'Ġzoom', 'Ġ,', 'Ġadvanced', 'Ġoptical', 'Ġimage', 'Ġstabilization', 'Ġ,', 'Ġone', '-', 'touch', 'Ġd', 'vd', 'Ġcopy', 'Ġ,', 'Ġanti', '-', 'shock', 'Ġshield', 'Ġand', 'Ġone', '-', 'touch', 'Ġnavigation', 'Ġ,', 'Ġrecords', 'Ġto', 'Ġinternal', 'Ġhard', 'Ġdrive', 'Ġor', 'Ġsd', 'Ġcard', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ', 'Ġ', '</s>']
is_heads: [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
y: 0
tags: 0
mask: tensor([1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1])
seqlen: 169
task_name: Textual/Abt-Buy
=======================
step: 0, task: Textual/Abt-Buy, loss: 0.5193074941635132
step: 10, task: Textual/Abt-Buy, loss: 0.12674449384212494
step: 20, task: Textual/Abt-Buy, loss: 0.0993066355586052
step: 30, task: Textual/Abt-Buy, loss: 0.2550690770149231
step: 40, task: Textual/Abt-Buy, loss: 0.12094413489103317
step: 50, task: Textual/Abt-Buy, loss: 0.5279606580734253
step: 60, task: Textual/Abt-Buy, loss: 0.1325407326221466
step: 70, task: Textual/Abt-Buy, loss: 0.22138336300849915
step: 80, task: Textual/Abt-Buy, loss: 0.5296111106872559
step: 90, task: Textual/Abt-Buy, loss: 0.1397034227848053
step: 100, task: Textual/Abt-Buy, loss: 0.2550431191921234
step: 110, task: Textual/Abt-Buy, loss: 0.10649261623620987
step: 120, task: Textual/Abt-Buy, loss: 0.23633627593517303
step: 130, task: Textual/Abt-Buy, loss: 0.4034366011619568
step: 140, task: Textual/Abt-Buy, loss: 0.10274574905633926
step: 150, task: Textual/Abt-Buy, loss: 0.371770977973938
step: 160, task: Textual/Abt-Buy, loss: 0.24075330793857574
step: 170, task: Textual/Abt-Buy, loss: 0.2571086585521698
step: 180, task: Textual/Abt-Buy, loss: 0.38917553424835205
step: 190, task: Textual/Abt-Buy, loss: 0.1108887791633606
step: 200, task: Textual/Abt-Buy, loss: 0.24592459201812744
step: 210, task: Textual/Abt-Buy, loss: 0.43194252252578735
step: 220, task: Textual/Abt-Buy, loss: 0.39148953557014465
Gradient overflow.  Skipping step, loss scaler 0 reducing loss scale to 8192.0
step: 230, task: Textual/Abt-Buy, loss: 0.09295636415481567
step: 240, task: Textual/Abt-Buy, loss: 0.4014371335506439
step: 250, task: Textual/Abt-Buy, loss: 0.22538946568965912
step: 260, task: Textual/Abt-Buy, loss: 0.3505738079547882
step: 270, task: Textual/Abt-Buy, loss: 0.36233508586883545
step: 280, task: Textual/Abt-Buy, loss: 0.6062777638435364
step: 290, task: Textual/Abt-Buy, loss: 0.2976210117340088
step: 300, task: Textual/Abt-Buy, loss: 0.3640387952327728
step: 310, task: Textual/Abt-Buy, loss: 0.364332377910614
step: 320, task: Textual/Abt-Buy, loss: 0.07534419000148773
step: 330, task: Textual/Abt-Buy, loss: 0.08469048142433167
step: 340, task: Textual/Abt-Buy, loss: 0.3931725323200226
step: 350, task: Textual/Abt-Buy, loss: 0.576598584651947
=========eval at epoch=1=========
Validation:
=============Textual/Abt-Buy==================
accuracy=0.892
precision=0.000
recall=0.000
f1=0.000
======================================
Test:
=============Textual/Abt-Buy==================
accuracy=0.892
precision=0.000
recall=0.000
f1=0.000
======================================
=====sanity check======
words: COL name VAL maytag jetclean ii black undercounter dishwasher mdb7851bk COL description VAL maytag jetclean ii mdb7851aw black undercounter dishwasher mdb7851bk 14-piece place setting oversize capacity plus steamclean option stainless steel tub interior dark duraguard adjustable and removable nylon rack quietseries 300ss sound package automatic temperature control 5 wash levels high pressure spray jets ventless dry system precision clean turbidity sensor control lockout energy star qualified nsf certified black finish COL price VAL   [SEP] COL name VAL whirlpool du1100xtps 24 ' undercounter dishwasher ( stainless steel ) COL description VAL  COL price VAL 537.29 
x: [    0 18047   766 27445   189 10058  4900 28401 42661   909   223 24774
  8847 34475   475 33845  5479  4708   428   330 14857  8194 27445   189
 10058  4900 28401 42661   475 33845  5479  4708  1584   909   223 24774
  8847 34475   475 33845  5479  4708   428   330   501    12 10449   317
  2749    81 10799  2148  2704 10473 28401  1973 23486  3689 17465  6291
  2933 17373 11993  1120 29861     8 37680 38874 20004  2677 46809  9709
  2993  7485  2369  3737  8408  5181   797   195 10397  1389   239  1164
 11782 10622 13228  1672  3841   467 15339  2382 33858 35714  9626   797
 41630  1007   999  6048   295 26649  9785   909  2073 14857   425 27445
  1437  1437     2     2 18047   766 27445  8401 12862 10416  4279 40830
 11483  3275   706   128   223 24774  8847 34475    36 23486  3689  4839
 14857  8194 27445  1437 14857   425 27445   195  3272     4  2890  1437
     2]
tokens: ['<s>', 'COL', 'Ġname', 'ĠVAL', 'Ġmay', 'tag', 'Ġjet', 'clean', 'Ġii', 'Ġblack', 'Ġunder', 'counter', 'Ġdish', 'washer', 'Ġm', 'db', '78', '51', 'b', 'k', 'ĠCOL', 'Ġdescription', 'ĠVAL', 'Ġmay', 'tag', 'Ġjet', 'clean', 'Ġii', 'Ġm', 'db', '78', '51', 'aw', 'Ġblack', 'Ġunder', 'counter', 'Ġdish', 'washer', 'Ġm', 'db', '78', '51', 'b', 'k', 'Ġ14', '-', 'piece', 'Ġplace', 'Ġsetting', 'Ġover', 'size', 'Ġcapacity', 'Ġplus', 'Ġsteam', 'clean', 'Ġoption', 'Ġstainless', 'Ġsteel', 'Ġtub', 'Ġinterior', 'Ġdark', 'Ġdur', 'agu', 'ard', 'Ġadjustable', 'Ġand', 'Ġremovable', 'Ġnylon', 'Ġrack', 'Ġqu', 'iets', 'eries', 'Ġ300', 'ss', 'Ġsound', 'Ġpackage', 'Ġautomatic', 'Ġtemperature', 'Ġcontrol', 'Ġ5', 'Ġwash', 'Ġlevels', 'Ġhigh', 'Ġpressure', 'Ġspray', 'Ġjets', 'Ġvent', 'less', 'Ġdry', 'Ġsystem', 'Ġprecision', 'Ġclean', 'Ġturb', 'idity', 'Ġsensor', 'Ġcontrol', 'Ġlockout', 'Ġenergy', 'Ġstar', 'Ġqualified', 'Ġn', 'sf', 'Ġcertified', 'Ġblack', 'Ġfinish', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ', 'Ġ', '</s>', '</s>', 'COL', 'Ġname', 'ĠVAL', 'Ġwh', 'irl', 'pool', 'Ġdu', '1100', 'xt', 'ps', 'Ġ24', "Ġ'", 'Ġunder', 'counter', 'Ġdish', 'washer', 'Ġ(', 'Ġstainless', 'Ġsteel', 'Ġ)', 'ĠCOL', 'Ġdescription', 'ĠVAL', 'Ġ', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ5', '37', '.', '29', 'Ġ', '</s>']
is_heads: [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
y: 0
tags: 0
mask: tensor([1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1])
seqlen: 145
task_name: Textual/Abt-Buy
=======================
step: 0, task: Textual/Abt-Buy, loss: 0.37631237506866455
step: 10, task: Textual/Abt-Buy, loss: 0.2603854238986969
step: 20, task: Textual/Abt-Buy, loss: 0.3206630349159241
step: 30, task: Textual/Abt-Buy, loss: 0.3941643536090851
step: 40, task: Textual/Abt-Buy, loss: 0.3274250328540802
step: 50, task: Textual/Abt-Buy, loss: 0.09989096969366074
step: 60, task: Textual/Abt-Buy, loss: 0.362784206867218
step: 70, task: Textual/Abt-Buy, loss: 0.1293283998966217
step: 80, task: Textual/Abt-Buy, loss: 0.2069997489452362
step: 90, task: Textual/Abt-Buy, loss: 0.26399731636047363
step: 100, task: Textual/Abt-Buy, loss: 0.1402704417705536
step: 110, task: Textual/Abt-Buy, loss: 0.28994864225387573
step: 120, task: Textual/Abt-Buy, loss: 0.12410032004117966
step: 130, task: Textual/Abt-Buy, loss: 0.27878886461257935
step: 140, task: Textual/Abt-Buy, loss: 0.2435271143913269
step: 150, task: Textual/Abt-Buy, loss: 0.258514940738678
step: 160, task: Textual/Abt-Buy, loss: 0.29003608226776123
step: 170, task: Textual/Abt-Buy, loss: 0.35877180099487305
step: 180, task: Textual/Abt-Buy, loss: 0.4383416771888733
step: 190, task: Textual/Abt-Buy, loss: 0.32187309861183167
step: 200, task: Textual/Abt-Buy, loss: 0.42267632484436035
step: 210, task: Textual/Abt-Buy, loss: 0.3877144455909729
step: 220, task: Textual/Abt-Buy, loss: 0.3407629132270813
step: 230, task: Textual/Abt-Buy, loss: 0.22952590882778168
step: 240, task: Textual/Abt-Buy, loss: 0.45899689197540283
step: 250, task: Textual/Abt-Buy, loss: 0.43175989389419556
step: 260, task: Textual/Abt-Buy, loss: 0.22790178656578064
step: 270, task: Textual/Abt-Buy, loss: 0.0996648445725441
step: 280, task: Textual/Abt-Buy, loss: 0.1109800711274147
step: 290, task: Textual/Abt-Buy, loss: 0.11588937789201736
step: 300, task: Textual/Abt-Buy, loss: 0.06929246336221695
step: 310, task: Textual/Abt-Buy, loss: 0.6427829265594482
step: 320, task: Textual/Abt-Buy, loss: 0.12648142874240875
step: 330, task: Textual/Abt-Buy, loss: 0.611435055732727
step: 340, task: Textual/Abt-Buy, loss: 0.11336889863014221
step: 350, task: Textual/Abt-Buy, loss: 0.07143035531044006
=========eval at epoch=1=========
Validation:
=============Textual/Abt-Buy==================
accuracy=0.892
precision=0.000
recall=0.000
f1=0.000
======================================
Test:
=============Textual/Abt-Buy==================
accuracy=0.892
precision=0.000
recall=0.000
f1=0.000
======================================
=====sanity check======
words: COL name VAL samsung 46 ' series 9 lcd black flat panel hdtv ln46a950 COL description VAL samsung 46 ' series 9 lcd black flat panel hdtv ln46a950 full 1080p high definition resolution 1,000,000:1 dynamic contrast ratio auto motion plus 120hz built-in digital tuner ( ntsc/atsc/clear qam ) 4ms response time srs trusurround xt down firing speakers picture-in-picture ( pip ) integrated woofer wide color gamut led backlight black finish COL price VAL   [SEP] COL name VAL samsung 6 series ln19a650 19 ' lcd tv COL description VAL samsung ln19a650 19 ' widescreen lcd hdtv 3,000:1 dynamic contrast ratio 8ms response time COL price VAL 369.0 
x: [    0 18047   766 27445   579 48545  4059   128   651   361   784 28690
   909  3269  2798  1368   417 18724   784   282  3761   102 24378 14857
  8194 27445   579 48545  4059   128   651   361   784 28690   909  3269
  2798  1368   417 18724   784   282  3761   102 24378   455 21083   642
   239  8515  3547   112     6   151     6   151    35   134  6878  5709
  1750  4485  4298  2704  5962 39569  1490    12   179  1778 27115   254
    36   295  1872   438    73  2923   438    73 18763  2231   424  4839
   204  4339  1263    86   579  4926  2664   687   710  3431  1437 11483
   159  5834  6864  2170    12   179    12 37587    36 35209  4839  6818
 19958 20779  1810  3195 20577  1182   669   124  6991   909  2073 14857
   425 27445  1437  1437     2     2 18047   766 27445   579 48545   231
   651   784   282  1646   102 16316   753   128   784 28690 30016 14857
  8194 27445   579 48545   784   282  1646   102 16316   753   128   885
  4376 37346   784 28690  1368   417 18724   155     6   151    35   134
  6878  5709  1750   290  4339  1263    86 14857   425 27445 41821     4
   288  1437     2]
tokens: ['<s>', 'COL', 'Ġname', 'ĠVAL', 'Ġs', 'amsung', 'Ġ46', "Ġ'", 'Ġseries', 'Ġ9', 'Ġl', 'cd', 'Ġblack', 'Ġflat', 'Ġpanel', 'Ġh', 'd', 'tv', 'Ġl', 'n', '46', 'a', '950', 'ĠCOL', 'Ġdescription', 'ĠVAL', 'Ġs', 'amsung', 'Ġ46', "Ġ'", 'Ġseries', 'Ġ9', 'Ġl', 'cd', 'Ġblack', 'Ġflat', 'Ġpanel', 'Ġh', 'd', 'tv', 'Ġl', 'n', '46', 'a', '950', 'Ġfull', 'Ġ1080', 'p', 'Ġhigh', 'Ġdefinition', 'Ġresolution', 'Ġ1', ',', '000', ',', '000', ':', '1', 'Ġdynamic', 'Ġcontrast', 'Ġratio', 'Ġauto', 'Ġmotion', 'Ġplus', 'Ġ120', 'hz', 'Ġbuilt', '-', 'in', 'Ġdigital', 'Ġtun', 'er', 'Ġ(', 'Ġn', 'ts', 'c', '/', 'ats', 'c', '/', 'clear', 'Ġq', 'am', 'Ġ)', 'Ġ4', 'ms', 'Ġresponse', 'Ġtime', 'Ġs', 'rs', 'Ġtr', 'us', 'ur', 'round', 'Ġ', 'xt', 'Ġdown', 'Ġfiring', 'Ġspeakers', 'Ġpicture', '-', 'in', '-', 'picture', 'Ġ(', 'Ġpip', 'Ġ)', 'Ġintegrated', 'Ġwo', 'ofer', 'Ġwide', 'Ġcolor', 'Ġgam', 'ut', 'Ġled', 'Ġback', 'light', 'Ġblack', 'Ġfinish', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ', 'Ġ', '</s>', '</s>', 'COL', 'Ġname', 'ĠVAL', 'Ġs', 'amsung', 'Ġ6', 'Ġseries', 'Ġl', 'n', '19', 'a', '650', 'Ġ19', "Ġ'", 'Ġl', 'cd', 'Ġtv', 'ĠCOL', 'Ġdescription', 'ĠVAL', 'Ġs', 'amsung', 'Ġl', 'n', '19', 'a', '650', 'Ġ19', "Ġ'", 'Ġw', 'ides', 'creen', 'Ġl', 'cd', 'Ġh', 'd', 'tv', 'Ġ3', ',', '000', ':', '1', 'Ġdynamic', 'Ġcontrast', 'Ġratio', 'Ġ8', 'ms', 'Ġresponse', 'Ġtime', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ369', '.', '0', 'Ġ', '</s>']
is_heads: [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
y: 0
tags: 0
mask: tensor([1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1])
seqlen: 183
task_name: Textual/Abt-Buy
=======================
step: 0, task: Textual/Abt-Buy, loss: 0.08455385267734528
step: 10, task: Textual/Abt-Buy, loss: 0.38497141003608704
step: 20, task: Textual/Abt-Buy, loss: 0.2637847661972046
step: 30, task: Textual/Abt-Buy, loss: 0.08787460625171661
step: 40, task: Textual/Abt-Buy, loss: 0.5747935771942139
step: 50, task: Textual/Abt-Buy, loss: 0.4244287312030792
step: 60, task: Textual/Abt-Buy, loss: 0.15688243508338928
step: 70, task: Textual/Abt-Buy, loss: 0.0848252922296524
step: 80, task: Textual/Abt-Buy, loss: 0.03166203200817108
step: 90, task: Textual/Abt-Buy, loss: 0.35829731822013855
step: 100, task: Textual/Abt-Buy, loss: 0.47666239738464355
step: 110, task: Textual/Abt-Buy, loss: 0.07017473876476288
step: 120, task: Textual/Abt-Buy, loss: 0.2982967495918274
step: 130, task: Textual/Abt-Buy, loss: 0.29785990715026855
step: 140, task: Textual/Abt-Buy, loss: 0.014732614159584045
step: 150, task: Textual/Abt-Buy, loss: 0.2144714593887329
step: 160, task: Textual/Abt-Buy, loss: 0.30772078037261963
step: 170, task: Textual/Abt-Buy, loss: 0.074343740940094
step: 180, task: Textual/Abt-Buy, loss: 0.05235389992594719
step: 190, task: Textual/Abt-Buy, loss: 0.058818429708480835
step: 200, task: Textual/Abt-Buy, loss: 0.21905675530433655
step: 210, task: Textual/Abt-Buy, loss: 0.11533274501562119
step: 220, task: Textual/Abt-Buy, loss: 0.1651337444782257
step: 230, task: Textual/Abt-Buy, loss: 0.07526542246341705
step: 240, task: Textual/Abt-Buy, loss: 0.07063855230808258
step: 250, task: Textual/Abt-Buy, loss: 0.035054877400398254
step: 260, task: Textual/Abt-Buy, loss: 0.20605717599391937
step: 270, task: Textual/Abt-Buy, loss: 0.20769542455673218
step: 280, task: Textual/Abt-Buy, loss: 0.28537166118621826
step: 290, task: Textual/Abt-Buy, loss: 0.041492659598588943
step: 300, task: Textual/Abt-Buy, loss: 0.22547504305839539
step: 310, task: Textual/Abt-Buy, loss: 0.05400353670120239
Gradient overflow.  Skipping step, loss scaler 0 reducing loss scale to 4096.0
step: 320, task: Textual/Abt-Buy, loss: 0.08568631112575531
step: 330, task: Textual/Abt-Buy, loss: 0.05388995260000229
step: 340, task: Textual/Abt-Buy, loss: 0.21335673332214355
step: 350, task: Textual/Abt-Buy, loss: 0.11160679161548615
=========eval at epoch=1=========
Validation:
=============Textual/Abt-Buy==================
accuracy=0.912
precision=0.571
recall=0.738
f1=0.644
======================================
Test:
=============Textual/Abt-Buy==================
accuracy=0.931
precision=0.637
recall=0.825
f1=0.719
======================================
=====sanity check======
words: COL name VAL sony cyber-shot black digital camera dsch10b COL description VAL sony dsch10 cyber-shot black digital camera dsch10b 8.1 megapixels 3.0 ' lcd display carl zeiss 10x optical zoom lens 31 mb internal memory versatile flash advanced sports mode 9-point auto focus high sensitivity mode burst mode face detection in-camera retouching super steadyshot optical image stabilization with anti-blur solution music slideshow hdtv compatibility stamina battery power beginner-friendly function guide black finish COL price VAL   [SEP] COL name VAL sony lcs-csl cyber-shot camera case COL description VAL top loading leather black COL price VAL  
x: [    0 18047   766 27445   579  6119  5381    12 10393   909  1778  2280
   385 12265   698   428 14857  8194 27445   579  6119   385 12265   698
  5381    12 10393   909  1778  2280   385 12265   698   428   290     4
   134 10721  1115 41699   155     4   288   128   784 28690  2332   512
   462 20025  3006   158  1178 17547 21762 10373  1105   475   428  3425
  3783 16106  7462  3319  1612  5745   361    12  2300  4485  1056   239
 15608  5745 10084  5745   652 12673    11    12 25092  5494 12746   154
  2422 23789  2459 10120 17547  2274 29632    19  1475    12  3662   710
  2472   930 13150  1368   417 18724 29988 34745  3822   476 37239    12
  6928  5043  4704   909  2073 14857   425 27445  1437  1437     2     2
 18047   766 27445   579  6119   784 11365    12 11365   462  5381    12
 10393  2280   403 14857  8194 27445   299 16761  9219   909 14857   425
 27445  1437  1437     2]
tokens: ['<s>', 'COL', 'Ġname', 'ĠVAL', 'Ġs', 'ony', 'Ġcyber', '-', 'shot', 'Ġblack', 'Ġdigital', 'Ġcamera', 'Ġd', 'sch', '10', 'b', 'ĠCOL', 'Ġdescription', 'ĠVAL', 'Ġs', 'ony', 'Ġd', 'sch', '10', 'Ġcyber', '-', 'shot', 'Ġblack', 'Ġdigital', 'Ġcamera', 'Ġd', 'sch', '10', 'b', 'Ġ8', '.', '1', 'Ġmeg', 'ap', 'ixels', 'Ġ3', '.', '0', "Ġ'", 'Ġl', 'cd', 'Ġdisplay', 'Ġcar', 'l', 'Ġze', 'iss', 'Ġ10', 'x', 'Ġoptical', 'Ġzoom', 'Ġlens', 'Ġ31', 'Ġm', 'b', 'Ġinternal', 'Ġmemory', 'Ġversatile', 'Ġflash', 'Ġadvanced', 'Ġsports', 'Ġmode', 'Ġ9', '-', 'point', 'Ġauto', 'Ġfocus', 'Ġhigh', 'Ġsensitivity', 'Ġmode', 'Ġburst', 'Ġmode', 'Ġface', 'Ġdetection', 'Ġin', '-', 'camera', 'Ġret', 'ouch', 'ing', 'Ġsuper', 'Ġstead', 'ys', 'hot', 'Ġoptical', 'Ġimage', 'Ġstabilization', 'Ġwith', 'Ġanti', '-', 'bl', 'ur', 'Ġsolution', 'Ġmusic', 'Ġslideshow', 'Ġh', 'd', 'tv', 'Ġcompatibility', 'Ġstamina', 'Ġbattery', 'Ġpower', 'Ġbeginner', '-', 'friendly', 'Ġfunction', 'Ġguide', 'Ġblack', 'Ġfinish', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ', 'Ġ', '</s>', '</s>', 'COL', 'Ġname', 'ĠVAL', 'Ġs', 'ony', 'Ġl', 'cs', '-', 'cs', 'l', 'Ġcyber', '-', 'shot', 'Ġcamera', 'Ġcase', 'ĠCOL', 'Ġdescription', 'ĠVAL', 'Ġtop', 'Ġloading', 'Ġleather', 'Ġblack', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ', 'Ġ', '</s>']
is_heads: [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
y: 0
tags: 0
mask: tensor([1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1])
seqlen: 148
task_name: Textual/Abt-Buy
=======================
step: 0, task: Textual/Abt-Buy, loss: 0.08577907085418701
step: 10, task: Textual/Abt-Buy, loss: 0.21205274760723114
step: 20, task: Textual/Abt-Buy, loss: 0.042743146419525146
step: 30, task: Textual/Abt-Buy, loss: 0.12789547443389893
step: 40, task: Textual/Abt-Buy, loss: 0.010622590780258179
step: 50, task: Textual/Abt-Buy, loss: 0.06607059389352798
step: 60, task: Textual/Abt-Buy, loss: 0.10773829370737076
step: 70, task: Textual/Abt-Buy, loss: 0.014784939587116241
step: 80, task: Textual/Abt-Buy, loss: 0.1582580953836441
step: 90, task: Textual/Abt-Buy, loss: 0.16347262263298035
step: 100, task: Textual/Abt-Buy, loss: 0.15238013863563538
step: 110, task: Textual/Abt-Buy, loss: 0.13508903980255127
step: 120, task: Textual/Abt-Buy, loss: 0.2871464192867279
step: 130, task: Textual/Abt-Buy, loss: 0.09528066962957382
step: 140, task: Textual/Abt-Buy, loss: 0.24386832118034363
step: 150, task: Textual/Abt-Buy, loss: 0.06297311931848526
step: 160, task: Textual/Abt-Buy, loss: 0.08409558981657028
step: 170, task: Textual/Abt-Buy, loss: 0.1344931274652481
step: 180, task: Textual/Abt-Buy, loss: 0.14608575403690338
step: 190, task: Textual/Abt-Buy, loss: 0.2195884883403778
step: 200, task: Textual/Abt-Buy, loss: 0.2636380195617676
step: 210, task: Textual/Abt-Buy, loss: 0.01689761132001877
step: 220, task: Textual/Abt-Buy, loss: 0.1895069181919098
step: 230, task: Textual/Abt-Buy, loss: 0.17349238693714142
step: 240, task: Textual/Abt-Buy, loss: 0.018015168607234955
step: 250, task: Textual/Abt-Buy, loss: 0.01681739091873169
step: 260, task: Textual/Abt-Buy, loss: 0.30775922536849976
step: 270, task: Textual/Abt-Buy, loss: 0.07887531071901321
step: 280, task: Textual/Abt-Buy, loss: 0.31476637721061707
step: 290, task: Textual/Abt-Buy, loss: 0.07283341884613037
step: 300, task: Textual/Abt-Buy, loss: 0.14176630973815918
step: 310, task: Textual/Abt-Buy, loss: 0.06745070219039917
step: 320, task: Textual/Abt-Buy, loss: 0.10481569916009903
step: 330, task: Textual/Abt-Buy, loss: 0.06246544420719147
step: 340, task: Textual/Abt-Buy, loss: 0.20846889913082123
step: 350, task: Textual/Abt-Buy, loss: 0.26483795046806335
=========eval at epoch=2=========
Validation:
=============Textual/Abt-Buy==================
accuracy=0.912
precision=0.571
recall=0.738
f1=0.644
======================================
Test:
=============Textual/Abt-Buy==================
accuracy=0.931
precision=0.637
recall=0.825
f1=0.719
======================================
=====sanity check======
words: COL name VAL panasonic silver 8.1 megapixel digital camera dmcfs3s COL description VAL panasonic silver 8.1 megapixel digital camera dmcfs3s 8.1-megapixel 33mm lens 3x optical zoom intelligent auto mode 2.5 ' diagonal intelligent lcd mega optical image stabilization intelligent iso control face detection hi-speed burst mode silver finish COL price VAL   [SEP] COL name VAL sony cyber-shot dsc-w150 digital camera silver dscw150 COL description VAL 8.1 megapixel 16:9 2x digital zoom 2.7 ' active matrix tft color lcd COL price VAL 129.99 
x: [    0 18047   766 27445  5730 38703  4334   290     4   134 10721 21424
  1778  2280   385 29297 17884   246    29 14857  8194 27445  5730 38703
  4334   290     4   134 10721 21424  1778  2280   385 29297 17884   246
    29   290     4   134    12 16258 21424  2357  5471 10373   155  1178
 17547 21762 12038  4485  5745   132     4   245   128 42539 12038   784
 28690 14251 17547  2274 29632 12038 47191   797   652 12673 20280    12
  8619 10084  5745  4334  2073 14857   425 27445  1437  1437     2     2
 18047   766 27445   579  6119  5381    12 10393   385  3866    12   605
  6115  1778  2280  4334   385  3866   605  6115 14857  8194 27445   290
     4   134 10721 21424   545    35   466   132  1178  1778 21762   132
     4   406   128  2171 36173   326  2543  3195   784 28690 14857   425
 27445 21234     4  2831  1437     2]
tokens: ['<s>', 'COL', 'Ġname', 'ĠVAL', 'Ġpan', 'asonic', 'Ġsilver', 'Ġ8', '.', '1', 'Ġmeg', 'apixel', 'Ġdigital', 'Ġcamera', 'Ġd', 'mc', 'fs', '3', 's', 'ĠCOL', 'Ġdescription', 'ĠVAL', 'Ġpan', 'asonic', 'Ġsilver', 'Ġ8', '.', '1', 'Ġmeg', 'apixel', 'Ġdigital', 'Ġcamera', 'Ġd', 'mc', 'fs', '3', 's', 'Ġ8', '.', '1', '-', 'meg', 'apixel', 'Ġ33', 'mm', 'Ġlens', 'Ġ3', 'x', 'Ġoptical', 'Ġzoom', 'Ġintelligent', 'Ġauto', 'Ġmode', 'Ġ2', '.', '5', "Ġ'", 'Ġdiagonal', 'Ġintelligent', 'Ġl', 'cd', 'Ġmega', 'Ġoptical', 'Ġimage', 'Ġstabilization', 'Ġintelligent', 'Ġiso', 'Ġcontrol', 'Ġface', 'Ġdetection', 'Ġhi', '-', 'speed', 'Ġburst', 'Ġmode', 'Ġsilver', 'Ġfinish', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ', 'Ġ', '</s>', '</s>', 'COL', 'Ġname', 'ĠVAL', 'Ġs', 'ony', 'Ġcyber', '-', 'shot', 'Ġd', 'sc', '-', 'w', '150', 'Ġdigital', 'Ġcamera', 'Ġsilver', 'Ġd', 'sc', 'w', '150', 'ĠCOL', 'Ġdescription', 'ĠVAL', 'Ġ8', '.', '1', 'Ġmeg', 'apixel', 'Ġ16', ':', '9', 'Ġ2', 'x', 'Ġdigital', 'Ġzoom', 'Ġ2', '.', '7', "Ġ'", 'Ġactive', 'Ġmatrix', 'Ġt', 'ft', 'Ġcolor', 'Ġl', 'cd', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ129', '.', '99', 'Ġ', '</s>']
is_heads: [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
y: 0
tags: 0
mask: tensor([1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1])
seqlen: 138
task_name: Textual/Abt-Buy
=======================
step: 0, task: Textual/Abt-Buy, loss: 0.10714181512594223
step: 10, task: Textual/Abt-Buy, loss: 0.03590214252471924
step: 20, task: Textual/Abt-Buy, loss: 0.11519047617912292
step: 30, task: Textual/Abt-Buy, loss: 0.16125155985355377
step: 40, task: Textual/Abt-Buy, loss: 0.0139121413230896
step: 50, task: Textual/Abt-Buy, loss: 0.04672686755657196
step: 60, task: Textual/Abt-Buy, loss: 0.10071983933448792
step: 70, task: Textual/Abt-Buy, loss: 0.0935969203710556
step: 80, task: Textual/Abt-Buy, loss: 0.06790391355752945
step: 90, task: Textual/Abt-Buy, loss: 0.11513463407754898
step: 100, task: Textual/Abt-Buy, loss: 0.21583335101604462
step: 110, task: Textual/Abt-Buy, loss: 0.17163503170013428
step: 120, task: Textual/Abt-Buy, loss: 0.10135439783334732
step: 130, task: Textual/Abt-Buy, loss: 0.11367196589708328
step: 140, task: Textual/Abt-Buy, loss: 0.3437689244747162
step: 150, task: Textual/Abt-Buy, loss: 0.19640253484249115
step: 160, task: Textual/Abt-Buy, loss: 0.11317428201436996
step: 170, task: Textual/Abt-Buy, loss: 0.07210689783096313
step: 180, task: Textual/Abt-Buy, loss: 0.10239741206169128
step: 190, task: Textual/Abt-Buy, loss: 0.05239575356245041
step: 200, task: Textual/Abt-Buy, loss: 0.028982803225517273
step: 210, task: Textual/Abt-Buy, loss: 0.016982294619083405
step: 220, task: Textual/Abt-Buy, loss: 0.2708835303783417
step: 230, task: Textual/Abt-Buy, loss: 0.11283961683511734
step: 240, task: Textual/Abt-Buy, loss: 0.06677629798650742
step: 250, task: Textual/Abt-Buy, loss: 0.07294921576976776
step: 260, task: Textual/Abt-Buy, loss: 0.012832388281822205
step: 270, task: Textual/Abt-Buy, loss: 0.06095142662525177
step: 280, task: Textual/Abt-Buy, loss: 0.03301069140434265
step: 290, task: Textual/Abt-Buy, loss: 0.1616811752319336
step: 300, task: Textual/Abt-Buy, loss: 0.17196428775787354
step: 310, task: Textual/Abt-Buy, loss: 0.06536224484443665
step: 320, task: Textual/Abt-Buy, loss: 0.15895740687847137
step: 330, task: Textual/Abt-Buy, loss: 0.13215328752994537
step: 340, task: Textual/Abt-Buy, loss: 0.2042732834815979
step: 350, task: Textual/Abt-Buy, loss: 0.06514331698417664
=========eval at epoch=3=========
Validation:
=============Textual/Abt-Buy==================
accuracy=0.912
precision=0.571
recall=0.738
f1=0.644
======================================
Test:
=============Textual/Abt-Buy==================
accuracy=0.931
precision=0.637
recall=0.825
f1=0.719
======================================
=====sanity check======
words: COL name VAL sony black 9 megapixel cyber-shot digital camera dsch50b COL description VAL sony black 9 megapixel cyber-shot digital camera dsch50b 9 megapixels 3.0 ' tilt-up clear photo lcd plus display carl zeiss 15x optical zoom lens 15 mb internal memory versatile long distance flash smart zoom in-camera red-eye correction smile shutter technology face detection in-camera retouching super steadyshot optical image stabilization double anti-blur solution hdtv compatibility nightshot infrared system black finish COL price VAL   [SEP] COL name VAL sony lcs-csq soft cyber-shot camera case lcscsq/b COL description VAL top loading polyamide black COL price VAL  
x: [    0 18047   766 27445   579  6119   909   361 10721 21424  5381    12
 10393  1778  2280   385 12265  1096   428 14857  8194 27445   579  6119
   909   361 10721 21424  5381    12 10393  1778  2280   385 12265  1096
   428   361 10721  1115 41699   155     4   288   128 22136    12   658
   699  1345   784 28690  2704  2332   512   462 20025  3006   379  1178
 17547 21762 10373   379   475   428  3425  3783 16106   251  4472  7462
  2793 21762    11    12 25092  1275    12 20668 14921  6675 27349   806
   652 12673    11    12 25092  5494 12746   154  2422 23789  2459 10120
 17547  2274 29632  1457  1475    12  3662   710  2472  1368   417 18724
 29988   363 10393 30175   467   909  2073 14857   425 27445  1437  1437
     2     2 18047   766 27445   579  6119   784 11365    12 11365  1343
  3793  5381    12 10393  2280   403   784   438  3866 31566    73   428
 14857  8194 27445   299 16761 11424 39522   909 14857   425 27445  1437
  1437     2]
tokens: ['<s>', 'COL', 'Ġname', 'ĠVAL', 'Ġs', 'ony', 'Ġblack', 'Ġ9', 'Ġmeg', 'apixel', 'Ġcyber', '-', 'shot', 'Ġdigital', 'Ġcamera', 'Ġd', 'sch', '50', 'b', 'ĠCOL', 'Ġdescription', 'ĠVAL', 'Ġs', 'ony', 'Ġblack', 'Ġ9', 'Ġmeg', 'apixel', 'Ġcyber', '-', 'shot', 'Ġdigital', 'Ġcamera', 'Ġd', 'sch', '50', 'b', 'Ġ9', 'Ġmeg', 'ap', 'ixels', 'Ġ3', '.', '0', "Ġ'", 'Ġtilt', '-', 'up', 'Ġclear', 'Ġphoto', 'Ġl', 'cd', 'Ġplus', 'Ġdisplay', 'Ġcar', 'l', 'Ġze', 'iss', 'Ġ15', 'x', 'Ġoptical', 'Ġzoom', 'Ġlens', 'Ġ15', 'Ġm', 'b', 'Ġinternal', 'Ġmemory', 'Ġversatile', 'Ġlong', 'Ġdistance', 'Ġflash', 'Ġsmart', 'Ġzoom', 'Ġin', '-', 'camera', 'Ġred', '-', 'eye', 'Ġcorrection', 'Ġsmile', 'Ġshutter', 'Ġtechnology', 'Ġface', 'Ġdetection', 'Ġin', '-', 'camera', 'Ġret', 'ouch', 'ing', 'Ġsuper', 'Ġstead', 'ys', 'hot', 'Ġoptical', 'Ġimage', 'Ġstabilization', 'Ġdouble', 'Ġanti', '-', 'bl', 'ur', 'Ġsolution', 'Ġh', 'd', 'tv', 'Ġcompatibility', 'Ġnight', 'shot', 'Ġinfrared', 'Ġsystem', 'Ġblack', 'Ġfinish', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ', 'Ġ', '</s>', '</s>', 'COL', 'Ġname', 'ĠVAL', 'Ġs', 'ony', 'Ġl', 'cs', '-', 'cs', 'q', 'Ġsoft', 'Ġcyber', '-', 'shot', 'Ġcamera', 'Ġcase', 'Ġl', 'c', 'sc', 'sq', '/', 'b', 'ĠCOL', 'Ġdescription', 'ĠVAL', 'Ġtop', 'Ġloading', 'Ġpoly', 'amide', 'Ġblack', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ', 'Ġ', '</s>']
is_heads: [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
y: 0
tags: 0
mask: tensor([1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1])
seqlen: 158
task_name: Textual/Abt-Buy
=======================
step: 0, task: Textual/Abt-Buy, loss: 0.04843847081065178
step: 10, task: Textual/Abt-Buy, loss: 0.3189878463745117
step: 20, task: Textual/Abt-Buy, loss: 0.12667909264564514
step: 30, task: Textual/Abt-Buy, loss: 0.11533787846565247
step: 40, task: Textual/Abt-Buy, loss: 0.06044593080878258
step: 50, task: Textual/Abt-Buy, loss: 0.2624875009059906
step: 60, task: Textual/Abt-Buy, loss: 0.18453796207904816
step: 70, task: Textual/Abt-Buy, loss: 0.07511498779058456
step: 80, task: Textual/Abt-Buy, loss: 0.17896640300750732
step: 90, task: Textual/Abt-Buy, loss: 0.04606710374355316
step: 100, task: Textual/Abt-Buy, loss: 0.15407659113407135
step: 110, task: Textual/Abt-Buy, loss: 0.07837474346160889
step: 120, task: Textual/Abt-Buy, loss: 0.2909943461418152
step: 130, task: Textual/Abt-Buy, loss: 0.006917260587215424
step: 140, task: Textual/Abt-Buy, loss: 0.09779926389455795
step: 150, task: Textual/Abt-Buy, loss: 0.2571130692958832
step: 160, task: Textual/Abt-Buy, loss: 0.16702687740325928
step: 170, task: Textual/Abt-Buy, loss: 0.04354912042617798
step: 180, task: Textual/Abt-Buy, loss: 0.13117676973342896
step: 190, task: Textual/Abt-Buy, loss: 0.07905644178390503
step: 200, task: Textual/Abt-Buy, loss: 0.1939576268196106
step: 210, task: Textual/Abt-Buy, loss: 0.008255697786808014
step: 220, task: Textual/Abt-Buy, loss: 0.12967893481254578
step: 230, task: Textual/Abt-Buy, loss: 0.09033668041229248
step: 240, task: Textual/Abt-Buy, loss: 0.5081309676170349
step: 250, task: Textual/Abt-Buy, loss: 0.1431570202112198
step: 260, task: Textual/Abt-Buy, loss: 0.2640066146850586
step: 270, task: Textual/Abt-Buy, loss: 0.15580885112285614
step: 280, task: Textual/Abt-Buy, loss: 0.11378032714128494
step: 290, task: Textual/Abt-Buy, loss: 0.1793092042207718
step: 300, task: Textual/Abt-Buy, loss: 0.22487610578536987
step: 310, task: Textual/Abt-Buy, loss: 0.1645982712507248
step: 320, task: Textual/Abt-Buy, loss: 0.017040736973285675
step: 330, task: Textual/Abt-Buy, loss: 0.17649085819721222
step: 340, task: Textual/Abt-Buy, loss: 0.09793303161859512
step: 350, task: Textual/Abt-Buy, loss: 0.17761936783790588
=========eval at epoch=4=========
Validation:
=============Textual/Abt-Buy==================
accuracy=0.912
precision=0.571
recall=0.738
f1=0.644
======================================
Test:
=============Textual/Abt-Buy==================
accuracy=0.931
precision=0.637
recall=0.825
f1=0.719
======================================
=====sanity check======
words: COL name VAL speck seethru blue hard shell case for 15 ' macbook mb15bluseev2 COL description VAL speck seethru blue hard shell case for 15 ' macbook mb15bluseev2 translucent hard plastic shell gives great protection full access to all controls rubber feet for added support blue finish COL price VAL   [SEP] COL name VAL speck products seethru case for apple 13 ' macbook mb13-org-see-v2 COL description VAL plastic orange COL price VAL  
x: [    0 18047   766 27445 25227  2420   842  4774  2070  2440   543 10785
   403    13   379   128 13418  6298   475   428   996  3662  3698  3623
   176 14857  8194 27445 25227  2420   842  4774  2070  2440   543 10785
   403    13   379   128 13418  6298   475   428   996  3662  3698  3623
   176 42026   543  4136 10785  2029   372  2591   455   899     7    70
  5656 11283  1730    13   355   323  2440  2073 14857   425 27445  1437
  1437     2     2 18047   766 27445 25227  2420   785   842  4774  2070
   403    13 15162   508   128 13418  6298   475   428  1558    12  1957
    12  7048    12   705   176 14857  8194 27445  4136  8978 14857   425
 27445  1437  1437     2]
tokens: ['<s>', 'COL', 'Ġname', 'ĠVAL', 'Ġspe', 'ck', 'Ġse', 'eth', 'ru', 'Ġblue', 'Ġhard', 'Ġshell', 'Ġcase', 'Ġfor', 'Ġ15', "Ġ'", 'Ġmac', 'book', 'Ġm', 'b', '15', 'bl', 'use', 'ev', '2', 'ĠCOL', 'Ġdescription', 'ĠVAL', 'Ġspe', 'ck', 'Ġse', 'eth', 'ru', 'Ġblue', 'Ġhard', 'Ġshell', 'Ġcase', 'Ġfor', 'Ġ15', "Ġ'", 'Ġmac', 'book', 'Ġm', 'b', '15', 'bl', 'use', 'ev', '2', 'Ġtranslucent', 'Ġhard', 'Ġplastic', 'Ġshell', 'Ġgives', 'Ġgreat', 'Ġprotection', 'Ġfull', 'Ġaccess', 'Ġto', 'Ġall', 'Ġcontrols', 'Ġrubber', 'Ġfeet', 'Ġfor', 'Ġadded', 'Ġsupport', 'Ġblue', 'Ġfinish', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ', 'Ġ', '</s>', '</s>', 'COL', 'Ġname', 'ĠVAL', 'Ġspe', 'ck', 'Ġproducts', 'Ġse', 'eth', 'ru', 'Ġcase', 'Ġfor', 'Ġapple', 'Ġ13', "Ġ'", 'Ġmac', 'book', 'Ġm', 'b', '13', '-', 'org', '-', 'see', '-', 'v', '2', 'ĠCOL', 'Ġdescription', 'ĠVAL', 'Ġplastic', 'Ġorange', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ', 'Ġ', '</s>']
is_heads: [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
y: 0
tags: 0
mask: tensor([1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1])
seqlen: 112
task_name: Textual/Abt-Buy
=======================
step: 0, task: Textual/Abt-Buy, loss: 0.2200588881969452
step: 10, task: Textual/Abt-Buy, loss: 0.2712211608886719
step: 20, task: Textual/Abt-Buy, loss: 0.07214909046888351
step: 30, task: Textual/Abt-Buy, loss: 0.1565483957529068
step: 40, task: Textual/Abt-Buy, loss: 0.1087116003036499
step: 50, task: Textual/Abt-Buy, loss: 0.09259580820798874
step: 60, task: Textual/Abt-Buy, loss: 0.09086844325065613
step: 70, task: Textual/Abt-Buy, loss: 0.17358587682247162
step: 80, task: Textual/Abt-Buy, loss: 0.04848269000649452
step: 90, task: Textual/Abt-Buy, loss: 0.21684864163398743
step: 100, task: Textual/Abt-Buy, loss: 0.11144393682479858
step: 110, task: Textual/Abt-Buy, loss: 0.026864100247621536
step: 120, task: Textual/Abt-Buy, loss: 0.11170335859060287
step: 130, task: Textual/Abt-Buy, loss: 0.402637243270874
step: 140, task: Textual/Abt-Buy, loss: 0.1804928332567215
step: 150, task: Textual/Abt-Buy, loss: 0.06917218863964081
step: 160, task: Textual/Abt-Buy, loss: 0.03495572507381439
step: 170, task: Textual/Abt-Buy, loss: 0.021459154784679413
step: 180, task: Textual/Abt-Buy, loss: 0.16330695152282715
step: 190, task: Textual/Abt-Buy, loss: 0.27264103293418884
step: 200, task: Textual/Abt-Buy, loss: 0.1195807084441185
step: 210, task: Textual/Abt-Buy, loss: 0.20885807275772095
step: 220, task: Textual/Abt-Buy, loss: 0.22690601646900177
step: 230, task: Textual/Abt-Buy, loss: 0.10576081275939941
step: 240, task: Textual/Abt-Buy, loss: 0.013744242489337921
step: 250, task: Textual/Abt-Buy, loss: 0.10824927687644958
step: 260, task: Textual/Abt-Buy, loss: 0.13593217730522156
step: 270, task: Textual/Abt-Buy, loss: 0.14599843323230743
step: 280, task: Textual/Abt-Buy, loss: 0.299169659614563
step: 290, task: Textual/Abt-Buy, loss: 0.050624050199985504
step: 300, task: Textual/Abt-Buy, loss: 0.14887453615665436
step: 310, task: Textual/Abt-Buy, loss: 0.04588910937309265
step: 320, task: Textual/Abt-Buy, loss: 0.18619249761104584
step: 330, task: Textual/Abt-Buy, loss: 0.22859306633472443
step: 340, task: Textual/Abt-Buy, loss: 0.22590863704681396
step: 350, task: Textual/Abt-Buy, loss: 0.1276475191116333
=========eval at epoch=5=========
Validation:
=============Textual/Abt-Buy==================
accuracy=0.912
precision=0.571
recall=0.738
f1=0.644
======================================
Test:
=============Textual/Abt-Buy==================
accuracy=0.931
precision=0.637
recall=0.825
f1=0.719
======================================
=====sanity check======
words: COL name VAL panasonic countertop microwave oven in stainless steel nnsd667ss COL description VAL panasonic nn-sd667s countertop microwave oven in stainless steel nnsd667ss 1.2 cubic foot 1250 watts high power 10 power levels 5 cooking stages quick minute easy-to-use pop-out dial one-touch sensor cooking inverter turbo defrost multi-lingual menu action screen popcorn key stainless steel finish COL price VAL   [SEP] COL name VAL panasonic nn-c994s genius prestige convection microwave oven with inverter turbo defrost and one-touch sensor cooking , stainless COL description VAL  COL price VAL  
x: [    0 18047   766 27445  5730 38703  3231  8766 28562 12941    11 23486
  3689   295  6852   417 29312  7485 14857  8194 27445  5730 38703   295
   282    12 28045 29312    29  3231  8766 28562 12941    11 23486  3689
   295  6852   417 29312  7485   112     4   176 15768  2767   316  1096
 42574   239   476   158   476  1389   195  6836  5612  2119  2289  1365
    12   560    12  3698  3495    12   995 11481    65    12 26673  9626
  6836 39312  1334 21124  3816 28050  3228    12  1527  5564  5765   814
  2441 26639   762 23486  3689  2073 14857   425 27445  1437  1437     2
     2 18047   766 27445  5730 38703   295   282    12   438 40690    29
 16333 28602 26991 14970 28562 12941    19 39312  1334 21124  3816 28050
     8    65    12 26673  9626  6836  2156 23486 14857  8194 27445  1437
 14857   425 27445  1437  1437     2]
tokens: ['<s>', 'COL', 'Ġname', 'ĠVAL', 'Ġpan', 'asonic', 'Ġcounter', 'top', 'Ġmicrowave', 'Ġoven', 'Ġin', 'Ġstainless', 'Ġsteel', 'Ġn', 'ns', 'd', '667', 'ss', 'ĠCOL', 'Ġdescription', 'ĠVAL', 'Ġpan', 'asonic', 'Ġn', 'n', '-', 'sd', '667', 's', 'Ġcounter', 'top', 'Ġmicrowave', 'Ġoven', 'Ġin', 'Ġstainless', 'Ġsteel', 'Ġn', 'ns', 'd', '667', 'ss', 'Ġ1', '.', '2', 'Ġcubic', 'Ġfoot', 'Ġ12', '50', 'Ġwatts', 'Ġhigh', 'Ġpower', 'Ġ10', 'Ġpower', 'Ġlevels', 'Ġ5', 'Ġcooking', 'Ġstages', 'Ġquick', 'Ġminute', 'Ġeasy', '-', 'to', '-', 'use', 'Ġpop', '-', 'out', 'Ġdial', 'Ġone', '-', 'touch', 'Ġsensor', 'Ġcooking', 'Ġinver', 'ter', 'Ġturbo', 'Ġdef', 'rost', 'Ġmulti', '-', 'ling', 'ual', 'Ġmenu', 'Ġaction', 'Ġscreen', 'Ġpopcorn', 'Ġkey', 'Ġstainless', 'Ġsteel', 'Ġfinish', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ', 'Ġ', '</s>', '</s>', 'COL', 'Ġname', 'ĠVAL', 'Ġpan', 'asonic', 'Ġn', 'n', '-', 'c', '994', 's', 'Ġgenius', 'Ġprestige', 'Ġconve', 'ction', 'Ġmicrowave', 'Ġoven', 'Ġwith', 'Ġinver', 'ter', 'Ġturbo', 'Ġdef', 'rost', 'Ġand', 'Ġone', '-', 'touch', 'Ġsensor', 'Ġcooking', 'Ġ,', 'Ġstainless', 'ĠCOL', 'Ġdescription', 'ĠVAL', 'Ġ', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ', 'Ġ', '</s>']
is_heads: [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
y: 0
tags: 0
mask: tensor([1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1])
seqlen: 138
task_name: Textual/Abt-Buy
=======================
step: 0, task: Textual/Abt-Buy, loss: 0.13149698078632355
step: 10, task: Textual/Abt-Buy, loss: 0.02242058888077736
step: 20, task: Textual/Abt-Buy, loss: 0.04638899117708206
step: 30, task: Textual/Abt-Buy, loss: 0.14546255767345428
step: 40, task: Textual/Abt-Buy, loss: 0.04144582152366638
step: 50, task: Textual/Abt-Buy, loss: 0.12498123198747635
step: 60, task: Textual/Abt-Buy, loss: 0.10071074962615967
step: 70, task: Textual/Abt-Buy, loss: 0.10289055854082108
step: 80, task: Textual/Abt-Buy, loss: 0.04737558960914612
step: 90, task: Textual/Abt-Buy, loss: 0.08181479573249817
step: 100, task: Textual/Abt-Buy, loss: 0.07667969912290573
step: 110, task: Textual/Abt-Buy, loss: 0.39154624938964844
step: 120, task: Textual/Abt-Buy, loss: 0.03002747893333435
step: 130, task: Textual/Abt-Buy, loss: 0.0760049819946289
step: 140, task: Textual/Abt-Buy, loss: 0.09281782060861588
step: 150, task: Textual/Abt-Buy, loss: 0.32069799304008484
step: 160, task: Textual/Abt-Buy, loss: 0.31693166494369507
step: 170, task: Textual/Abt-Buy, loss: 0.08809708058834076
step: 180, task: Textual/Abt-Buy, loss: 0.3079127073287964
step: 190, task: Textual/Abt-Buy, loss: 0.13115543127059937
step: 200, task: Textual/Abt-Buy, loss: 0.10965217649936676
step: 210, task: Textual/Abt-Buy, loss: 0.20136365294456482
step: 220, task: Textual/Abt-Buy, loss: 0.19092383980751038
step: 230, task: Textual/Abt-Buy, loss: 0.09640417993068695
step: 240, task: Textual/Abt-Buy, loss: 0.0793682113289833
step: 250, task: Textual/Abt-Buy, loss: 0.06763715296983719
step: 260, task: Textual/Abt-Buy, loss: 0.20359259843826294
step: 270, task: Textual/Abt-Buy, loss: 0.07243284583091736
step: 280, task: Textual/Abt-Buy, loss: 0.23280061781406403
step: 290, task: Textual/Abt-Buy, loss: 0.2710244357585907
step: 300, task: Textual/Abt-Buy, loss: 0.12776446342468262
step: 310, task: Textual/Abt-Buy, loss: 0.36923331022262573
step: 320, task: Textual/Abt-Buy, loss: 0.039198338985443115
step: 330, task: Textual/Abt-Buy, loss: 0.3670048117637634
step: 340, task: Textual/Abt-Buy, loss: 0.1611253023147583
step: 350, task: Textual/Abt-Buy, loss: 0.02885289490222931
=========eval at epoch=6=========
Validation:
=============Textual/Abt-Buy==================
accuracy=0.912
precision=0.571
recall=0.738
f1=0.644
======================================
Test:
=============Textual/Abt-Buy==================
accuracy=0.931
precision=0.637
recall=0.825
f1=0.719
======================================
=====sanity check======
words: COL name VAL monster mini-to-mini icable for car aicminiip3s COL description VAL monster mini-to-mini icable for car aicminiip3s 3 ft. cable 1/8 mini-jack input for car stereo dual balanced high-purity copper conductors and 24k gold xtra low noise doublehelix construction compatible with apple ipod , iphone , and portable mp3 player white finish COL price VAL 15.0  [SEP] COL name VAL monster cable icable a ic mini ip-3 s audio stereo cable 123870 COL description VAL 1 x mini-phone stereo 1 x mini-phone stereo 3ft COL price VAL  
x: [    0 18047   766 27445 13317  7983    12   560    12 32081 41591   868
    13   512    10   636 32081  1588   246    29 14857  8194 27445 13317
  7983    12   560    12 32081 41591   868    13   512    10   636 32081
  1588   246    29   155 16935     4  6129   112    73   398  7983    12
 23018  8135    13   512 31436  6594  9320   239    12   642 25075  7621
  2883   994     8   706   330  1637  1437 11483   763   614  6496  1457
  4393  3181  1663 16632    19 15162 36180  1630  2156  1437 28778  1264
  2156     8 15295 44857   246   869  1104  2073 14857   425 27445   379
     4   288  1437     2     2 18047   766 27445 13317  6129 41591   868
    10 41591  7983 36180    12   246   579  6086 31436  6129   316  3170
  3083 14857  8194 27445   112  3023  7983    12 17283 31436   112  3023
  7983    12 17283 31436   155  2543 14857   425 27445  1437  1437     2]
tokens: ['<s>', 'COL', 'Ġname', 'ĠVAL', 'Ġmonster', 'Ġmini', '-', 'to', '-', 'mini', 'Ġic', 'able', 'Ġfor', 'Ġcar', 'Ġa', 'ic', 'mini', 'ip', '3', 's', 'ĠCOL', 'Ġdescription', 'ĠVAL', 'Ġmonster', 'Ġmini', '-', 'to', '-', 'mini', 'Ġic', 'able', 'Ġfor', 'Ġcar', 'Ġa', 'ic', 'mini', 'ip', '3', 's', 'Ġ3', 'Ġft', '.', 'Ġcable', 'Ġ1', '/', '8', 'Ġmini', '-', 'jack', 'Ġinput', 'Ġfor', 'Ġcar', 'Ġstereo', 'Ġdual', 'Ġbalanced', 'Ġhigh', '-', 'p', 'urity', 'Ġcopper', 'Ġconduct', 'ors', 'Ġand', 'Ġ24', 'k', 'Ġgold', 'Ġ', 'xt', 'ra', 'Ġlow', 'Ġnoise', 'Ġdouble', 'hel', 'ix', 'Ġconstruction', 'Ġcompatible', 'Ġwith', 'Ġapple', 'Ġip', 'od', 'Ġ,', 'Ġ', 'iph', 'one', 'Ġ,', 'Ġand', 'Ġportable', 'Ġmp', '3', 'Ġplayer', 'Ġwhite', 'Ġfinish', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ15', '.', '0', 'Ġ', '</s>', '</s>', 'COL', 'Ġname', 'ĠVAL', 'Ġmonster', 'Ġcable', 'Ġic', 'able', 'Ġa', 'Ġic', 'Ġmini', 'Ġip', '-', '3', 'Ġs', 'Ġaudio', 'Ġstereo', 'Ġcable', 'Ġ12', '38', '70', 'ĠCOL', 'Ġdescription', 'ĠVAL', 'Ġ1', 'Ġx', 'Ġmini', '-', 'phone', 'Ġstereo', 'Ġ1', 'Ġx', 'Ġmini', '-', 'phone', 'Ġstereo', 'Ġ3', 'ft', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ', 'Ġ', '</s>']
is_heads: [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
y: 1
tags: 1
mask: tensor([1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1])
seqlen: 144
task_name: Textual/Abt-Buy
=======================
step: 0, task: Textual/Abt-Buy, loss: 0.1874314546585083
step: 10, task: Textual/Abt-Buy, loss: 0.07427268475294113
step: 20, task: Textual/Abt-Buy, loss: 0.10898339748382568
step: 30, task: Textual/Abt-Buy, loss: 0.11915827542543411
step: 40, task: Textual/Abt-Buy, loss: 0.17456647753715515
step: 50, task: Textual/Abt-Buy, loss: 0.17237544059753418
step: 60, task: Textual/Abt-Buy, loss: 0.06380053609609604
step: 70, task: Textual/Abt-Buy, loss: 0.4395446181297302
step: 80, task: Textual/Abt-Buy, loss: 0.05009922757744789
step: 90, task: Textual/Abt-Buy, loss: 0.0761130154132843
step: 100, task: Textual/Abt-Buy, loss: 0.11493288725614548
step: 110, task: Textual/Abt-Buy, loss: 0.05889793112874031
step: 120, task: Textual/Abt-Buy, loss: 0.09004843235015869
step: 130, task: Textual/Abt-Buy, loss: 0.0609515905380249
step: 140, task: Textual/Abt-Buy, loss: 0.12746569514274597
step: 150, task: Textual/Abt-Buy, loss: 0.1973414123058319
step: 160, task: Textual/Abt-Buy, loss: 0.1630570888519287
step: 170, task: Textual/Abt-Buy, loss: 0.3426634669303894
step: 180, task: Textual/Abt-Buy, loss: 0.2069419026374817
step: 190, task: Textual/Abt-Buy, loss: 0.08241960406303406
step: 200, task: Textual/Abt-Buy, loss: 0.0703735426068306
step: 210, task: Textual/Abt-Buy, loss: 0.03913920745253563
step: 220, task: Textual/Abt-Buy, loss: 0.0897066667675972
step: 230, task: Textual/Abt-Buy, loss: 0.1589587926864624
step: 240, task: Textual/Abt-Buy, loss: 0.1652054637670517
step: 250, task: Textual/Abt-Buy, loss: 0.182851642370224
step: 260, task: Textual/Abt-Buy, loss: 0.1778116226196289
step: 270, task: Textual/Abt-Buy, loss: 0.3275567293167114
step: 280, task: Textual/Abt-Buy, loss: 0.2693241238594055
step: 290, task: Textual/Abt-Buy, loss: 0.08183436840772629
step: 300, task: Textual/Abt-Buy, loss: 0.1687852442264557
step: 310, task: Textual/Abt-Buy, loss: 0.04117773473262787
step: 320, task: Textual/Abt-Buy, loss: 0.32863134145736694
step: 330, task: Textual/Abt-Buy, loss: 0.06085900217294693
step: 340, task: Textual/Abt-Buy, loss: 0.1222001239657402
step: 350, task: Textual/Abt-Buy, loss: 0.018558189272880554
=========eval at epoch=7=========
Validation:
=============Textual/Abt-Buy==================
accuracy=0.912
precision=0.571
recall=0.738
f1=0.644
======================================
Test:
=============Textual/Abt-Buy==================
accuracy=0.931
precision=0.637
recall=0.825
f1=0.719
======================================
=====sanity check======
words: COL name VAL sony 40 ' bravia z series black lcd flat panel hdtv kdl40z4100b COL description VAL sony 40 ' bravia z series black lcd flat panel hdtv kdl40z4100b 1920 x 1080 full hd 1080p resolution digital media extender ( dmex ) bravia engine technology advanced contrast enhancer ( ace ) enhanced ( xmb ) user interface with rich 3d graphics 24p true cinema black finish COL price VAL   [SEP] COL name VAL sony bravia xbr series kdl-37xbr6 37 ' lcd tv kdl37xbr6 COL description VAL 37 ' active matrix tft atsc , ntsc , ntsc-m 16:9 1920 x 1080 surround hdtv 1080i , 1080p COL price VAL 1197.66 
x: [    0 18047   766 27445   579  6119   843   128 35977   493   992   651
   909   784 28690  3269  2798  1368   417 18724   449 30469  1749   329
   306  1866   428 14857  8194 27445   579  6119   843   128 35977   493
   992   651   909   784 28690  3269  2798  1368   417 18724   449 30469
  1749   329   306  1866   428 18283  3023 21083   455  1368   417 21083
   642  3547  1778   433  8935  7232    36   385   119  3463  4839 35977
   493  3819   806  3319  5709 45378 20126    36  9837  4839  9094    36
  3023  6648  4839  3018 12332    19  4066   155   417 12774   706   642
  1528 11605   909  2073 14857   425 27445  1437  1437     2     2 18047
   766 27445   579  6119 35977   493  3023  3809   651   449 30469    12
  3272  1178  3809   401  2908   128   784 28690 30016   449 30469  3272
  1178  3809   401 14857  8194 27445  2908   128  2171 36173   326  2543
    23  3866  2156   295  1872   438  2156   295  1872   438    12   119
   545    35   466 18283  3023 21083 21104  1368   417 18724 21083   118
  2156 21083   642 14857   425 27445 16491   406     4  4280  1437     2]
tokens: ['<s>', 'COL', 'Ġname', 'ĠVAL', 'Ġs', 'ony', 'Ġ40', "Ġ'", 'Ġbrav', 'ia', 'Ġz', 'Ġseries', 'Ġblack', 'Ġl', 'cd', 'Ġflat', 'Ġpanel', 'Ġh', 'd', 'tv', 'Ġk', 'dl', '40', 'z', '4', '100', 'b', 'ĠCOL', 'Ġdescription', 'ĠVAL', 'Ġs', 'ony', 'Ġ40', "Ġ'", 'Ġbrav', 'ia', 'Ġz', 'Ġseries', 'Ġblack', 'Ġl', 'cd', 'Ġflat', 'Ġpanel', 'Ġh', 'd', 'tv', 'Ġk', 'dl', '40', 'z', '4', '100', 'b', 'Ġ1920', 'Ġx', 'Ġ1080', 'Ġfull', 'Ġh', 'd', 'Ġ1080', 'p', 'Ġresolution', 'Ġdigital', 'Ġmedia', 'Ġext', 'ender', 'Ġ(', 'Ġd', 'm', 'ex', 'Ġ)', 'Ġbrav', 'ia', 'Ġengine', 'Ġtechnology', 'Ġadvanced', 'Ġcontrast', 'Ġenh', 'ancer', 'Ġ(', 'Ġace', 'Ġ)', 'Ġenhanced', 'Ġ(', 'Ġx', 'mb', 'Ġ)', 'Ġuser', 'Ġinterface', 'Ġwith', 'Ġrich', 'Ġ3', 'd', 'Ġgraphics', 'Ġ24', 'p', 'Ġtrue', 'Ġcinema', 'Ġblack', 'Ġfinish', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ', 'Ġ', '</s>', '</s>', 'COL', 'Ġname', 'ĠVAL', 'Ġs', 'ony', 'Ġbrav', 'ia', 'Ġx', 'br', 'Ġseries', 'Ġk', 'dl', '-', '37', 'x', 'br', '6', 'Ġ37', "Ġ'", 'Ġl', 'cd', 'Ġtv', 'Ġk', 'dl', '37', 'x', 'br', '6', 'ĠCOL', 'Ġdescription', 'ĠVAL', 'Ġ37', "Ġ'", 'Ġactive', 'Ġmatrix', 'Ġt', 'ft', 'Ġat', 'sc', 'Ġ,', 'Ġn', 'ts', 'c', 'Ġ,', 'Ġn', 'ts', 'c', '-', 'm', 'Ġ16', ':', '9', 'Ġ1920', 'Ġx', 'Ġ1080', 'Ġsurround', 'Ġh', 'd', 'tv', 'Ġ1080', 'i', 'Ġ,', 'Ġ1080', 'p', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ119', '7', '.', '66', 'Ġ', '</s>']
is_heads: [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
y: 0
tags: 0
mask: tensor([1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1])
seqlen: 180
task_name: Textual/Abt-Buy
=======================
step: 0, task: Textual/Abt-Buy, loss: 0.060867972671985626
step: 10, task: Textual/Abt-Buy, loss: 0.10590333491563797
step: 20, task: Textual/Abt-Buy, loss: 0.0544595941901207
step: 30, task: Textual/Abt-Buy, loss: 0.20403245091438293
step: 40, task: Textual/Abt-Buy, loss: 0.09215768426656723
step: 50, task: Textual/Abt-Buy, loss: 0.6312360167503357
step: 60, task: Textual/Abt-Buy, loss: 0.10864943265914917
step: 70, task: Textual/Abt-Buy, loss: 0.09736207127571106
step: 80, task: Textual/Abt-Buy, loss: 0.21767762303352356
step: 90, task: Textual/Abt-Buy, loss: 0.27659112215042114
step: 100, task: Textual/Abt-Buy, loss: 0.10210438072681427
step: 110, task: Textual/Abt-Buy, loss: 0.17924565076828003
step: 120, task: Textual/Abt-Buy, loss: 0.17188021540641785
step: 130, task: Textual/Abt-Buy, loss: 0.25003519654273987
step: 140, task: Textual/Abt-Buy, loss: 0.13732631504535675
step: 150, task: Textual/Abt-Buy, loss: 0.07142666727304459
step: 160, task: Textual/Abt-Buy, loss: 0.18885035812854767
step: 170, task: Textual/Abt-Buy, loss: 0.08769014477729797
step: 180, task: Textual/Abt-Buy, loss: 0.1380997598171234
step: 190, task: Textual/Abt-Buy, loss: 0.09451168030500412
step: 200, task: Textual/Abt-Buy, loss: 0.03541434183716774
step: 210, task: Textual/Abt-Buy, loss: 0.18410614132881165
step: 220, task: Textual/Abt-Buy, loss: 0.13501277565956116
step: 230, task: Textual/Abt-Buy, loss: 0.08986882120370865
step: 240, task: Textual/Abt-Buy, loss: 0.15423965454101562
step: 250, task: Textual/Abt-Buy, loss: 0.07633199542760849
step: 260, task: Textual/Abt-Buy, loss: 0.07647863030433655
step: 270, task: Textual/Abt-Buy, loss: 0.02457728236913681
step: 280, task: Textual/Abt-Buy, loss: 0.11759816110134125
step: 290, task: Textual/Abt-Buy, loss: 0.11318695545196533
step: 300, task: Textual/Abt-Buy, loss: 0.28798961639404297
step: 310, task: Textual/Abt-Buy, loss: 0.7132188081741333
step: 320, task: Textual/Abt-Buy, loss: 0.2425737977027893
step: 330, task: Textual/Abt-Buy, loss: 0.2230815291404724
step: 340, task: Textual/Abt-Buy, loss: 0.10720241814851761
step: 350, task: Textual/Abt-Buy, loss: 0.045024845749139786
=========eval at epoch=8=========
Validation:
=============Textual/Abt-Buy==================
accuracy=0.912
precision=0.571
recall=0.738
f1=0.644
======================================
Test:
=============Textual/Abt-Buy==================
accuracy=0.931
precision=0.637
recall=0.825
f1=0.719
======================================
Selected optimization level O2:  FP16 training with FP32 batchnorm and FP32 master weights.

Defaults for this optimization level are:
enabled                : True
opt_level              : O2
cast_model_type        : torch.float16
patch_torch_functions  : False
keep_batchnorm_fp32    : True
master_weights         : True
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O2
cast_model_type        : torch.float16
patch_torch_functions  : False
keep_batchnorm_fp32    : True
master_weights         : True
loss_scale             : dynamic
Warning:  multi_tensor_applier fused unscale kernel is unavailable, possibly because apex was installed without --cuda_ext --cpp_ext. Using Python fallback.  Original ImportError was: ModuleNotFoundError("No module named 'amp_C'")
=====sanity check======
words: COL name VAL lg 5.6 cu . ft. white freestanding electric range lre30453wh COL description VAL lg 5.6 cu . ft. white freestanding electric range lre30453wh intuitouch control system evenjet convection system 5.6 cubic capacity wideview oven window 5 radiant elements 25 heating settings white finish COL price VAL   [SEP] COL name VAL lg 5.6 cu.ft . freestanding electric range COL description VAL  COL price VAL  
x: [    0 18047   766 27445   784   571   195     4   401  3729   479 16935
     4  1104  7619   990 20515  3459  1186   784   241   541 35261 11613
 14857  8194 27445   784   571   195     4   401  3729   479 16935     4
  1104  7619   990 20515  3459  1186   784   241   541 35261 11613  6979
  6439 12746   797   467   190  6622 26991 14970   467   195     4   401
 15768  2148  1810  5877 12941  2931   195 35787  4785   564 11545  9629
  1104  2073 14857   425 27445  1437  1437     2     2 18047   766 27445
   784   571   195     4   401  3729     4  2543   479  7619   990 20515
  3459  1186 14857  8194 27445  1437 14857   425 27445  1437  1437     2]
tokens: ['<s>', 'COL', 'Ġname', 'ĠVAL', 'Ġl', 'g', 'Ġ5', '.', '6', 'Ġcu', 'Ġ.', 'Ġft', '.', 'Ġwhite', 'Ġfre', 'est', 'anding', 'Ġelectric', 'Ġrange', 'Ġl', 're', '30', '453', 'wh', 'ĠCOL', 'Ġdescription', 'ĠVAL', 'Ġl', 'g', 'Ġ5', '.', '6', 'Ġcu', 'Ġ.', 'Ġft', '.', 'Ġwhite', 'Ġfre', 'est', 'anding', 'Ġelectric', 'Ġrange', 'Ġl', 're', '30', '453', 'wh', 'Ġint', 'uit', 'ouch', 'Ġcontrol', 'Ġsystem', 'Ġeven', 'jet', 'Ġconve', 'ction', 'Ġsystem', 'Ġ5', '.', '6', 'Ġcubic', 'Ġcapacity', 'Ġwide', 'view', 'Ġoven', 'Ġwindow', 'Ġ5', 'Ġradiant', 'Ġelements', 'Ġ25', 'Ġheating', 'Ġsettings', 'Ġwhite', 'Ġfinish', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ', 'Ġ', '</s>', '</s>', 'COL', 'Ġname', 'ĠVAL', 'Ġl', 'g', 'Ġ5', '.', '6', 'Ġcu', '.', 'ft', 'Ġ.', 'Ġfre', 'est', 'anding', 'Ġelectric', 'Ġrange', 'ĠCOL', 'Ġdescription', 'ĠVAL', 'Ġ', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ', 'Ġ', '</s>']
is_heads: [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
y: 1
tags: 1
mask: tensor([1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1])
seqlen: 108
task_name: Textual/Abt-Buy
=======================
step: 0, task: Textual/Abt-Buy, loss: 0.5227667093276978
Gradient overflow.  Skipping step, loss scaler 0 reducing loss scale to 32768.0
Gradient overflow.  Skipping step, loss scaler 0 reducing loss scale to 16384.0
step: 10, task: Textual/Abt-Buy, loss: 0.42988449335098267
step: 20, task: Textual/Abt-Buy, loss: 0.341724157333374
step: 30, task: Textual/Abt-Buy, loss: 0.4612433612346649
step: 40, task: Textual/Abt-Buy, loss: 0.29396477341651917
Gradient overflow.  Skipping step, loss scaler 0 reducing loss scale to 8192.0
step: 50, task: Textual/Abt-Buy, loss: 0.4042147397994995
step: 60, task: Textual/Abt-Buy, loss: 0.29391658306121826
step: 70, task: Textual/Abt-Buy, loss: 0.0971384197473526
step: 80, task: Textual/Abt-Buy, loss: 0.40943682193756104
step: 90, task: Textual/Abt-Buy, loss: 0.230078786611557
step: 100, task: Textual/Abt-Buy, loss: 0.21480077505111694
step: 110, task: Textual/Abt-Buy, loss: 0.2390064001083374
step: 120, task: Textual/Abt-Buy, loss: 0.3319805860519409
step: 130, task: Textual/Abt-Buy, loss: 0.2517612874507904
step: 140, task: Textual/Abt-Buy, loss: 0.39473602175712585
step: 150, task: Textual/Abt-Buy, loss: 0.3725513517856598
step: 160, task: Textual/Abt-Buy, loss: 0.24904483556747437
step: 170, task: Textual/Abt-Buy, loss: 0.33305928111076355
step: 180, task: Textual/Abt-Buy, loss: 0.27954745292663574
step: 190, task: Textual/Abt-Buy, loss: 0.30881381034851074
step: 200, task: Textual/Abt-Buy, loss: 0.4444595277309418
step: 210, task: Textual/Abt-Buy, loss: 0.8532902002334595
step: 220, task: Textual/Abt-Buy, loss: 0.4245172142982483
step: 230, task: Textual/Abt-Buy, loss: 0.5084046125411987
step: 240, task: Textual/Abt-Buy, loss: 0.12630170583724976
step: 250, task: Textual/Abt-Buy, loss: 0.09094420820474625
step: 260, task: Textual/Abt-Buy, loss: 0.23713982105255127
step: 270, task: Textual/Abt-Buy, loss: 0.2561476230621338
step: 280, task: Textual/Abt-Buy, loss: 0.10460247099399567
step: 290, task: Textual/Abt-Buy, loss: 0.0792640969157219
step: 300, task: Textual/Abt-Buy, loss: 0.21742382645606995
step: 310, task: Textual/Abt-Buy, loss: 0.2715815603733063
step: 320, task: Textual/Abt-Buy, loss: 0.4313001334667206
step: 330, task: Textual/Abt-Buy, loss: 0.359586238861084
step: 340, task: Textual/Abt-Buy, loss: 0.21133014559745789
step: 350, task: Textual/Abt-Buy, loss: 1.0591108798980713
=========eval at epoch=1=========
Validation:
=============Textual/Abt-Buy==================
accuracy=0.892
precision=0.000
recall=0.000
f1=0.000
======================================
Test:
=============Textual/Abt-Buy==================
accuracy=0.892
precision=0.000
recall=0.000
f1=0.000
======================================
/w/246/tianyu2020/miniconda2/envs/ditto/lib/python3.7/site-packages/apex/amp/_initialize.py:24: UserWarning: An input tensor was not cuda.
  warnings.warn("An input tensor was not cuda.")
/w/246/tianyu2020/miniconda2/envs/ditto/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1221: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
=====sanity check======
words: COL name VAL transcend 133x high-speed 8gb compact flash card ts8gcf133 COL description VAL transcend 133x high-speed 8gb compact flash card ts8gcf133 21.5 mb per sec . data transfer rate dual-channel support multi-platform compatibility supports ultra dma mode 0-4 low power consumption COL price VAL 38.0  [SEP] COL name VAL transcend 4gb compactflash card ( 133x ) ts4gcf133 COL description VAL transcend 4gb compactflash memory card ( 133x ) COL price VAL  
x: [    0 18047   766 27445 32539 21448  1178   239    12  8619   290 19562
 12549  7462  1886 42270   398   571 19911 25037 14857  8194 27445 32539
 21448  1178   239    12  8619   290 19562 12549  7462  1886 42270   398
   571 19911 25037   733     4   245   475   428   228 15636   479   414
  2937   731  6594    12 27681   323  3228    12 29912 29988  4548  9620
   385  1916  5745   321    12   306   614   476  4850 14857   425 27445
  2843     4   288  1437     2     2 18047   766 27445 32539   204 19562
 12549 39837  1886    36 21448  1178  4839 42270   306   571 19911 25037
 14857  8194 27445 32539   204 19562 12549 39837  3783  1886    36 21448
  1178  4839 14857   425 27445  1437  1437     2]
tokens: ['<s>', 'COL', 'Ġname', 'ĠVAL', 'Ġtranscend', 'Ġ133', 'x', 'Ġhigh', '-', 'speed', 'Ġ8', 'gb', 'Ġcompact', 'Ġflash', 'Ġcard', 'Ġts', '8', 'g', 'cf', '133', 'ĠCOL', 'Ġdescription', 'ĠVAL', 'Ġtranscend', 'Ġ133', 'x', 'Ġhigh', '-', 'speed', 'Ġ8', 'gb', 'Ġcompact', 'Ġflash', 'Ġcard', 'Ġts', '8', 'g', 'cf', '133', 'Ġ21', '.', '5', 'Ġm', 'b', 'Ġper', 'Ġsec', 'Ġ.', 'Ġdata', 'Ġtransfer', 'Ġrate', 'Ġdual', '-', 'channel', 'Ġsupport', 'Ġmulti', '-', 'platform', 'Ġcompatibility', 'Ġsupports', 'Ġultra', 'Ġd', 'ma', 'Ġmode', 'Ġ0', '-', '4', 'Ġlow', 'Ġpower', 'Ġconsumption', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ38', '.', '0', 'Ġ', '</s>', '</s>', 'COL', 'Ġname', 'ĠVAL', 'Ġtranscend', 'Ġ4', 'gb', 'Ġcompact', 'flash', 'Ġcard', 'Ġ(', 'Ġ133', 'x', 'Ġ)', 'Ġts', '4', 'g', 'cf', '133', 'ĠCOL', 'Ġdescription', 'ĠVAL', 'Ġtranscend', 'Ġ4', 'gb', 'Ġcompact', 'flash', 'Ġmemory', 'Ġcard', 'Ġ(', 'Ġ133', 'x', 'Ġ)', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ', 'Ġ', '</s>']
is_heads: [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
y: 0
tags: 0
mask: tensor([1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1])
seqlen: 116
task_name: Textual/Abt-Buy
=======================
step: 0, task: Textual/Abt-Buy, loss: 0.30547159910202026
step: 10, task: Textual/Abt-Buy, loss: 0.7954407930374146
step: 20, task: Textual/Abt-Buy, loss: 0.5204582214355469
step: 30, task: Textual/Abt-Buy, loss: 0.575109601020813
step: 40, task: Textual/Abt-Buy, loss: 0.7204190492630005
step: 50, task: Textual/Abt-Buy, loss: 0.3691504895687103
step: 60, task: Textual/Abt-Buy, loss: 0.45548123121261597
step: 70, task: Textual/Abt-Buy, loss: 0.48006296157836914
step: 80, task: Textual/Abt-Buy, loss: 0.13360008597373962
step: 90, task: Textual/Abt-Buy, loss: 0.39075908064842224
step: 100, task: Textual/Abt-Buy, loss: 0.4042975902557373
step: 110, task: Textual/Abt-Buy, loss: 0.23665468394756317
step: 120, task: Textual/Abt-Buy, loss: 0.2780480980873108
step: 130, task: Textual/Abt-Buy, loss: 0.5364695191383362
step: 140, task: Textual/Abt-Buy, loss: 0.28436416387557983
step: 150, task: Textual/Abt-Buy, loss: 0.1622849404811859
step: 160, task: Textual/Abt-Buy, loss: 0.07838262617588043
step: 170, task: Textual/Abt-Buy, loss: 0.16787628829479218
step: 180, task: Textual/Abt-Buy, loss: 0.2352355569601059
step: 190, task: Textual/Abt-Buy, loss: 0.20795677602291107
step: 200, task: Textual/Abt-Buy, loss: 0.23177456855773926
step: 210, task: Textual/Abt-Buy, loss: 0.1141907274723053
step: 220, task: Textual/Abt-Buy, loss: 0.020756781101226807
step: 230, task: Textual/Abt-Buy, loss: 0.1519748866558075
step: 240, task: Textual/Abt-Buy, loss: 0.15407207608222961
step: 250, task: Textual/Abt-Buy, loss: 0.04406341165304184
step: 260, task: Textual/Abt-Buy, loss: 0.16288335621356964
step: 270, task: Textual/Abt-Buy, loss: 0.2436417043209076
step: 280, task: Textual/Abt-Buy, loss: 0.2010345309972763
step: 290, task: Textual/Abt-Buy, loss: 0.0593094639480114
step: 300, task: Textual/Abt-Buy, loss: 0.03179588541388512
step: 310, task: Textual/Abt-Buy, loss: 0.06605733931064606
step: 320, task: Textual/Abt-Buy, loss: 0.042126208543777466
step: 330, task: Textual/Abt-Buy, loss: 0.09037399291992188
step: 340, task: Textual/Abt-Buy, loss: 0.0585140585899353
step: 350, task: Textual/Abt-Buy, loss: 0.07967352122068405
=========eval at epoch=1=========
Validation:
=============Textual/Abt-Buy==================
accuracy=0.928
precision=0.879
recall=0.388
f1=0.539
======================================
Test:
=============Textual/Abt-Buy==================
accuracy=0.919
precision=0.868
recall=0.286
f1=0.431
======================================
=====sanity check======
words: COL name VAL samsung black blu-ray disc player bdp2500 COL description VAL samsung black blu-ray disc player bdp2500 full hd 1080p bd live 2.0 ready netflix instant streaming ready ethernet and usb for firmware upgrades dolby digital plus , dolby digital true-hd dts-hd upgradable hdmi-cec ( anynet + ) usb 2.0 black finish COL price VAL   [SEP] COL name VAL sony bdp-s550 blu-ray dvd player COL description VAL  COL price VAL 322.7 
x: [    0 18047   766 27445   579 48545   909 42034    12  5022  9553   869
   741 43923 41374 14857  8194 27445   579 48545   909 42034    12  5022
  9553   869   741 43923 41374   455  1368   417 21083   642   741   417
   697   132     4   288  1227  1161 47274 10062  5230  1227 41014  4135
     8 49030    13 34569 11500   385  1168  1409  1778  2704  2156   385
  1168  1409  1778  1528    12 35905   385  1872    12 35905 44126   625
   868  1368   417  5408    12  1755   438    36   143  4135  2055  4839
 49030   132     4   288   909  2073 14857   425 27445  1437  1437     2
     2 18047   766 27445   579  6119   741 43923    12    29 17953 42034
    12  5022   385 40311   869 14857  8194 27445  1437 14857   425 27445
 37244     4   406  1437     2]
tokens: ['<s>', 'COL', 'Ġname', 'ĠVAL', 'Ġs', 'amsung', 'Ġblack', 'Ġblu', '-', 'ray', 'Ġdisc', 'Ġplayer', 'Ġb', 'dp', '2500', 'ĠCOL', 'Ġdescription', 'ĠVAL', 'Ġs', 'amsung', 'Ġblack', 'Ġblu', '-', 'ray', 'Ġdisc', 'Ġplayer', 'Ġb', 'dp', '2500', 'Ġfull', 'Ġh', 'd', 'Ġ1080', 'p', 'Ġb', 'd', 'Ġlive', 'Ġ2', '.', '0', 'Ġready', 'Ġnet', 'flix', 'Ġinstant', 'Ġstreaming', 'Ġready', 'Ġether', 'net', 'Ġand', 'Ġusb', 'Ġfor', 'Ġfirmware', 'Ġupgrades', 'Ġd', 'ol', 'by', 'Ġdigital', 'Ġplus', 'Ġ,', 'Ġd', 'ol', 'by', 'Ġdigital', 'Ġtrue', '-', 'hd', 'Ġd', 'ts', '-', 'hd', 'Ġupgr', 'ad', 'able', 'Ġh', 'd', 'mi', '-', 'ce', 'c', 'Ġ(', 'Ġany', 'net', 'Ġ+', 'Ġ)', 'Ġusb', 'Ġ2', '.', '0', 'Ġblack', 'Ġfinish', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ', 'Ġ', '</s>', '</s>', 'COL', 'Ġname', 'ĠVAL', 'Ġs', 'ony', 'Ġb', 'dp', '-', 's', '550', 'Ġblu', '-', 'ray', 'Ġd', 'vd', 'Ġplayer', 'ĠCOL', 'Ġdescription', 'ĠVAL', 'Ġ', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ322', '.', '7', 'Ġ', '</s>']
is_heads: [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
y: 0
tags: 0
mask: tensor([1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1])
seqlen: 125
task_name: Textual/Abt-Buy
=======================
step: 0, task: Textual/Abt-Buy, loss: 0.4330568313598633
step: 10, task: Textual/Abt-Buy, loss: 0.13737176358699799
step: 20, task: Textual/Abt-Buy, loss: 0.02412860095500946
step: 30, task: Textual/Abt-Buy, loss: 0.2524256706237793
step: 40, task: Textual/Abt-Buy, loss: 0.01584375649690628
step: 50, task: Textual/Abt-Buy, loss: 0.025272369384765625
step: 60, task: Textual/Abt-Buy, loss: 0.08757980167865753
step: 70, task: Textual/Abt-Buy, loss: 0.020969778299331665
step: 80, task: Textual/Abt-Buy, loss: 0.04911109432578087
step: 90, task: Textual/Abt-Buy, loss: 0.06062096357345581
step: 100, task: Textual/Abt-Buy, loss: 0.33790385723114014
step: 110, task: Textual/Abt-Buy, loss: 0.12524771690368652
step: 120, task: Textual/Abt-Buy, loss: 0.04432469606399536
step: 130, task: Textual/Abt-Buy, loss: 0.14605659246444702
step: 140, task: Textual/Abt-Buy, loss: 0.09627009928226471
step: 150, task: Textual/Abt-Buy, loss: 0.0965636596083641
step: 160, task: Textual/Abt-Buy, loss: 0.004913821816444397
step: 170, task: Textual/Abt-Buy, loss: 0.05855075269937515
step: 180, task: Textual/Abt-Buy, loss: 0.034944433718919754
step: 190, task: Textual/Abt-Buy, loss: 0.805473804473877
step: 200, task: Textual/Abt-Buy, loss: 0.12497743219137192
step: 210, task: Textual/Abt-Buy, loss: 0.28413957357406616
step: 220, task: Textual/Abt-Buy, loss: 0.042125094681978226
step: 230, task: Textual/Abt-Buy, loss: 0.028963737189769745
step: 240, task: Textual/Abt-Buy, loss: 0.08036261051893234
step: 250, task: Textual/Abt-Buy, loss: 0.13207171857357025
step: 260, task: Textual/Abt-Buy, loss: 0.2928253412246704
step: 270, task: Textual/Abt-Buy, loss: 0.041306979954242706
step: 280, task: Textual/Abt-Buy, loss: 0.0417604073882103
step: 290, task: Textual/Abt-Buy, loss: 0.03021237999200821
step: 300, task: Textual/Abt-Buy, loss: 0.27109262347221375
step: 310, task: Textual/Abt-Buy, loss: 0.04764002189040184
step: 320, task: Textual/Abt-Buy, loss: 0.01259119063615799
step: 330, task: Textual/Abt-Buy, loss: 0.2802842855453491
step: 340, task: Textual/Abt-Buy, loss: 0.043983105570077896
step: 350, task: Textual/Abt-Buy, loss: 0.009473368525505066
=========eval at epoch=2=========
Validation:
=============Textual/Abt-Buy==================
accuracy=0.940
precision=0.925
recall=0.481
f1=0.633
======================================
Test:
=============Textual/Abt-Buy==================
accuracy=0.944
precision=0.908
recall=0.529
f1=0.669
======================================
=====sanity check======
words: COL name VAL sony vaio cs series red notebook computer vgncs110er COL description VAL sony vaio cs series red notebook computer vgncs110er 2.0 ghz intel core 2 duo processor t5800 14.1 ' ( 1280 x 800 ) xbrite-eco widescreen display 250gb serial ata 5400rpm hard drive built-in 1.3 megapixel motion eye camera and microphone 3gb pc2-6400 ( 2gbx1 + 1gbx1 ) installed memory integrated stereo a2dp bluetooth 800mhz front side bus speed 2mb l2 cache genuine microsoft windows vista home premium 32-bit with sp1 red finish COL price VAL   [SEP] COL name VAL sony z550n/b notebook vgnz550n/b COL description VAL sony vaio z550n/b intel centrino 2 core 2 duo p8600 2.40 ghz notebook 3gb ddr3 sdram , 250gb sata hd , 13.1 ' lcd , dvdr dl/dvdrw/ram , modem , gigabit nic , 802.11 a/b/g / n , sprint mobile , bluetooth , vista business sp1/xp downgrade COL price VAL  
x: [    0 18047   766 27445   579  6119 13205  1020 42123   651  1275 27276
  3034   748 16993 11365 11670   254 14857  8194 27445   579  6119 13205
  1020 42123   651  1275 27276  3034   748 16993 11365 11670   254   132
     4   288 34648   329 33238  2731   132  6458 10655   326  4432   612
   501     4   134   128    36 45576  3023  5735  4839  3023  3809  1459
    12 30701   885  4376 37346  2332  5773 19562 13603    23   102   195
  4017 43773   543  1305  1490    12   179   112     4   246 10721 21424
  4298  2295  2280     8 18896   155 19562 46213   176    12  4027   612
    36   132 19562  1178   134  2055   112 19562  1178   134  4839  5923
  3783  6818 31436    10   176 43923 42034 44969  5735   119 39569   760
   526  2353  2078   132  6648   784   176 30283  8916  5177 24810  6410
   748  6377   184  4549     2     2 18047   766 27445   579  6119   992
 17953   282    73   428 27276   748 16993   329 17953   282    73   428
 14857  8194 27445   579  6119 13205  1020   992 17953   282    73   428
 33238 41248  1696   132  2731   132  6458   181  5334   612   132     4
  1749 34648   329 27276   155 19562   385 10232   246 46409  4040  2156
  5773 19562   579  2186  1368   417  2156   508     4   134   128   784
 28690  2156   385   705 10232   385   462    73   417   705 10232   605
    73  4040  2156 38533  2156 10196 30820 18657  2156 31551     4  1225
    10    73   428    73   571  1589   295  2156 12631  1830  2156 42034
 44969  2156   748  6377   265  2292   134    73 44813 19637 14857   425
 27445  1437  1437     2]
tokens: ['<s>', 'COL', 'Ġname', 'ĠVAL', 'Ġs', 'ony', 'Ġva', 'io', 'Ġcs', 'Ġseries', 'Ġred', 'Ġnotebook', 'Ġcomputer', 'Ġv', 'gn', 'cs', '110', 'er', 'ĠCOL', 'Ġdescription', 'ĠVAL', 'Ġs', 'ony', 'Ġva', 'io', 'Ġcs', 'Ġseries', 'Ġred', 'Ġnotebook', 'Ġcomputer', 'Ġv', 'gn', 'cs', '110', 'er', 'Ġ2', '.', '0', 'Ġgh', 'z', 'Ġintel', 'Ġcore', 'Ġ2', 'Ġduo', 'Ġprocessor', 'Ġt', '58', '00', 'Ġ14', '.', '1', "Ġ'", 'Ġ(', 'Ġ1280', 'Ġx', 'Ġ800', 'Ġ)', 'Ġx', 'br', 'ite', '-', 'eco', 'Ġw', 'ides', 'creen', 'Ġdisplay', 'Ġ250', 'gb', 'Ġserial', 'Ġat', 'a', 'Ġ5', '400', 'rpm', 'Ġhard', 'Ġdrive', 'Ġbuilt', '-', 'in', 'Ġ1', '.', '3', 'Ġmeg', 'apixel', 'Ġmotion', 'Ġeye', 'Ġcamera', 'Ġand', 'Ġmicrophone', 'Ġ3', 'gb', 'Ġpc', '2', '-', '64', '00', 'Ġ(', 'Ġ2', 'gb', 'x', '1', 'Ġ+', 'Ġ1', 'gb', 'x', '1', 'Ġ)', 'Ġinstalled', 'Ġmemory', 'Ġintegrated', 'Ġstereo', 'Ġa', '2', 'dp', 'Ġblu', 'etooth', 'Ġ800', 'm', 'hz', 'Ġfront', 'Ġside', 'Ġbus', 'Ġspeed', 'Ġ2', 'mb', 'Ġl', '2', 'Ġcache', 'Ġgenuine', 'Ġmicro', 'soft', 'Ġwindows', 'Ġv', 'ista', 'Ġhome', 'Ġpremium', '</s>', '</s>', 'COL', 'Ġname', 'ĠVAL', 'Ġs', 'ony', 'Ġz', '550', 'n', '/', 'b', 'Ġnotebook', 'Ġv', 'gn', 'z', '550', 'n', '/', 'b', 'ĠCOL', 'Ġdescription', 'ĠVAL', 'Ġs', 'ony', 'Ġva', 'io', 'Ġz', '550', 'n', '/', 'b', 'Ġintel', 'Ġcentr', 'ino', 'Ġ2', 'Ġcore', 'Ġ2', 'Ġduo', 'Ġp', '86', '00', 'Ġ2', '.', '40', 'Ġgh', 'z', 'Ġnotebook', 'Ġ3', 'gb', 'Ġd', 'dr', '3', 'Ġsd', 'ram', 'Ġ,', 'Ġ250', 'gb', 'Ġs', 'ata', 'Ġh', 'd', 'Ġ,', 'Ġ13', '.', '1', "Ġ'", 'Ġl', 'cd', 'Ġ,', 'Ġd', 'v', 'dr', 'Ġd', 'l', '/', 'd', 'v', 'dr', 'w', '/', 'ram', 'Ġ,', 'Ġmodem', 'Ġ,', 'Ġgig', 'abit', 'Ġnic', 'Ġ,', 'Ġ802', '.', '11', 'Ġa', '/', 'b', '/', 'g', 'Ġ/', 'Ġn', 'Ġ,', 'Ġsprint', 'Ġmobile', 'Ġ,', 'Ġblu', 'etooth', 'Ġ,', 'Ġv', 'ista', 'Ġbusiness', 'Ġsp', '1', '/', 'xp', 'Ġdowngrade', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ', 'Ġ', '</s>']
is_heads: [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
y: 0
tags: 0
mask: tensor([1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1])
seqlen: 256
task_name: Textual/Abt-Buy
=======================
step: 0, task: Textual/Abt-Buy, loss: 0.03221965581178665
step: 10, task: Textual/Abt-Buy, loss: 0.04100361838936806
step: 20, task: Textual/Abt-Buy, loss: 0.005531862378120422
step: 30, task: Textual/Abt-Buy, loss: 0.005862638354301453
step: 40, task: Textual/Abt-Buy, loss: 0.23477007448673248
step: 50, task: Textual/Abt-Buy, loss: 0.017100531607866287
step: 60, task: Textual/Abt-Buy, loss: 0.012011781334877014
step: 70, task: Textual/Abt-Buy, loss: 0.004012957215309143
step: 80, task: Textual/Abt-Buy, loss: 0.03632410615682602
step: 90, task: Textual/Abt-Buy, loss: 0.144084170460701
step: 100, task: Textual/Abt-Buy, loss: 0.00330546498298645
step: 110, task: Textual/Abt-Buy, loss: 0.1739795207977295
step: 120, task: Textual/Abt-Buy, loss: 0.00548708438873291
step: 130, task: Textual/Abt-Buy, loss: 0.011668823659420013
step: 140, task: Textual/Abt-Buy, loss: 0.012570194900035858
step: 150, task: Textual/Abt-Buy, loss: 0.01919516921043396
step: 160, task: Textual/Abt-Buy, loss: 0.005929470062255859
step: 170, task: Textual/Abt-Buy, loss: 0.04212609678506851
step: 180, task: Textual/Abt-Buy, loss: 0.028403379023075104
step: 190, task: Textual/Abt-Buy, loss: 0.13849398493766785
step: 200, task: Textual/Abt-Buy, loss: 0.10581468790769577
step: 210, task: Textual/Abt-Buy, loss: 0.0684070885181427
step: 220, task: Textual/Abt-Buy, loss: 0.009527914226055145
step: 230, task: Textual/Abt-Buy, loss: 0.21216724812984467
step: 240, task: Textual/Abt-Buy, loss: 0.14471948146820068
step: 250, task: Textual/Abt-Buy, loss: 0.1933581531047821
step: 260, task: Textual/Abt-Buy, loss: 0.06254692375659943
step: 270, task: Textual/Abt-Buy, loss: 0.005646854639053345
step: 280, task: Textual/Abt-Buy, loss: 0.0738096535205841
step: 290, task: Textual/Abt-Buy, loss: 0.04355502128601074
step: 300, task: Textual/Abt-Buy, loss: 0.11246929317712784
step: 310, task: Textual/Abt-Buy, loss: 0.005206339061260223
step: 320, task: Textual/Abt-Buy, loss: 0.005120381712913513
step: 330, task: Textual/Abt-Buy, loss: 0.09026269614696503
step: 340, task: Textual/Abt-Buy, loss: 0.05872615426778793
step: 350, task: Textual/Abt-Buy, loss: 0.09533856809139252
=========eval at epoch=3=========
Validation:
=============Textual/Abt-Buy==================
accuracy=0.934
precision=0.976
recall=0.393
f1=0.561
======================================
Test:
=============Textual/Abt-Buy==================
accuracy=0.945
precision=0.981
recall=0.495
f1=0.658
======================================
=====sanity check======
words: COL name VAL sony scph-98046 playstation 3 blu-ray dvd remote control 711719804604 COL description VAL sony scph-98046 playstation 3 blu-ray dvd remote control 711719804604 full access to the playstation 3 systems disc features can be used without having to point directly at the system COL price VAL 24.99  [SEP] COL name VAL sony learning remote control rmvl600 COL description VAL tv , dvd player , vcr , cd player , satellite receiver , dvr 32.81 ft universal remote COL price VAL 19.99 
x: [    0 18047   766 27445   579  6119  2850  3792    12 36824  3761   310
 30650   155 42034    12  5022   385 40311  6063   797   262 21598 34499
   306 33287 14857  8194 27445   579  6119  2850  3792    12 36824  3761
   310 30650   155 42034    12  5022   385 40311  6063   797   262 21598
 34499   306 33287   455   899     7     5   310 30650   155  1743  9553
  1575    64    28   341   396   519     7   477  2024    23     5   467
 14857   425 27445   706     4  2831  1437     2     2 18047   766 27445
   579  6119  2239  6063   797 45900 41350  4697 14857  8194 27445 30016
  2156   385 40311   869  2156   748  8344  2156 45584   869  2156  7595
  4797  2156   385 37032  2107     4  6668 16935 10547  6063 14857   425
 27445   753     4  2831  1437     2]
tokens: ['<s>', 'COL', 'Ġname', 'ĠVAL', 'Ġs', 'ony', 'Ġsc', 'ph', '-', '980', '46', 'Ġplay', 'station', 'Ġ3', 'Ġblu', '-', 'ray', 'Ġd', 'vd', 'Ġremote', 'Ġcontrol', 'Ġ7', '117', '1980', '4', '604', 'ĠCOL', 'Ġdescription', 'ĠVAL', 'Ġs', 'ony', 'Ġsc', 'ph', '-', '980', '46', 'Ġplay', 'station', 'Ġ3', 'Ġblu', '-', 'ray', 'Ġd', 'vd', 'Ġremote', 'Ġcontrol', 'Ġ7', '117', '1980', '4', '604', 'Ġfull', 'Ġaccess', 'Ġto', 'Ġthe', 'Ġplay', 'station', 'Ġ3', 'Ġsystems', 'Ġdisc', 'Ġfeatures', 'Ġcan', 'Ġbe', 'Ġused', 'Ġwithout', 'Ġhaving', 'Ġto', 'Ġpoint', 'Ġdirectly', 'Ġat', 'Ġthe', 'Ġsystem', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ24', '.', '99', 'Ġ', '</s>', '</s>', 'COL', 'Ġname', 'ĠVAL', 'Ġs', 'ony', 'Ġlearning', 'Ġremote', 'Ġcontrol', 'Ġrm', 'vl', '600', 'ĠCOL', 'Ġdescription', 'ĠVAL', 'Ġtv', 'Ġ,', 'Ġd', 'vd', 'Ġplayer', 'Ġ,', 'Ġv', 'cr', 'Ġ,', 'Ġcd', 'Ġplayer', 'Ġ,', 'Ġsatellite', 'Ġreceiver', 'Ġ,', 'Ġd', 'vr', 'Ġ32', '.', '81', 'Ġft', 'Ġuniversal', 'Ġremote', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ19', '.', '99', 'Ġ', '</s>']
is_heads: [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
y: 0
tags: 0
mask: tensor([1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1])
seqlen: 126
task_name: Textual/Abt-Buy
=======================
step: 0, task: Textual/Abt-Buy, loss: 0.009229019284248352
step: 10, task: Textual/Abt-Buy, loss: 0.009607404470443726
step: 20, task: Textual/Abt-Buy, loss: 0.15440425276756287
step: 30, task: Textual/Abt-Buy, loss: 0.07553234696388245
step: 40, task: Textual/Abt-Buy, loss: 0.0072595179080963135
step: 50, task: Textual/Abt-Buy, loss: 0.010865829885005951
step: 60, task: Textual/Abt-Buy, loss: 0.05345587804913521
step: 70, task: Textual/Abt-Buy, loss: 0.2771727740764618
step: 80, task: Textual/Abt-Buy, loss: 0.0007891654968261719
step: 90, task: Textual/Abt-Buy, loss: 0.038647737354040146
step: 100, task: Textual/Abt-Buy, loss: 0.03497055172920227
step: 110, task: Textual/Abt-Buy, loss: 0.01859816163778305
step: 120, task: Textual/Abt-Buy, loss: 0.33418864011764526
step: 130, task: Textual/Abt-Buy, loss: 0.15874065458774567
step: 140, task: Textual/Abt-Buy, loss: 0.13094645738601685
step: 150, task: Textual/Abt-Buy, loss: 0.03452669829130173
step: 160, task: Textual/Abt-Buy, loss: 0.012388594448566437
step: 170, task: Textual/Abt-Buy, loss: 0.0012502074241638184
step: 180, task: Textual/Abt-Buy, loss: 0.08805318921804428
step: 190, task: Textual/Abt-Buy, loss: 0.01583045721054077
step: 200, task: Textual/Abt-Buy, loss: 0.0037986040115356445
step: 210, task: Textual/Abt-Buy, loss: 0.020303696393966675
step: 220, task: Textual/Abt-Buy, loss: 0.4749367833137512
step: 230, task: Textual/Abt-Buy, loss: 0.22555679082870483
step: 240, task: Textual/Abt-Buy, loss: 0.0022783130407333374
step: 250, task: Textual/Abt-Buy, loss: 0.08811787515878677
step: 260, task: Textual/Abt-Buy, loss: 0.011579994112253189
step: 270, task: Textual/Abt-Buy, loss: 0.04341774433851242
step: 280, task: Textual/Abt-Buy, loss: 0.002901047468185425
step: 290, task: Textual/Abt-Buy, loss: 0.01118621975183487
step: 300, task: Textual/Abt-Buy, loss: 0.06624772399663925
step: 310, task: Textual/Abt-Buy, loss: 0.030455388128757477
step: 320, task: Textual/Abt-Buy, loss: 0.016473792493343353
step: 330, task: Textual/Abt-Buy, loss: 0.007883749902248383
step: 340, task: Textual/Abt-Buy, loss: 0.07182397693395615
step: 350, task: Textual/Abt-Buy, loss: 0.0327465683221817
=========eval at epoch=4=========
Validation:
=============Textual/Abt-Buy==================
accuracy=0.947
precision=0.926
recall=0.549
f1=0.689
======================================
Test:
=============Textual/Abt-Buy==================
accuracy=0.953
precision=0.953
recall=0.587
f1=0.727
======================================
=====sanity check======
words: COL name VAL canon deluxe black digital camera case 2595b002 COL description VAL canon deluxe black digital camera case 2595b002 soft nylon case flip-down cover belt loop attachment for hands-free convenience compatible with canon powershot a series black finish COL price VAL 13.99  [SEP] COL name VAL canon powershot sd890 is digital camera 2566b001 COL description VAL canon powershot sd890 is 10 megapixel , 5x optical zoom , 2.5 ' lcd , ua lens digital camera COL price VAL 198.0 
x: [    0 18047   766 27445 32839  2424 39210   909  1778  2280   403   564
  4015   428 19130 14857  8194 27445 32839  2424 39210   909  1778  2280
   403   564  4015   428 19130  3793 38874   403 11113    12  3955  1719
  7494 14018 26350    13  1420    12  3743  9742 16632    19 32839  4361
 10120    10   651   909  2073 14857   425 27445   508     4  2831  1437
     2     2 18047   766 27445 32839  4361 10120 46409   398  3248    16
  1778  2280   564  4280   428 19089 14857  8194 27445 32839  4361 10120
 46409   398  3248    16   158 10721 21424  2156   195  1178 17547 21762
  2156   132     4   245   128   784 28690  2156  1717   102 10373  1778
  2280 14857   425 27445 30858     4   288  1437     2]
tokens: ['<s>', 'COL', 'Ġname', 'ĠVAL', 'Ġcanon', 'Ġdel', 'uxe', 'Ġblack', 'Ġdigital', 'Ġcamera', 'Ġcase', 'Ġ25', '95', 'b', '002', 'ĠCOL', 'Ġdescription', 'ĠVAL', 'Ġcanon', 'Ġdel', 'uxe', 'Ġblack', 'Ġdigital', 'Ġcamera', 'Ġcase', 'Ġ25', '95', 'b', '002', 'Ġsoft', 'Ġnylon', 'Ġcase', 'Ġflip', '-', 'down', 'Ġcover', 'Ġbelt', 'Ġloop', 'Ġattachment', 'Ġfor', 'Ġhands', '-', 'free', 'Ġconvenience', 'Ġcompatible', 'Ġwith', 'Ġcanon', 'Ġpowers', 'hot', 'Ġa', 'Ġseries', 'Ġblack', 'Ġfinish', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ13', '.', '99', 'Ġ', '</s>', '</s>', 'COL', 'Ġname', 'ĠVAL', 'Ġcanon', 'Ġpowers', 'hot', 'Ġsd', '8', '90', 'Ġis', 'Ġdigital', 'Ġcamera', 'Ġ25', '66', 'b', '001', 'ĠCOL', 'Ġdescription', 'ĠVAL', 'Ġcanon', 'Ġpowers', 'hot', 'Ġsd', '8', '90', 'Ġis', 'Ġ10', 'Ġmeg', 'apixel', 'Ġ,', 'Ġ5', 'x', 'Ġoptical', 'Ġzoom', 'Ġ,', 'Ġ2', '.', '5', "Ġ'", 'Ġl', 'cd', 'Ġ,', 'Ġu', 'a', 'Ġlens', 'Ġdigital', 'Ġcamera', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ198', '.', '0', 'Ġ', '</s>']
is_heads: [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
y: 0
tags: 0
mask: tensor([1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1])
seqlen: 117
task_name: Textual/Abt-Buy
=======================
step: 0, task: Textual/Abt-Buy, loss: 0.0018276870250701904
step: 10, task: Textual/Abt-Buy, loss: 0.22053351998329163
step: 20, task: Textual/Abt-Buy, loss: 0.00557805597782135
step: 30, task: Textual/Abt-Buy, loss: 0.018919572234153748
step: 40, task: Textual/Abt-Buy, loss: 0.001779899001121521
step: 50, task: Textual/Abt-Buy, loss: 0.0004969239234924316
step: 60, task: Textual/Abt-Buy, loss: 0.1273888349533081
step: 70, task: Textual/Abt-Buy, loss: 0.0004354715347290039
step: 80, task: Textual/Abt-Buy, loss: 0.0005210638046264648
step: 90, task: Textual/Abt-Buy, loss: 0.0007452964782714844
step: 100, task: Textual/Abt-Buy, loss: 0.0009618103504180908
step: 110, task: Textual/Abt-Buy, loss: 0.03729783371090889
step: 120, task: Textual/Abt-Buy, loss: 0.001009821891784668
step: 130, task: Textual/Abt-Buy, loss: 0.0005685538053512573
step: 140, task: Textual/Abt-Buy, loss: 0.0033090710639953613
step: 150, task: Textual/Abt-Buy, loss: 0.003478109836578369
step: 160, task: Textual/Abt-Buy, loss: 0.014701806008815765
step: 170, task: Textual/Abt-Buy, loss: 0.015451312065124512
step: 180, task: Textual/Abt-Buy, loss: 0.0030767396092414856
step: 190, task: Textual/Abt-Buy, loss: 0.01006615161895752
step: 200, task: Textual/Abt-Buy, loss: 0.009480834007263184
step: 210, task: Textual/Abt-Buy, loss: 0.06305544078350067
step: 220, task: Textual/Abt-Buy, loss: 0.0020383521914482117
step: 230, task: Textual/Abt-Buy, loss: 0.0019299834966659546
step: 240, task: Textual/Abt-Buy, loss: 0.0003699660301208496
step: 250, task: Textual/Abt-Buy, loss: 0.0005193799734115601
step: 260, task: Textual/Abt-Buy, loss: 0.02380520850419998
step: 270, task: Textual/Abt-Buy, loss: 0.0010897070169448853
step: 280, task: Textual/Abt-Buy, loss: 0.16482575237751007
step: 290, task: Textual/Abt-Buy, loss: 0.02103704959154129
step: 300, task: Textual/Abt-Buy, loss: 0.014926321804523468
step: 310, task: Textual/Abt-Buy, loss: 0.007112808525562286
step: 320, task: Textual/Abt-Buy, loss: 0.004744879901409149
step: 330, task: Textual/Abt-Buy, loss: 0.002537734806537628
step: 340, task: Textual/Abt-Buy, loss: 0.022851906716823578
step: 350, task: Textual/Abt-Buy, loss: 0.001069381833076477
=========eval at epoch=5=========
Validation:
=============Textual/Abt-Buy==================
accuracy=0.956
precision=0.891
recall=0.675
f1=0.768
======================================
Test:
=============Textual/Abt-Buy==================
accuracy=0.958
precision=0.862
recall=0.728
f1=0.789
======================================
=====sanity check======
words: COL name VAL panasonic kx-tg4500b black 5.8 ghz cordless phone system kxtg4500b COL description VAL panasonic kx-tg4500b black 5.8 ghz cordless phone system kxtg4500b frequency-hopping spread spectrum technology all-digital voice mail system handles up to 4 lines tollsaver 2-way recording black finish COL price VAL   [SEP] COL name VAL panasonic kx-tg4323b 5.8 ghz expandable digital cordless phone COL description VAL 1 x phone line ( s ) black COL price VAL  
x: [    0 18047   766 27445  5730 38703   449  1178    12 42698  1898   612
   428   909   195     4   398 34648   329 13051  1672  1028   467   449
 11483   571  1898   612   428 14857  8194 27445  5730 38703   449  1178
    12 42698  1898   612   428   909   195     4   398 34648   329 13051
  1672  1028   467   449 11483   571  1898   612   428 13135    12  5410
  5435  2504  8576   806    70    12 29563  2236  7107   467 14617    62
     7   204  2301  5831    29  9903   132    12  1970  5492   909  2073
 14857   425 27445  1437  1437     2     2 18047   766 27445  5730 38703
   449  1178    12 42698  3897  1922   428   195     4   398 34648   329
  3003   868  1778 13051  1672  1028 14857  8194 27445   112  3023  1028
   516    36   579  4839   909 14857   425 27445  1437  1437     2]
tokens: ['<s>', 'COL', 'Ġname', 'ĠVAL', 'Ġpan', 'asonic', 'Ġk', 'x', '-', 'tg', '45', '00', 'b', 'Ġblack', 'Ġ5', '.', '8', 'Ġgh', 'z', 'Ġcord', 'less', 'Ġphone', 'Ġsystem', 'Ġk', 'xt', 'g', '45', '00', 'b', 'ĠCOL', 'Ġdescription', 'ĠVAL', 'Ġpan', 'asonic', 'Ġk', 'x', '-', 'tg', '45', '00', 'b', 'Ġblack', 'Ġ5', '.', '8', 'Ġgh', 'z', 'Ġcord', 'less', 'Ġphone', 'Ġsystem', 'Ġk', 'xt', 'g', '45', '00', 'b', 'Ġfrequency', '-', 'ho', 'pping', 'Ġspread', 'Ġspectrum', 'Ġtechnology', 'Ġall', '-', 'digital', 'Ġvoice', 'Ġmail', 'Ġsystem', 'Ġhandles', 'Ġup', 'Ġto', 'Ġ4', 'Ġlines', 'Ġtoll', 's', 'aver', 'Ġ2', '-', 'way', 'Ġrecording', 'Ġblack', 'Ġfinish', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ', 'Ġ', '</s>', '</s>', 'COL', 'Ġname', 'ĠVAL', 'Ġpan', 'asonic', 'Ġk', 'x', '-', 'tg', '43', '23', 'b', 'Ġ5', '.', '8', 'Ġgh', 'z', 'Ġexpand', 'able', 'Ġdigital', 'Ġcord', 'less', 'Ġphone', 'ĠCOL', 'Ġdescription', 'ĠVAL', 'Ġ1', 'Ġx', 'Ġphone', 'Ġline', 'Ġ(', 'Ġs', 'Ġ)', 'Ġblack', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ', 'Ġ', '</s>']
is_heads: [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
y: 0
tags: 0
mask: tensor([1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1])
seqlen: 131
task_name: Textual/Abt-Buy
=======================
step: 0, task: Textual/Abt-Buy, loss: 0.031077243387699127
step: 10, task: Textual/Abt-Buy, loss: 0.0007523000240325928
step: 20, task: Textual/Abt-Buy, loss: 0.0027805566787719727
step: 30, task: Textual/Abt-Buy, loss: 0.004248619079589844
step: 40, task: Textual/Abt-Buy, loss: 0.00214308500289917
step: 50, task: Textual/Abt-Buy, loss: 0.00136488676071167
step: 60, task: Textual/Abt-Buy, loss: 0.0012182295322418213
step: 70, task: Textual/Abt-Buy, loss: 0.0009288042783737183
step: 80, task: Textual/Abt-Buy, loss: 0.004989102482795715
step: 90, task: Textual/Abt-Buy, loss: 0.0010731518268585205
step: 100, task: Textual/Abt-Buy, loss: 0.00125063955783844
step: 110, task: Textual/Abt-Buy, loss: 0.06018908694386482
step: 120, task: Textual/Abt-Buy, loss: 0.0031448453664779663
step: 130, task: Textual/Abt-Buy, loss: 0.001032799482345581
step: 140, task: Textual/Abt-Buy, loss: 0.004085041582584381
step: 150, task: Textual/Abt-Buy, loss: 0.001260906457901001
step: 160, task: Textual/Abt-Buy, loss: 0.0016572177410125732
step: 170, task: Textual/Abt-Buy, loss: 0.002122059464454651
step: 180, task: Textual/Abt-Buy, loss: 0.0026036202907562256
step: 190, task: Textual/Abt-Buy, loss: 0.012597322463989258
step: 200, task: Textual/Abt-Buy, loss: 0.0003859400749206543
step: 210, task: Textual/Abt-Buy, loss: 0.024844400584697723
step: 220, task: Textual/Abt-Buy, loss: 0.000337451696395874
step: 230, task: Textual/Abt-Buy, loss: 0.0010365098714828491
step: 240, task: Textual/Abt-Buy, loss: 0.0028486400842666626
step: 250, task: Textual/Abt-Buy, loss: 0.003305770456790924
step: 260, task: Textual/Abt-Buy, loss: 0.015419118106365204
step: 270, task: Textual/Abt-Buy, loss: 0.0006383955478668213
step: 280, task: Textual/Abt-Buy, loss: 0.04006906598806381
step: 290, task: Textual/Abt-Buy, loss: 0.002254664897918701
step: 300, task: Textual/Abt-Buy, loss: 0.0004291832447052002
step: 310, task: Textual/Abt-Buy, loss: 0.001930534839630127
step: 320, task: Textual/Abt-Buy, loss: 0.28634512424468994
step: 330, task: Textual/Abt-Buy, loss: 0.015169546008110046
step: 340, task: Textual/Abt-Buy, loss: 0.028241850435733795
step: 350, task: Textual/Abt-Buy, loss: 0.0031868964433670044
=========eval at epoch=6=========
Validation:
=============Textual/Abt-Buy==================
accuracy=0.950
precision=0.836
recall=0.670
f1=0.744
======================================
Test:
=============Textual/Abt-Buy==================
accuracy=0.957
precision=0.860
recall=0.714
f1=0.780
======================================
=====sanity check======
words: COL name VAL canon black photo ink cartridge cli8b COL description VAL canon black photo ink cartridge cli8b fine technology for exceptional sharpness & detail compatible with canon pixma printers COL price VAL 16.0  [SEP] COL name VAL canon cli-221 black ink cartridge 2946b001 COL description VAL black COL price VAL 11.99 
x: [    0 18047   766 27445 32839   909  1345 16019 41785  3741   118   398
   428 14857  8194 27445 32839   909  1345 16019 41785  3741   118   398
   428  2051   806    13  9297  4406  1825   359  4617 16632    19 32839
   181  3181  1916 29379 14857   425 27445   545     4   288  1437     2
     2 18047   766 27445 32839  3741   118    12 28730   909 16019 41785
  1132  3761   428 19089 14857  8194 27445   909 14857   425 27445   365
     4  2831  1437     2]
tokens: ['<s>', 'COL', 'Ġname', 'ĠVAL', 'Ġcanon', 'Ġblack', 'Ġphoto', 'Ġink', 'Ġcartridge', 'Ġcl', 'i', '8', 'b', 'ĠCOL', 'Ġdescription', 'ĠVAL', 'Ġcanon', 'Ġblack', 'Ġphoto', 'Ġink', 'Ġcartridge', 'Ġcl', 'i', '8', 'b', 'Ġfine', 'Ġtechnology', 'Ġfor', 'Ġexceptional', 'Ġsharp', 'ness', 'Ġ&', 'Ġdetail', 'Ġcompatible', 'Ġwith', 'Ġcanon', 'Ġp', 'ix', 'ma', 'Ġprinters', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ16', '.', '0', 'Ġ', '</s>', '</s>', 'COL', 'Ġname', 'ĠVAL', 'Ġcanon', 'Ġcl', 'i', '-', '221', 'Ġblack', 'Ġink', 'Ġcartridge', 'Ġ29', '46', 'b', '001', 'ĠCOL', 'Ġdescription', 'ĠVAL', 'Ġblack', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ11', '.', '99', 'Ġ', '</s>']
is_heads: [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
y: 0
tags: 0
mask: tensor([1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1])
seqlen: 76
task_name: Textual/Abt-Buy
=======================
step: 0, task: Textual/Abt-Buy, loss: 0.0031453073024749756
step: 10, task: Textual/Abt-Buy, loss: 0.021696865558624268
step: 20, task: Textual/Abt-Buy, loss: 0.001374468207359314
step: 30, task: Textual/Abt-Buy, loss: 0.05412319302558899
step: 40, task: Textual/Abt-Buy, loss: 0.0013642162084579468
step: 50, task: Textual/Abt-Buy, loss: 0.001985326409339905
step: 60, task: Textual/Abt-Buy, loss: 0.010097041726112366
step: 70, task: Textual/Abt-Buy, loss: 0.0015081316232681274
step: 80, task: Textual/Abt-Buy, loss: 0.0024495720863342285
step: 90, task: Textual/Abt-Buy, loss: 0.013874419033527374
step: 100, task: Textual/Abt-Buy, loss: 0.04383888468146324
step: 110, task: Textual/Abt-Buy, loss: 0.013284742832183838
step: 120, task: Textual/Abt-Buy, loss: 0.020832546055316925
step: 130, task: Textual/Abt-Buy, loss: 0.0009883344173431396
step: 140, task: Textual/Abt-Buy, loss: 0.023594930768013
step: 150, task: Textual/Abt-Buy, loss: 0.009020820260047913
step: 160, task: Textual/Abt-Buy, loss: 0.0025577694177627563
step: 170, task: Textual/Abt-Buy, loss: 0.09520003199577332
step: 180, task: Textual/Abt-Buy, loss: 0.0016543716192245483
step: 190, task: Textual/Abt-Buy, loss: 0.004668205976486206
step: 200, task: Textual/Abt-Buy, loss: 0.000500217080116272
step: 210, task: Textual/Abt-Buy, loss: 0.0012156814336776733
step: 220, task: Textual/Abt-Buy, loss: 0.002060338854789734
step: 230, task: Textual/Abt-Buy, loss: 0.0009505897760391235
step: 240, task: Textual/Abt-Buy, loss: 0.013076990842819214
step: 250, task: Textual/Abt-Buy, loss: 0.003101542592048645
step: 260, task: Textual/Abt-Buy, loss: 0.003625325858592987
step: 270, task: Textual/Abt-Buy, loss: 0.000463142991065979
step: 280, task: Textual/Abt-Buy, loss: 0.001593753695487976
step: 290, task: Textual/Abt-Buy, loss: 0.006411440670490265
step: 300, task: Textual/Abt-Buy, loss: 0.0004609823226928711
step: 310, task: Textual/Abt-Buy, loss: 0.0004137009382247925
step: 320, task: Textual/Abt-Buy, loss: 0.00029383599758148193
step: 330, task: Textual/Abt-Buy, loss: 0.0004300326108932495
step: 340, task: Textual/Abt-Buy, loss: 0.003418177366256714
step: 350, task: Textual/Abt-Buy, loss: 0.0004781186580657959
=========eval at epoch=7=========
Validation:
=============Textual/Abt-Buy==================
accuracy=0.956
precision=0.871
recall=0.689
f1=0.770
======================================
Test:
=============Textual/Abt-Buy==================
accuracy=0.958
precision=0.888
recall=0.694
f1=0.779
======================================
=====sanity check======
words: COL name VAL linksys wireless-g internet home monitoring camera wvc54gca COL description VAL linksys wireless-g internet home monitoring camera wvc54gca sends high-quality live audio and video to your network wirelessly viewable from most web browsers anywhere in the world built-in video stream encoder and stand-alone web server ( no pc necessary ) security mode supports mpeg-4 and mjpeg video at up to 640x480 up to four simultaneous remote users COL price VAL 99.0  [SEP] COL name VAL linksys wireless-g wusb54gc compact usb adapter COL description VAL  COL price VAL  
x: [    0 18047   766 27445  5678  2459  6955    12   571  2888   184  4872
  2280   885 36940  4283   571  3245 14857  8194 27445  5678  2459  6955
    12   571  2888   184  4872  2280   885 36940  4283   571  3245 11210
   239    12  8634   697  6086     8   569     7   110  1546  8869 12445
  1217   868    31   144  3748 35855  4558    11     5   232  1490    12
   179   569  4615  9689 15362     8  1413    12 22446  3748 10228    36
   117 46213  2139  4839   573  5745  4548   475 41191    12   306     8
   475   267 41191   569    23    62     7 37101  1178 27018    62     7
   237 30444  6063  1434 14857   425 27445  6705     4   288  1437     2
     2 18047   766 27445  5678  2459  6955    12   571   885 47358  4283
 42406 12549 49030 36007 14857  8194 27445  1437 14857   425 27445  1437
  1437     2]
tokens: ['<s>', 'COL', 'Ġname', 'ĠVAL', 'Ġlinks', 'ys', 'Ġwireless', '-', 'g', 'Ġinternet', 'Ġhome', 'Ġmonitoring', 'Ġcamera', 'Ġw', 'vc', '54', 'g', 'ca', 'ĠCOL', 'Ġdescription', 'ĠVAL', 'Ġlinks', 'ys', 'Ġwireless', '-', 'g', 'Ġinternet', 'Ġhome', 'Ġmonitoring', 'Ġcamera', 'Ġw', 'vc', '54', 'g', 'ca', 'Ġsends', 'Ġhigh', '-', 'quality', 'Ġlive', 'Ġaudio', 'Ġand', 'Ġvideo', 'Ġto', 'Ġyour', 'Ġnetwork', 'Ġwire', 'lessly', 'Ġview', 'able', 'Ġfrom', 'Ġmost', 'Ġweb', 'Ġbrowsers', 'Ġanywhere', 'Ġin', 'Ġthe', 'Ġworld', 'Ġbuilt', '-', 'in', 'Ġvideo', 'Ġstream', 'Ġenc', 'oder', 'Ġand', 'Ġstand', '-', 'alone', 'Ġweb', 'Ġserver', 'Ġ(', 'Ġno', 'Ġpc', 'Ġnecessary', 'Ġ)', 'Ġsecurity', 'Ġmode', 'Ġsupports', 'Ġm', 'peg', '-', '4', 'Ġand', 'Ġm', 'j', 'peg', 'Ġvideo', 'Ġat', 'Ġup', 'Ġto', 'Ġ640', 'x', '480', 'Ġup', 'Ġto', 'Ġfour', 'Ġsimultaneous', 'Ġremote', 'Ġusers', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ99', '.', '0', 'Ġ', '</s>', '</s>', 'COL', 'Ġname', 'ĠVAL', 'Ġlinks', 'ys', 'Ġwireless', '-', 'g', 'Ġw', 'usb', '54', 'gc', 'Ġcompact', 'Ġusb', 'Ġadapter', 'ĠCOL', 'Ġdescription', 'ĠVAL', 'Ġ', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ', 'Ġ', '</s>']
is_heads: [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
y: 0
tags: 0
mask: tensor([1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1])
seqlen: 134
task_name: Textual/Abt-Buy
=======================
step: 0, task: Textual/Abt-Buy, loss: 0.001901783049106598
step: 10, task: Textual/Abt-Buy, loss: 0.0009488314390182495
step: 20, task: Textual/Abt-Buy, loss: 0.022526100277900696
step: 30, task: Textual/Abt-Buy, loss: 0.005538858473300934
step: 40, task: Textual/Abt-Buy, loss: 0.06236473098397255
step: 50, task: Textual/Abt-Buy, loss: 0.0006586015224456787
step: 60, task: Textual/Abt-Buy, loss: 0.041079964488744736
step: 70, task: Textual/Abt-Buy, loss: 0.0004289001226425171
step: 80, task: Textual/Abt-Buy, loss: 0.0034104138612747192
step: 90, task: Textual/Abt-Buy, loss: 0.0021063461899757385
step: 100, task: Textual/Abt-Buy, loss: 0.004000522196292877
step: 110, task: Textual/Abt-Buy, loss: 0.0019864141941070557
step: 120, task: Textual/Abt-Buy, loss: 0.0006888210773468018
step: 130, task: Textual/Abt-Buy, loss: 0.003974221646785736
step: 140, task: Textual/Abt-Buy, loss: 0.0024714618921279907
step: 150, task: Textual/Abt-Buy, loss: 0.0005116164684295654
step: 160, task: Textual/Abt-Buy, loss: 0.0012276619672775269
step: 170, task: Textual/Abt-Buy, loss: 0.006240099668502808
step: 180, task: Textual/Abt-Buy, loss: 0.02169143408536911
step: 190, task: Textual/Abt-Buy, loss: 0.00048092007637023926
step: 200, task: Textual/Abt-Buy, loss: 0.023312605917453766
step: 210, task: Textual/Abt-Buy, loss: 0.013602428138256073
step: 220, task: Textual/Abt-Buy, loss: 0.017320558428764343
step: 230, task: Textual/Abt-Buy, loss: 0.0012671798467636108
step: 240, task: Textual/Abt-Buy, loss: 0.01587609201669693
step: 250, task: Textual/Abt-Buy, loss: 0.0011963099241256714
step: 260, task: Textual/Abt-Buy, loss: 0.0020757317543029785
step: 270, task: Textual/Abt-Buy, loss: 0.00109080970287323
step: 280, task: Textual/Abt-Buy, loss: 0.0025265663862228394
step: 290, task: Textual/Abt-Buy, loss: 0.008751876652240753
step: 300, task: Textual/Abt-Buy, loss: 0.0006708055734634399
step: 310, task: Textual/Abt-Buy, loss: 0.0024428367614746094
step: 320, task: Textual/Abt-Buy, loss: 0.0018445849418640137
step: 330, task: Textual/Abt-Buy, loss: 0.0010875016450881958
step: 340, task: Textual/Abt-Buy, loss: 0.0028041601181030273
Gradient overflow.  Skipping step, loss scaler 0 reducing loss scale to 8192.0
step: 350, task: Textual/Abt-Buy, loss: 0.000917777419090271
=========eval at epoch=8=========
Validation:
=============Textual/Abt-Buy==================
accuracy=0.952
precision=0.896
recall=0.626
f1=0.737
======================================
Test:
=============Textual/Abt-Buy==================
accuracy=0.958
precision=0.889
recall=0.699
f1=0.783
======================================
Selected optimization level O2:  FP16 training with FP32 batchnorm and FP32 master weights.

Defaults for this optimization level are:
enabled                : True
opt_level              : O2
cast_model_type        : torch.float16
patch_torch_functions  : False
keep_batchnorm_fp32    : True
master_weights         : True
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O2
cast_model_type        : torch.float16
patch_torch_functions  : False
keep_batchnorm_fp32    : True
master_weights         : True
loss_scale             : dynamic
Warning:  multi_tensor_applier fused unscale kernel is unavailable, possibly because apex was installed without --cuda_ext --cpp_ext. Using Python fallback.  Original ImportError was: ModuleNotFoundError("No module named 'amp_C'")
Gradient overflow.  Skipping step, loss scaler 0 reducing loss scale to 32768.0
=====sanity check======
words: COL name VAL canon black ink cartridge pg50 COL description VAL canon black ink cartridge pg50 pigment ink formulation for long lasting prints resists smearing caused by highlighters smudge resistant ink remaining notification technology crisp laser text-quality text black ink COL price VAL 29.0  [SEP] COL name VAL canon cli-8c ink cartridge 0621b002 COL description VAL cyan COL price VAL 13.99 
x: [    0 18047   766 27445 32839   909 16019 41785 47194  1096 14857  8194
 27445 32839   909 16019 41785 47194  1096 39461 16019 32018    13   251
  9735 19553 44430  5278 10852  1726    30   239   462 38361  5278 14328
 19152 16019  2405 12059   806 17766 13443  2788    12  8634  2788   909
 16019 14857   425 27445  1132     4   288  1437     2     2 18047   766
 27445 32839  3741   118    12   398   438 16019 41785 15007  2146   428
 19130 14857  8194 27445 39493 14857   425 27445   508     4  2831  1437
     2]
tokens: ['<s>', 'COL', 'Ġname', 'ĠVAL', 'Ġcanon', 'Ġblack', 'Ġink', 'Ġcartridge', 'Ġpg', '50', 'ĠCOL', 'Ġdescription', 'ĠVAL', 'Ġcanon', 'Ġblack', 'Ġink', 'Ġcartridge', 'Ġpg', '50', 'Ġpigment', 'Ġink', 'Ġformulation', 'Ġfor', 'Ġlong', 'Ġlasting', 'Ġprints', 'Ġresists', 'Ġsm', 'earing', 'Ġcaused', 'Ġby', 'Ġhigh', 'l', 'ighters', 'Ġsm', 'udge', 'Ġresistant', 'Ġink', 'Ġremaining', 'Ġnotification', 'Ġtechnology', 'Ġcrisp', 'Ġlaser', 'Ġtext', '-', 'quality', 'Ġtext', 'Ġblack', 'Ġink', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ29', '.', '0', 'Ġ', '</s>', '</s>', 'COL', 'Ġname', 'ĠVAL', 'Ġcanon', 'Ġcl', 'i', '-', '8', 'c', 'Ġink', 'Ġcartridge', 'Ġ06', '21', 'b', '002', 'ĠCOL', 'Ġdescription', 'ĠVAL', 'Ġcyan', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ13', '.', '99', 'Ġ', '</s>']
is_heads: [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
y: 0
tags: 0
mask: tensor([1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1])
seqlen: 85
task_name: Textual/Abt-Buy
=======================
step: 0, task: Textual/Abt-Buy, loss: 0.7012410163879395
Gradient overflow.  Skipping step, loss scaler 0 reducing loss scale to 16384.0
Gradient overflow.  Skipping step, loss scaler 0 reducing loss scale to 8192.0
step: 10, task: Textual/Abt-Buy, loss: 0.6804599165916443
step: 20, task: Textual/Abt-Buy, loss: 0.6490525603294373
step: 30, task: Textual/Abt-Buy, loss: 0.593296229839325
step: 40, task: Textual/Abt-Buy, loss: 0.47371992468833923
step: 50, task: Textual/Abt-Buy, loss: 0.5633002519607544
step: 60, task: Textual/Abt-Buy, loss: 0.2408309131860733
step: 70, task: Textual/Abt-Buy, loss: 0.44800424575805664
step: 80, task: Textual/Abt-Buy, loss: 0.24256305396556854
step: 90, task: Textual/Abt-Buy, loss: 0.07521072775125504
step: 100, task: Textual/Abt-Buy, loss: 0.2278272807598114
step: 110, task: Textual/Abt-Buy, loss: 0.3334525525569916
step: 120, task: Textual/Abt-Buy, loss: 0.3817234933376312
step: 130, task: Textual/Abt-Buy, loss: 0.4592796564102173
step: 140, task: Textual/Abt-Buy, loss: 0.3310280442237854
step: 150, task: Textual/Abt-Buy, loss: 0.2160111665725708
step: 160, task: Textual/Abt-Buy, loss: 0.23456023633480072
step: 170, task: Textual/Abt-Buy, loss: 0.17571458220481873
step: 180, task: Textual/Abt-Buy, loss: 0.21878977119922638
step: 190, task: Textual/Abt-Buy, loss: 0.12156364321708679
step: 200, task: Textual/Abt-Buy, loss: 0.30834972858428955
step: 210, task: Textual/Abt-Buy, loss: 0.3348512351512909
step: 220, task: Textual/Abt-Buy, loss: 0.1277593970298767
step: 230, task: Textual/Abt-Buy, loss: 0.3161497414112091
step: 240, task: Textual/Abt-Buy, loss: 0.1685585379600525
step: 250, task: Textual/Abt-Buy, loss: 0.3498839735984802
step: 260, task: Textual/Abt-Buy, loss: 0.00819772481918335
step: 270, task: Textual/Abt-Buy, loss: 0.07381847500801086
step: 280, task: Textual/Abt-Buy, loss: 0.25685787200927734
step: 290, task: Textual/Abt-Buy, loss: 0.306142657995224
step: 300, task: Textual/Abt-Buy, loss: 0.2053799033164978
step: 310, task: Textual/Abt-Buy, loss: 0.12981732189655304
step: 320, task: Textual/Abt-Buy, loss: 0.22368797659873962
step: 330, task: Textual/Abt-Buy, loss: 0.18036356568336487
step: 340, task: Textual/Abt-Buy, loss: 0.348979651927948
step: 350, task: Textual/Abt-Buy, loss: 0.044749729335308075
=========eval at epoch=1=========
Validation:
=============Textual/Abt-Buy==================
accuracy=0.908
precision=0.968
recall=0.146
f1=0.253
======================================
Test:
=============Textual/Abt-Buy==================
accuracy=0.906
precision=0.906
recall=0.141
f1=0.244
======================================
/w/246/tianyu2020/miniconda2/envs/ditto/lib/python3.7/site-packages/apex/amp/_initialize.py:24: UserWarning: An input tensor was not cuda.
  warnings.warn("An input tensor was not cuda.")
/w/246/tianyu2020/miniconda2/envs/ditto/lib/python3.7/site-packages/torch/optim/lr_scheduler.py:122: UserWarning: Detected call of `lr_scheduler.step()` before `optimizer.step()`. In PyTorch 1.1.0 and later, you should call them in the opposite order: `optimizer.step()` before `lr_scheduler.step()`.  Failure to do this will result in PyTorch skipping the first value of the learning rate schedule. See more details at https://pytorch.org/docs/stable/optim.html#how-to-adjust-learning-rate
  "https://pytorch.org/docs/stable/optim.html#how-to-adjust-learning-rate", UserWarning)
=====sanity check======
words: COL name VAL nikon d300 digital slr digital camera d300body COL description VAL nikon d300 digital slr digital camera d300body 12.3 megapixel dx-format cmos sensor 3 ' super density 920,000-dot vga color monitor continuous shooting up to 6 frames per second fast accurate 51-point autofocus with 3d focus tracking scene recognition system ( srs ) dynamic integrated dust reduction system two liveview shooting modes picture control settings rugged magnesium-alloy construction black finish body only COL price VAL   [SEP] COL name VAL sony cyber-shot dsc-w150 digital camera gold dscw150n COL description VAL 8.1 megapixel 16:9 2x digital zoom 2.7 ' active matrix tft color lcd COL price VAL 129.99 
x: [    0 18047   766 27445   295   967   261   385  2965  1778  3369   338
  1778  2280   385  2965  9773 14857  8194 27445   295   967   261   385
  2965  1778  3369   338  1778  2280   385  2965  9773   316     4   246
 10721 21424 49386    12 34609 25434   366  9626   155   128  2422 16522
 37543     6   151    12 33369   748  2538  3195  5271 11152  1094    62
     7   231 16420   228   200  1769  6030  4074    12  2300  7241  1116
 23189    19   155   417  1056  6779  1310  4972   467    36   579  4926
  4839  6878  6818  8402  4878   467    80   697  5877  1094 19180  2170
   797  9629 21937 36165    12  1250  2160  1663   909  2073   809   129
 14857   425 27445  1437  1437     2     2 18047   766 27445   579  6119
  5381    12 10393   385  3866    12   605  6115  1778  2280  1637   385
  3866   605  6115   282 14857  8194 27445   290     4   134 10721 21424
   545    35   466   132  1178  1778 21762   132     4   406   128  2171
 36173   326  2543  3195   784 28690 14857   425 27445 21234     4  2831
  1437     2]
tokens: ['<s>', 'COL', 'Ġname', 'ĠVAL', 'Ġn', 'ik', 'on', 'Ġd', '300', 'Ġdigital', 'Ġsl', 'r', 'Ġdigital', 'Ġcamera', 'Ġd', '300', 'body', 'ĠCOL', 'Ġdescription', 'ĠVAL', 'Ġn', 'ik', 'on', 'Ġd', '300', 'Ġdigital', 'Ġsl', 'r', 'Ġdigital', 'Ġcamera', 'Ġd', '300', 'body', 'Ġ12', '.', '3', 'Ġmeg', 'apixel', 'Ġdx', '-', 'format', 'Ġcm', 'os', 'Ġsensor', 'Ġ3', "Ġ'", 'Ġsuper', 'Ġdensity', 'Ġ920', ',', '000', '-', 'dot', 'Ġv', 'ga', 'Ġcolor', 'Ġmonitor', 'Ġcontinuous', 'Ġshooting', 'Ġup', 'Ġto', 'Ġ6', 'Ġframes', 'Ġper', 'Ġsecond', 'Ġfast', 'Ġaccurate', 'Ġ51', '-', 'point', 'Ġaut', 'of', 'ocus', 'Ġwith', 'Ġ3', 'd', 'Ġfocus', 'Ġtracking', 'Ġscene', 'Ġrecognition', 'Ġsystem', 'Ġ(', 'Ġs', 'rs', 'Ġ)', 'Ġdynamic', 'Ġintegrated', 'Ġdust', 'Ġreduction', 'Ġsystem', 'Ġtwo', 'Ġlive', 'view', 'Ġshooting', 'Ġmodes', 'Ġpicture', 'Ġcontrol', 'Ġsettings', 'Ġrugged', 'Ġmagnesium', '-', 'all', 'oy', 'Ġconstruction', 'Ġblack', 'Ġfinish', 'Ġbody', 'Ġonly', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ', 'Ġ', '</s>', '</s>', 'COL', 'Ġname', 'ĠVAL', 'Ġs', 'ony', 'Ġcyber', '-', 'shot', 'Ġd', 'sc', '-', 'w', '150', 'Ġdigital', 'Ġcamera', 'Ġgold', 'Ġd', 'sc', 'w', '150', 'n', 'ĠCOL', 'Ġdescription', 'ĠVAL', 'Ġ8', '.', '1', 'Ġmeg', 'apixel', 'Ġ16', ':', '9', 'Ġ2', 'x', 'Ġdigital', 'Ġzoom', 'Ġ2', '.', '7', "Ġ'", 'Ġactive', 'Ġmatrix', 'Ġt', 'ft', 'Ġcolor', 'Ġl', 'cd', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ129', '.', '99', 'Ġ', '</s>']
is_heads: [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
y: 0
tags: 0
mask: tensor([1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1])
seqlen: 170
task_name: Textual/Abt-Buy
=======================
step: 0, task: Textual/Abt-Buy, loss: 0.2670780420303345
step: 10, task: Textual/Abt-Buy, loss: 0.02667652815580368
step: 20, task: Textual/Abt-Buy, loss: 0.04313376918435097
step: 30, task: Textual/Abt-Buy, loss: 0.6752378344535828
step: 40, task: Textual/Abt-Buy, loss: 0.08585973083972931
step: 50, task: Textual/Abt-Buy, loss: 0.10574657469987869
step: 60, task: Textual/Abt-Buy, loss: 0.08093578368425369
step: 70, task: Textual/Abt-Buy, loss: 0.06357452273368835
step: 80, task: Textual/Abt-Buy, loss: 0.22175776958465576
step: 90, task: Textual/Abt-Buy, loss: 0.16414925456047058
step: 100, task: Textual/Abt-Buy, loss: 0.01003292202949524
step: 110, task: Textual/Abt-Buy, loss: 0.05848214030265808
step: 120, task: Textual/Abt-Buy, loss: 0.08592867851257324
step: 130, task: Textual/Abt-Buy, loss: 0.02550935000181198
step: 140, task: Textual/Abt-Buy, loss: 0.03203508257865906
step: 150, task: Textual/Abt-Buy, loss: 0.23281541466712952
step: 160, task: Textual/Abt-Buy, loss: 0.028856202960014343
step: 170, task: Textual/Abt-Buy, loss: 0.07304105162620544
step: 180, task: Textual/Abt-Buy, loss: 0.03184632211923599
step: 190, task: Textual/Abt-Buy, loss: 0.011239655315876007
step: 200, task: Textual/Abt-Buy, loss: 0.13285380601882935
step: 210, task: Textual/Abt-Buy, loss: 0.04758288711309433
step: 220, task: Textual/Abt-Buy, loss: 0.2281508594751358
step: 230, task: Textual/Abt-Buy, loss: 0.1782342791557312
step: 240, task: Textual/Abt-Buy, loss: 0.19265493750572205
step: 250, task: Textual/Abt-Buy, loss: 0.045606181025505066
step: 260, task: Textual/Abt-Buy, loss: 0.029969237744808197
step: 270, task: Textual/Abt-Buy, loss: 0.0036635249853134155
step: 280, task: Textual/Abt-Buy, loss: 0.009533219039440155
step: 290, task: Textual/Abt-Buy, loss: 0.037353210151195526
step: 300, task: Textual/Abt-Buy, loss: 0.035786405205726624
step: 310, task: Textual/Abt-Buy, loss: 0.1114974096417427
step: 320, task: Textual/Abt-Buy, loss: 0.011128857731819153
step: 330, task: Textual/Abt-Buy, loss: 0.008365020155906677
step: 340, task: Textual/Abt-Buy, loss: 0.03884485363960266
step: 350, task: Textual/Abt-Buy, loss: 0.038674246519804
=========eval at epoch=2=========
Validation:
=============Textual/Abt-Buy==================
accuracy=0.950
precision=0.814
recall=0.699
f1=0.752
======================================
Test:
=============Textual/Abt-Buy==================
accuracy=0.947
precision=0.757
recall=0.743
f1=0.750
======================================
=====sanity check======
words: COL name VAL nikon d300 digital slr digital camera d300body COL description VAL nikon d300 digital slr digital camera d300body 12.3 megapixel dx-format cmos sensor 3 ' super density 920,000-dot vga color monitor continuous shooting up to 6 frames per second fast accurate 51-point autofocus with 3d focus tracking scene recognition system ( srs ) dynamic integrated dust reduction system two liveview shooting modes picture control settings rugged magnesium-alloy construction black finish body only COL price VAL   [SEP] COL name VAL nikon coolpix s550 digital camera graphite black 26108 COL description VAL 10 megapixel 16:9 4x digital zoom 2.5 ' active matrix tft color lcd COL price VAL 168.72 
x: [    0 18047   766 27445   295   967   261   385  2965  1778  3369   338
  1778  2280   385  2965  9773 14857  8194 27445   295   967   261   385
  2965  1778  3369   338  1778  2280   385  2965  9773   316     4   246
 10721 21424 49386    12 34609 25434   366  9626   155   128  2422 16522
 37543     6   151    12 33369   748  2538  3195  5271 11152  1094    62
     7   231 16420   228   200  1769  6030  4074    12  2300  7241  1116
 23189    19   155   417  1056  6779  1310  4972   467    36   579  4926
  4839  6878  6818  8402  4878   467    80   697  5877  1094 19180  2170
   797  9629 21937 36165    12  1250  2160  1663   909  2073   809   129
 14857   425 27445  1437  1437     2     2 18047   766 27445   295   967
   261  3035   642  3181   579 17953  1778  2280 20992  1459   909   973
 18844 14857  8194 27445   158 10721 21424   545    35   466   204  1178
  1778 21762   132     4   245   128  2171 36173   326  2543  3195   784
 28690 14857   425 27445 26372     4  4956  1437     2]
tokens: ['<s>', 'COL', 'Ġname', 'ĠVAL', 'Ġn', 'ik', 'on', 'Ġd', '300', 'Ġdigital', 'Ġsl', 'r', 'Ġdigital', 'Ġcamera', 'Ġd', '300', 'body', 'ĠCOL', 'Ġdescription', 'ĠVAL', 'Ġn', 'ik', 'on', 'Ġd', '300', 'Ġdigital', 'Ġsl', 'r', 'Ġdigital', 'Ġcamera', 'Ġd', '300', 'body', 'Ġ12', '.', '3', 'Ġmeg', 'apixel', 'Ġdx', '-', 'format', 'Ġcm', 'os', 'Ġsensor', 'Ġ3', "Ġ'", 'Ġsuper', 'Ġdensity', 'Ġ920', ',', '000', '-', 'dot', 'Ġv', 'ga', 'Ġcolor', 'Ġmonitor', 'Ġcontinuous', 'Ġshooting', 'Ġup', 'Ġto', 'Ġ6', 'Ġframes', 'Ġper', 'Ġsecond', 'Ġfast', 'Ġaccurate', 'Ġ51', '-', 'point', 'Ġaut', 'of', 'ocus', 'Ġwith', 'Ġ3', 'd', 'Ġfocus', 'Ġtracking', 'Ġscene', 'Ġrecognition', 'Ġsystem', 'Ġ(', 'Ġs', 'rs', 'Ġ)', 'Ġdynamic', 'Ġintegrated', 'Ġdust', 'Ġreduction', 'Ġsystem', 'Ġtwo', 'Ġlive', 'view', 'Ġshooting', 'Ġmodes', 'Ġpicture', 'Ġcontrol', 'Ġsettings', 'Ġrugged', 'Ġmagnesium', '-', 'all', 'oy', 'Ġconstruction', 'Ġblack', 'Ġfinish', 'Ġbody', 'Ġonly', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ', 'Ġ', '</s>', '</s>', 'COL', 'Ġname', 'ĠVAL', 'Ġn', 'ik', 'on', 'Ġcool', 'p', 'ix', 'Ġs', '550', 'Ġdigital', 'Ġcamera', 'Ġgraph', 'ite', 'Ġblack', 'Ġ26', '108', 'ĠCOL', 'Ġdescription', 'ĠVAL', 'Ġ10', 'Ġmeg', 'apixel', 'Ġ16', ':', '9', 'Ġ4', 'x', 'Ġdigital', 'Ġzoom', 'Ġ2', '.', '5', "Ġ'", 'Ġactive', 'Ġmatrix', 'Ġt', 'ft', 'Ġcolor', 'Ġl', 'cd', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ168', '.', '72', 'Ġ', '</s>']
is_heads: [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
y: 0
tags: 0
mask: tensor([1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1])
seqlen: 165
task_name: Textual/Abt-Buy
=======================
step: 0, task: Textual/Abt-Buy, loss: 0.0036559104919433594
step: 10, task: Textual/Abt-Buy, loss: 0.029791250824928284
step: 20, task: Textual/Abt-Buy, loss: 0.013185136020183563
step: 30, task: Textual/Abt-Buy, loss: 0.00600549578666687
step: 40, task: Textual/Abt-Buy, loss: 0.00270138680934906
step: 50, task: Textual/Abt-Buy, loss: 0.08810558170080185
step: 60, task: Textual/Abt-Buy, loss: 0.016733713448047638
step: 70, task: Textual/Abt-Buy, loss: 0.007947966456413269
step: 80, task: Textual/Abt-Buy, loss: 0.009571582078933716
step: 90, task: Textual/Abt-Buy, loss: 0.2673102617263794
step: 100, task: Textual/Abt-Buy, loss: 0.0033819079399108887
step: 110, task: Textual/Abt-Buy, loss: 0.03836953639984131
step: 120, task: Textual/Abt-Buy, loss: 0.12070988118648529
step: 130, task: Textual/Abt-Buy, loss: 0.008904308080673218
step: 140, task: Textual/Abt-Buy, loss: 0.02908545732498169
step: 150, task: Textual/Abt-Buy, loss: 0.04002948850393295
step: 160, task: Textual/Abt-Buy, loss: 0.129319429397583
step: 170, task: Textual/Abt-Buy, loss: 0.06904172897338867
step: 180, task: Textual/Abt-Buy, loss: 0.006398938596248627
step: 190, task: Textual/Abt-Buy, loss: 0.0046326518058776855
step: 200, task: Textual/Abt-Buy, loss: 0.029227986931800842
step: 210, task: Textual/Abt-Buy, loss: 0.0015132129192352295
step: 220, task: Textual/Abt-Buy, loss: 0.0018853992223739624
step: 230, task: Textual/Abt-Buy, loss: 0.013186648488044739
step: 240, task: Textual/Abt-Buy, loss: 0.051644135266542435
step: 250, task: Textual/Abt-Buy, loss: 0.09934347867965698
step: 260, task: Textual/Abt-Buy, loss: 0.00037567317485809326
step: 270, task: Textual/Abt-Buy, loss: 0.0027255862951278687
step: 280, task: Textual/Abt-Buy, loss: 0.02349752187728882
step: 290, task: Textual/Abt-Buy, loss: 0.3016371726989746
step: 300, task: Textual/Abt-Buy, loss: 0.00706857442855835
step: 310, task: Textual/Abt-Buy, loss: 0.001715630292892456
step: 320, task: Textual/Abt-Buy, loss: 0.016859576106071472
step: 330, task: Textual/Abt-Buy, loss: 0.005535349249839783
step: 340, task: Textual/Abt-Buy, loss: 0.015071570873260498
step: 350, task: Textual/Abt-Buy, loss: 0.03644365072250366
=========eval at epoch=3=========
Validation:
=============Textual/Abt-Buy==================
accuracy=0.919
precision=0.931
recall=0.262
f1=0.409
======================================
Test:
=============Textual/Abt-Buy==================
accuracy=0.924
precision=0.930
recall=0.320
f1=0.477
======================================
=====sanity check======
words: COL name VAL sharp 26 ' black lcd hdtv with built in dvd player lc26dv24u COL description VAL sharp 26 ' black lcd hdtv with built in dvd player lc26dv24u side loading progressive scan dvd player true 16:9 aspect ratio ( 1366 x 768 ) 500 cd/m2 brightness 800:1 contrast ratio 8ms response time 1 hdmi pc input black finish COL price VAL   [SEP] COL name VAL sharp lc26dv24u 26 ' tv/dvd combo COL description VAL sharp lc-26dv24u 26 ' widescreen tv/dvd combo hdtv 800:1 contrast ratio 8ms response time piano black COL price VAL 508.72 
x: [    0 18047   766 27445  4406   973   128   909   784 28690  1368   417
 18724    19  1490    11   385 40311   869   784   438  2481   417   705
  1978   257 14857  8194 27445  4406   973   128   909   784 28690  1368
   417 18724    19  1490    11   385 40311   869   784   438  2481   417
   705  1978   257   526 16761  8212 14194   385 40311   869  1528   545
    35   466  6659  1750    36   508  4280  3023 43751  4839  1764 45584
    73   119   176 27406  5735    35   134  5709  1750   290  4339  1263
    86   112  1368   417  5408 46213  8135   909  2073 14857   425 27445
  1437  1437     2     2 18047   766 27445  4406   784   438  2481   417
   705  1978   257   973   128 30016    73   417 40311 23358 14857  8194
 27445  4406   784   438    12  2481   417   705  1978   257   973   128
   885  4376 37346 30016    73   417 40311 23358  1368   417 18724  5735
    35   134  5709  1750   290  4339  1263    86 13305   909 14857   425
 27445   654   398     4  4956  1437     2]
tokens: ['<s>', 'COL', 'Ġname', 'ĠVAL', 'Ġsharp', 'Ġ26', "Ġ'", 'Ġblack', 'Ġl', 'cd', 'Ġh', 'd', 'tv', 'Ġwith', 'Ġbuilt', 'Ġin', 'Ġd', 'vd', 'Ġplayer', 'Ġl', 'c', '26', 'd', 'v', '24', 'u', 'ĠCOL', 'Ġdescription', 'ĠVAL', 'Ġsharp', 'Ġ26', "Ġ'", 'Ġblack', 'Ġl', 'cd', 'Ġh', 'd', 'tv', 'Ġwith', 'Ġbuilt', 'Ġin', 'Ġd', 'vd', 'Ġplayer', 'Ġl', 'c', '26', 'd', 'v', '24', 'u', 'Ġside', 'Ġloading', 'Ġprogressive', 'Ġscan', 'Ġd', 'vd', 'Ġplayer', 'Ġtrue', 'Ġ16', ':', '9', 'Ġaspect', 'Ġratio', 'Ġ(', 'Ġ13', '66', 'Ġx', 'Ġ768', 'Ġ)', 'Ġ500', 'Ġcd', '/', 'm', '2', 'Ġbrightness', 'Ġ800', ':', '1', 'Ġcontrast', 'Ġratio', 'Ġ8', 'ms', 'Ġresponse', 'Ġtime', 'Ġ1', 'Ġh', 'd', 'mi', 'Ġpc', 'Ġinput', 'Ġblack', 'Ġfinish', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ', 'Ġ', '</s>', '</s>', 'COL', 'Ġname', 'ĠVAL', 'Ġsharp', 'Ġl', 'c', '26', 'd', 'v', '24', 'u', 'Ġ26', "Ġ'", 'Ġtv', '/', 'd', 'vd', 'Ġcombo', 'ĠCOL', 'Ġdescription', 'ĠVAL', 'Ġsharp', 'Ġl', 'c', '-', '26', 'd', 'v', '24', 'u', 'Ġ26', "Ġ'", 'Ġw', 'ides', 'creen', 'Ġtv', '/', 'd', 'vd', 'Ġcombo', 'Ġh', 'd', 'tv', 'Ġ800', ':', '1', 'Ġcontrast', 'Ġratio', 'Ġ8', 'ms', 'Ġresponse', 'Ġtime', 'Ġpiano', 'Ġblack', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ50', '8', '.', '72', 'Ġ', '</s>']
is_heads: [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
y: 1
tags: 1
mask: tensor([1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1])
seqlen: 163
task_name: Textual/Abt-Buy
=======================
step: 0, task: Textual/Abt-Buy, loss: 0.07118396461009979
step: 10, task: Textual/Abt-Buy, loss: 0.027075186371803284
step: 20, task: Textual/Abt-Buy, loss: 0.016115345060825348
step: 30, task: Textual/Abt-Buy, loss: 0.0009161680936813354
step: 40, task: Textual/Abt-Buy, loss: 0.025698386132717133
step: 50, task: Textual/Abt-Buy, loss: 0.002132982015609741
step: 60, task: Textual/Abt-Buy, loss: 0.010068342089653015
step: 70, task: Textual/Abt-Buy, loss: 0.350913941860199
step: 80, task: Textual/Abt-Buy, loss: 0.01770767569541931
step: 90, task: Textual/Abt-Buy, loss: 0.003282710909843445
step: 100, task: Textual/Abt-Buy, loss: 0.003746628761291504
step: 110, task: Textual/Abt-Buy, loss: 0.27451273798942566
step: 120, task: Textual/Abt-Buy, loss: 0.013098984956741333
step: 130, task: Textual/Abt-Buy, loss: 0.44494375586509705
step: 140, task: Textual/Abt-Buy, loss: 0.008753366768360138
step: 150, task: Textual/Abt-Buy, loss: 0.006265968084335327
step: 160, task: Textual/Abt-Buy, loss: 0.0066300928592681885
step: 170, task: Textual/Abt-Buy, loss: 0.11423854529857635
step: 180, task: Textual/Abt-Buy, loss: 0.02614426612854004
step: 190, task: Textual/Abt-Buy, loss: 0.0009981989860534668
step: 200, task: Textual/Abt-Buy, loss: 0.05668652802705765
step: 210, task: Textual/Abt-Buy, loss: 0.08382655680179596
step: 220, task: Textual/Abt-Buy, loss: 0.019377857446670532
step: 230, task: Textual/Abt-Buy, loss: 0.3301757872104645
step: 240, task: Textual/Abt-Buy, loss: 0.018640272319316864
step: 250, task: Textual/Abt-Buy, loss: 0.045061007142066956
step: 260, task: Textual/Abt-Buy, loss: 0.023561567068099976
step: 270, task: Textual/Abt-Buy, loss: 0.0028124600648880005
step: 280, task: Textual/Abt-Buy, loss: 0.01553276926279068
step: 290, task: Textual/Abt-Buy, loss: 0.3744903802871704
step: 300, task: Textual/Abt-Buy, loss: 0.06100919470191002
step: 310, task: Textual/Abt-Buy, loss: 0.003755524754524231
step: 320, task: Textual/Abt-Buy, loss: 0.021601088345050812
step: 330, task: Textual/Abt-Buy, loss: 0.005631186068058014
step: 340, task: Textual/Abt-Buy, loss: 0.03225540369749069
step: 350, task: Textual/Abt-Buy, loss: 0.008016735315322876
=========eval at epoch=4=========
Validation:
=============Textual/Abt-Buy==================
accuracy=0.954
precision=0.864
recall=0.680
f1=0.761
======================================
Test:
=============Textual/Abt-Buy==================
accuracy=0.956
precision=0.891
recall=0.675
f1=0.768
======================================
=====sanity check======
words: COL name VAL canon ef-s 55-250mm f/4 -5.6 is telephoto zoom lens 2044b002 COL description VAL canon ef-s 55-250mm f/4 -5.6 is telephoto zoom lens 2044b002 55-250mm focal length f/4 -5.6 maximum aperture optical image stabilizer technology 4-stop stabilization correction ud-glass lens element gear-driven focus adjustment black finish COL price VAL   [SEP] COL name VAL canon eos rebel xsi digital slr camera with ef-s 18-55mm f/3 .5 -5.6 is lens black 2756b003 COL description VAL canon eos rebel xsi 12 megapixel digital slr camera with 18-55mm is lens black COL price VAL 649.88 
x: [    0 18047   766 27445 32839   364   506    12    29  3490    12  5714
  5471   856    73   306   111   245     4   401    16  8327 17827 21762
 10373   291  3305   428 19130 14857  8194 27445 32839   364   506    12
    29  3490    12  5714  5471   856    73   306   111   245     4   401
    16  8327 17827 21762 10373   291  3305   428 19130  3490    12  5714
  5471 22628  5933   856    73   306   111   245     4   401  4532 27399
 17547  2274 12964  6315   806   204    12  8287 29632 14921  1717   417
    12 19487 10373  7510  6351    12  9756  1056 13380   909  2073 14857
   425 27445  1437  1437     2     2 18047   766 27445 32839   364   366
  8829  3023 11000  1778  3369   338  2280    19   364   506    12    29
   504    12  3118  5471   856    73   246   479   245   111   245     4
   401    16 10373   909 25949   401   428 33490 14857  8194 27445 32839
   364   366  8829  3023 11000   316 10721 21424  1778  3369   338  2280
    19   504    12  3118  5471    16 10373   909 14857   425 27445   231
  3414     4  4652  1437     2]
tokens: ['<s>', 'COL', 'Ġname', 'ĠVAL', 'Ġcanon', 'Ġe', 'f', '-', 's', 'Ġ55', '-', '250', 'mm', 'Ġf', '/', '4', 'Ġ-', '5', '.', '6', 'Ġis', 'Ġtele', 'photo', 'Ġzoom', 'Ġlens', 'Ġ20', '44', 'b', '002', 'ĠCOL', 'Ġdescription', 'ĠVAL', 'Ġcanon', 'Ġe', 'f', '-', 's', 'Ġ55', '-', '250', 'mm', 'Ġf', '/', '4', 'Ġ-', '5', '.', '6', 'Ġis', 'Ġtele', 'photo', 'Ġzoom', 'Ġlens', 'Ġ20', '44', 'b', '002', 'Ġ55', '-', '250', 'mm', 'Ġfocal', 'Ġlength', 'Ġf', '/', '4', 'Ġ-', '5', '.', '6', 'Ġmaximum', 'Ġaperture', 'Ġoptical', 'Ġimage', 'Ġstabil', 'izer', 'Ġtechnology', 'Ġ4', '-', 'stop', 'Ġstabilization', 'Ġcorrection', 'Ġu', 'd', '-', 'glass', 'Ġlens', 'Ġelement', 'Ġgear', '-', 'driven', 'Ġfocus', 'Ġadjustment', 'Ġblack', 'Ġfinish', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ', 'Ġ', '</s>', '</s>', 'COL', 'Ġname', 'ĠVAL', 'Ġcanon', 'Ġe', 'os', 'Ġrebel', 'Ġx', 'si', 'Ġdigital', 'Ġsl', 'r', 'Ġcamera', 'Ġwith', 'Ġe', 'f', '-', 's', 'Ġ18', '-', '55', 'mm', 'Ġf', '/', '3', 'Ġ.', '5', 'Ġ-', '5', '.', '6', 'Ġis', 'Ġlens', 'Ġblack', 'Ġ275', '6', 'b', '003', 'ĠCOL', 'Ġdescription', 'ĠVAL', 'Ġcanon', 'Ġe', 'os', 'Ġrebel', 'Ġx', 'si', 'Ġ12', 'Ġmeg', 'apixel', 'Ġdigital', 'Ġsl', 'r', 'Ġcamera', 'Ġwith', 'Ġ18', '-', '55', 'mm', 'Ġis', 'Ġlens', 'Ġblack', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ6', '49', '.', '88', 'Ġ', '</s>']
is_heads: [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
y: 0
tags: 0
mask: tensor([1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1])
seqlen: 173
task_name: Textual/Abt-Buy
=======================
step: 0, task: Textual/Abt-Buy, loss: 0.0015286952257156372
step: 10, task: Textual/Abt-Buy, loss: 0.005424022674560547
step: 20, task: Textual/Abt-Buy, loss: 0.0016693174839019775
step: 30, task: Textual/Abt-Buy, loss: 0.3800833225250244
step: 40, task: Textual/Abt-Buy, loss: 0.02884630858898163
step: 50, task: Textual/Abt-Buy, loss: 0.011768236756324768
step: 60, task: Textual/Abt-Buy, loss: 0.00881553441286087
step: 70, task: Textual/Abt-Buy, loss: 0.003038927912712097
step: 80, task: Textual/Abt-Buy, loss: 0.0005231499671936035
step: 90, task: Textual/Abt-Buy, loss: 0.0011063963174819946
step: 100, task: Textual/Abt-Buy, loss: 0.001111552119255066
step: 110, task: Textual/Abt-Buy, loss: 0.0008644461631774902
step: 120, task: Textual/Abt-Buy, loss: 0.08883602917194366
step: 130, task: Textual/Abt-Buy, loss: 0.014349699020385742
step: 140, task: Textual/Abt-Buy, loss: 0.0012839138507843018
step: 150, task: Textual/Abt-Buy, loss: 0.0014144033193588257
step: 160, task: Textual/Abt-Buy, loss: 0.0016840994358062744
step: 170, task: Textual/Abt-Buy, loss: 0.13427290320396423
step: 180, task: Textual/Abt-Buy, loss: 0.007683277130126953
step: 190, task: Textual/Abt-Buy, loss: 0.006352484226226807
step: 200, task: Textual/Abt-Buy, loss: 0.0010249614715576172
step: 210, task: Textual/Abt-Buy, loss: 0.0006723552942276001
step: 220, task: Textual/Abt-Buy, loss: 0.0010086745023727417
step: 230, task: Textual/Abt-Buy, loss: 0.00895138829946518
step: 240, task: Textual/Abt-Buy, loss: 0.0012175440788269043
step: 250, task: Textual/Abt-Buy, loss: 0.08250140398740768
step: 260, task: Textual/Abt-Buy, loss: 0.046766750514507294
step: 270, task: Textual/Abt-Buy, loss: 0.013158813118934631
step: 280, task: Textual/Abt-Buy, loss: 0.02856011688709259
step: 290, task: Textual/Abt-Buy, loss: 0.0011761784553527832
step: 300, task: Textual/Abt-Buy, loss: 0.015564680099487305
step: 310, task: Textual/Abt-Buy, loss: 0.0012217611074447632
step: 320, task: Textual/Abt-Buy, loss: 0.0015431344509124756
step: 330, task: Textual/Abt-Buy, loss: 0.0078645721077919
step: 340, task: Textual/Abt-Buy, loss: 0.133131742477417
step: 350, task: Textual/Abt-Buy, loss: 0.0016944706439971924
=========eval at epoch=5=========
Validation:
=============Textual/Abt-Buy==================
accuracy=0.957
precision=0.907
recall=0.665
f1=0.768
======================================
Test:
=============Textual/Abt-Buy==================
accuracy=0.966
precision=0.933
recall=0.738
f1=0.824
======================================
=====sanity check======
words: COL name VAL sony 7.1 channel black a/v receiver strdg720 COL description VAL sony 7.1 channel black a/v receiver strdg720 105 watts x 7 amplifier power accepts 1080/60p and 24p video signal via hdmi bravia sync digital media port digital cinema auto calibration digital cinema sound dolby digital , dolby digital ex , dolby pro logic ii , dolby pro logic iix , dts , dts-es , dts 96/24 , dts neo :6 decoding black finish COL price VAL   [SEP] COL name VAL sony str-de197 av receiver 100 watts per channel COL description VAL  COL price VAL 122.43 
x: [    0 18047   766 27445   579  6119   262     4   134  4238   909    10
    73   705  4797  7031   417   571 29721 14857  8194 27445   579  6119
   262     4   134  4238   909    10    73   705  4797  7031   417   571
 29721 11061 42574  3023   262 42521   476 14564 21083    73  2466   642
     8   706   642   569  6029  1241  1368   417  5408 35977   493 22785
  1778   433  4103  1778 11605  4485 42269  1778 11605  2369   385  1168
  1409  1778  2156   385  1168  1409  1778  1931  2156   385  1168  1409
  1759 14578 42661  2156   385  1168  1409  1759 14578   939  3181  2156
   385  1872  2156   385  1872    12   293  2156   385  1872  8971    73
  1978  2156   385  1872 17863  4832   401 46133   909  2073 14857   425
 27445  1437  1437     2     2 18047   766 27445   579  6119  7031    12
  2794 30586  6402  4797   727 42574   228  4238 14857  8194 27445  1437
 14857   425 27445 18817     4  3897  1437     2]
tokens: ['<s>', 'COL', 'Ġname', 'ĠVAL', 'Ġs', 'ony', 'Ġ7', '.', '1', 'Ġchannel', 'Ġblack', 'Ġa', '/', 'v', 'Ġreceiver', 'Ġstr', 'd', 'g', '720', 'ĠCOL', 'Ġdescription', 'ĠVAL', 'Ġs', 'ony', 'Ġ7', '.', '1', 'Ġchannel', 'Ġblack', 'Ġa', '/', 'v', 'Ġreceiver', 'Ġstr', 'd', 'g', '720', 'Ġ105', 'Ġwatts', 'Ġx', 'Ġ7', 'Ġamplifier', 'Ġpower', 'Ġaccepts', 'Ġ1080', '/', '60', 'p', 'Ġand', 'Ġ24', 'p', 'Ġvideo', 'Ġsignal', 'Ġvia', 'Ġh', 'd', 'mi', 'Ġbrav', 'ia', 'Ġsync', 'Ġdigital', 'Ġmedia', 'Ġport', 'Ġdigital', 'Ġcinema', 'Ġauto', 'Ġcalibration', 'Ġdigital', 'Ġcinema', 'Ġsound', 'Ġd', 'ol', 'by', 'Ġdigital', 'Ġ,', 'Ġd', 'ol', 'by', 'Ġdigital', 'Ġex', 'Ġ,', 'Ġd', 'ol', 'by', 'Ġpro', 'Ġlogic', 'Ġii', 'Ġ,', 'Ġd', 'ol', 'by', 'Ġpro', 'Ġlogic', 'Ġi', 'ix', 'Ġ,', 'Ġd', 'ts', 'Ġ,', 'Ġd', 'ts', '-', 'es', 'Ġ,', 'Ġd', 'ts', 'Ġ96', '/', '24', 'Ġ,', 'Ġd', 'ts', 'Ġneo', 'Ġ:', '6', 'Ġdecoding', 'Ġblack', 'Ġfinish', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ', 'Ġ', '</s>', '</s>', 'COL', 'Ġname', 'ĠVAL', 'Ġs', 'ony', 'Ġstr', '-', 'de', '197', 'Ġav', 'Ġreceiver', 'Ġ100', 'Ġwatts', 'Ġper', 'Ġchannel', 'ĠCOL', 'Ġdescription', 'ĠVAL', 'Ġ', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ122', '.', '43', 'Ġ', '</s>']
is_heads: [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
y: 0
tags: 0
mask: tensor([1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1])
seqlen: 152
task_name: Textual/Abt-Buy
=======================
step: 0, task: Textual/Abt-Buy, loss: 0.008859045803546906
step: 10, task: Textual/Abt-Buy, loss: 0.011864647269248962
step: 20, task: Textual/Abt-Buy, loss: 0.11478262394666672
step: 30, task: Textual/Abt-Buy, loss: 0.002392783761024475
step: 40, task: Textual/Abt-Buy, loss: 0.005467891693115234
step: 50, task: Textual/Abt-Buy, loss: 0.004544079303741455
step: 60, task: Textual/Abt-Buy, loss: 0.0019933730363845825
step: 70, task: Textual/Abt-Buy, loss: 0.0019420534372329712
step: 80, task: Textual/Abt-Buy, loss: 0.0014354288578033447
step: 90, task: Textual/Abt-Buy, loss: 0.0019344240427017212
step: 100, task: Textual/Abt-Buy, loss: 0.0007907897233963013
step: 110, task: Textual/Abt-Buy, loss: 0.0006144344806671143
Gradient overflow.  Skipping step, loss scaler 0 reducing loss scale to 4096.0
step: 120, task: Textual/Abt-Buy, loss: 0.3925567865371704
step: 130, task: Textual/Abt-Buy, loss: 0.03897558152675629
step: 140, task: Textual/Abt-Buy, loss: 0.002520143985748291
step: 150, task: Textual/Abt-Buy, loss: 0.015056073665618896
step: 160, task: Textual/Abt-Buy, loss: 0.09616231173276901
step: 170, task: Textual/Abt-Buy, loss: 0.15429744124412537
step: 180, task: Textual/Abt-Buy, loss: 0.0026812702417373657
step: 190, task: Textual/Abt-Buy, loss: 0.0029176920652389526
step: 200, task: Textual/Abt-Buy, loss: 0.17908254265785217
step: 210, task: Textual/Abt-Buy, loss: 0.0034508556127548218
step: 220, task: Textual/Abt-Buy, loss: 0.005549013614654541
step: 230, task: Textual/Abt-Buy, loss: 0.0018658041954040527
step: 240, task: Textual/Abt-Buy, loss: 0.00439867377281189
step: 250, task: Textual/Abt-Buy, loss: 0.001138925552368164
step: 260, task: Textual/Abt-Buy, loss: 0.0024116337299346924
step: 270, task: Textual/Abt-Buy, loss: 0.0010709911584854126
step: 280, task: Textual/Abt-Buy, loss: 0.03875613957643509
step: 290, task: Textual/Abt-Buy, loss: 0.0007383823394775391
step: 300, task: Textual/Abt-Buy, loss: 0.0006075948476791382
step: 310, task: Textual/Abt-Buy, loss: 0.002020120620727539
step: 320, task: Textual/Abt-Buy, loss: 0.0007569342851638794
step: 330, task: Textual/Abt-Buy, loss: 0.0004666149616241455
step: 340, task: Textual/Abt-Buy, loss: 0.00046546757221221924
step: 350, task: Textual/Abt-Buy, loss: 0.0007322430610656738
=========eval at epoch=6=========
Validation:
=============Textual/Abt-Buy==================
accuracy=0.954
precision=0.893
recall=0.646
f1=0.749
======================================
Test:
=============Textual/Abt-Buy==================
accuracy=0.960
precision=0.891
recall=0.714
f1=0.792
======================================
=====sanity check======
words: COL name VAL kenwood kca-ip300v ipod video direct cable kcaip300v COL description VAL kenwood kca-ip300v ipod video direct cable kcaip300v ipod video direct cable for dnx7100 , ddx7019 and kvt719dvd indash monitors COL price VAL 49.99  [SEP] COL name VAL kenwood ipod direct cable kcaip200 COL description VAL 1 x proprietary 1 x mini-phone stereo , 1 x type a COL price VAL 19.72 
x: [    0 18047   766 27445   449   225  1845   449  3245    12  1588  2965
   705 36180  1630   569  2228  6129   449  3245  1588  2965   705 14857
  8194 27445   449   225  1845   449  3245    12  1588  2965   705 36180
  1630   569  2228  6129   449  3245  1588  2965   705 36180  1630   569
  2228  6129    13   385   282  1178   406  1866  2156   385 46106   406
 36632     8   449 26390   406  1646   417 40311  9473  1671 14516 14857
   425 27445  2766     4  2831  1437     2     2 18047   766 27445   449
   225  1845 36180  1630  2228  6129   449  3245  1588  2619 14857  8194
 27445   112  3023 14101   112  3023  7983    12 17283 31436  2156   112
  3023  1907    10 14857   425 27445   753     4  4956  1437     2]
tokens: ['<s>', 'COL', 'Ġname', 'ĠVAL', 'Ġk', 'en', 'wood', 'Ġk', 'ca', '-', 'ip', '300', 'v', 'Ġip', 'od', 'Ġvideo', 'Ġdirect', 'Ġcable', 'Ġk', 'ca', 'ip', '300', 'v', 'ĠCOL', 'Ġdescription', 'ĠVAL', 'Ġk', 'en', 'wood', 'Ġk', 'ca', '-', 'ip', '300', 'v', 'Ġip', 'od', 'Ġvideo', 'Ġdirect', 'Ġcable', 'Ġk', 'ca', 'ip', '300', 'v', 'Ġip', 'od', 'Ġvideo', 'Ġdirect', 'Ġcable', 'Ġfor', 'Ġd', 'n', 'x', '7', '100', 'Ġ,', 'Ġd', 'dx', '7', '019', 'Ġand', 'Ġk', 'vt', '7', '19', 'd', 'vd', 'Ġind', 'ash', 'Ġmonitors', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ49', '.', '99', 'Ġ', '</s>', '</s>', 'COL', 'Ġname', 'ĠVAL', 'Ġk', 'en', 'wood', 'Ġip', 'od', 'Ġdirect', 'Ġcable', 'Ġk', 'ca', 'ip', '200', 'ĠCOL', 'Ġdescription', 'ĠVAL', 'Ġ1', 'Ġx', 'Ġproprietary', 'Ġ1', 'Ġx', 'Ġmini', '-', 'phone', 'Ġstereo', 'Ġ,', 'Ġ1', 'Ġx', 'Ġtype', 'Ġa', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ19', '.', '72', 'Ġ', '</s>']
is_heads: [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
y: 0
tags: 0
mask: tensor([1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1])
seqlen: 119
task_name: Textual/Abt-Buy
=======================
step: 0, task: Textual/Abt-Buy, loss: 0.4083338677883148
step: 10, task: Textual/Abt-Buy, loss: 0.012563236057758331
step: 20, task: Textual/Abt-Buy, loss: 0.00045658648014068604
step: 30, task: Textual/Abt-Buy, loss: 0.0003397911787033081
step: 40, task: Textual/Abt-Buy, loss: 0.00048200786113739014
step: 50, task: Textual/Abt-Buy, loss: 0.0026673823595046997
step: 60, task: Textual/Abt-Buy, loss: 0.000224381685256958
step: 70, task: Textual/Abt-Buy, loss: 0.0004905164241790771
step: 80, task: Textual/Abt-Buy, loss: 0.0011658668518066406
step: 90, task: Textual/Abt-Buy, loss: 0.00047440826892852783
step: 100, task: Textual/Abt-Buy, loss: 0.00029639899730682373
step: 110, task: Textual/Abt-Buy, loss: 0.11128327995538712
step: 120, task: Textual/Abt-Buy, loss: 0.0006052553653717041
step: 130, task: Textual/Abt-Buy, loss: 0.0006605833768844604
step: 140, task: Textual/Abt-Buy, loss: 0.003198862075805664
step: 150, task: Textual/Abt-Buy, loss: 0.0009816735982894897
step: 160, task: Textual/Abt-Buy, loss: 0.006786033511161804
step: 170, task: Textual/Abt-Buy, loss: 0.0005918145179748535
step: 180, task: Textual/Abt-Buy, loss: 0.04467704892158508
step: 190, task: Textual/Abt-Buy, loss: 0.0007038861513137817
step: 200, task: Textual/Abt-Buy, loss: 0.00037501752376556396
step: 210, task: Textual/Abt-Buy, loss: 0.00040124356746673584
step: 220, task: Textual/Abt-Buy, loss: 0.0004379153251647949
step: 230, task: Textual/Abt-Buy, loss: 0.000921294093132019
step: 240, task: Textual/Abt-Buy, loss: 0.019224703311920166
step: 250, task: Textual/Abt-Buy, loss: 0.00037892162799835205
step: 260, task: Textual/Abt-Buy, loss: 0.0015245229005813599
step: 270, task: Textual/Abt-Buy, loss: 0.0019932985305786133
step: 280, task: Textual/Abt-Buy, loss: 0.010989896953105927
step: 290, task: Textual/Abt-Buy, loss: 0.001844644546508789
step: 300, task: Textual/Abt-Buy, loss: 0.0009396225214004517
step: 310, task: Textual/Abt-Buy, loss: 0.048849478363990784
step: 320, task: Textual/Abt-Buy, loss: 0.035085394978523254
step: 330, task: Textual/Abt-Buy, loss: 0.0005473941564559937
step: 340, task: Textual/Abt-Buy, loss: 0.0028678923845291138
step: 350, task: Textual/Abt-Buy, loss: 0.009993650019168854
=========eval at epoch=7=========
Validation:
=============Textual/Abt-Buy==================
accuracy=0.952
precision=0.896
recall=0.626
f1=0.737
======================================
Test:
=============Textual/Abt-Buy==================
accuracy=0.961
precision=0.929
recall=0.694
f1=0.794
======================================
=====sanity check======
words: COL name VAL olympus lithium ion rechargeable battery li42b COL description VAL olympus li-42b lithium ion rechargeable battery li42b compatible with stylus 730 , 7200sw , 770se , 710 , 740 and fe230 COL price VAL   [SEP] COL name VAL panasonic lithium ion digital camera battery cgr-s006a / 1b COL description VAL lithium ion ( li-ion ) photo battery COL price VAL 49.99 
x: [    0 18047   766 27445  1021 31434   687 16904 31973 25850   868  3822
 16787  3714   428 14857  8194 27445  1021 31434   687 16787    12  3714
   428 16904 31973 25850   868  3822 16787  3714   428 16632    19 15240
   687   262   541  2156   262  2619  4184  2156 39570  1090  2156   262
   698  2156   262  1749     8 10668 20352 14857   425 27445  1437  1437
     2     2 18047   766 27445  5730 38703 16904 31973  1778  2280  3822
   740  6504    12    29 38049   102  1589   112   428 14857  8194 27445
 16904 31973    36 16787    12  1499  4839  1345  3822 14857   425 27445
  2766     4  2831  1437     2]
tokens: ['<s>', 'COL', 'Ġname', 'ĠVAL', 'Ġo', 'lymp', 'us', 'Ġlithium', 'Ġion', 'Ġrecharge', 'able', 'Ġbattery', 'Ġli', '42', 'b', 'ĠCOL', 'Ġdescription', 'ĠVAL', 'Ġo', 'lymp', 'us', 'Ġli', '-', '42', 'b', 'Ġlithium', 'Ġion', 'Ġrecharge', 'able', 'Ġbattery', 'Ġli', '42', 'b', 'Ġcompatible', 'Ġwith', 'Ġstyl', 'us', 'Ġ7', '30', 'Ġ,', 'Ġ7', '200', 'sw', 'Ġ,', 'Ġ770', 'se', 'Ġ,', 'Ġ7', '10', 'Ġ,', 'Ġ7', '40', 'Ġand', 'Ġfe', '230', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ', 'Ġ', '</s>', '</s>', 'COL', 'Ġname', 'ĠVAL', 'Ġpan', 'asonic', 'Ġlithium', 'Ġion', 'Ġdigital', 'Ġcamera', 'Ġbattery', 'Ġc', 'gr', '-', 's', '006', 'a', 'Ġ/', 'Ġ1', 'b', 'ĠCOL', 'Ġdescription', 'ĠVAL', 'Ġlithium', 'Ġion', 'Ġ(', 'Ġli', '-', 'ion', 'Ġ)', 'Ġphoto', 'Ġbattery', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ49', '.', '99', 'Ġ', '</s>']
is_heads: [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
y: 0
tags: 0
mask: tensor([1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1])
seqlen: 101
task_name: Textual/Abt-Buy
=======================
step: 0, task: Textual/Abt-Buy, loss: 0.001254752278327942
step: 10, task: Textual/Abt-Buy, loss: 0.0017711222171783447
step: 20, task: Textual/Abt-Buy, loss: 0.008214332163333893
step: 30, task: Textual/Abt-Buy, loss: 0.007637783885002136
step: 40, task: Textual/Abt-Buy, loss: 0.001605108380317688
step: 50, task: Textual/Abt-Buy, loss: 0.001089721918106079
step: 60, task: Textual/Abt-Buy, loss: 0.00037676095962524414
step: 70, task: Textual/Abt-Buy, loss: 0.0009684115648269653
step: 80, task: Textual/Abt-Buy, loss: 0.007079385221004486
step: 90, task: Textual/Abt-Buy, loss: 0.0005802065134048462
step: 100, task: Textual/Abt-Buy, loss: 0.0008425712585449219
step: 110, task: Textual/Abt-Buy, loss: 0.00029969215393066406
step: 120, task: Textual/Abt-Buy, loss: 0.014171436429023743
step: 130, task: Textual/Abt-Buy, loss: 0.19477787613868713
step: 140, task: Textual/Abt-Buy, loss: 0.0007478594779968262
step: 150, task: Textual/Abt-Buy, loss: 0.00030624866485595703
step: 160, task: Textual/Abt-Buy, loss: 0.012725591659545898
step: 170, task: Textual/Abt-Buy, loss: 0.013994596898555756
step: 180, task: Textual/Abt-Buy, loss: 0.013497136533260345
step: 190, task: Textual/Abt-Buy, loss: 0.0001933276653289795
step: 200, task: Textual/Abt-Buy, loss: 0.16298651695251465
step: 210, task: Textual/Abt-Buy, loss: 0.00032970309257507324
step: 220, task: Textual/Abt-Buy, loss: 0.0003506392240524292
step: 230, task: Textual/Abt-Buy, loss: 0.0007186084985733032
step: 240, task: Textual/Abt-Buy, loss: 0.001178845763206482
step: 250, task: Textual/Abt-Buy, loss: 0.02363697439432144
step: 260, task: Textual/Abt-Buy, loss: 0.0004608035087585449
step: 270, task: Textual/Abt-Buy, loss: 0.0004403740167617798
step: 280, task: Textual/Abt-Buy, loss: 0.00031313300132751465
step: 290, task: Textual/Abt-Buy, loss: 0.0003266632556915283
step: 300, task: Textual/Abt-Buy, loss: 0.0043219998478889465
step: 310, task: Textual/Abt-Buy, loss: 0.00030969083309173584
step: 320, task: Textual/Abt-Buy, loss: 0.0003541707992553711
step: 330, task: Textual/Abt-Buy, loss: 0.0011116564273834229
step: 340, task: Textual/Abt-Buy, loss: 0.0033612698316574097
step: 350, task: Textual/Abt-Buy, loss: 0.000403672456741333
=========eval at epoch=8=========
Validation:
=============Textual/Abt-Buy==================
accuracy=0.949
precision=0.861
recall=0.631
f1=0.728
======================================
Test:
=============Textual/Abt-Buy==================
accuracy=0.962
precision=0.919
recall=0.714
f1=0.803
======================================
Selected optimization level O2:  FP16 training with FP32 batchnorm and FP32 master weights.

Defaults for this optimization level are:
enabled                : True
opt_level              : O2
cast_model_type        : torch.float16
patch_torch_functions  : False
keep_batchnorm_fp32    : True
master_weights         : True
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O2
cast_model_type        : torch.float16
patch_torch_functions  : False
keep_batchnorm_fp32    : True
master_weights         : True
loss_scale             : dynamic
Warning:  multi_tensor_applier fused unscale kernel is unavailable, possibly because apex was installed without --cuda_ext --cpp_ext. Using Python fallback.  Original ImportError was: ModuleNotFoundError("No module named 'amp_C'")
Gradient overflow.  Skipping step, loss scaler 0 reducing loss scale to 32768.0
=====sanity check======
words: COL name VAL hoover bagged tempo widepath upright vacuum u5140 COL description VAL hoover u5140-900 bagged tempo widepath upright vacuum u5140 filter traps 100 percent dust mites , 99.98 percent ragweed and common grass pollens powerful 12 amp motor filter bag check for optimum cleaner performance 15 ' cleaner width COL price VAL   [SEP] COL name VAL hoover empower u5269-900 vacuum ( upright , hepa , bagless ) COL description VAL  COL price VAL  
x: [    0 18047   766 27445  1368  3036  2802  3298  4462 20889  1810 22609
 25922 15702  1717   245 14753 14857  8194 27445  1368  3036  2802  1717
   245 14753    12  7784  3298  4462 20889  1810 22609 25922 15702  1717
   245 14753 14929 25583   727   135  8402   475  5110  2156  6705     4
  5208   135 31179 35824     8  1537  6964  2902  1290  2247   316 28127
  4243 14929  3298  1649    13 33771 16126   819   379   128 16126 22523
 14857   425 27445  1437  1437     2     2 18047   766 27445  1368  3036
  2802 15519  1717   245 31416    12  7784 15702    36 25922  2156    37
  6709  2156  3298  1672  4839 14857  8194 27445  1437 14857   425 27445
  1437  1437     2]
tokens: ['<s>', 'COL', 'Ġname', 'ĠVAL', 'Ġh', 'oo', 'ver', 'Ġbag', 'ged', 'Ġtempo', 'Ġwide', 'path', 'Ġupright', 'Ġvacuum', 'Ġu', '5', '140', 'ĠCOL', 'Ġdescription', 'ĠVAL', 'Ġh', 'oo', 'ver', 'Ġu', '5', '140', '-', '900', 'Ġbag', 'ged', 'Ġtempo', 'Ġwide', 'path', 'Ġupright', 'Ġvacuum', 'Ġu', '5', '140', 'Ġfilter', 'Ġtraps', 'Ġ100', 'Ġpercent', 'Ġdust', 'Ġm', 'ites', 'Ġ,', 'Ġ99', '.', '98', 'Ġpercent', 'Ġrag', 'weed', 'Ġand', 'Ġcommon', 'Ġgrass', 'Ġpoll', 'ens', 'Ġpowerful', 'Ġ12', 'Ġamp', 'Ġmotor', 'Ġfilter', 'Ġbag', 'Ġcheck', 'Ġfor', 'Ġoptimum', 'Ġcleaner', 'Ġperformance', 'Ġ15', "Ġ'", 'Ġcleaner', 'Ġwidth', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ', 'Ġ', '</s>', '</s>', 'COL', 'Ġname', 'ĠVAL', 'Ġh', 'oo', 'ver', 'Ġempower', 'Ġu', '5', '269', '-', '900', 'Ġvacuum', 'Ġ(', 'Ġupright', 'Ġ,', 'Ġhe', 'pa', 'Ġ,', 'Ġbag', 'less', 'Ġ)', 'ĠCOL', 'Ġdescription', 'ĠVAL', 'Ġ', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ', 'Ġ', '</s>']
is_heads: [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
y: 0
tags: 0
mask: tensor([1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1])
seqlen: 111
task_name: Textual/Abt-Buy
=======================
step: 0, task: Textual/Abt-Buy, loss: 1.066542387008667
Gradient overflow.  Skipping step, loss scaler 0 reducing loss scale to 16384.0
Gradient overflow.  Skipping step, loss scaler 0 reducing loss scale to 8192.0
Gradient overflow.  Skipping step, loss scaler 0 reducing loss scale to 4096.0
step: 10, task: Textual/Abt-Buy, loss: 0.9503033757209778
step: 20, task: Textual/Abt-Buy, loss: 0.8406859040260315
step: 30, task: Textual/Abt-Buy, loss: 0.7914289236068726
step: 40, task: Textual/Abt-Buy, loss: 0.7295212149620056
step: 50, task: Textual/Abt-Buy, loss: 0.4554430842399597
step: 60, task: Textual/Abt-Buy, loss: 0.23966620862483978
step: 70, task: Textual/Abt-Buy, loss: 0.11192411929368973
step: 80, task: Textual/Abt-Buy, loss: 0.21631436049938202
step: 90, task: Textual/Abt-Buy, loss: 0.36527329683303833
step: 100, task: Textual/Abt-Buy, loss: 0.34227657318115234
step: 110, task: Textual/Abt-Buy, loss: 0.3767988383769989
step: 120, task: Textual/Abt-Buy, loss: 0.0818268209695816
step: 130, task: Textual/Abt-Buy, loss: 0.3605073392391205
step: 140, task: Textual/Abt-Buy, loss: 0.53282630443573
step: 150, task: Textual/Abt-Buy, loss: 0.5107970237731934
step: 160, task: Textual/Abt-Buy, loss: 0.2583281695842743
step: 170, task: Textual/Abt-Buy, loss: 0.234073206782341
step: 180, task: Textual/Abt-Buy, loss: 0.22915785014629364
step: 190, task: Textual/Abt-Buy, loss: 0.22811774909496307
step: 200, task: Textual/Abt-Buy, loss: 0.7975832223892212
step: 210, task: Textual/Abt-Buy, loss: 0.5145654082298279
step: 220, task: Textual/Abt-Buy, loss: 0.744849681854248
step: 230, task: Textual/Abt-Buy, loss: 0.4144059717655182
step: 240, task: Textual/Abt-Buy, loss: 0.5218434929847717
step: 250, task: Textual/Abt-Buy, loss: 0.19624826312065125
step: 260, task: Textual/Abt-Buy, loss: 0.12860676646232605
step: 270, task: Textual/Abt-Buy, loss: 0.22919948399066925
step: 280, task: Textual/Abt-Buy, loss: 0.4043099880218506
step: 290, task: Textual/Abt-Buy, loss: 0.35311055183410645
step: 300, task: Textual/Abt-Buy, loss: 0.46756696701049805
step: 310, task: Textual/Abt-Buy, loss: 0.6609849333763123
step: 320, task: Textual/Abt-Buy, loss: 0.24779169261455536
step: 330, task: Textual/Abt-Buy, loss: 0.11830713599920273
step: 340, task: Textual/Abt-Buy, loss: 0.3831842839717865
step: 350, task: Textual/Abt-Buy, loss: 0.23085322976112366
=========eval at epoch=1=========
Validation:
=============Textual/Abt-Buy==================
accuracy=0.892
precision=0.000
recall=0.000
f1=0.000
======================================
Test:
=============Textual/Abt-Buy==================
accuracy=0.892
precision=0.000
recall=0.000
f1=0.000
======================================
/w/246/tianyu2020/miniconda2/envs/ditto/lib/python3.7/site-packages/apex/amp/_initialize.py:24: UserWarning: An input tensor was not cuda.
  warnings.warn("An input tensor was not cuda.")
/w/246/tianyu2020/miniconda2/envs/ditto/lib/python3.7/site-packages/torch/optim/lr_scheduler.py:122: UserWarning: Detected call of `lr_scheduler.step()` before `optimizer.step()`. In PyTorch 1.1.0 and later, you should call them in the opposite order: `optimizer.step()` before `lr_scheduler.step()`.  Failure to do this will result in PyTorch skipping the first value of the learning rate schedule. See more details at https://pytorch.org/docs/stable/optim.html#how-to-adjust-learning-rate
  "https://pytorch.org/docs/stable/optim.html#how-to-adjust-learning-rate", UserWarning)
/w/246/tianyu2020/miniconda2/envs/ditto/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1221: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
=====sanity check======
words: COL name VAL sony slv-d380p black dvd vhs combo player slvd380p COL description VAL sony slv-d380p black dvd vhs combo player slvd380p line input recording component output progressive output multi-brand tv remote control cd , mp3 , and jpeg playback 4-head hi-fi stereo auto head cleaner black finish no tuner COL price VAL   [SEP] COL name VAL sony dvp-nc800h / s dvd player dvp-nc800hs COL description VAL dvd + rw , dvd-rw , dvd + r , dvd-r , cd-rw dvd video , cd-da , jpeg , mp3 , svcd , video cd playback 5 disc ( s ) progressive scan silver COL price VAL 128.69 
x: [    0 18047   766 27445   579  6119  3369   705    12   417 19148   642
   909   385 40311   748 15354 23358   869  3369 40311 19148   642 14857
  8194 27445   579  6119  3369   705    12   417 19148   642   909   385
 40311   748 15354 23358   869  3369 40311 19148   642   516  8135  5492
  7681  4195  8212  4195  3228    12 11638 30016  6063   797 45584  2156
 44857   246  2156     8  1236 41191 20083   204    12  3628 20280    12
  9169 31436  4485   471 16126   909  2073   117 27115   254 14857   425
 27445  1437  1437     2     2 18047   766 27445   579  6119   385 45883
    12 11326  3913   298  1589   579   385 40311   869   385 45883    12
 11326  3913 15354 14857  8194 27445   385 40311  2055   910   605  2156
   385 40311    12 43926  2156   385 40311  2055   910  2156   385 40311
    12   338  2156 45584    12 43926   385 40311   569  2156 45584    12
  6106  2156  1236 41191  2156 44857   246  2156 23119 28690  2156   569
 45584 20083   195  9553    36   579  4839  8212 14194  4334 14857   425
 27445 13950     4  4563  1437     2]
tokens: ['<s>', 'COL', 'Ġname', 'ĠVAL', 'Ġs', 'ony', 'Ġsl', 'v', '-', 'd', '380', 'p', 'Ġblack', 'Ġd', 'vd', 'Ġv', 'hs', 'Ġcombo', 'Ġplayer', 'Ġsl', 'vd', '380', 'p', 'ĠCOL', 'Ġdescription', 'ĠVAL', 'Ġs', 'ony', 'Ġsl', 'v', '-', 'd', '380', 'p', 'Ġblack', 'Ġd', 'vd', 'Ġv', 'hs', 'Ġcombo', 'Ġplayer', 'Ġsl', 'vd', '380', 'p', 'Ġline', 'Ġinput', 'Ġrecording', 'Ġcomponent', 'Ġoutput', 'Ġprogressive', 'Ġoutput', 'Ġmulti', '-', 'brand', 'Ġtv', 'Ġremote', 'Ġcontrol', 'Ġcd', 'Ġ,', 'Ġmp', '3', 'Ġ,', 'Ġand', 'Ġj', 'peg', 'Ġplayback', 'Ġ4', '-', 'head', 'Ġhi', '-', 'fi', 'Ġstereo', 'Ġauto', 'Ġhead', 'Ġcleaner', 'Ġblack', 'Ġfinish', 'Ġno', 'Ġtun', 'er', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ', 'Ġ', '</s>', '</s>', 'COL', 'Ġname', 'ĠVAL', 'Ġs', 'ony', 'Ġd', 'vp', '-', 'nc', '800', 'h', 'Ġ/', 'Ġs', 'Ġd', 'vd', 'Ġplayer', 'Ġd', 'vp', '-', 'nc', '800', 'hs', 'ĠCOL', 'Ġdescription', 'ĠVAL', 'Ġd', 'vd', 'Ġ+', 'Ġr', 'w', 'Ġ,', 'Ġd', 'vd', '-', 'rw', 'Ġ,', 'Ġd', 'vd', 'Ġ+', 'Ġr', 'Ġ,', 'Ġd', 'vd', '-', 'r', 'Ġ,', 'Ġcd', '-', 'rw', 'Ġd', 'vd', 'Ġvideo', 'Ġ,', 'Ġcd', '-', 'da', 'Ġ,', 'Ġj', 'peg', 'Ġ,', 'Ġmp', '3', 'Ġ,', 'Ġsv', 'cd', 'Ġ,', 'Ġvideo', 'Ġcd', 'Ġplayback', 'Ġ5', 'Ġdisc', 'Ġ(', 'Ġs', 'Ġ)', 'Ġprogressive', 'Ġscan', 'Ġsilver', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ128', '.', '69', 'Ġ', '</s>']
is_heads: [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
y: 0
tags: 0
mask: tensor([1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1])
seqlen: 174
task_name: Textual/Abt-Buy
=======================
step: 0, task: Textual/Abt-Buy, loss: 0.48888203501701355
step: 10, task: Textual/Abt-Buy, loss: 0.37009483575820923
step: 20, task: Textual/Abt-Buy, loss: 0.3925073444843292
step: 30, task: Textual/Abt-Buy, loss: 0.251045823097229
step: 40, task: Textual/Abt-Buy, loss: 0.23577472567558289
step: 50, task: Textual/Abt-Buy, loss: 0.1491956114768982
step: 60, task: Textual/Abt-Buy, loss: 0.15221677720546722
step: 70, task: Textual/Abt-Buy, loss: 0.21906143426895142
step: 80, task: Textual/Abt-Buy, loss: 0.1832929402589798
step: 90, task: Textual/Abt-Buy, loss: 0.370730996131897
step: 100, task: Textual/Abt-Buy, loss: 0.023863263428211212
step: 110, task: Textual/Abt-Buy, loss: 0.1082121878862381
step: 120, task: Textual/Abt-Buy, loss: 0.32710015773773193
step: 130, task: Textual/Abt-Buy, loss: 0.08935687690973282
step: 140, task: Textual/Abt-Buy, loss: 1.0573647022247314
step: 150, task: Textual/Abt-Buy, loss: 0.2980157732963562
step: 160, task: Textual/Abt-Buy, loss: 0.36697620153427124
step: 170, task: Textual/Abt-Buy, loss: 0.07255390286445618
step: 180, task: Textual/Abt-Buy, loss: 0.22460058331489563
step: 190, task: Textual/Abt-Buy, loss: 0.27223050594329834
step: 200, task: Textual/Abt-Buy, loss: 0.251059353351593
step: 210, task: Textual/Abt-Buy, loss: 0.22875742614269257
step: 220, task: Textual/Abt-Buy, loss: 0.363920658826828
step: 230, task: Textual/Abt-Buy, loss: 0.14332705736160278
step: 240, task: Textual/Abt-Buy, loss: 0.09073110669851303
step: 250, task: Textual/Abt-Buy, loss: 0.27596455812454224
step: 260, task: Textual/Abt-Buy, loss: 0.24954083561897278
step: 270, task: Textual/Abt-Buy, loss: 0.06327220797538757
step: 280, task: Textual/Abt-Buy, loss: 0.35977596044540405
step: 290, task: Textual/Abt-Buy, loss: 0.2397131323814392
step: 300, task: Textual/Abt-Buy, loss: 0.2594633102416992
step: 310, task: Textual/Abt-Buy, loss: 0.14629927277565002
step: 320, task: Textual/Abt-Buy, loss: 0.3329084515571594
step: 330, task: Textual/Abt-Buy, loss: 0.3876791000366211
step: 340, task: Textual/Abt-Buy, loss: 0.4795646071434021
step: 350, task: Textual/Abt-Buy, loss: 0.11983585357666016
=========eval at epoch=1=========
Validation:
=============Textual/Abt-Buy==================
accuracy=0.894
precision=0.503
recall=0.714
f1=0.590
======================================
Test:
=============Textual/Abt-Buy==================
accuracy=0.901
precision=0.528
recall=0.777
f1=0.629
======================================
=====sanity check======
words: COL name VAL canon powershot black digital camera sx110isb COL description VAL canon powershot sx110 is black digital camera sx110isb 9.0 megapixel 10x optical zoom lens with optical image stabilizer technology 3.0 ' lcd display digic iii image processor face detection motion detection 20 shooting modes including 8 special scene modes red-eye correction automatic iso settings print-share button power by aa batteries for convenient black finish COL price VAL   [SEP] COL name VAL sony cyber-shot dsc-w170 digital camera silver dscw170 COL description VAL 10.1 megapixel 16:9 2x digital zoom 2.7 ' active matrix tft color lcd COL price VAL  
x: [    0 18047   766 27445 32839  4361 10120   909  1778  2280   579  1178
 11670   354   428 14857  8194 27445 32839  4361 10120   579  1178 11670
    16   909  1778  2280   579  1178 11670   354   428   361     4   288
 10721 21424   158  1178 17547 21762 10373    19 17547  2274 12964  6315
   806   155     4   288   128   784 28690  2332  8512   636 46814  2274
 10655   652 12673  4298 12673   291  1094 19180   217   290   780  1310
 19180  1275    12 20668 14921  8408 47191  9629  5780    12 12689  6148
   476    30    10   102 10535    13 12148   909  2073 14857   425 27445
  1437  1437     2     2 18047   766 27445   579  6119  5381    12 10393
   385  3866    12   605 16218  1778  2280  4334   385  3866   605 16218
 14857  8194 27445   158     4   134 10721 21424   545    35   466   132
  1178  1778 21762   132     4   406   128  2171 36173   326  2543  3195
   784 28690 14857   425 27445  1437  1437     2]
tokens: ['<s>', 'COL', 'Ġname', 'ĠVAL', 'Ġcanon', 'Ġpowers', 'hot', 'Ġblack', 'Ġdigital', 'Ġcamera', 'Ġs', 'x', '110', 'is', 'b', 'ĠCOL', 'Ġdescription', 'ĠVAL', 'Ġcanon', 'Ġpowers', 'hot', 'Ġs', 'x', '110', 'Ġis', 'Ġblack', 'Ġdigital', 'Ġcamera', 'Ġs', 'x', '110', 'is', 'b', 'Ġ9', '.', '0', 'Ġmeg', 'apixel', 'Ġ10', 'x', 'Ġoptical', 'Ġzoom', 'Ġlens', 'Ġwith', 'Ġoptical', 'Ġimage', 'Ġstabil', 'izer', 'Ġtechnology', 'Ġ3', '.', '0', "Ġ'", 'Ġl', 'cd', 'Ġdisplay', 'Ġdig', 'ic', 'Ġiii', 'Ġimage', 'Ġprocessor', 'Ġface', 'Ġdetection', 'Ġmotion', 'Ġdetection', 'Ġ20', 'Ġshooting', 'Ġmodes', 'Ġincluding', 'Ġ8', 'Ġspecial', 'Ġscene', 'Ġmodes', 'Ġred', '-', 'eye', 'Ġcorrection', 'Ġautomatic', 'Ġiso', 'Ġsettings', 'Ġprint', '-', 'share', 'Ġbutton', 'Ġpower', 'Ġby', 'Ġa', 'a', 'Ġbatteries', 'Ġfor', 'Ġconvenient', 'Ġblack', 'Ġfinish', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ', 'Ġ', '</s>', '</s>', 'COL', 'Ġname', 'ĠVAL', 'Ġs', 'ony', 'Ġcyber', '-', 'shot', 'Ġd', 'sc', '-', 'w', '170', 'Ġdigital', 'Ġcamera', 'Ġsilver', 'Ġd', 'sc', 'w', '170', 'ĠCOL', 'Ġdescription', 'ĠVAL', 'Ġ10', '.', '1', 'Ġmeg', 'apixel', 'Ġ16', ':', '9', 'Ġ2', 'x', 'Ġdigital', 'Ġzoom', 'Ġ2', '.', '7', "Ġ'", 'Ġactive', 'Ġmatrix', 'Ġt', 'ft', 'Ġcolor', 'Ġl', 'cd', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ', 'Ġ', '</s>']
is_heads: [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
y: 0
tags: 0
mask: tensor([1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1])
seqlen: 152
task_name: Textual/Abt-Buy
=======================
step: 0, task: Textual/Abt-Buy, loss: 0.18430840969085693
step: 10, task: Textual/Abt-Buy, loss: 0.271506667137146
step: 20, task: Textual/Abt-Buy, loss: 0.516290545463562
step: 30, task: Textual/Abt-Buy, loss: 0.09563875943422318
step: 40, task: Textual/Abt-Buy, loss: 0.20362676680088043
step: 50, task: Textual/Abt-Buy, loss: 0.18392547965049744
step: 60, task: Textual/Abt-Buy, loss: 0.16250337660312653
step: 70, task: Textual/Abt-Buy, loss: 0.22656428813934326
step: 80, task: Textual/Abt-Buy, loss: 0.09322409331798553
step: 90, task: Textual/Abt-Buy, loss: 0.33957457542419434
step: 100, task: Textual/Abt-Buy, loss: 0.20651540160179138
step: 110, task: Textual/Abt-Buy, loss: 0.3337232768535614
step: 120, task: Textual/Abt-Buy, loss: 0.13728199899196625
step: 130, task: Textual/Abt-Buy, loss: 0.2053883969783783
step: 140, task: Textual/Abt-Buy, loss: 0.31827107071876526
step: 150, task: Textual/Abt-Buy, loss: 0.10159964114427567
step: 160, task: Textual/Abt-Buy, loss: 0.03173705190420151
step: 170, task: Textual/Abt-Buy, loss: 0.004903323948383331
step: 180, task: Textual/Abt-Buy, loss: 0.13666749000549316
step: 190, task: Textual/Abt-Buy, loss: 0.05596891790628433
step: 200, task: Textual/Abt-Buy, loss: 0.2994821071624756
step: 210, task: Textual/Abt-Buy, loss: 0.017487816512584686
step: 220, task: Textual/Abt-Buy, loss: 0.030158445239067078
step: 230, task: Textual/Abt-Buy, loss: 0.128998801112175
step: 240, task: Textual/Abt-Buy, loss: 0.17891578376293182
step: 250, task: Textual/Abt-Buy, loss: 0.02712145447731018
step: 260, task: Textual/Abt-Buy, loss: 0.1597682237625122
step: 270, task: Textual/Abt-Buy, loss: 0.0069201067090034485
step: 280, task: Textual/Abt-Buy, loss: 0.013017140328884125
step: 290, task: Textual/Abt-Buy, loss: 0.12389075011014938
step: 300, task: Textual/Abt-Buy, loss: 0.04031846299767494
step: 310, task: Textual/Abt-Buy, loss: 0.059101272374391556
step: 320, task: Textual/Abt-Buy, loss: 0.05002017691731453
step: 330, task: Textual/Abt-Buy, loss: 0.15291301906108856
step: 340, task: Textual/Abt-Buy, loss: 0.08500128984451294
step: 350, task: Textual/Abt-Buy, loss: 0.34988993406295776
=========eval at epoch=2=========
Validation:
=============Textual/Abt-Buy==================
accuracy=0.933
precision=0.905
recall=0.417
f1=0.571
======================================
Test:
=============Textual/Abt-Buy==================
accuracy=0.929
precision=0.850
recall=0.413
f1=0.556
======================================
=====sanity check======
words: COL name VAL olympus ps-bls1 lithium ion rechargeable battery liionpsbls1 COL description VAL olympus ps-bls1 lithium ion rechargeable battery liionpsbls1 double your shooting time with a spare battery for the evolt e-410 COL price VAL   [SEP] COL name VAL canon nb-4l rechargeable camera battery 9763a001 COL description VAL canon nb-4l lithium ion battery COL price VAL 36.89 
x: [    0 18047   766 27445  1021 31434   687 27778    12  3662    29   134
 16904 31973 25850   868  3822 16787  1499  3275  3662    29   134 14857
  8194 27445  1021 31434   687 27778    12  3662    29   134 16904 31973
 25850   868  3822 16787  1499  3275  3662    29   134  1457   110  1094
    86    19    10 10628  3822    13     5  7630 11499   364    12 31132
 14857   425 27445  1437  1437     2     2 18047   766 27445 32839   295
   428    12   306   462 25850   868  2280  3822   361 39850   102 19089
 14857  8194 27445 32839   295   428    12   306   462 16904 31973  3822
 14857   425 27445  2491     4  5046  1437     2]
tokens: ['<s>', 'COL', 'Ġname', 'ĠVAL', 'Ġo', 'lymp', 'us', 'Ġps', '-', 'bl', 's', '1', 'Ġlithium', 'Ġion', 'Ġrecharge', 'able', 'Ġbattery', 'Ġli', 'ion', 'ps', 'bl', 's', '1', 'ĠCOL', 'Ġdescription', 'ĠVAL', 'Ġo', 'lymp', 'us', 'Ġps', '-', 'bl', 's', '1', 'Ġlithium', 'Ġion', 'Ġrecharge', 'able', 'Ġbattery', 'Ġli', 'ion', 'ps', 'bl', 's', '1', 'Ġdouble', 'Ġyour', 'Ġshooting', 'Ġtime', 'Ġwith', 'Ġa', 'Ġspare', 'Ġbattery', 'Ġfor', 'Ġthe', 'Ġev', 'olt', 'Ġe', '-', '410', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ', 'Ġ', '</s>', '</s>', 'COL', 'Ġname', 'ĠVAL', 'Ġcanon', 'Ġn', 'b', '-', '4', 'l', 'Ġrecharge', 'able', 'Ġcamera', 'Ġbattery', 'Ġ9', '763', 'a', '001', 'ĠCOL', 'Ġdescription', 'ĠVAL', 'Ġcanon', 'Ġn', 'b', '-', '4', 'l', 'Ġlithium', 'Ġion', 'Ġbattery', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ36', '.', '89', 'Ġ', '</s>']
is_heads: [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
y: 0
tags: 0
mask: tensor([1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1])
seqlen: 104
task_name: Textual/Abt-Buy
=======================
step: 0, task: Textual/Abt-Buy, loss: 0.23270991444587708
step: 10, task: Textual/Abt-Buy, loss: 0.12403574585914612
step: 20, task: Textual/Abt-Buy, loss: 0.10899535566568375
step: 30, task: Textual/Abt-Buy, loss: 0.07366105169057846
step: 40, task: Textual/Abt-Buy, loss: 0.25490784645080566
step: 50, task: Textual/Abt-Buy, loss: 0.0700862854719162
step: 60, task: Textual/Abt-Buy, loss: 0.014159321784973145
step: 70, task: Textual/Abt-Buy, loss: 0.07516533136367798
step: 80, task: Textual/Abt-Buy, loss: 0.08001363277435303
step: 90, task: Textual/Abt-Buy, loss: 0.20139433443546295
step: 100, task: Textual/Abt-Buy, loss: 0.06691063195466995
step: 110, task: Textual/Abt-Buy, loss: 0.09873056411743164
step: 120, task: Textual/Abt-Buy, loss: 0.2282029688358307
step: 130, task: Textual/Abt-Buy, loss: 0.17357559502124786
step: 140, task: Textual/Abt-Buy, loss: 0.04239910468459129
step: 150, task: Textual/Abt-Buy, loss: 0.09264882653951645
step: 160, task: Textual/Abt-Buy, loss: 0.12106019258499146
step: 170, task: Textual/Abt-Buy, loss: 0.00529373437166214
step: 180, task: Textual/Abt-Buy, loss: 0.03784213215112686
step: 190, task: Textual/Abt-Buy, loss: 0.007476337254047394
step: 200, task: Textual/Abt-Buy, loss: 0.506216287612915
step: 210, task: Textual/Abt-Buy, loss: 0.0486905463039875
step: 220, task: Textual/Abt-Buy, loss: 0.01099967211484909
step: 230, task: Textual/Abt-Buy, loss: 0.05958586186170578
step: 240, task: Textual/Abt-Buy, loss: 0.15998363494873047
step: 250, task: Textual/Abt-Buy, loss: 0.11009062826633453
step: 260, task: Textual/Abt-Buy, loss: 0.0941423624753952
step: 270, task: Textual/Abt-Buy, loss: 0.009420916438102722
step: 280, task: Textual/Abt-Buy, loss: 0.23499158024787903
step: 290, task: Textual/Abt-Buy, loss: 0.0997907966375351
step: 300, task: Textual/Abt-Buy, loss: 0.2794901430606842
step: 310, task: Textual/Abt-Buy, loss: 0.0062676966190338135
step: 320, task: Textual/Abt-Buy, loss: 0.0046838074922561646
step: 330, task: Textual/Abt-Buy, loss: 0.0014250576496124268
step: 340, task: Textual/Abt-Buy, loss: 0.0346786305308342
step: 350, task: Textual/Abt-Buy, loss: 0.02428004890680313
=========eval at epoch=3=========
Validation:
=============Textual/Abt-Buy==================
accuracy=0.926
precision=0.921
recall=0.340
f1=0.496
======================================
Test:
=============Textual/Abt-Buy==================
accuracy=0.934
precision=0.955
recall=0.408
f1=0.571
======================================
=====sanity check======
words: COL name VAL toshiba 10.2 ' portable dvd player in black sdp101s COL description VAL toshiba 10.2 ' portable dvd player in black sdp101s lcd display with 800x480 pixel resolution swivel and flip screen up to 5 hour lithium ion battery divx certified 4-in-1 card slot mp3 and wma formats jpeg viewer car cord adapter dual headphone outputs virtual surround built-in speakers COL price VAL   [SEP] COL name VAL toshiba d-r410 dvd player/recorder COL description VAL toshiba d-r410 dvd recorder w / 1080p upconversion COL price VAL  
x: [    0 18047   766 27445     7  1193 15577   158     4   176   128 15295
   385 40311   869    11   909   579 43923 12636    29 14857  8194 27445
     7  1193 15577   158     4   176   128 15295   385 40311   869    11
   909   579 43923 12636    29   784 28690  2332    19  5735  1178 27018
 29597  3547  3514  2088   462     8 11113  2441    62     7   195  1946
 16904 31973  3822 14445  1178  9785   204    12   179    12   134  1886
  8534 44857   246     8   885  1916 19052  1236 41191 18754   512 13051
 36007  6594 27671 39512  6229 21104  1490    12   179  6864 14857   425
 27445  1437  1437     2     2 18047   766 27445     7  1193 15577   385
    12   338 31132   385 40311   869    73 13139 10337 14857  8194 27445
     7  1193 15577   385    12   338 31132   385 40311 32017   885  1589
 21083   642    62  3865 21747 14857   425 27445  1437  1437     2]
tokens: ['<s>', 'COL', 'Ġname', 'ĠVAL', 'Ġto', 'sh', 'iba', 'Ġ10', '.', '2', "Ġ'", 'Ġportable', 'Ġd', 'vd', 'Ġplayer', 'Ġin', 'Ġblack', 'Ġs', 'dp', '101', 's', 'ĠCOL', 'Ġdescription', 'ĠVAL', 'Ġto', 'sh', 'iba', 'Ġ10', '.', '2', "Ġ'", 'Ġportable', 'Ġd', 'vd', 'Ġplayer', 'Ġin', 'Ġblack', 'Ġs', 'dp', '101', 's', 'Ġl', 'cd', 'Ġdisplay', 'Ġwith', 'Ġ800', 'x', '480', 'Ġpixel', 'Ġresolution', 'Ġsw', 'ive', 'l', 'Ġand', 'Ġflip', 'Ġscreen', 'Ġup', 'Ġto', 'Ġ5', 'Ġhour', 'Ġlithium', 'Ġion', 'Ġbattery', 'Ġdiv', 'x', 'Ġcertified', 'Ġ4', '-', 'in', '-', '1', 'Ġcard', 'Ġslot', 'Ġmp', '3', 'Ġand', 'Ġw', 'ma', 'Ġformats', 'Ġj', 'peg', 'Ġviewer', 'Ġcar', 'Ġcord', 'Ġadapter', 'Ġdual', 'Ġheadphone', 'Ġoutputs', 'Ġvirtual', 'Ġsurround', 'Ġbuilt', '-', 'in', 'Ġspeakers', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ', 'Ġ', '</s>', '</s>', 'COL', 'Ġname', 'ĠVAL', 'Ġto', 'sh', 'iba', 'Ġd', '-', 'r', '410', 'Ġd', 'vd', 'Ġplayer', '/', 'rec', 'order', 'ĠCOL', 'Ġdescription', 'ĠVAL', 'Ġto', 'sh', 'iba', 'Ġd', '-', 'r', '410', 'Ġd', 'vd', 'Ġrecorder', 'Ġw', 'Ġ/', 'Ġ1080', 'p', 'Ġup', 'con', 'version', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ', 'Ġ', '</s>']
is_heads: [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
y: 0
tags: 0
mask: tensor([1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1])
seqlen: 143
task_name: Textual/Abt-Buy
=======================
step: 0, task: Textual/Abt-Buy, loss: 0.06780723482370377
step: 10, task: Textual/Abt-Buy, loss: 0.08294442296028137
step: 20, task: Textual/Abt-Buy, loss: 0.011937908828258514
step: 30, task: Textual/Abt-Buy, loss: 0.016350798308849335
step: 40, task: Textual/Abt-Buy, loss: 0.1596119999885559
step: 50, task: Textual/Abt-Buy, loss: 0.032072022557258606
step: 60, task: Textual/Abt-Buy, loss: 0.11661141365766525
step: 70, task: Textual/Abt-Buy, loss: 0.029274366796016693
step: 80, task: Textual/Abt-Buy, loss: 0.01619476079940796
step: 90, task: Textual/Abt-Buy, loss: 0.017232686281204224
step: 100, task: Textual/Abt-Buy, loss: 0.003122776746749878
step: 110, task: Textual/Abt-Buy, loss: 0.11643350124359131
step: 120, task: Textual/Abt-Buy, loss: 0.02759634330868721
step: 130, task: Textual/Abt-Buy, loss: 0.0050820112228393555
step: 140, task: Textual/Abt-Buy, loss: 0.2076529562473297
step: 150, task: Textual/Abt-Buy, loss: 0.018671460449695587
step: 160, task: Textual/Abt-Buy, loss: 0.03201770782470703
step: 170, task: Textual/Abt-Buy, loss: 0.047106996178627014
step: 180, task: Textual/Abt-Buy, loss: 0.016549669206142426
step: 190, task: Textual/Abt-Buy, loss: 0.050113335251808167
step: 200, task: Textual/Abt-Buy, loss: 0.004601418972015381
step: 210, task: Textual/Abt-Buy, loss: 0.01271442323923111
step: 220, task: Textual/Abt-Buy, loss: 0.020855598151683807
step: 230, task: Textual/Abt-Buy, loss: 0.2516517639160156
step: 240, task: Textual/Abt-Buy, loss: 0.005505315959453583
step: 250, task: Textual/Abt-Buy, loss: 0.05694358050823212
step: 260, task: Textual/Abt-Buy, loss: 0.026320084929466248
step: 270, task: Textual/Abt-Buy, loss: 0.0006684660911560059
step: 280, task: Textual/Abt-Buy, loss: 0.0028641223907470703
step: 290, task: Textual/Abt-Buy, loss: 0.018756859004497528
step: 300, task: Textual/Abt-Buy, loss: 0.00874369591474533
step: 310, task: Textual/Abt-Buy, loss: 0.004477404057979584
step: 320, task: Textual/Abt-Buy, loss: 0.17160479724407196
step: 330, task: Textual/Abt-Buy, loss: 0.005497284233570099
step: 340, task: Textual/Abt-Buy, loss: 0.01134655624628067
step: 350, task: Textual/Abt-Buy, loss: 0.03464949131011963
=========eval at epoch=4=========
Validation:
=============Textual/Abt-Buy==================
accuracy=0.951
precision=0.884
recall=0.626
f1=0.733
======================================
Test:
=============Textual/Abt-Buy==================
accuracy=0.952
precision=0.901
recall=0.621
f1=0.736
======================================
=====sanity check======
words: COL name VAL sony hd-handycam 3 meters ( 10 feet ) hdmi mini cable vmc30mhd COL description VAL sony hd-handycam 3 meters ( 10 feet ) hdmi mini cable vmc30mhd gold plating plug hdmi-compliant high speed category 2 cable support full hd 1080p digital audio transfer 3 meters ( 10 feet ) black finish COL price VAL 69.0  [SEP] COL name VAL sony high definition hdmi to mini-hdmi cable vmc15mhd COL description VAL 1 x hdmi 1 x mini-hdmi 4.92 ft COL price VAL 26.95 
x: [    0 18047   766 27445   579  6119  1368   417    12  4539   219 16767
   155  7679    36   158  1730  4839  1368   417  5408  7983  6129   748
 29297   541   119 35905 14857  8194 27445   579  6119  1368   417    12
  4539   219 16767   155  7679    36   158  1730  4839  1368   417  5408
  7983  6129   748 29297   541   119 35905  1637  2968  1295 10242  1368
   417  5408    12 23391  9488   239  2078  4120   132  6129   323   455
  1368   417 21083   642  1778  6086  2937   155  7679    36   158  1730
  4839   909  2073 14857   425 27445  5913     4   288  1437     2     2
 18047   766 27445   579  6119   239  8515  1368   417  5408     7  7983
    12 35905  5408  6129   748 29297   996   119 35905 14857  8194 27445
   112  3023  1368   417  5408   112  3023  7983    12 35905  5408   204
     4  6617 16935 14857   425 27445   973     4  4015  1437     2]
tokens: ['<s>', 'COL', 'Ġname', 'ĠVAL', 'Ġs', 'ony', 'Ġh', 'd', '-', 'hand', 'y', 'cam', 'Ġ3', 'Ġmeters', 'Ġ(', 'Ġ10', 'Ġfeet', 'Ġ)', 'Ġh', 'd', 'mi', 'Ġmini', 'Ġcable', 'Ġv', 'mc', '30', 'm', 'hd', 'ĠCOL', 'Ġdescription', 'ĠVAL', 'Ġs', 'ony', 'Ġh', 'd', '-', 'hand', 'y', 'cam', 'Ġ3', 'Ġmeters', 'Ġ(', 'Ġ10', 'Ġfeet', 'Ġ)', 'Ġh', 'd', 'mi', 'Ġmini', 'Ġcable', 'Ġv', 'mc', '30', 'm', 'hd', 'Ġgold', 'Ġpl', 'ating', 'Ġplug', 'Ġh', 'd', 'mi', '-', 'compl', 'iant', 'Ġhigh', 'Ġspeed', 'Ġcategory', 'Ġ2', 'Ġcable', 'Ġsupport', 'Ġfull', 'Ġh', 'd', 'Ġ1080', 'p', 'Ġdigital', 'Ġaudio', 'Ġtransfer', 'Ġ3', 'Ġmeters', 'Ġ(', 'Ġ10', 'Ġfeet', 'Ġ)', 'Ġblack', 'Ġfinish', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ69', '.', '0', 'Ġ', '</s>', '</s>', 'COL', 'Ġname', 'ĠVAL', 'Ġs', 'ony', 'Ġhigh', 'Ġdefinition', 'Ġh', 'd', 'mi', 'Ġto', 'Ġmini', '-', 'hd', 'mi', 'Ġcable', 'Ġv', 'mc', '15', 'm', 'hd', 'ĠCOL', 'Ġdescription', 'ĠVAL', 'Ġ1', 'Ġx', 'Ġh', 'd', 'mi', 'Ġ1', 'Ġx', 'Ġmini', '-', 'hd', 'mi', 'Ġ4', '.', '92', 'Ġft', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ26', '.', '95', 'Ġ', '</s>']
is_heads: [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
y: 0
tags: 0
mask: tensor([1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1])
seqlen: 143
task_name: Textual/Abt-Buy
=======================
step: 0, task: Textual/Abt-Buy, loss: 0.008135519921779633
step: 10, task: Textual/Abt-Buy, loss: 0.010723583400249481
step: 20, task: Textual/Abt-Buy, loss: 0.01712796837091446
step: 30, task: Textual/Abt-Buy, loss: 0.010293975472450256
step: 40, task: Textual/Abt-Buy, loss: 0.010199621319770813
step: 50, task: Textual/Abt-Buy, loss: 0.04681694880127907
step: 60, task: Textual/Abt-Buy, loss: 0.017895124852657318
step: 70, task: Textual/Abt-Buy, loss: 0.0020645856857299805
step: 80, task: Textual/Abt-Buy, loss: 0.0011140555143356323
step: 90, task: Textual/Abt-Buy, loss: 0.0014046281576156616
step: 100, task: Textual/Abt-Buy, loss: 0.004200108349323273
step: 110, task: Textual/Abt-Buy, loss: 0.03778303414583206
step: 120, task: Textual/Abt-Buy, loss: 0.017498403787612915
step: 130, task: Textual/Abt-Buy, loss: 0.04123690724372864
step: 140, task: Textual/Abt-Buy, loss: 0.012851864099502563
step: 150, task: Textual/Abt-Buy, loss: 0.059391118586063385
step: 160, task: Textual/Abt-Buy, loss: 0.0670166164636612
step: 170, task: Textual/Abt-Buy, loss: 0.0034614652395248413
step: 180, task: Textual/Abt-Buy, loss: 0.00612369179725647
step: 190, task: Textual/Abt-Buy, loss: 0.009549252688884735
step: 200, task: Textual/Abt-Buy, loss: 0.0033845528960227966
step: 210, task: Textual/Abt-Buy, loss: 0.008443780243396759
step: 220, task: Textual/Abt-Buy, loss: 0.0042739808559417725
step: 230, task: Textual/Abt-Buy, loss: 0.0019116252660751343
step: 240, task: Textual/Abt-Buy, loss: 0.02461552619934082
step: 250, task: Textual/Abt-Buy, loss: 0.0034425705671310425
step: 260, task: Textual/Abt-Buy, loss: 0.23015615344047546
step: 270, task: Textual/Abt-Buy, loss: 0.006848037242889404
step: 280, task: Textual/Abt-Buy, loss: 0.008924074470996857
step: 290, task: Textual/Abt-Buy, loss: 0.026529371738433838
step: 300, task: Textual/Abt-Buy, loss: 0.05611030012369156
step: 310, task: Textual/Abt-Buy, loss: 0.019354715943336487
step: 320, task: Textual/Abt-Buy, loss: 0.01480843871831894
step: 330, task: Textual/Abt-Buy, loss: 0.01936514675617218
step: 340, task: Textual/Abt-Buy, loss: 0.05832746624946594
step: 350, task: Textual/Abt-Buy, loss: 0.16706664860248566
=========eval at epoch=5=========
Validation:
=============Textual/Abt-Buy==================
accuracy=0.942
precision=0.952
recall=0.485
f1=0.643
======================================
Test:
=============Textual/Abt-Buy==================
accuracy=0.945
precision=0.963
recall=0.505
f1=0.662
======================================
=====sanity check======
words: COL name VAL speck seethru purple hard shell case for 15 ' macbook mb15purseev2 COL description VAL speck seethru purple hard shell case for 15 ' macbook mb15purseev2 translucent hard plastic shell gives great protection full access to all controls rubber feet for added support purple finish COL price VAL   [SEP] COL name VAL speck products seethru case for apple 13 ' macbook mb13-blu-see-v2 COL description VAL plastic blue COL price VAL  
x: [    0 18047   766 27445 25227  2420   842  4774  2070 14327   543 10785
   403    13   379   128 13418  6298   475   428   996   642 33901  3623
   176 14857  8194 27445 25227  2420   842  4774  2070 14327   543 10785
   403    13   379   128 13418  6298   475   428   996   642 33901  3623
   176 42026   543  4136 10785  2029   372  2591   455   899     7    70
  5656 11283  1730    13   355   323 14327  2073 14857   425 27445  1437
  1437     2     2 18047   766 27445 25227  2420   785   842  4774  2070
   403    13 15162   508   128 13418  6298   475   428  1558    12   428
  6487    12  7048    12   705   176 14857  8194 27445  4136  2440 14857
   425 27445  1437  1437     2]
tokens: ['<s>', 'COL', 'Ġname', 'ĠVAL', 'Ġspe', 'ck', 'Ġse', 'eth', 'ru', 'Ġpurple', 'Ġhard', 'Ġshell', 'Ġcase', 'Ġfor', 'Ġ15', "Ġ'", 'Ġmac', 'book', 'Ġm', 'b', '15', 'p', 'urse', 'ev', '2', 'ĠCOL', 'Ġdescription', 'ĠVAL', 'Ġspe', 'ck', 'Ġse', 'eth', 'ru', 'Ġpurple', 'Ġhard', 'Ġshell', 'Ġcase', 'Ġfor', 'Ġ15', "Ġ'", 'Ġmac', 'book', 'Ġm', 'b', '15', 'p', 'urse', 'ev', '2', 'Ġtranslucent', 'Ġhard', 'Ġplastic', 'Ġshell', 'Ġgives', 'Ġgreat', 'Ġprotection', 'Ġfull', 'Ġaccess', 'Ġto', 'Ġall', 'Ġcontrols', 'Ġrubber', 'Ġfeet', 'Ġfor', 'Ġadded', 'Ġsupport', 'Ġpurple', 'Ġfinish', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ', 'Ġ', '</s>', '</s>', 'COL', 'Ġname', 'ĠVAL', 'Ġspe', 'ck', 'Ġproducts', 'Ġse', 'eth', 'ru', 'Ġcase', 'Ġfor', 'Ġapple', 'Ġ13', "Ġ'", 'Ġmac', 'book', 'Ġm', 'b', '13', '-', 'b', 'lu', '-', 'see', '-', 'v', '2', 'ĠCOL', 'Ġdescription', 'ĠVAL', 'Ġplastic', 'Ġblue', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ', 'Ġ', '</s>']
is_heads: [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
y: 0
tags: 0
mask: tensor([1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1])
seqlen: 113
task_name: Textual/Abt-Buy
=======================
step: 0, task: Textual/Abt-Buy, loss: 0.0028358548879623413
step: 10, task: Textual/Abt-Buy, loss: 0.01016785204410553
step: 20, task: Textual/Abt-Buy, loss: 0.022734947502613068
step: 30, task: Textual/Abt-Buy, loss: 0.01493021845817566
step: 40, task: Textual/Abt-Buy, loss: 0.08900658041238785
step: 50, task: Textual/Abt-Buy, loss: 0.00565001368522644
step: 60, task: Textual/Abt-Buy, loss: 0.0028927549719810486
step: 70, task: Textual/Abt-Buy, loss: 0.002604544162750244
step: 80, task: Textual/Abt-Buy, loss: 0.0012324899435043335
step: 90, task: Textual/Abt-Buy, loss: 0.042409516870975494
step: 100, task: Textual/Abt-Buy, loss: 0.1296534687280655
step: 110, task: Textual/Abt-Buy, loss: 0.022466734051704407
step: 120, task: Textual/Abt-Buy, loss: 0.002303577959537506
step: 130, task: Textual/Abt-Buy, loss: 0.01244102418422699
step: 140, task: Textual/Abt-Buy, loss: 0.05563058704137802
step: 150, task: Textual/Abt-Buy, loss: 0.003018319606781006
step: 160, task: Textual/Abt-Buy, loss: 0.001669079065322876
step: 170, task: Textual/Abt-Buy, loss: 0.0017251819372177124
step: 180, task: Textual/Abt-Buy, loss: 0.000994175672531128
step: 190, task: Textual/Abt-Buy, loss: 0.0016342699527740479
step: 200, task: Textual/Abt-Buy, loss: 0.003944225609302521
step: 210, task: Textual/Abt-Buy, loss: 0.00022579729557037354
step: 220, task: Textual/Abt-Buy, loss: 0.004017278552055359
step: 230, task: Textual/Abt-Buy, loss: 0.0056673139333724976
step: 240, task: Textual/Abt-Buy, loss: 0.07031524181365967
step: 250, task: Textual/Abt-Buy, loss: 0.005505748093128204
step: 260, task: Textual/Abt-Buy, loss: 0.0018957406282424927
step: 270, task: Textual/Abt-Buy, loss: 0.009632162749767303
step: 280, task: Textual/Abt-Buy, loss: 0.0044350773096084595
step: 290, task: Textual/Abt-Buy, loss: 0.10523422807455063
step: 300, task: Textual/Abt-Buy, loss: 0.013842657208442688
step: 310, task: Textual/Abt-Buy, loss: 0.003912888467311859
step: 320, task: Textual/Abt-Buy, loss: 0.000929608941078186
step: 330, task: Textual/Abt-Buy, loss: 0.020156890153884888
step: 340, task: Textual/Abt-Buy, loss: 0.006826937198638916
step: 350, task: Textual/Abt-Buy, loss: 0.002187669277191162
=========eval at epoch=6=========
Validation:
=============Textual/Abt-Buy==================
accuracy=0.947
precision=0.949
recall=0.539
f1=0.687
======================================
Test:
=============Textual/Abt-Buy==================
accuracy=0.955
precision=0.928
recall=0.626
f1=0.748
======================================
=====sanity check======
words: COL name VAL samsung 22 ' white flat panel lcd hdtv ln22a451 COL description VAL samsung 22 ' white flat panel series 4 lcd hdtv ln22a451 1680 x 1050 resolution 3000:1 contrast ratio srs trusurround xt cold cathode fluorescent lamp ( ccfl ) 8ms response time hidden bottom speakers pc compatible white finish COL price VAL   [SEP] COL name VAL samsung ln22a650 22 ' lcd tv COL description VAL samsung ln22a650 22 ' widescreen lcd hdtv 3,000:1 contrast ratio 8ms response time COL price VAL 458.0 
x: [    0 18047   766 27445   579 48545   820   128  1104  3269  2798   784
 28690  1368   417 18724   784   282  2036   102 36860 14857  8194 27445
   579 48545   820   128  1104  3269  2798   651   204   784 28690  1368
   417 18724   784   282  2036   102 36860   545  2940  3023 43504  3547
 23513    35   134  5709  1750   579  4926  2664   687   710  3431  1437
 11483  2569 31420  4636 38006 24272    36 41754  4825  4839   290  4339
  1263    86  7397  2576  6864 46213 16632  1104  2073 14857   425 27445
  1437  1437     2     2 18047   766 27445   579 48545   784   282  2036
   102 16316   820   128   784 28690 30016 14857  8194 27445   579 48545
   784   282  2036   102 16316   820   128   885  4376 37346   784 28690
  1368   417 18724   155     6   151    35   134  5709  1750   290  4339
  1263    86 14857   425 27445 42513     4   288  1437     2]
tokens: ['<s>', 'COL', 'Ġname', 'ĠVAL', 'Ġs', 'amsung', 'Ġ22', "Ġ'", 'Ġwhite', 'Ġflat', 'Ġpanel', 'Ġl', 'cd', 'Ġh', 'd', 'tv', 'Ġl', 'n', '22', 'a', '451', 'ĠCOL', 'Ġdescription', 'ĠVAL', 'Ġs', 'amsung', 'Ġ22', "Ġ'", 'Ġwhite', 'Ġflat', 'Ġpanel', 'Ġseries', 'Ġ4', 'Ġl', 'cd', 'Ġh', 'd', 'tv', 'Ġl', 'n', '22', 'a', '451', 'Ġ16', '80', 'Ġx', 'Ġ1050', 'Ġresolution', 'Ġ3000', ':', '1', 'Ġcontrast', 'Ġratio', 'Ġs', 'rs', 'Ġtr', 'us', 'ur', 'round', 'Ġ', 'xt', 'Ġcold', 'Ġcath', 'ode', 'Ġfluorescent', 'Ġlamp', 'Ġ(', 'Ġcc', 'fl', 'Ġ)', 'Ġ8', 'ms', 'Ġresponse', 'Ġtime', 'Ġhidden', 'Ġbottom', 'Ġspeakers', 'Ġpc', 'Ġcompatible', 'Ġwhite', 'Ġfinish', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ', 'Ġ', '</s>', '</s>', 'COL', 'Ġname', 'ĠVAL', 'Ġs', 'amsung', 'Ġl', 'n', '22', 'a', '650', 'Ġ22', "Ġ'", 'Ġl', 'cd', 'Ġtv', 'ĠCOL', 'Ġdescription', 'ĠVAL', 'Ġs', 'amsung', 'Ġl', 'n', '22', 'a', '650', 'Ġ22', "Ġ'", 'Ġw', 'ides', 'creen', 'Ġl', 'cd', 'Ġh', 'd', 'tv', 'Ġ3', ',', '000', ':', '1', 'Ġcontrast', 'Ġratio', 'Ġ8', 'ms', 'Ġresponse', 'Ġtime', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ458', '.', '0', 'Ġ', '</s>']
is_heads: [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
y: 0
tags: 0
mask: tensor([1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1])
seqlen: 142
task_name: Textual/Abt-Buy
=======================
step: 0, task: Textual/Abt-Buy, loss: 0.03409674018621445
step: 10, task: Textual/Abt-Buy, loss: 0.01665361225605011
step: 20, task: Textual/Abt-Buy, loss: 0.0005837827920913696
step: 30, task: Textual/Abt-Buy, loss: 0.0057037994265556335
step: 40, task: Textual/Abt-Buy, loss: 0.0005022287368774414
step: 50, task: Textual/Abt-Buy, loss: 0.0006272196769714355
step: 60, task: Textual/Abt-Buy, loss: 0.0006318837404251099
step: 70, task: Textual/Abt-Buy, loss: 0.003425128757953644
step: 80, task: Textual/Abt-Buy, loss: 0.0010751113295555115
step: 90, task: Textual/Abt-Buy, loss: 0.0007271319627761841
step: 100, task: Textual/Abt-Buy, loss: 0.0004916191101074219
step: 110, task: Textual/Abt-Buy, loss: 0.003541618585586548
step: 120, task: Textual/Abt-Buy, loss: 0.010552622377872467
step: 130, task: Textual/Abt-Buy, loss: 0.09152375161647797
step: 140, task: Textual/Abt-Buy, loss: 0.02569008246064186
step: 150, task: Textual/Abt-Buy, loss: 0.04461433365941048
step: 160, task: Textual/Abt-Buy, loss: 0.0010313540697097778
step: 170, task: Textual/Abt-Buy, loss: 0.0053125470876693726
step: 180, task: Textual/Abt-Buy, loss: 0.007020406424999237
step: 190, task: Textual/Abt-Buy, loss: 0.1709447205066681
step: 200, task: Textual/Abt-Buy, loss: 0.00018480420112609863
step: 210, task: Textual/Abt-Buy, loss: 0.0062683746218681335
step: 220, task: Textual/Abt-Buy, loss: 0.0002910196781158447
step: 230, task: Textual/Abt-Buy, loss: 0.10090941935777664
step: 240, task: Textual/Abt-Buy, loss: 0.09149075299501419
step: 250, task: Textual/Abt-Buy, loss: 0.0001649409532546997
step: 260, task: Textual/Abt-Buy, loss: 0.011338837444782257
step: 270, task: Textual/Abt-Buy, loss: 0.00034137070178985596
step: 280, task: Textual/Abt-Buy, loss: 0.004090540111064911
step: 290, task: Textual/Abt-Buy, loss: 0.0009201020002365112
step: 300, task: Textual/Abt-Buy, loss: 0.005646698176860809
step: 310, task: Textual/Abt-Buy, loss: 0.0015417039394378662
step: 320, task: Textual/Abt-Buy, loss: 0.0001961439847946167
step: 330, task: Textual/Abt-Buy, loss: 0.002355918288230896
step: 340, task: Textual/Abt-Buy, loss: 0.0005526691675186157
step: 350, task: Textual/Abt-Buy, loss: 0.020157448947429657
=========eval at epoch=7=========
Validation:
=============Textual/Abt-Buy==================
accuracy=0.953
precision=0.932
recall=0.602
f1=0.732
======================================
Test:
=============Textual/Abt-Buy==================
accuracy=0.951
precision=0.894
recall=0.617
f1=0.730
======================================
=====sanity check======
words: COL name VAL garmin suction cup mount and 12-volt adapter kit 0101097900 COL description VAL garmin suction cup mount and 12-volt adapter kit 0101097900 suction cup mount and 12-volt adapter included COL price VAL 30.0  [SEP] COL name VAL garmin suction cup mount 010-10815-00 COL description VAL  COL price VAL 17.4 
x: [    0 18047   766 27445 15475  4691  2628 14970  4946 14206     8   316
    12 28989 36007 10549  9465  2663  3546  5220   612 14857  8194 27445
 15475  4691  2628 14970  4946 14206     8   316    12 28989 36007 10549
  9465  2663  3546  5220   612  2628 14970  4946 14206     8   316    12
 28989 36007  1165 14857   425 27445   389     4   288  1437     2     2
 18047   766 27445 15475  4691  2628 14970  4946 14206  9465   288    12
 18844   996    12   612 14857  8194 27445  1437 14857   425 27445   601
     4   306  1437     2]
tokens: ['<s>', 'COL', 'Ġname', 'ĠVAL', 'Ġgar', 'min', 'Ġsu', 'ction', 'Ġcup', 'Ġmount', 'Ġand', 'Ġ12', '-', 'volt', 'Ġadapter', 'Ġkit', 'Ġ01', '01', '09', '79', '00', 'ĠCOL', 'Ġdescription', 'ĠVAL', 'Ġgar', 'min', 'Ġsu', 'ction', 'Ġcup', 'Ġmount', 'Ġand', 'Ġ12', '-', 'volt', 'Ġadapter', 'Ġkit', 'Ġ01', '01', '09', '79', '00', 'Ġsu', 'ction', 'Ġcup', 'Ġmount', 'Ġand', 'Ġ12', '-', 'volt', 'Ġadapter', 'Ġincluded', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ30', '.', '0', 'Ġ', '</s>', '</s>', 'COL', 'Ġname', 'ĠVAL', 'Ġgar', 'min', 'Ġsu', 'ction', 'Ġcup', 'Ġmount', 'Ġ01', '0', '-', '108', '15', '-', '00', 'ĠCOL', 'Ġdescription', 'ĠVAL', 'Ġ', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ17', '.', '4', 'Ġ', '</s>']
is_heads: [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
y: 0
tags: 0
mask: tensor([1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1])
seqlen: 88
task_name: Textual/Abt-Buy
=======================
step: 0, task: Textual/Abt-Buy, loss: 0.005291439592838287
step: 10, task: Textual/Abt-Buy, loss: 0.008744508028030396
step: 20, task: Textual/Abt-Buy, loss: 0.0006368160247802734
step: 30, task: Textual/Abt-Buy, loss: 0.005103990435600281
step: 40, task: Textual/Abt-Buy, loss: 0.0009852200746536255
step: 50, task: Textual/Abt-Buy, loss: 0.03823600336909294
step: 60, task: Textual/Abt-Buy, loss: 0.003016538918018341
step: 70, task: Textual/Abt-Buy, loss: 0.002041161060333252
step: 80, task: Textual/Abt-Buy, loss: 0.004459083080291748
step: 90, task: Textual/Abt-Buy, loss: 0.017487697303295135
step: 100, task: Textual/Abt-Buy, loss: 0.0011293888092041016
step: 110, task: Textual/Abt-Buy, loss: 0.017527788877487183
step: 120, task: Textual/Abt-Buy, loss: 0.055120788514614105
step: 130, task: Textual/Abt-Buy, loss: 0.0006001442670822144
step: 140, task: Textual/Abt-Buy, loss: 0.008530668914318085
step: 150, task: Textual/Abt-Buy, loss: 0.001504272222518921
step: 160, task: Textual/Abt-Buy, loss: 0.00020207464694976807
step: 170, task: Textual/Abt-Buy, loss: 0.0004386305809020996
step: 180, task: Textual/Abt-Buy, loss: 0.006725780665874481
step: 190, task: Textual/Abt-Buy, loss: 0.00046962499618530273
step: 200, task: Textual/Abt-Buy, loss: 0.0031961649656295776
step: 210, task: Textual/Abt-Buy, loss: 0.00042219460010528564
step: 220, task: Textual/Abt-Buy, loss: 0.01819945126771927
step: 230, task: Textual/Abt-Buy, loss: 0.0006573498249053955
step: 240, task: Textual/Abt-Buy, loss: 0.0003100931644439697
step: 250, task: Textual/Abt-Buy, loss: 0.0006145238876342773
step: 260, task: Textual/Abt-Buy, loss: 0.00039076805114746094
step: 270, task: Textual/Abt-Buy, loss: 0.0003220289945602417
step: 280, task: Textual/Abt-Buy, loss: 0.023349754512310028
step: 290, task: Textual/Abt-Buy, loss: 0.0003567039966583252
step: 300, task: Textual/Abt-Buy, loss: 0.00019882619380950928
step: 310, task: Textual/Abt-Buy, loss: 0.0009876787662506104
step: 320, task: Textual/Abt-Buy, loss: 0.0022358447313308716
step: 330, task: Textual/Abt-Buy, loss: 0.0008812099695205688
step: 340, task: Textual/Abt-Buy, loss: 0.04642891883850098
step: 350, task: Textual/Abt-Buy, loss: 0.017121508717536926
=========eval at epoch=8=========
Validation:
=============Textual/Abt-Buy==================
accuracy=0.946
precision=0.876
recall=0.583
f1=0.700
======================================
Test:
=============Textual/Abt-Buy==================
accuracy=0.950
precision=0.894
recall=0.612
f1=0.726
======================================
Selected optimization level O2:  FP16 training with FP32 batchnorm and FP32 master weights.

Defaults for this optimization level are:
enabled                : True
opt_level              : O2
cast_model_type        : torch.float16
patch_torch_functions  : False
keep_batchnorm_fp32    : True
master_weights         : True
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O2
cast_model_type        : torch.float16
patch_torch_functions  : False
keep_batchnorm_fp32    : True
master_weights         : True
loss_scale             : dynamic
Warning:  multi_tensor_applier fused unscale kernel is unavailable, possibly because apex was installed without --cuda_ext --cpp_ext. Using Python fallback.  Original ImportError was: ModuleNotFoundError("No module named 'amp_C'")
Gradient overflow.  Skipping step, loss scaler 0 reducing loss scale to 32768.0
=====sanity check======
words: COL name VAL canon silver powershot digital camera sd880is COL description VAL canon silver powershot digital camera sd880is 10 megapixel 4x optical zoom optical image stabilizer 3.0 ' purecolor lcd ii digic 4 image processor face detection self-timer red-eye correction 19 shooting modes print/share button silver finish COL price VAL   [SEP] COL name VAL canon eos 5d mark ii digital slr camera 2764b003 COL description VAL 21.1 megapixel 16:9 3 ' active matrix tft color lcd COL price VAL 3699.99 
x: [    0 18047   766 27445 32839  4334  4361 10120  1778  2280 46409 32954
   354 14857  8194 27445 32839  4334  4361 10120  1778  2280 46409 32954
   354   158 10721 21424   204  1178 17547 21762 17547  2274 12964  6315
   155     4   288   128  8309 21685   784 28690 42661  8512   636   204
  2274 10655   652 12673  1403    12 36588  1275    12 20668 14921   753
  1094 19180  5780    73 12689  6148  4334  2073 14857   425 27445  1437
  1437     2     2 18047   766 27445 32839   364   366   195   417  2458
 42661  1778  3369   338  2280   974  4027   428 33490 14857  8194 27445
   733     4   134 10721 21424   545    35   466   155   128  2171 36173
   326  2543  3195   784 28690 14857   425 27445  2491  2831     4  2831
  1437     2]
tokens: ['<s>', 'COL', 'Ġname', 'ĠVAL', 'Ġcanon', 'Ġsilver', 'Ġpowers', 'hot', 'Ġdigital', 'Ġcamera', 'Ġsd', '880', 'is', 'ĠCOL', 'Ġdescription', 'ĠVAL', 'Ġcanon', 'Ġsilver', 'Ġpowers', 'hot', 'Ġdigital', 'Ġcamera', 'Ġsd', '880', 'is', 'Ġ10', 'Ġmeg', 'apixel', 'Ġ4', 'x', 'Ġoptical', 'Ġzoom', 'Ġoptical', 'Ġimage', 'Ġstabil', 'izer', 'Ġ3', '.', '0', "Ġ'", 'Ġpure', 'color', 'Ġl', 'cd', 'Ġii', 'Ġdig', 'ic', 'Ġ4', 'Ġimage', 'Ġprocessor', 'Ġface', 'Ġdetection', 'Ġself', '-', 'timer', 'Ġred', '-', 'eye', 'Ġcorrection', 'Ġ19', 'Ġshooting', 'Ġmodes', 'Ġprint', '/', 'share', 'Ġbutton', 'Ġsilver', 'Ġfinish', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ', 'Ġ', '</s>', '</s>', 'COL', 'Ġname', 'ĠVAL', 'Ġcanon', 'Ġe', 'os', 'Ġ5', 'd', 'Ġmark', 'Ġii', 'Ġdigital', 'Ġsl', 'r', 'Ġcamera', 'Ġ27', '64', 'b', '003', 'ĠCOL', 'Ġdescription', 'ĠVAL', 'Ġ21', '.', '1', 'Ġmeg', 'apixel', 'Ġ16', ':', '9', 'Ġ3', "Ġ'", 'Ġactive', 'Ġmatrix', 'Ġt', 'ft', 'Ġcolor', 'Ġl', 'cd', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ36', '99', '.', '99', 'Ġ', '</s>']
is_heads: [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
y: 0
tags: 0
mask: tensor([1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1])
seqlen: 122
task_name: Textual/Abt-Buy
=======================
step: 0, task: Textual/Abt-Buy, loss: 0.6291043162345886
Gradient overflow.  Skipping step, loss scaler 0 reducing loss scale to 16384.0
Gradient overflow.  Skipping step, loss scaler 0 reducing loss scale to 8192.0
step: 10, task: Textual/Abt-Buy, loss: 0.6920537352561951
step: 20, task: Textual/Abt-Buy, loss: 0.5453364849090576
step: 30, task: Textual/Abt-Buy, loss: 0.6749846935272217
step: 40, task: Textual/Abt-Buy, loss: 0.48183611035346985
step: 50, task: Textual/Abt-Buy, loss: 0.4431418180465698
step: 60, task: Textual/Abt-Buy, loss: 0.3115152418613434
step: 70, task: Textual/Abt-Buy, loss: 0.4050627648830414
step: 80, task: Textual/Abt-Buy, loss: 0.22886916995048523
step: 90, task: Textual/Abt-Buy, loss: 0.22571781277656555
step: 100, task: Textual/Abt-Buy, loss: 0.3525253236293793
step: 110, task: Textual/Abt-Buy, loss: 0.07271993905305862
step: 120, task: Textual/Abt-Buy, loss: 0.2650431990623474
step: 130, task: Textual/Abt-Buy, loss: 0.4009726643562317
step: 140, task: Textual/Abt-Buy, loss: 0.37959545850753784
step: 150, task: Textual/Abt-Buy, loss: 0.41526949405670166
step: 160, task: Textual/Abt-Buy, loss: 0.16681039333343506
step: 170, task: Textual/Abt-Buy, loss: 0.12494127452373505
step: 180, task: Textual/Abt-Buy, loss: 0.5408411622047424
step: 190, task: Textual/Abt-Buy, loss: 0.07778378576040268
step: 200, task: Textual/Abt-Buy, loss: 0.266194224357605
step: 210, task: Textual/Abt-Buy, loss: 0.20864546298980713
step: 220, task: Textual/Abt-Buy, loss: 0.17946667969226837
step: 230, task: Textual/Abt-Buy, loss: 0.2919721007347107
step: 240, task: Textual/Abt-Buy, loss: 0.5291243195533752
step: 250, task: Textual/Abt-Buy, loss: 0.5854388475418091
step: 260, task: Textual/Abt-Buy, loss: 0.3202765882015228
step: 270, task: Textual/Abt-Buy, loss: 0.11262056231498718
step: 280, task: Textual/Abt-Buy, loss: 0.27660033106803894
step: 290, task: Textual/Abt-Buy, loss: 0.44552162289619446
step: 300, task: Textual/Abt-Buy, loss: 0.24298200011253357
step: 310, task: Textual/Abt-Buy, loss: 0.20673593878746033
step: 320, task: Textual/Abt-Buy, loss: 0.3984355926513672
step: 330, task: Textual/Abt-Buy, loss: 0.524406373500824
step: 340, task: Textual/Abt-Buy, loss: 0.4630272090435028
step: 350, task: Textual/Abt-Buy, loss: 0.48407554626464844
=========eval at epoch=1=========
Validation:
=============Textual/Abt-Buy==================
accuracy=0.892
precision=0.000
recall=0.000
f1=0.000
======================================
Test:
=============Textual/Abt-Buy==================
accuracy=0.892
precision=0.000
recall=0.000
f1=0.000
======================================
/w/246/tianyu2020/miniconda2/envs/ditto/lib/python3.7/site-packages/apex/amp/_initialize.py:24: UserWarning: An input tensor was not cuda.
  warnings.warn("An input tensor was not cuda.")
/w/246/tianyu2020/miniconda2/envs/ditto/lib/python3.7/site-packages/torch/optim/lr_scheduler.py:122: UserWarning: Detected call of `lr_scheduler.step()` before `optimizer.step()`. In PyTorch 1.1.0 and later, you should call them in the opposite order: `optimizer.step()` before `lr_scheduler.step()`.  Failure to do this will result in PyTorch skipping the first value of the learning rate schedule. See more details at https://pytorch.org/docs/stable/optim.html#how-to-adjust-learning-rate
  "https://pytorch.org/docs/stable/optim.html#how-to-adjust-learning-rate", UserWarning)
/w/246/tianyu2020/miniconda2/envs/ditto/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1221: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
=====sanity check======
words: COL name VAL canon photo ink cartridge cl52 COL description VAL canon photo ink cartridge cl52 compatible with pixma ip6210d and ip6220d printers COL price VAL 25.0  [SEP] COL name VAL canon pixma ip4600 inkjet color photo printer 2909b002 COL description VAL  COL price VAL  
x: [    0 18047   766 27445 32839  1345 16019 41785  3741  4429 14857  8194
 27445 32839  1345 16019 41785  3741  4429 16632    19   181  3181  1916
 36180  5379   698   417     8 36180  5379   844   417 29379 14857   425
 27445   564     4   288  1437     2     2 18047   766 27445 32839   181
  3181  1916 36180  3761   612 16019  6622  3195  1345 24079  1132  3546
   428 19130 14857  8194 27445  1437 14857   425 27445  1437  1437     2]
tokens: ['<s>', 'COL', 'Ġname', 'ĠVAL', 'Ġcanon', 'Ġphoto', 'Ġink', 'Ġcartridge', 'Ġcl', '52', 'ĠCOL', 'Ġdescription', 'ĠVAL', 'Ġcanon', 'Ġphoto', 'Ġink', 'Ġcartridge', 'Ġcl', '52', 'Ġcompatible', 'Ġwith', 'Ġp', 'ix', 'ma', 'Ġip', '62', '10', 'd', 'Ġand', 'Ġip', '62', '20', 'd', 'Ġprinters', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ25', '.', '0', 'Ġ', '</s>', '</s>', 'COL', 'Ġname', 'ĠVAL', 'Ġcanon', 'Ġp', 'ix', 'ma', 'Ġip', '46', '00', 'Ġink', 'jet', 'Ġcolor', 'Ġphoto', 'Ġprinter', 'Ġ29', '09', 'b', '002', 'ĠCOL', 'Ġdescription', 'ĠVAL', 'Ġ', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ', 'Ġ', '</s>']
is_heads: [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
y: 0
tags: 0
mask: tensor([1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1])
seqlen: 72
task_name: Textual/Abt-Buy
=======================
step: 0, task: Textual/Abt-Buy, loss: 0.2421364039182663
step: 10, task: Textual/Abt-Buy, loss: 0.08027791231870651
step: 20, task: Textual/Abt-Buy, loss: 0.34371140599250793
step: 30, task: Textual/Abt-Buy, loss: 0.3953557312488556
step: 40, task: Textual/Abt-Buy, loss: 0.4022778868675232
step: 50, task: Textual/Abt-Buy, loss: 0.4856681823730469
step: 60, task: Textual/Abt-Buy, loss: 0.6306838393211365
step: 70, task: Textual/Abt-Buy, loss: 0.10397815704345703
step: 80, task: Textual/Abt-Buy, loss: 0.34721261262893677
step: 90, task: Textual/Abt-Buy, loss: 0.06978853046894073
step: 100, task: Textual/Abt-Buy, loss: 0.2076723724603653
step: 110, task: Textual/Abt-Buy, loss: 0.3420127034187317
step: 120, task: Textual/Abt-Buy, loss: 0.2538875341415405
step: 130, task: Textual/Abt-Buy, loss: 0.4157911539077759
step: 140, task: Textual/Abt-Buy, loss: 0.40542274713516235
step: 150, task: Textual/Abt-Buy, loss: 0.2515922486782074
step: 160, task: Textual/Abt-Buy, loss: 0.36933648586273193
step: 170, task: Textual/Abt-Buy, loss: 0.49903756380081177
step: 180, task: Textual/Abt-Buy, loss: 0.392869234085083
step: 190, task: Textual/Abt-Buy, loss: 0.23433321714401245
step: 200, task: Textual/Abt-Buy, loss: 0.36076319217681885
step: 210, task: Textual/Abt-Buy, loss: 0.3849654495716095
step: 220, task: Textual/Abt-Buy, loss: 0.5675152540206909
step: 230, task: Textual/Abt-Buy, loss: 0.11015453189611435
step: 240, task: Textual/Abt-Buy, loss: 0.07012034952640533
step: 250, task: Textual/Abt-Buy, loss: 0.24413272738456726
step: 260, task: Textual/Abt-Buy, loss: 0.3301811218261719
step: 270, task: Textual/Abt-Buy, loss: 0.41763439774513245
step: 280, task: Textual/Abt-Buy, loss: 0.21534404158592224
step: 290, task: Textual/Abt-Buy, loss: 0.24244534969329834
step: 300, task: Textual/Abt-Buy, loss: 0.6995558142662048
step: 310, task: Textual/Abt-Buy, loss: 0.24430547654628754
step: 320, task: Textual/Abt-Buy, loss: 0.1443617045879364
step: 330, task: Textual/Abt-Buy, loss: 0.2531971037387848
step: 340, task: Textual/Abt-Buy, loss: 0.44566085934638977
step: 350, task: Textual/Abt-Buy, loss: 0.27938413619995117
=========eval at epoch=1=========
Validation:
=============Textual/Abt-Buy==================
accuracy=0.892
precision=0.000
recall=0.000
f1=0.000
======================================
Test:
=============Textual/Abt-Buy==================
accuracy=0.892
precision=0.000
recall=0.000
f1=0.000
======================================
=====sanity check======
words: COL name VAL panasonic black dvd home theater sound system scpt660 COL description VAL panasonic black dvd home theater sound system scpt660 kelton subwoofer bamboo diaphragm center speakers 1080p up-conversion integrated universal dock and on-screen display for ipod ipod video playback whisper-mode surround built-in dolby digital and dts decoder high speed 5-dvd/cd changer black finish COL price VAL 289.0  [SEP] COL name VAL sony ht-ct100 home theater system COL description VAL , 3.1 speakers progressive scan 250w rms COL price VAL 279.95 
x: [    0 18047   766 27445  5730 38703   909   385 40311   184  7364  2369
   467  2850  3320 31412 14857  8194 27445  5730 38703   909   385 40311
   184  7364  2369   467  2850  3320 31412  7321   462  1054  2849 14869
 20779 31970  2269  8258 18937   119  1312  6864 21083   642    62    12
  3865 21747  6818 10547 15261     8    15    12  9806  2332    13 36180
  1630 36180  1630   569 20083 37539    12 42253 21104  1490    12   179
   385  1168  1409  1778     8   385  1872  5044 15362   239  2078   195
    12   417 40311    73 28690 24622   254   909  2073 14857   425 27445
 39613     4   288  1437     2     2 18047   766 27445   579  6119  1368
    90    12  3894  1866   184  7364   467 14857  8194 27445  2156   155
     4   134  6864  8212 14194  5773   605   910  4339 14857   425 27445
 37191     4  4015  1437     2]
tokens: ['<s>', 'COL', 'Ġname', 'ĠVAL', 'Ġpan', 'asonic', 'Ġblack', 'Ġd', 'vd', 'Ġhome', 'Ġtheater', 'Ġsound', 'Ġsystem', 'Ġsc', 'pt', '660', 'ĠCOL', 'Ġdescription', 'ĠVAL', 'Ġpan', 'asonic', 'Ġblack', 'Ġd', 'vd', 'Ġhome', 'Ġtheater', 'Ġsound', 'Ġsystem', 'Ġsc', 'pt', '660', 'Ġke', 'l', 'ton', 'Ġsub', 'wo', 'ofer', 'Ġbamboo', 'Ġdi', 'aph', 'rag', 'm', 'Ġcenter', 'Ġspeakers', 'Ġ1080', 'p', 'Ġup', '-', 'con', 'version', 'Ġintegrated', 'Ġuniversal', 'Ġdock', 'Ġand', 'Ġon', '-', 'screen', 'Ġdisplay', 'Ġfor', 'Ġip', 'od', 'Ġip', 'od', 'Ġvideo', 'Ġplayback', 'Ġwhisper', '-', 'mode', 'Ġsurround', 'Ġbuilt', '-', 'in', 'Ġd', 'ol', 'by', 'Ġdigital', 'Ġand', 'Ġd', 'ts', 'Ġdec', 'oder', 'Ġhigh', 'Ġspeed', 'Ġ5', '-', 'd', 'vd', '/', 'cd', 'Ġchang', 'er', 'Ġblack', 'Ġfinish', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ289', '.', '0', 'Ġ', '</s>', '</s>', 'COL', 'Ġname', 'ĠVAL', 'Ġs', 'ony', 'Ġh', 't', '-', 'ct', '100', 'Ġhome', 'Ġtheater', 'Ġsystem', 'ĠCOL', 'Ġdescription', 'ĠVAL', 'Ġ,', 'Ġ3', '.', '1', 'Ġspeakers', 'Ġprogressive', 'Ġscan', 'Ġ250', 'w', 'Ġr', 'ms', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ279', '.', '95', 'Ġ', '</s>']
is_heads: [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
y: 0
tags: 0
mask: tensor([1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1])
seqlen: 137
task_name: Textual/Abt-Buy
=======================
step: 0, task: Textual/Abt-Buy, loss: 0.3260895609855652
step: 10, task: Textual/Abt-Buy, loss: 0.380391001701355
step: 20, task: Textual/Abt-Buy, loss: 0.3235122561454773
step: 30, task: Textual/Abt-Buy, loss: 0.1491146981716156
step: 40, task: Textual/Abt-Buy, loss: 0.39564990997314453
step: 50, task: Textual/Abt-Buy, loss: 0.46566838026046753
step: 60, task: Textual/Abt-Buy, loss: 0.3933136463165283
step: 70, task: Textual/Abt-Buy, loss: 0.34250596165657043
step: 80, task: Textual/Abt-Buy, loss: 0.2720607817173004
step: 90, task: Textual/Abt-Buy, loss: 0.2646448314189911
step: 100, task: Textual/Abt-Buy, loss: 0.3324311673641205
step: 110, task: Textual/Abt-Buy, loss: 0.3850215673446655
step: 120, task: Textual/Abt-Buy, loss: 0.4504459500312805
step: 130, task: Textual/Abt-Buy, loss: 0.4345909059047699
step: 140, task: Textual/Abt-Buy, loss: 0.11712578684091568
step: 150, task: Textual/Abt-Buy, loss: 0.20157232880592346
step: 160, task: Textual/Abt-Buy, loss: 0.12455639243125916
step: 170, task: Textual/Abt-Buy, loss: 0.2659592926502228
step: 180, task: Textual/Abt-Buy, loss: 0.22897778451442719
step: 190, task: Textual/Abt-Buy, loss: 0.6116155385971069
step: 200, task: Textual/Abt-Buy, loss: 0.39592444896698
step: 210, task: Textual/Abt-Buy, loss: 0.337204247713089
step: 220, task: Textual/Abt-Buy, loss: 0.2114480882883072
step: 230, task: Textual/Abt-Buy, loss: 0.19367924332618713
step: 240, task: Textual/Abt-Buy, loss: 0.2487640678882599
step: 250, task: Textual/Abt-Buy, loss: 0.2767293453216553
step: 260, task: Textual/Abt-Buy, loss: 0.28187301754951477
step: 270, task: Textual/Abt-Buy, loss: 0.2905411720275879
step: 280, task: Textual/Abt-Buy, loss: 0.5485297441482544
step: 290, task: Textual/Abt-Buy, loss: 0.2329586148262024
step: 300, task: Textual/Abt-Buy, loss: 0.3879232108592987
step: 310, task: Textual/Abt-Buy, loss: 0.7218471169471741
step: 320, task: Textual/Abt-Buy, loss: 0.603269100189209
step: 330, task: Textual/Abt-Buy, loss: 0.6037150621414185
step: 340, task: Textual/Abt-Buy, loss: 0.24683867394924164
step: 350, task: Textual/Abt-Buy, loss: 0.3511652946472168
=========eval at epoch=1=========
Validation:
=============Textual/Abt-Buy==================
accuracy=0.892
precision=0.000
recall=0.000
f1=0.000
======================================
Test:
=============Textual/Abt-Buy==================
accuracy=0.892
precision=0.000
recall=0.000
f1=0.000
======================================
=====sanity check======
words: COL name VAL sony bravia home theater system davhdx275 COL description VAL sony bravia home theater system davhdx275 5.1 channel surround 1080p upscaling via hdmi 1000watts 5-disc dvd-cd player multi-room s-air technology bravia sync ipod cradle digital media port digital cinema auto calibration multi speaker formation black and silver finish COL price VAL   [SEP] COL name VAL samsung htx810t home theater system htx810t COL description VAL samsung ht-x810 2.1 soundbar home theater system COL price VAL 580.14 
x: [    0 18047   766 27445   579  6119 35977   493   184  7364   467   385
  1469 35905  1178 21138 14857  8194 27445   579  6119 35977   493   184
  7364   467   385  1469 35905  1178 21138   195     4   134  4238 21104
 21083   642    62  3866  8279  1241  1368   417  5408 10775   605 26366
   195    12 18909   385 40311    12 28690   869  3228    12  4294   579
    12  2456   806 35977   493 22785 36180  1630 39111  1778   433  4103
  1778 11605  4485 42269  3228  5385  9285   909     8  4334  2073 14857
   425 27445  1437  1437     2     2 18047   766 27445   579 48545  1368
 43820 35269    90   184  7364   467  1368 43820 35269    90 14857  8194
 27445   579 48545  1368    90    12  1178 35269   132     4   134  2369
  4901   184  7364   467 14857   425 27445 34240     4  1570  1437     2]
tokens: ['<s>', 'COL', 'Ġname', 'ĠVAL', 'Ġs', 'ony', 'Ġbrav', 'ia', 'Ġhome', 'Ġtheater', 'Ġsystem', 'Ġd', 'av', 'hd', 'x', '275', 'ĠCOL', 'Ġdescription', 'ĠVAL', 'Ġs', 'ony', 'Ġbrav', 'ia', 'Ġhome', 'Ġtheater', 'Ġsystem', 'Ġd', 'av', 'hd', 'x', '275', 'Ġ5', '.', '1', 'Ġchannel', 'Ġsurround', 'Ġ1080', 'p', 'Ġup', 'sc', 'aling', 'Ġvia', 'Ġh', 'd', 'mi', 'Ġ1000', 'w', 'atts', 'Ġ5', '-', 'disc', 'Ġd', 'vd', '-', 'cd', 'Ġplayer', 'Ġmulti', '-', 'room', 'Ġs', '-', 'air', 'Ġtechnology', 'Ġbrav', 'ia', 'Ġsync', 'Ġip', 'od', 'Ġcradle', 'Ġdigital', 'Ġmedia', 'Ġport', 'Ġdigital', 'Ġcinema', 'Ġauto', 'Ġcalibration', 'Ġmulti', 'Ġspeaker', 'Ġformation', 'Ġblack', 'Ġand', 'Ġsilver', 'Ġfinish', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ', 'Ġ', '</s>', '</s>', 'COL', 'Ġname', 'ĠVAL', 'Ġs', 'amsung', 'Ġh', 'tx', '810', 't', 'Ġhome', 'Ġtheater', 'Ġsystem', 'Ġh', 'tx', '810', 't', 'ĠCOL', 'Ġdescription', 'ĠVAL', 'Ġs', 'amsung', 'Ġh', 't', '-', 'x', '810', 'Ġ2', '.', '1', 'Ġsound', 'bar', 'Ġhome', 'Ġtheater', 'Ġsystem', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ580', '.', '14', 'Ġ', '</s>']
is_heads: [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
y: 0
tags: 0
mask: tensor([1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1])
seqlen: 132
task_name: Textual/Abt-Buy
=======================
step: 0, task: Textual/Abt-Buy, loss: 0.34602952003479004
step: 10, task: Textual/Abt-Buy, loss: 0.38720864057540894
step: 20, task: Textual/Abt-Buy, loss: 0.4387465715408325
step: 30, task: Textual/Abt-Buy, loss: 0.5710775852203369
step: 40, task: Textual/Abt-Buy, loss: 0.13207939267158508
step: 50, task: Textual/Abt-Buy, loss: 0.48696252703666687
step: 60, task: Textual/Abt-Buy, loss: 0.2288040965795517
step: 70, task: Textual/Abt-Buy, loss: 0.389096200466156
step: 80, task: Textual/Abt-Buy, loss: 0.29149943590164185
step: 90, task: Textual/Abt-Buy, loss: 0.2706397771835327
step: 100, task: Textual/Abt-Buy, loss: 0.3066259026527405
step: 110, task: Textual/Abt-Buy, loss: 0.26056158542633057
step: 120, task: Textual/Abt-Buy, loss: 0.1592668890953064
step: 130, task: Textual/Abt-Buy, loss: 0.3682785928249359
step: 140, task: Textual/Abt-Buy, loss: 0.3515643775463104
step: 150, task: Textual/Abt-Buy, loss: 0.4165259003639221
step: 160, task: Textual/Abt-Buy, loss: 0.5673953294754028
step: 170, task: Textual/Abt-Buy, loss: 0.25784212350845337
step: 180, task: Textual/Abt-Buy, loss: 0.6131214499473572
step: 190, task: Textual/Abt-Buy, loss: 0.42538854479789734
step: 200, task: Textual/Abt-Buy, loss: 0.6329078674316406
step: 210, task: Textual/Abt-Buy, loss: 0.786185622215271
step: 220, task: Textual/Abt-Buy, loss: 0.43065381050109863
step: 230, task: Textual/Abt-Buy, loss: 0.2723180055618286
step: 240, task: Textual/Abt-Buy, loss: 0.22522370517253876
step: 250, task: Textual/Abt-Buy, loss: 0.20426100492477417
step: 260, task: Textual/Abt-Buy, loss: 0.23940110206604004
step: 270, task: Textual/Abt-Buy, loss: 0.6257384419441223
step: 280, task: Textual/Abt-Buy, loss: 0.29422178864479065
step: 290, task: Textual/Abt-Buy, loss: 0.27671805024147034
step: 300, task: Textual/Abt-Buy, loss: 0.3806855380535126
step: 310, task: Textual/Abt-Buy, loss: 0.36256715655326843
step: 320, task: Textual/Abt-Buy, loss: 0.4003693461418152
step: 330, task: Textual/Abt-Buy, loss: 0.44251272082328796
step: 340, task: Textual/Abt-Buy, loss: 0.32458359003067017
step: 350, task: Textual/Abt-Buy, loss: 0.13042865693569183
=========eval at epoch=1=========
Validation:
=============Textual/Abt-Buy==================
accuracy=0.892
precision=0.000
recall=0.000
f1=0.000
======================================
Test:
=============Textual/Abt-Buy==================
accuracy=0.892
precision=0.000
recall=0.000
f1=0.000
======================================
=====sanity check======
words: COL name VAL omnimount wall speaker mount 20wlbk COL description VAL omnimount wall speaker mount 20wlbk stainless steel shafts and all necessary hardware included supports speakers up to 20 lbs . sold as single black finish COL price VAL 39.95  [SEP] COL name VAL omnimount universal wall speaker mounting kit 20.0 wall-b COL description VAL stainless steel 20 lb COL price VAL 24.34 
x: [    0 18047   766 27445 32442   757 12825  2204  5385 14206   291   605
 17243   330 14857  8194 27445 32442   757 12825  2204  5385 14206   291
   605 17243   330 23486  3689 27050    29     8    70  2139  6554  1165
  4548  6864    62     7   291 23246   479  1088    25   881   909  2073
 14857   425 27445  3191     4  4015  1437     2     2 18047   766 27445
 32442   757 12825 10547  2204  5385 12033 10549   291     4   288  2204
    12   428 14857  8194 27445 23486  3689   291 19821 14857   425 27445
   706     4  3079  1437     2]
tokens: ['<s>', 'COL', 'Ġname', 'ĠVAL', 'Ġomn', 'im', 'ount', 'Ġwall', 'Ġspeaker', 'Ġmount', 'Ġ20', 'w', 'lb', 'k', 'ĠCOL', 'Ġdescription', 'ĠVAL', 'Ġomn', 'im', 'ount', 'Ġwall', 'Ġspeaker', 'Ġmount', 'Ġ20', 'w', 'lb', 'k', 'Ġstainless', 'Ġsteel', 'Ġshaft', 's', 'Ġand', 'Ġall', 'Ġnecessary', 'Ġhardware', 'Ġincluded', 'Ġsupports', 'Ġspeakers', 'Ġup', 'Ġto', 'Ġ20', 'Ġlbs', 'Ġ.', 'Ġsold', 'Ġas', 'Ġsingle', 'Ġblack', 'Ġfinish', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ39', '.', '95', 'Ġ', '</s>', '</s>', 'COL', 'Ġname', 'ĠVAL', 'Ġomn', 'im', 'ount', 'Ġuniversal', 'Ġwall', 'Ġspeaker', 'Ġmounting', 'Ġkit', 'Ġ20', '.', '0', 'Ġwall', '-', 'b', 'ĠCOL', 'Ġdescription', 'ĠVAL', 'Ġstainless', 'Ġsteel', 'Ġ20', 'Ġlb', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ24', '.', '34', 'Ġ', '</s>']
is_heads: [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
y: 1
tags: 1
mask: tensor([1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1])
seqlen: 89
task_name: Textual/Abt-Buy
=======================
step: 0, task: Textual/Abt-Buy, loss: 0.5360667705535889
step: 10, task: Textual/Abt-Buy, loss: 0.6420450806617737
step: 20, task: Textual/Abt-Buy, loss: 0.38371366262435913
step: 30, task: Textual/Abt-Buy, loss: 0.31252583861351013
step: 40, task: Textual/Abt-Buy, loss: 0.32999297976493835
step: 50, task: Textual/Abt-Buy, loss: 0.2937697172164917
step: 60, task: Textual/Abt-Buy, loss: 0.35409659147262573
step: 70, task: Textual/Abt-Buy, loss: 0.5986945033073425
step: 80, task: Textual/Abt-Buy, loss: 0.43095460534095764
step: 90, task: Textual/Abt-Buy, loss: 0.253147691488266
step: 100, task: Textual/Abt-Buy, loss: 0.5698986053466797
step: 110, task: Textual/Abt-Buy, loss: 0.1023460403084755
step: 120, task: Textual/Abt-Buy, loss: 0.340787410736084
step: 130, task: Textual/Abt-Buy, loss: 0.2264460176229477
step: 140, task: Textual/Abt-Buy, loss: 0.25509271025657654
step: 150, task: Textual/Abt-Buy, loss: 0.30393362045288086
step: 160, task: Textual/Abt-Buy, loss: 0.3635497987270355
step: 170, task: Textual/Abt-Buy, loss: 0.3127557337284088
step: 180, task: Textual/Abt-Buy, loss: 0.02676507830619812
step: 190, task: Textual/Abt-Buy, loss: 0.13586962223052979
step: 200, task: Textual/Abt-Buy, loss: 0.23400352895259857
step: 210, task: Textual/Abt-Buy, loss: 0.03926970064640045
step: 220, task: Textual/Abt-Buy, loss: 0.03528868407011032
step: 230, task: Textual/Abt-Buy, loss: 0.3208843469619751
step: 240, task: Textual/Abt-Buy, loss: 0.17535005509853363
step: 250, task: Textual/Abt-Buy, loss: 0.08617574721574783
step: 260, task: Textual/Abt-Buy, loss: 0.27116554975509644
step: 270, task: Textual/Abt-Buy, loss: 0.2163909524679184
step: 280, task: Textual/Abt-Buy, loss: 0.1952478289604187
step: 290, task: Textual/Abt-Buy, loss: 0.5026875734329224
step: 300, task: Textual/Abt-Buy, loss: 0.2587338387966156
step: 310, task: Textual/Abt-Buy, loss: 0.28441280126571655
step: 320, task: Textual/Abt-Buy, loss: 0.08930707722902298
step: 330, task: Textual/Abt-Buy, loss: 0.27398744225502014
step: 340, task: Textual/Abt-Buy, loss: 0.21561166644096375
step: 350, task: Textual/Abt-Buy, loss: 0.14112406969070435
=========eval at epoch=1=========
Validation:
=============Textual/Abt-Buy==================
accuracy=0.937
precision=0.730
recall=0.655
f1=0.691
======================================
Test:
=============Textual/Abt-Buy==================
accuracy=0.929
precision=0.684
recall=0.631
f1=0.657
======================================
=====sanity check======
words: COL name VAL omnimount 42 ' 63 ' wishbone cantilever extra large flat panel tv silver wall mount uclxb COL description VAL omnimount 42 ' 63 ' wishbone cantilever extra large flat panel tv silver wall mount uclxb double stud mounting dual arm cantilever mount lift n lock for easy installation integrated cable management supports up to 200 lbs COL price VAL   [SEP] COL name VAL sanus flat panel tv wall mount vm1b COL description VAL aluminum 50 lb COL price VAL 69.99 
x: [    0 18047   766 27445 32442   757 12825  3330   128  5549   128  2813
 18026 17672  1848  2802  1823   739  3269  2798 30016  4334  2204 14206
  1717  3998 46073 14857  8194 27445 32442   757 12825  3330   128  5549
   128  2813 18026 17672  1848  2802  1823   739  3269  2798 30016  4334
  2204 14206  1717  3998 46073  1457 15863 12033  6594  3124 17672  1848
  2802 14206  5258   295  7014    13  1365  8809  6818  6129  1052  4548
    62     7  1878 23246 14857   425 27445  1437  1437     2     2 18047
   766 27445 15610   687  3269  2798 30016  2204 14206 48643   134   428
 14857  8194 27445  9757   654 19821 14857   425 27445  5913     4  2831
  1437     2]
tokens: ['<s>', 'COL', 'Ġname', 'ĠVAL', 'Ġomn', 'im', 'ount', 'Ġ42', "Ġ'", 'Ġ63', "Ġ'", 'Ġwish', 'bone', 'Ġcant', 'ile', 'ver', 'Ġextra', 'Ġlarge', 'Ġflat', 'Ġpanel', 'Ġtv', 'Ġsilver', 'Ġwall', 'Ġmount', 'Ġu', 'cl', 'xb', 'ĠCOL', 'Ġdescription', 'ĠVAL', 'Ġomn', 'im', 'ount', 'Ġ42', "Ġ'", 'Ġ63', "Ġ'", 'Ġwish', 'bone', 'Ġcant', 'ile', 'ver', 'Ġextra', 'Ġlarge', 'Ġflat', 'Ġpanel', 'Ġtv', 'Ġsilver', 'Ġwall', 'Ġmount', 'Ġu', 'cl', 'xb', 'Ġdouble', 'Ġstud', 'Ġmounting', 'Ġdual', 'Ġarm', 'Ġcant', 'ile', 'ver', 'Ġmount', 'Ġlift', 'Ġn', 'Ġlock', 'Ġfor', 'Ġeasy', 'Ġinstallation', 'Ġintegrated', 'Ġcable', 'Ġmanagement', 'Ġsupports', 'Ġup', 'Ġto', 'Ġ200', 'Ġlbs', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ', 'Ġ', '</s>', '</s>', 'COL', 'Ġname', 'ĠVAL', 'Ġsan', 'us', 'Ġflat', 'Ġpanel', 'Ġtv', 'Ġwall', 'Ġmount', 'Ġvm', '1', 'b', 'ĠCOL', 'Ġdescription', 'ĠVAL', 'Ġaluminum', 'Ġ50', 'Ġlb', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ69', '.', '99', 'Ġ', '</s>']
is_heads: [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
y: 0
tags: 0
mask: tensor([1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1])
seqlen: 110
task_name: Textual/Abt-Buy
=======================
step: 0, task: Textual/Abt-Buy, loss: 0.1776912808418274
step: 10, task: Textual/Abt-Buy, loss: 0.07519317418336868
step: 20, task: Textual/Abt-Buy, loss: 0.0771169513463974
step: 30, task: Textual/Abt-Buy, loss: 0.12391409277915955
step: 40, task: Textual/Abt-Buy, loss: 0.08539630472660065
step: 50, task: Textual/Abt-Buy, loss: 0.4068053960800171
step: 60, task: Textual/Abt-Buy, loss: 0.27381253242492676
step: 70, task: Textual/Abt-Buy, loss: 0.18470732867717743
step: 80, task: Textual/Abt-Buy, loss: 0.01059715449810028
step: 90, task: Textual/Abt-Buy, loss: 0.11558195948600769
step: 100, task: Textual/Abt-Buy, loss: 0.4107031226158142
step: 110, task: Textual/Abt-Buy, loss: 0.017038490623235703
step: 120, task: Textual/Abt-Buy, loss: 0.03486628085374832
step: 130, task: Textual/Abt-Buy, loss: 0.4046933650970459
step: 140, task: Textual/Abt-Buy, loss: 0.1289461851119995
step: 150, task: Textual/Abt-Buy, loss: 0.3796800374984741
step: 160, task: Textual/Abt-Buy, loss: 0.06627358496189117
step: 170, task: Textual/Abt-Buy, loss: 0.0029738694429397583
step: 180, task: Textual/Abt-Buy, loss: 0.23129227757453918
step: 190, task: Textual/Abt-Buy, loss: 0.08206374943256378
step: 200, task: Textual/Abt-Buy, loss: 0.003626801073551178
step: 210, task: Textual/Abt-Buy, loss: 0.0691232904791832
step: 220, task: Textual/Abt-Buy, loss: 0.015481308102607727
step: 230, task: Textual/Abt-Buy, loss: 0.039296891540288925
step: 240, task: Textual/Abt-Buy, loss: 0.029398292303085327
step: 250, task: Textual/Abt-Buy, loss: 0.11295023560523987
step: 260, task: Textual/Abt-Buy, loss: 0.0156368650496006
step: 270, task: Textual/Abt-Buy, loss: 0.0991855189204216
step: 280, task: Textual/Abt-Buy, loss: 0.08029067516326904
step: 290, task: Textual/Abt-Buy, loss: 0.010725051164627075
step: 300, task: Textual/Abt-Buy, loss: 0.006309740245342255
step: 310, task: Textual/Abt-Buy, loss: 0.12188149988651276
Gradient overflow.  Skipping step, loss scaler 0 reducing loss scale to 8192.0
step: 320, task: Textual/Abt-Buy, loss: 0.013587012887001038
step: 330, task: Textual/Abt-Buy, loss: 0.0876641646027565
step: 340, task: Textual/Abt-Buy, loss: 0.2250681221485138
step: 350, task: Textual/Abt-Buy, loss: 0.322902113199234
=========eval at epoch=2=========
Validation:
=============Textual/Abt-Buy==================
accuracy=0.930
precision=0.853
recall=0.422
f1=0.565
======================================
Test:
=============Textual/Abt-Buy==================
accuracy=0.944
precision=0.884
recall=0.553
f1=0.681
======================================
=====sanity check======
words: COL name VAL toshiba black portable dvd player sdp71s COL description VAL toshiba black portable dvd player sdp71s 7 ' widescreen tft lcd display up to 3 hour lithium battery life jpeg viewer switchable audio/video input and output black finish COL price VAL   [SEP] COL name VAL panasonic dvd-ls86 portable dvd player COL description VAL 8.5 ' lcd dvd + rw , dvd-rw , dvd-ram , dvd-r , dvd + r , cd-rw cd-da , mp3 , wma , jpeg , mpeg-4 , divx , video cd , svcd , highmat , dvd video playback COL price VAL 164.12 
x: [    0 18047   766 27445     7  1193 15577   909 15295   385 40311   869
   579 43923  5339    29 14857  8194 27445     7  1193 15577   909 15295
   385 40311   869   579 43923  5339    29   262   128   885  4376 37346
   326  2543   784 28690  2332    62     7   155  1946 16904  3822   301
  1236 41191 18754  5405   868  6086    73 14406  8135     8  4195   909
  2073 14857   425 27445  1437  1437     2     2 18047   766 27445  5730
 38703   385 40311    12  6634  5334 15295   385 40311   869 14857  8194
 27445   290     4   245   128   784 28690   385 40311  2055   910   605
  2156   385 40311    12 43926  2156   385 40311    12  4040  2156   385
 40311    12   338  2156   385 40311  2055   910  2156 45584    12 43926
 45584    12  6106  2156 44857   246  2156   885  1916  2156  1236 41191
  2156   475 41191    12   306  2156 14445  1178  2156   569 45584  2156
 23119 28690  2156   239  9244  2156   385 40311   569 20083 14857   425
 27445 27983     4  1092  1437     2]
tokens: ['<s>', 'COL', 'Ġname', 'ĠVAL', 'Ġto', 'sh', 'iba', 'Ġblack', 'Ġportable', 'Ġd', 'vd', 'Ġplayer', 'Ġs', 'dp', '71', 's', 'ĠCOL', 'Ġdescription', 'ĠVAL', 'Ġto', 'sh', 'iba', 'Ġblack', 'Ġportable', 'Ġd', 'vd', 'Ġplayer', 'Ġs', 'dp', '71', 's', 'Ġ7', "Ġ'", 'Ġw', 'ides', 'creen', 'Ġt', 'ft', 'Ġl', 'cd', 'Ġdisplay', 'Ġup', 'Ġto', 'Ġ3', 'Ġhour', 'Ġlithium', 'Ġbattery', 'Ġlife', 'Ġj', 'peg', 'Ġviewer', 'Ġswitch', 'able', 'Ġaudio', '/', 'video', 'Ġinput', 'Ġand', 'Ġoutput', 'Ġblack', 'Ġfinish', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ', 'Ġ', '</s>', '</s>', 'COL', 'Ġname', 'ĠVAL', 'Ġpan', 'asonic', 'Ġd', 'vd', '-', 'ls', '86', 'Ġportable', 'Ġd', 'vd', 'Ġplayer', 'ĠCOL', 'Ġdescription', 'ĠVAL', 'Ġ8', '.', '5', "Ġ'", 'Ġl', 'cd', 'Ġd', 'vd', 'Ġ+', 'Ġr', 'w', 'Ġ,', 'Ġd', 'vd', '-', 'rw', 'Ġ,', 'Ġd', 'vd', '-', 'ram', 'Ġ,', 'Ġd', 'vd', '-', 'r', 'Ġ,', 'Ġd', 'vd', 'Ġ+', 'Ġr', 'Ġ,', 'Ġcd', '-', 'rw', 'Ġcd', '-', 'da', 'Ġ,', 'Ġmp', '3', 'Ġ,', 'Ġw', 'ma', 'Ġ,', 'Ġj', 'peg', 'Ġ,', 'Ġm', 'peg', '-', '4', 'Ġ,', 'Ġdiv', 'x', 'Ġ,', 'Ġvideo', 'Ġcd', 'Ġ,', 'Ġsv', 'cd', 'Ġ,', 'Ġhigh', 'mat', 'Ġ,', 'Ġd', 'vd', 'Ġvideo', 'Ġplayback', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ164', '.', '12', 'Ġ', '</s>']
is_heads: [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
y: 0
tags: 0
mask: tensor([1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1])
seqlen: 162
task_name: Textual/Abt-Buy
=======================
step: 0, task: Textual/Abt-Buy, loss: 0.004743486642837524
step: 10, task: Textual/Abt-Buy, loss: 0.020000837743282318
step: 20, task: Textual/Abt-Buy, loss: 0.01172960177063942
step: 30, task: Textual/Abt-Buy, loss: 0.0806393027305603
step: 40, task: Textual/Abt-Buy, loss: 0.0101701058447361
step: 50, task: Textual/Abt-Buy, loss: 0.012429863214492798
step: 60, task: Textual/Abt-Buy, loss: 0.07279226928949356
step: 70, task: Textual/Abt-Buy, loss: 0.2615221440792084
step: 80, task: Textual/Abt-Buy, loss: 0.024207331240177155
step: 90, task: Textual/Abt-Buy, loss: 0.33083575963974
step: 100, task: Textual/Abt-Buy, loss: 0.0705508291721344
step: 110, task: Textual/Abt-Buy, loss: 0.032279711216688156
step: 120, task: Textual/Abt-Buy, loss: 0.24629831314086914
step: 130, task: Textual/Abt-Buy, loss: 0.010635018348693848
step: 140, task: Textual/Abt-Buy, loss: 0.08039456605911255
step: 150, task: Textual/Abt-Buy, loss: 0.0170716755092144
step: 160, task: Textual/Abt-Buy, loss: 0.05881192535161972
step: 170, task: Textual/Abt-Buy, loss: 0.16807885468006134
step: 180, task: Textual/Abt-Buy, loss: 0.0234510600566864
step: 190, task: Textual/Abt-Buy, loss: 0.05744193121790886
step: 200, task: Textual/Abt-Buy, loss: 0.07777289301156998
step: 210, task: Textual/Abt-Buy, loss: 0.013401687145233154
step: 220, task: Textual/Abt-Buy, loss: 0.024638164788484573
step: 230, task: Textual/Abt-Buy, loss: 0.12252706289291382
step: 240, task: Textual/Abt-Buy, loss: 0.004816822707653046
step: 250, task: Textual/Abt-Buy, loss: 0.013205256313085556
step: 260, task: Textual/Abt-Buy, loss: 0.000624433159828186
step: 270, task: Textual/Abt-Buy, loss: 0.11165068298578262
step: 280, task: Textual/Abt-Buy, loss: 0.011164017021656036
step: 290, task: Textual/Abt-Buy, loss: 0.2794615626335144
step: 300, task: Textual/Abt-Buy, loss: 0.02770642191171646
step: 310, task: Textual/Abt-Buy, loss: 0.007227063179016113
step: 320, task: Textual/Abt-Buy, loss: 0.2741762399673462
step: 330, task: Textual/Abt-Buy, loss: 0.013747196644544601
step: 340, task: Textual/Abt-Buy, loss: 0.0014879778027534485
step: 350, task: Textual/Abt-Buy, loss: 0.03604456037282944
=========eval at epoch=3=========
Validation:
=============Textual/Abt-Buy==================
accuracy=0.951
precision=0.860
recall=0.655
f1=0.744
======================================
Test:
=============Textual/Abt-Buy==================
accuracy=0.949
precision=0.822
recall=0.675
f1=0.741
======================================
=====sanity check======
words: COL name VAL applecare protection plan for ipod touch or ipod classic mb591lla COL description VAL applecare protection plan for ipod touch or ipod classic mb591lla extends your service coverage to up to two years includes both phone and in store techinical support COL price VAL 59.0  [SEP] COL name VAL apple ipod touch 32gb flash portable media player mb533ll/a COL description VAL audio player , video player , photo viewer 3.5 ' color lcd 32gb flash memory COL price VAL 394.99 
x: [    0 18047   766 27445 15162  6350  2591   563    13 36180  1630  2842
    50 36180  1630  4187   475   428 40284  5104 14857  8194 27445 15162
  6350  2591   563    13 36180  1630  2842    50 36180  1630  4187   475
   428 40284  5104 14269   110   544  1953     7    62     7    80   107
  1171   258  1028     8    11  1400  2903 44839   323 14857   425 27445
  5169     4   288  1437     2     2 18047   766 27445 15162 36180  1630
  2842  2107 19562  7462 15295   433   869   475   428 38037   890    73
   102 14857  8194 27445  6086   869  2156   569   869  2156  1345 18754
   155     4   245   128  3195   784 28690  2107 19562  7462  3783 14857
   425 27445  3191   306     4  2831  1437     2]
tokens: ['<s>', 'COL', 'Ġname', 'ĠVAL', 'Ġapple', 'care', 'Ġprotection', 'Ġplan', 'Ġfor', 'Ġip', 'od', 'Ġtouch', 'Ġor', 'Ġip', 'od', 'Ġclassic', 'Ġm', 'b', '591', 'lla', 'ĠCOL', 'Ġdescription', 'ĠVAL', 'Ġapple', 'care', 'Ġprotection', 'Ġplan', 'Ġfor', 'Ġip', 'od', 'Ġtouch', 'Ġor', 'Ġip', 'od', 'Ġclassic', 'Ġm', 'b', '591', 'lla', 'Ġextends', 'Ġyour', 'Ġservice', 'Ġcoverage', 'Ġto', 'Ġup', 'Ġto', 'Ġtwo', 'Ġyears', 'Ġincludes', 'Ġboth', 'Ġphone', 'Ġand', 'Ġin', 'Ġstore', 'Ġtech', 'inical', 'Ġsupport', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ59', '.', '0', 'Ġ', '</s>', '</s>', 'COL', 'Ġname', 'ĠVAL', 'Ġapple', 'Ġip', 'od', 'Ġtouch', 'Ġ32', 'gb', 'Ġflash', 'Ġportable', 'Ġmedia', 'Ġplayer', 'Ġm', 'b', '533', 'll', '/', 'a', 'ĠCOL', 'Ġdescription', 'ĠVAL', 'Ġaudio', 'Ġplayer', 'Ġ,', 'Ġvideo', 'Ġplayer', 'Ġ,', 'Ġphoto', 'Ġviewer', 'Ġ3', '.', '5', "Ġ'", 'Ġcolor', 'Ġl', 'cd', 'Ġ32', 'gb', 'Ġflash', 'Ġmemory', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ39', '4', '.', '99', 'Ġ', '</s>']
is_heads: [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
y: 0
tags: 0
mask: tensor([1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1])
seqlen: 116
task_name: Textual/Abt-Buy
=======================
step: 0, task: Textual/Abt-Buy, loss: 0.025616798549890518
step: 10, task: Textual/Abt-Buy, loss: 0.34747064113616943
step: 20, task: Textual/Abt-Buy, loss: 0.017530784010887146
step: 30, task: Textual/Abt-Buy, loss: 0.10485456138849258
step: 40, task: Textual/Abt-Buy, loss: 0.020811021327972412
step: 50, task: Textual/Abt-Buy, loss: 0.0028883889317512512
step: 60, task: Textual/Abt-Buy, loss: 0.024835236370563507
step: 70, task: Textual/Abt-Buy, loss: 0.00976986438035965
step: 80, task: Textual/Abt-Buy, loss: 0.05387648195028305
step: 90, task: Textual/Abt-Buy, loss: 0.008044853806495667
step: 100, task: Textual/Abt-Buy, loss: 0.034933172166347504
step: 110, task: Textual/Abt-Buy, loss: 0.022584620863199234
step: 120, task: Textual/Abt-Buy, loss: 0.06441861391067505
step: 130, task: Textual/Abt-Buy, loss: 0.004561081528663635
step: 140, task: Textual/Abt-Buy, loss: 0.03244625777006149
step: 150, task: Textual/Abt-Buy, loss: 0.024926215410232544
step: 160, task: Textual/Abt-Buy, loss: 0.004802674055099487
step: 170, task: Textual/Abt-Buy, loss: 0.15560215711593628
step: 180, task: Textual/Abt-Buy, loss: 0.0030608177185058594
step: 190, task: Textual/Abt-Buy, loss: 0.005847569555044174
step: 200, task: Textual/Abt-Buy, loss: 0.022712189704179764
step: 210, task: Textual/Abt-Buy, loss: 0.002495996654033661
step: 220, task: Textual/Abt-Buy, loss: 0.02265775576233864
step: 230, task: Textual/Abt-Buy, loss: 0.09540389478206635
step: 240, task: Textual/Abt-Buy, loss: 0.5024479031562805
step: 250, task: Textual/Abt-Buy, loss: 0.029813993722200394
step: 260, task: Textual/Abt-Buy, loss: 0.12114326655864716
step: 270, task: Textual/Abt-Buy, loss: 0.011727951467037201
step: 280, task: Textual/Abt-Buy, loss: 0.14246946573257446
step: 290, task: Textual/Abt-Buy, loss: 0.025929491966962814
step: 300, task: Textual/Abt-Buy, loss: 0.005881071090698242
step: 310, task: Textual/Abt-Buy, loss: 0.002330273389816284
step: 320, task: Textual/Abt-Buy, loss: 0.011804930865764618
step: 330, task: Textual/Abt-Buy, loss: 0.012121669948101044
step: 340, task: Textual/Abt-Buy, loss: 0.006596319377422333
step: 350, task: Textual/Abt-Buy, loss: 0.05669914931058884
=========eval at epoch=4=========
Validation:
=============Textual/Abt-Buy==================
accuracy=0.935
precision=0.840
recall=0.485
f1=0.615
======================================
Test:
=============Textual/Abt-Buy==================
accuracy=0.945
precision=0.874
recall=0.573
f1=0.692
======================================
=====sanity check======
words: COL name VAL kenwood 6-disc cd changer kdcc669 COL description VAL kenwood 6-disc cd changer kdcc669 3-angle mounting cd , cd-r and cd-rw playback anti-vibration disc transport compatible with all kenwood units with changer control COL price VAL 129.0  [SEP] COL name VAL denon dcm-390 5 disc cd changer dcm390 COL description VAL  COL price VAL 348.0 
x: [    0 18047   766 27445   449   225  1845   231    12 18909 45584 24622
   254   449   417  7309 36400 14857  8194 27445   449   225  1845   231
    12 18909 45584 24622   254   449   417  7309 36400   155    12 14982
 12033 45584  2156 45584    12   338     8 45584    12 43926 20083  1475
    12   705  1452  8475  9553  4240 16632    19    70   449   225  1845
  2833    19 24622   254   797 14857   425 27445 21234     4   288  1437
     2     2 18047   766 27445  3069   261   385 13753    12 27873   195
  9553 45584 24622   254   385 13753 27873 14857  8194 27445  1437 14857
   425 27445 41097     4   288  1437     2]
tokens: ['<s>', 'COL', 'Ġname', 'ĠVAL', 'Ġk', 'en', 'wood', 'Ġ6', '-', 'disc', 'Ġcd', 'Ġchang', 'er', 'Ġk', 'd', 'cc', '669', 'ĠCOL', 'Ġdescription', 'ĠVAL', 'Ġk', 'en', 'wood', 'Ġ6', '-', 'disc', 'Ġcd', 'Ġchang', 'er', 'Ġk', 'd', 'cc', '669', 'Ġ3', '-', 'angle', 'Ġmounting', 'Ġcd', 'Ġ,', 'Ġcd', '-', 'r', 'Ġand', 'Ġcd', '-', 'rw', 'Ġplayback', 'Ġanti', '-', 'v', 'ib', 'ration', 'Ġdisc', 'Ġtransport', 'Ġcompatible', 'Ġwith', 'Ġall', 'Ġk', 'en', 'wood', 'Ġunits', 'Ġwith', 'Ġchang', 'er', 'Ġcontrol', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ129', '.', '0', 'Ġ', '</s>', '</s>', 'COL', 'Ġname', 'ĠVAL', 'Ġden', 'on', 'Ġd', 'cm', '-', '390', 'Ġ5', 'Ġdisc', 'Ġcd', 'Ġchang', 'er', 'Ġd', 'cm', '390', 'ĠCOL', 'Ġdescription', 'ĠVAL', 'Ġ', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ348', '.', '0', 'Ġ', '</s>']
is_heads: [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
y: 0
tags: 0
mask: tensor([1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1])
seqlen: 103
task_name: Textual/Abt-Buy
=======================
step: 0, task: Textual/Abt-Buy, loss: 0.0046414583921432495
step: 10, task: Textual/Abt-Buy, loss: 0.008641213178634644
step: 20, task: Textual/Abt-Buy, loss: 0.009278148412704468
step: 30, task: Textual/Abt-Buy, loss: 0.005955934524536133
step: 40, task: Textual/Abt-Buy, loss: 0.03367762640118599
step: 50, task: Textual/Abt-Buy, loss: 0.0010846853256225586
step: 60, task: Textual/Abt-Buy, loss: 0.013924241065979004
step: 70, task: Textual/Abt-Buy, loss: 0.04528571665287018
step: 80, task: Textual/Abt-Buy, loss: 0.004608225077390671
step: 90, task: Textual/Abt-Buy, loss: 0.004849724471569061
step: 100, task: Textual/Abt-Buy, loss: 0.03983317315578461
step: 110, task: Textual/Abt-Buy, loss: 0.008229192346334457
step: 120, task: Textual/Abt-Buy, loss: 0.38577789068222046
step: 130, task: Textual/Abt-Buy, loss: 0.00335703045129776
step: 140, task: Textual/Abt-Buy, loss: 0.011977508664131165
step: 150, task: Textual/Abt-Buy, loss: 0.010696832090616226
step: 160, task: Textual/Abt-Buy, loss: 0.005661938339471817
step: 170, task: Textual/Abt-Buy, loss: 0.020065024495124817
step: 180, task: Textual/Abt-Buy, loss: 0.029181376099586487
step: 190, task: Textual/Abt-Buy, loss: 0.06529808044433594
step: 200, task: Textual/Abt-Buy, loss: 0.008279778063297272
step: 210, task: Textual/Abt-Buy, loss: 0.0034137293696403503
step: 220, task: Textual/Abt-Buy, loss: 0.002461060881614685
step: 230, task: Textual/Abt-Buy, loss: 0.01132245734333992
step: 240, task: Textual/Abt-Buy, loss: 0.005383163690567017
step: 250, task: Textual/Abt-Buy, loss: 0.0022841617465019226
step: 260, task: Textual/Abt-Buy, loss: 0.02679535374045372
step: 270, task: Textual/Abt-Buy, loss: 0.005480334162712097
step: 280, task: Textual/Abt-Buy, loss: 0.14976011216640472
step: 290, task: Textual/Abt-Buy, loss: 0.012376435101032257
step: 300, task: Textual/Abt-Buy, loss: 0.039060432463884354
step: 310, task: Textual/Abt-Buy, loss: 0.03327690809965134
step: 320, task: Textual/Abt-Buy, loss: 0.005626339465379715
step: 330, task: Textual/Abt-Buy, loss: 0.011476315557956696
step: 340, task: Textual/Abt-Buy, loss: 0.015655841678380966
step: 350, task: Textual/Abt-Buy, loss: 0.07832115143537521
=========eval at epoch=5=========
Validation:
=============Textual/Abt-Buy==================
accuracy=0.938
precision=0.885
recall=0.485
f1=0.627
======================================
Test:
=============Textual/Abt-Buy==================
accuracy=0.946
precision=0.870
recall=0.583
f1=0.698
======================================
=====sanity check======
words: COL name VAL nikon coolpix s550 10 megapixel black digital camera coolpixs550gb COL description VAL nikon coolpix s550 10 megapixel black digital camera coolpixs550gb 10.0 megapixels 5x optical zoom nikkor glass lens electronic vr image stabilization bright 2.5 ' high resolution lcd in-camera red-eye fix face-priority af d-lighting graphite black finish COL price VAL   [SEP] COL name VAL nikon en-el3e lithium ion digital camera battery 25334 COL description VAL nikon en-el3e rechargeable li-ion battery COL price VAL 34.24 
x: [    0 18047   766 27445   295   967   261  3035   642  3181   579 17953
   158 10721 21424   909  1778  2280  3035   642  3181    29 17953 19562
 14857  8194 27445   295   967   261  3035   642  3181   579 17953   158
 10721 21424   909  1778  2280  3035   642  3181    29 17953 19562   158
     4   288 10721  1115 41699   195  1178 17547 21762   295 21609   368
  4049 10373  5175   748   338  2274 29632  4520   132     4   245   128
   239  3547   784 28690    11    12 25092  1275    12 20668  4190   652
    12 41565  9724   385    12 30181 20992  1459   909  2073 14857   425
 27445  1437  1437     2     2 18047   766 27445   295   967   261  1177
    12   523   246   242 16904 31973  1778  2280  3822   564 33325 14857
  8194 27445   295   967   261  1177    12   523   246   242 25850   868
 16787    12  1499  3822 14857   425 27445  2631     4  1978  1437     2]
tokens: ['<s>', 'COL', 'Ġname', 'ĠVAL', 'Ġn', 'ik', 'on', 'Ġcool', 'p', 'ix', 'Ġs', '550', 'Ġ10', 'Ġmeg', 'apixel', 'Ġblack', 'Ġdigital', 'Ġcamera', 'Ġcool', 'p', 'ix', 's', '550', 'gb', 'ĠCOL', 'Ġdescription', 'ĠVAL', 'Ġn', 'ik', 'on', 'Ġcool', 'p', 'ix', 'Ġs', '550', 'Ġ10', 'Ġmeg', 'apixel', 'Ġblack', 'Ġdigital', 'Ġcamera', 'Ġcool', 'p', 'ix', 's', '550', 'gb', 'Ġ10', '.', '0', 'Ġmeg', 'ap', 'ixels', 'Ġ5', 'x', 'Ġoptical', 'Ġzoom', 'Ġn', 'ikk', 'or', 'Ġglass', 'Ġlens', 'Ġelectronic', 'Ġv', 'r', 'Ġimage', 'Ġstabilization', 'Ġbright', 'Ġ2', '.', '5', "Ġ'", 'Ġhigh', 'Ġresolution', 'Ġl', 'cd', 'Ġin', '-', 'camera', 'Ġred', '-', 'eye', 'Ġfix', 'Ġface', '-', 'priority', 'Ġaf', 'Ġd', '-', 'lighting', 'Ġgraph', 'ite', 'Ġblack', 'Ġfinish', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ', 'Ġ', '</s>', '</s>', 'COL', 'Ġname', 'ĠVAL', 'Ġn', 'ik', 'on', 'Ġen', '-', 'el', '3', 'e', 'Ġlithium', 'Ġion', 'Ġdigital', 'Ġcamera', 'Ġbattery', 'Ġ25', '334', 'ĠCOL', 'Ġdescription', 'ĠVAL', 'Ġn', 'ik', 'on', 'Ġen', '-', 'el', '3', 'e', 'Ġrecharge', 'able', 'Ġli', '-', 'ion', 'Ġbattery', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ34', '.', '24', 'Ġ', '</s>']
is_heads: [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
y: 0
tags: 0
mask: tensor([1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1])
seqlen: 144
task_name: Textual/Abt-Buy
=======================
step: 0, task: Textual/Abt-Buy, loss: 0.0007282644510269165
step: 10, task: Textual/Abt-Buy, loss: 0.09881353378295898
step: 20, task: Textual/Abt-Buy, loss: 0.003492973744869232
step: 30, task: Textual/Abt-Buy, loss: 0.09522798657417297
step: 40, task: Textual/Abt-Buy, loss: 0.03210834413766861
step: 50, task: Textual/Abt-Buy, loss: 0.04190463200211525
step: 60, task: Textual/Abt-Buy, loss: 0.04161462187767029
step: 70, task: Textual/Abt-Buy, loss: 0.010523594915866852
step: 80, task: Textual/Abt-Buy, loss: 0.012439727783203125
step: 90, task: Textual/Abt-Buy, loss: 0.03040044754743576
step: 100, task: Textual/Abt-Buy, loss: 0.014002237468957901
step: 110, task: Textual/Abt-Buy, loss: 0.006404530256986618
step: 120, task: Textual/Abt-Buy, loss: 0.12691904604434967
step: 130, task: Textual/Abt-Buy, loss: 0.05915822088718414
step: 140, task: Textual/Abt-Buy, loss: 0.09540503472089767
step: 150, task: Textual/Abt-Buy, loss: 0.005493484437465668
step: 160, task: Textual/Abt-Buy, loss: 0.03871919587254524
step: 170, task: Textual/Abt-Buy, loss: 0.018459942191839218
step: 180, task: Textual/Abt-Buy, loss: 0.045076679438352585
step: 190, task: Textual/Abt-Buy, loss: 0.09562736749649048
step: 200, task: Textual/Abt-Buy, loss: 0.0036542341113090515
step: 210, task: Textual/Abt-Buy, loss: 0.0058164820075035095
step: 220, task: Textual/Abt-Buy, loss: 0.038113147020339966
step: 230, task: Textual/Abt-Buy, loss: 0.13791589438915253
step: 240, task: Textual/Abt-Buy, loss: 0.046856869012117386
step: 250, task: Textual/Abt-Buy, loss: 0.07551957666873932
step: 260, task: Textual/Abt-Buy, loss: 0.02058957889676094
step: 270, task: Textual/Abt-Buy, loss: 0.011952675879001617
step: 280, task: Textual/Abt-Buy, loss: 0.03214310109615326
step: 290, task: Textual/Abt-Buy, loss: 0.004982694983482361
step: 300, task: Textual/Abt-Buy, loss: 0.09404034167528152
step: 310, task: Textual/Abt-Buy, loss: 0.0271158367395401
step: 320, task: Textual/Abt-Buy, loss: 0.014740906655788422
step: 330, task: Textual/Abt-Buy, loss: 0.19580672681331635
step: 340, task: Textual/Abt-Buy, loss: 0.0008684247732162476
step: 350, task: Textual/Abt-Buy, loss: 0.017384134232997894
=========eval at epoch=6=========
Validation:
=============Textual/Abt-Buy==================
accuracy=0.942
precision=0.892
recall=0.519
f1=0.656
======================================
Test:
=============Textual/Abt-Buy==================
accuracy=0.946
precision=0.871
recall=0.587
f1=0.701
======================================
=====sanity check======
words: COL name VAL sony ms-a1gd 1gb memory stick micro ( m2 ) msa1gd COL description VAL sony ms-a1gd 1gb memory stick micro ( m2 ) msa1gd 1gb storage capacity with 900mb available minimum write speeds of 15 mbps on memory stick micro enabled devices COL price VAL   [SEP] COL name VAL sony 2gb memory stick micro ( m2 ) msa2gd COL description VAL 2 gb COL price VAL  
x: [    0 18047   766 27445   579  6119 43601    12   102   134 27122   112
 19562  3783  4757  5177    36   475   176  4839   475 11146   134 27122
 14857  8194 27445   579  6119 43601    12   102   134 27122   112 19562
  3783  4757  5177    36   475   176  4839   475 11146   134 27122   112
 19562  3521  2148    19 10742  6648   577  3527  3116  9706     9   379
   475 27072    15  3783  4757  5177  9778  2110 14857   425 27445  1437
  1437     2     2 18047   766 27445   579  6119   132 19562  3783  4757
  5177    36   475   176  4839   475 11146   176 27122 14857  8194 27445
   132   821   428 14857   425 27445  1437  1437     2]
tokens: ['<s>', 'COL', 'Ġname', 'ĠVAL', 'Ġs', 'ony', 'Ġms', '-', 'a', '1', 'gd', 'Ġ1', 'gb', 'Ġmemory', 'Ġstick', 'Ġmicro', 'Ġ(', 'Ġm', '2', 'Ġ)', 'Ġm', 'sa', '1', 'gd', 'ĠCOL', 'Ġdescription', 'ĠVAL', 'Ġs', 'ony', 'Ġms', '-', 'a', '1', 'gd', 'Ġ1', 'gb', 'Ġmemory', 'Ġstick', 'Ġmicro', 'Ġ(', 'Ġm', '2', 'Ġ)', 'Ġm', 'sa', '1', 'gd', 'Ġ1', 'gb', 'Ġstorage', 'Ġcapacity', 'Ġwith', 'Ġ900', 'mb', 'Ġavailable', 'Ġminimum', 'Ġwrite', 'Ġspeeds', 'Ġof', 'Ġ15', 'Ġm', 'bps', 'Ġon', 'Ġmemory', 'Ġstick', 'Ġmicro', 'Ġenabled', 'Ġdevices', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ', 'Ġ', '</s>', '</s>', 'COL', 'Ġname', 'ĠVAL', 'Ġs', 'ony', 'Ġ2', 'gb', 'Ġmemory', 'Ġstick', 'Ġmicro', 'Ġ(', 'Ġm', '2', 'Ġ)', 'Ġm', 'sa', '2', 'gd', 'ĠCOL', 'Ġdescription', 'ĠVAL', 'Ġ2', 'Ġg', 'b', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ', 'Ġ', '</s>']
is_heads: [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
y: 0
tags: 0
mask: tensor([1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1])
seqlen: 105
task_name: Textual/Abt-Buy
=======================
step: 0, task: Textual/Abt-Buy, loss: 0.008266247808933258
step: 10, task: Textual/Abt-Buy, loss: 0.01031871885061264
step: 20, task: Textual/Abt-Buy, loss: 0.005040496587753296
step: 30, task: Textual/Abt-Buy, loss: 0.1399405151605606
step: 40, task: Textual/Abt-Buy, loss: 0.0033793896436691284
step: 50, task: Textual/Abt-Buy, loss: 0.013880368322134018
step: 60, task: Textual/Abt-Buy, loss: 0.0037993192672729492
step: 70, task: Textual/Abt-Buy, loss: 0.013599719852209091
step: 80, task: Textual/Abt-Buy, loss: 0.006495170295238495
step: 90, task: Textual/Abt-Buy, loss: 0.047190722078084946
step: 100, task: Textual/Abt-Buy, loss: 0.0032162293791770935
step: 110, task: Textual/Abt-Buy, loss: 0.004521042108535767
step: 120, task: Textual/Abt-Buy, loss: 0.018541298806667328
step: 130, task: Textual/Abt-Buy, loss: 0.2522898316383362
step: 140, task: Textual/Abt-Buy, loss: 0.006072815507650375
step: 150, task: Textual/Abt-Buy, loss: 0.2193056046962738
step: 160, task: Textual/Abt-Buy, loss: 0.02871812880039215
step: 170, task: Textual/Abt-Buy, loss: 0.02912857010960579
step: 180, task: Textual/Abt-Buy, loss: 0.00456913560628891
step: 190, task: Textual/Abt-Buy, loss: 0.04900728538632393
step: 200, task: Textual/Abt-Buy, loss: 0.060812149196863174
step: 210, task: Textual/Abt-Buy, loss: 0.013047777116298676
step: 220, task: Textual/Abt-Buy, loss: 0.07581135630607605
step: 230, task: Textual/Abt-Buy, loss: 0.05167486518621445
step: 240, task: Textual/Abt-Buy, loss: 0.2204645425081253
step: 250, task: Textual/Abt-Buy, loss: 0.032054297626018524
step: 260, task: Textual/Abt-Buy, loss: 0.006112195551395416
step: 270, task: Textual/Abt-Buy, loss: 0.08049149066209793
step: 280, task: Textual/Abt-Buy, loss: 0.004717975854873657
step: 290, task: Textual/Abt-Buy, loss: 0.027916960418224335
step: 300, task: Textual/Abt-Buy, loss: 0.006458453834056854
step: 310, task: Textual/Abt-Buy, loss: 0.006070688366889954
step: 320, task: Textual/Abt-Buy, loss: 0.018056944012641907
step: 330, task: Textual/Abt-Buy, loss: 0.07531718909740448
step: 340, task: Textual/Abt-Buy, loss: 0.02533964440226555
step: 350, task: Textual/Abt-Buy, loss: 0.1408909410238266
=========eval at epoch=7=========
Validation:
=============Textual/Abt-Buy==================
accuracy=0.944
precision=0.916
recall=0.529
f1=0.671
======================================
Test:
=============Textual/Abt-Buy==================
accuracy=0.944
precision=0.867
recall=0.568
f1=0.686
======================================
=====sanity check======
words: COL name VAL panasonic viera 42 ' plasma flat panel hdtv in black th42px80u COL description VAL panasonic viera 42 ' plasma flat panel hdtv in black th42px80u 720p display 1024 x 768 native resolution color purity optimizer surround sound anti-reflective filter viera link hdavi control built-in ntsc/atsc/qam tuners 3 hdmi inputs built-in galleryplayer capable sd card memory slot pedestal stand included black finish COL price VAL   [SEP] COL name VAL panasonic viera th-50pz850u 50 ' plasma tv COL description VAL 50 ' atsc , ntsc 16:9 1920 x 1080 hdtv COL price VAL 2096.99 
x: [    0 18047   766 27445  5730 38703   748 16432  3330   128 29051  3269
  2798  1368   417 18724    11   909  3553  3714 38740  2940   257 14857
  8194 27445  5730 38703   748 16432  3330   128 29051  3269  2798  1368
   417 18724    11   909  3553  3714 38740  2940   257 26180   642  2332
 46959  3023 43751  3763  3547  3195 32195 17775  6315 21104  2369  1475
    12 39878  2088 14929   748 16432  3104  1368   417 11132   797  1490
    12   179   295  1872   438    73  2923   438    73  1343   424 27115
   268   155  1368   417  5408 16584  1490    12   179  7294 23233  4453
 46409  1886  3783  8534 38238   337  1413  1165   909  2073 14857   425
 27445  1437  1437     2     2 18047   766 27445  5730 38703   748 16432
  3553    12  1096   642   329 19270   257   654   128 29051 30016 14857
  8194 27445   654   128    23  3866  2156   295  1872   438   545    35
   466 18283  3023 21083  1368   417 18724 14857   425 27445   291  5607
     4  2831  1437     2]
tokens: ['<s>', 'COL', 'Ġname', 'ĠVAL', 'Ġpan', 'asonic', 'Ġv', 'iera', 'Ġ42', "Ġ'", 'Ġplasma', 'Ġflat', 'Ġpanel', 'Ġh', 'd', 'tv', 'Ġin', 'Ġblack', 'Ġth', '42', 'px', '80', 'u', 'ĠCOL', 'Ġdescription', 'ĠVAL', 'Ġpan', 'asonic', 'Ġv', 'iera', 'Ġ42', "Ġ'", 'Ġplasma', 'Ġflat', 'Ġpanel', 'Ġh', 'd', 'tv', 'Ġin', 'Ġblack', 'Ġth', '42', 'px', '80', 'u', 'Ġ720', 'p', 'Ġdisplay', 'Ġ1024', 'Ġx', 'Ġ768', 'Ġnative', 'Ġresolution', 'Ġcolor', 'Ġpurity', 'Ġoptim', 'izer', 'Ġsurround', 'Ġsound', 'Ġanti', '-', 'reflect', 'ive', 'Ġfilter', 'Ġv', 'iera', 'Ġlink', 'Ġh', 'd', 'avi', 'Ġcontrol', 'Ġbuilt', '-', 'in', 'Ġn', 'ts', 'c', '/', 'ats', 'c', '/', 'q', 'am', 'Ġtun', 'ers', 'Ġ3', 'Ġh', 'd', 'mi', 'Ġinputs', 'Ġbuilt', '-', 'in', 'Ġgallery', 'player', 'Ġcapable', 'Ġsd', 'Ġcard', 'Ġmemory', 'Ġslot', 'Ġpedest', 'al', 'Ġstand', 'Ġincluded', 'Ġblack', 'Ġfinish', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ', 'Ġ', '</s>', '</s>', 'COL', 'Ġname', 'ĠVAL', 'Ġpan', 'asonic', 'Ġv', 'iera', 'Ġth', '-', '50', 'p', 'z', '850', 'u', 'Ġ50', "Ġ'", 'Ġplasma', 'Ġtv', 'ĠCOL', 'Ġdescription', 'ĠVAL', 'Ġ50', "Ġ'", 'Ġat', 'sc', 'Ġ,', 'Ġn', 'ts', 'c', 'Ġ16', ':', '9', 'Ġ1920', 'Ġx', 'Ġ1080', 'Ġh', 'd', 'tv', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ20', '96', '.', '99', 'Ġ', '</s>']
is_heads: [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
y: 0
tags: 0
mask: tensor([1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1])
seqlen: 160
task_name: Textual/Abt-Buy
=======================
step: 0, task: Textual/Abt-Buy, loss: 0.02663559839129448
step: 10, task: Textual/Abt-Buy, loss: 0.00843813270330429
step: 20, task: Textual/Abt-Buy, loss: 0.10847041010856628
step: 30, task: Textual/Abt-Buy, loss: 0.005815334618091583
step: 40, task: Textual/Abt-Buy, loss: 0.006186164915561676
step: 50, task: Textual/Abt-Buy, loss: 0.03557686135172844
step: 60, task: Textual/Abt-Buy, loss: 0.007695302367210388
step: 70, task: Textual/Abt-Buy, loss: 0.05207880958914757
step: 80, task: Textual/Abt-Buy, loss: 0.1286253035068512
step: 90, task: Textual/Abt-Buy, loss: 0.0377684012055397
step: 100, task: Textual/Abt-Buy, loss: 0.02998529002070427
step: 110, task: Textual/Abt-Buy, loss: 0.15943224728107452
step: 120, task: Textual/Abt-Buy, loss: 0.0015547871589660645
step: 130, task: Textual/Abt-Buy, loss: 0.03342725336551666
step: 140, task: Textual/Abt-Buy, loss: 0.032225221395492554
step: 150, task: Textual/Abt-Buy, loss: 0.10275658965110779
step: 160, task: Textual/Abt-Buy, loss: 0.06677137315273285
step: 170, task: Textual/Abt-Buy, loss: 0.008600518107414246
step: 180, task: Textual/Abt-Buy, loss: 0.0029862448573112488
step: 190, task: Textual/Abt-Buy, loss: 0.02863946184515953
step: 200, task: Textual/Abt-Buy, loss: 0.005880169570446014
step: 210, task: Textual/Abt-Buy, loss: 0.2911386489868164
step: 220, task: Textual/Abt-Buy, loss: 0.05092642083764076
step: 230, task: Textual/Abt-Buy, loss: 0.043490126729011536
step: 240, task: Textual/Abt-Buy, loss: 0.012177161872386932
step: 250, task: Textual/Abt-Buy, loss: 0.004434302449226379
step: 260, task: Textual/Abt-Buy, loss: 0.03781057894229889
step: 270, task: Textual/Abt-Buy, loss: 0.013235148042440414
step: 280, task: Textual/Abt-Buy, loss: 0.10068379342556
step: 290, task: Textual/Abt-Buy, loss: 0.008017241954803467
step: 300, task: Textual/Abt-Buy, loss: 0.10995655506849289
step: 310, task: Textual/Abt-Buy, loss: 0.008993469178676605
step: 320, task: Textual/Abt-Buy, loss: 0.01704389601945877
Gradient overflow.  Skipping step, loss scaler 0 reducing loss scale to 8192.0
step: 330, task: Textual/Abt-Buy, loss: 0.004766128957271576
step: 340, task: Textual/Abt-Buy, loss: 0.03225547447800636
step: 350, task: Textual/Abt-Buy, loss: 0.10848119854927063
=========eval at epoch=8=========
Validation:
=============Textual/Abt-Buy==================
accuracy=0.938
precision=0.872
recall=0.495
f1=0.632
======================================
Test:
=============Textual/Abt-Buy==================
accuracy=0.945
precision=0.852
recall=0.587
f1=0.695
======================================
Selected optimization level O2:  FP16 training with FP32 batchnorm and FP32 master weights.

Defaults for this optimization level are:
enabled                : True
opt_level              : O2
cast_model_type        : torch.float16
patch_torch_functions  : False
keep_batchnorm_fp32    : True
master_weights         : True
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O2
cast_model_type        : torch.float16
patch_torch_functions  : False
keep_batchnorm_fp32    : True
master_weights         : True
loss_scale             : dynamic
Warning:  multi_tensor_applier fused unscale kernel is unavailable, possibly because apex was installed without --cuda_ext --cpp_ext. Using Python fallback.  Original ImportError was: ModuleNotFoundError("No module named 'amp_C'")
Gradient overflow.  Skipping step, loss scaler 0 reducing loss scale to 32768.0
=====sanity check======
words: COL name VAL canon battery charger 1133b001 COL description VAL canon battery charger 1133b001 compatible with canon nb-5l lithium battery black finish COL price VAL   [SEP] COL name VAL canon cb-2lv battery charger 9764a001 COL description VAL for nb-4l COL price VAL  
x: [    0 18047   766 27445 32839  3822 27362   365  3103   428 19089 14857
  8194 27445 32839  3822 27362   365  3103   428 19089 16632    19 32839
   295   428    12   245   462 16904  3822   909  2073 14857   425 27445
  1437  1437     2     2 18047   766 27445 32839   740   428    12   176
 25091  3822 27362  8783  4027   102 19089 14857  8194 27445    13   295
   428    12   306   462 14857   425 27445  1437  1437     2]
tokens: ['<s>', 'COL', 'Ġname', 'ĠVAL', 'Ġcanon', 'Ġbattery', 'Ġcharger', 'Ġ11', '33', 'b', '001', 'ĠCOL', 'Ġdescription', 'ĠVAL', 'Ġcanon', 'Ġbattery', 'Ġcharger', 'Ġ11', '33', 'b', '001', 'Ġcompatible', 'Ġwith', 'Ġcanon', 'Ġn', 'b', '-', '5', 'l', 'Ġlithium', 'Ġbattery', 'Ġblack', 'Ġfinish', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ', 'Ġ', '</s>', '</s>', 'COL', 'Ġname', 'ĠVAL', 'Ġcanon', 'Ġc', 'b', '-', '2', 'lv', 'Ġbattery', 'Ġcharger', 'Ġ97', '64', 'a', '001', 'ĠCOL', 'Ġdescription', 'ĠVAL', 'Ġfor', 'Ġn', 'b', '-', '4', 'l', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ', 'Ġ', '</s>']
is_heads: [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
y: 0
tags: 0
mask: tensor([1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1])
seqlen: 70
task_name: Textual/Abt-Buy
=======================
step: 0, task: Textual/Abt-Buy, loss: 0.6514257788658142
Gradient overflow.  Skipping step, loss scaler 0 reducing loss scale to 16384.0
Gradient overflow.  Skipping step, loss scaler 0 reducing loss scale to 8192.0
step: 10, task: Textual/Abt-Buy, loss: 0.6867703199386597
step: 20, task: Textual/Abt-Buy, loss: 0.5914256572723389
step: 30, task: Textual/Abt-Buy, loss: 0.629870593547821
step: 40, task: Textual/Abt-Buy, loss: 0.33110177516937256
step: 50, task: Textual/Abt-Buy, loss: 0.2643034756183624
step: 60, task: Textual/Abt-Buy, loss: 0.25304698944091797
step: 70, task: Textual/Abt-Buy, loss: 0.23073209822177887
step: 80, task: Textual/Abt-Buy, loss: 0.2589789628982544
step: 90, task: Textual/Abt-Buy, loss: 0.30120229721069336
step: 100, task: Textual/Abt-Buy, loss: 0.2397060990333557
step: 110, task: Textual/Abt-Buy, loss: 0.37784987688064575
step: 120, task: Textual/Abt-Buy, loss: 0.2624812424182892
step: 130, task: Textual/Abt-Buy, loss: 0.5072963833808899
step: 140, task: Textual/Abt-Buy, loss: 0.637844443321228
step: 150, task: Textual/Abt-Buy, loss: 0.35039031505584717
step: 160, task: Textual/Abt-Buy, loss: 0.21376526355743408
step: 170, task: Textual/Abt-Buy, loss: 0.2856496274471283
step: 180, task: Textual/Abt-Buy, loss: 0.18359506130218506
step: 190, task: Textual/Abt-Buy, loss: 0.504582941532135
step: 200, task: Textual/Abt-Buy, loss: 0.2567879557609558
step: 210, task: Textual/Abt-Buy, loss: 0.3727336823940277
step: 220, task: Textual/Abt-Buy, loss: 0.4815090298652649
step: 230, task: Textual/Abt-Buy, loss: 0.23392102122306824
step: 240, task: Textual/Abt-Buy, loss: 0.7162421941757202
step: 250, task: Textual/Abt-Buy, loss: 0.42004334926605225
step: 260, task: Textual/Abt-Buy, loss: 0.26905983686447144
step: 270, task: Textual/Abt-Buy, loss: 0.3558167517185211
step: 280, task: Textual/Abt-Buy, loss: 0.541948676109314
step: 290, task: Textual/Abt-Buy, loss: 0.4450238347053528
step: 300, task: Textual/Abt-Buy, loss: 0.4507490396499634
step: 310, task: Textual/Abt-Buy, loss: 0.34494203329086304
step: 320, task: Textual/Abt-Buy, loss: 0.4483225345611572
step: 330, task: Textual/Abt-Buy, loss: 0.19542279839515686
step: 340, task: Textual/Abt-Buy, loss: 0.24054262042045593
step: 350, task: Textual/Abt-Buy, loss: 0.1927647590637207
=========eval at epoch=1=========
Validation:
=============Textual/Abt-Buy==================
accuracy=0.892
precision=0.000
recall=0.000
f1=0.000
======================================
Test:
=============Textual/Abt-Buy==================
accuracy=0.892
precision=0.000
recall=0.000
f1=0.000
======================================
/w/246/tianyu2020/miniconda2/envs/ditto/lib/python3.7/site-packages/apex/amp/_initialize.py:24: UserWarning: An input tensor was not cuda.
  warnings.warn("An input tensor was not cuda.")
/w/246/tianyu2020/miniconda2/envs/ditto/lib/python3.7/site-packages/torch/optim/lr_scheduler.py:122: UserWarning: Detected call of `lr_scheduler.step()` before `optimizer.step()`. In PyTorch 1.1.0 and later, you should call them in the opposite order: `optimizer.step()` before `lr_scheduler.step()`.  Failure to do this will result in PyTorch skipping the first value of the learning rate schedule. See more details at https://pytorch.org/docs/stable/optim.html#how-to-adjust-learning-rate
  "https://pytorch.org/docs/stable/optim.html#how-to-adjust-learning-rate", UserWarning)
/w/246/tianyu2020/miniconda2/envs/ditto/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1221: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
=====sanity check======
words: COL name VAL sony silver cyber-shot digital camera dscs750 COL description VAL sony silver cyber-shot digital camera dscs750 7.2 megapixel super had ccd 2.5 ' lcd display 3x optical zoom high sensitivity mode auto focus 22 mb internal memory face detection burst mode convenient photo modes beginner-friendly function guide silver finish COL price VAL   [SEP] COL name VAL sony dpfd80 digital photo frame COL description VAL photo viewer 8 ' lcd COL price VAL  
x: [    0 18047   766 27445   579  6119  4334  5381    12 10393  1778  2280
   385  3866    29 10569 14857  8194 27445   579  6119  4334  5381    12
 10393  1778  2280   385  3866    29 10569   262     4   176 10721 21424
  2422    56   740 28690   132     4   245   128   784 28690  2332   155
  1178 17547 21762   239 15608  5745  4485  1056   820   475   428  3425
  3783   652 12673 10084  5745 12148  1345 19180 37239    12  6928  5043
  4704  4334  2073 14857   425 27445  1437  1437     2     2 18047   766
 27445   579  6119   385   642 37379  2940  1778  1345  5120 14857  8194
 27445  1345 18754   290   128   784 28690 14857   425 27445  1437  1437
     2]
tokens: ['<s>', 'COL', 'Ġname', 'ĠVAL', 'Ġs', 'ony', 'Ġsilver', 'Ġcyber', '-', 'shot', 'Ġdigital', 'Ġcamera', 'Ġd', 'sc', 's', '750', 'ĠCOL', 'Ġdescription', 'ĠVAL', 'Ġs', 'ony', 'Ġsilver', 'Ġcyber', '-', 'shot', 'Ġdigital', 'Ġcamera', 'Ġd', 'sc', 's', '750', 'Ġ7', '.', '2', 'Ġmeg', 'apixel', 'Ġsuper', 'Ġhad', 'Ġc', 'cd', 'Ġ2', '.', '5', "Ġ'", 'Ġl', 'cd', 'Ġdisplay', 'Ġ3', 'x', 'Ġoptical', 'Ġzoom', 'Ġhigh', 'Ġsensitivity', 'Ġmode', 'Ġauto', 'Ġfocus', 'Ġ22', 'Ġm', 'b', 'Ġinternal', 'Ġmemory', 'Ġface', 'Ġdetection', 'Ġburst', 'Ġmode', 'Ġconvenient', 'Ġphoto', 'Ġmodes', 'Ġbeginner', '-', 'friendly', 'Ġfunction', 'Ġguide', 'Ġsilver', 'Ġfinish', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ', 'Ġ', '</s>', '</s>', 'COL', 'Ġname', 'ĠVAL', 'Ġs', 'ony', 'Ġd', 'p', 'fd', '80', 'Ġdigital', 'Ġphoto', 'Ġframe', 'ĠCOL', 'Ġdescription', 'ĠVAL', 'Ġphoto', 'Ġviewer', 'Ġ8', "Ġ'", 'Ġl', 'cd', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ', 'Ġ', '</s>']
is_heads: [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
y: 0
tags: 0
mask: tensor([1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1])
seqlen: 109
task_name: Textual/Abt-Buy
=======================
step: 0, task: Textual/Abt-Buy, loss: 0.35140156745910645
step: 10, task: Textual/Abt-Buy, loss: 0.4135242700576782
step: 20, task: Textual/Abt-Buy, loss: 0.2597395181655884
step: 30, task: Textual/Abt-Buy, loss: 0.1420011669397354
step: 40, task: Textual/Abt-Buy, loss: 0.4124943017959595
step: 50, task: Textual/Abt-Buy, loss: 0.15107525885105133
step: 60, task: Textual/Abt-Buy, loss: 0.3256341814994812
step: 70, task: Textual/Abt-Buy, loss: 0.42071470618247986
step: 80, task: Textual/Abt-Buy, loss: 0.6419829726219177
step: 90, task: Textual/Abt-Buy, loss: 0.2528885006904602
step: 100, task: Textual/Abt-Buy, loss: 0.1736760437488556
step: 110, task: Textual/Abt-Buy, loss: 0.1962008774280548
step: 120, task: Textual/Abt-Buy, loss: 0.4028940498828888
step: 130, task: Textual/Abt-Buy, loss: 0.31053707003593445
step: 140, task: Textual/Abt-Buy, loss: 0.14043809473514557
step: 150, task: Textual/Abt-Buy, loss: 0.013825558125972748
step: 160, task: Textual/Abt-Buy, loss: 0.09638061374425888
step: 170, task: Textual/Abt-Buy, loss: 0.5026959776878357
step: 180, task: Textual/Abt-Buy, loss: 0.14972354471683502
step: 190, task: Textual/Abt-Buy, loss: 0.035519346594810486
step: 200, task: Textual/Abt-Buy, loss: 0.007459715008735657
step: 210, task: Textual/Abt-Buy, loss: 0.03802403062582016
step: 220, task: Textual/Abt-Buy, loss: 0.014064017683267593
step: 230, task: Textual/Abt-Buy, loss: 0.013396225869655609
step: 240, task: Textual/Abt-Buy, loss: 0.350000262260437
step: 250, task: Textual/Abt-Buy, loss: 0.09534456580877304
step: 260, task: Textual/Abt-Buy, loss: 0.053236767649650574
step: 270, task: Textual/Abt-Buy, loss: 0.3490146994590759
step: 280, task: Textual/Abt-Buy, loss: 0.01542973518371582
step: 290, task: Textual/Abt-Buy, loss: 0.1127384603023529
step: 300, task: Textual/Abt-Buy, loss: 0.10735495388507843
step: 310, task: Textual/Abt-Buy, loss: 0.16881008446216583
step: 320, task: Textual/Abt-Buy, loss: 0.009229615330696106
step: 330, task: Textual/Abt-Buy, loss: 0.49680161476135254
step: 340, task: Textual/Abt-Buy, loss: 0.31512269377708435
step: 350, task: Textual/Abt-Buy, loss: 0.03228987753391266
=========eval at epoch=1=========
Validation:
=============Textual/Abt-Buy==================
accuracy=0.936
precision=0.741
recall=0.626
f1=0.679
======================================
Test:
=============Textual/Abt-Buy==================
accuracy=0.945
precision=0.801
recall=0.646
f1=0.715
======================================
=====sanity check======
words: COL name VAL sony slv-d380p black dvd vhs combo player slvd380p COL description VAL sony slv-d380p black dvd vhs combo player slvd380p line input recording component output progressive output multi-brand tv remote control cd , mp3 , and jpeg playback 4-head hi-fi stereo auto head cleaner black finish no tuner COL price VAL   [SEP] COL name VAL sony dvp-nc800h / b dvd player COL description VAL dvd + rw , dvd-rw , dvd + r , dvd-r , cd-rw dvd video , cd-da , mp3 , jpeg , svcd , video cd playback 5 disc ( s ) progressive scan black COL price VAL  
x: [    0 18047   766 27445   579  6119  3369   705    12   417 19148   642
   909   385 40311   748 15354 23358   869  3369 40311 19148   642 14857
  8194 27445   579  6119  3369   705    12   417 19148   642   909   385
 40311   748 15354 23358   869  3369 40311 19148   642   516  8135  5492
  7681  4195  8212  4195  3228    12 11638 30016  6063   797 45584  2156
 44857   246  2156     8  1236 41191 20083   204    12  3628 20280    12
  9169 31436  4485   471 16126   909  2073   117 27115   254 14857   425
 27445  1437  1437     2     2 18047   766 27445   579  6119   385 45883
    12 11326  3913   298  1589   741   385 40311   869 14857  8194 27445
   385 40311  2055   910   605  2156   385 40311    12 43926  2156   385
 40311  2055   910  2156   385 40311    12   338  2156 45584    12 43926
   385 40311   569  2156 45584    12  6106  2156 44857   246  2156  1236
 41191  2156 23119 28690  2156   569 45584 20083   195  9553    36   579
  4839  8212 14194   909 14857   425 27445  1437  1437     2]
tokens: ['<s>', 'COL', 'Ġname', 'ĠVAL', 'Ġs', 'ony', 'Ġsl', 'v', '-', 'd', '380', 'p', 'Ġblack', 'Ġd', 'vd', 'Ġv', 'hs', 'Ġcombo', 'Ġplayer', 'Ġsl', 'vd', '380', 'p', 'ĠCOL', 'Ġdescription', 'ĠVAL', 'Ġs', 'ony', 'Ġsl', 'v', '-', 'd', '380', 'p', 'Ġblack', 'Ġd', 'vd', 'Ġv', 'hs', 'Ġcombo', 'Ġplayer', 'Ġsl', 'vd', '380', 'p', 'Ġline', 'Ġinput', 'Ġrecording', 'Ġcomponent', 'Ġoutput', 'Ġprogressive', 'Ġoutput', 'Ġmulti', '-', 'brand', 'Ġtv', 'Ġremote', 'Ġcontrol', 'Ġcd', 'Ġ,', 'Ġmp', '3', 'Ġ,', 'Ġand', 'Ġj', 'peg', 'Ġplayback', 'Ġ4', '-', 'head', 'Ġhi', '-', 'fi', 'Ġstereo', 'Ġauto', 'Ġhead', 'Ġcleaner', 'Ġblack', 'Ġfinish', 'Ġno', 'Ġtun', 'er', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ', 'Ġ', '</s>', '</s>', 'COL', 'Ġname', 'ĠVAL', 'Ġs', 'ony', 'Ġd', 'vp', '-', 'nc', '800', 'h', 'Ġ/', 'Ġb', 'Ġd', 'vd', 'Ġplayer', 'ĠCOL', 'Ġdescription', 'ĠVAL', 'Ġd', 'vd', 'Ġ+', 'Ġr', 'w', 'Ġ,', 'Ġd', 'vd', '-', 'rw', 'Ġ,', 'Ġd', 'vd', 'Ġ+', 'Ġr', 'Ġ,', 'Ġd', 'vd', '-', 'r', 'Ġ,', 'Ġcd', '-', 'rw', 'Ġd', 'vd', 'Ġvideo', 'Ġ,', 'Ġcd', '-', 'da', 'Ġ,', 'Ġmp', '3', 'Ġ,', 'Ġj', 'peg', 'Ġ,', 'Ġsv', 'cd', 'Ġ,', 'Ġvideo', 'Ġcd', 'Ġplayback', 'Ġ5', 'Ġdisc', 'Ġ(', 'Ġs', 'Ġ)', 'Ġprogressive', 'Ġscan', 'Ġblack', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ', 'Ġ', '</s>']
is_heads: [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
y: 0
tags: 0
mask: tensor([1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1])
seqlen: 166
task_name: Textual/Abt-Buy
=======================
step: 0, task: Textual/Abt-Buy, loss: 0.0435013622045517
step: 10, task: Textual/Abt-Buy, loss: 0.09628942608833313
step: 20, task: Textual/Abt-Buy, loss: 0.060218699276447296
step: 30, task: Textual/Abt-Buy, loss: 0.1915212869644165
step: 40, task: Textual/Abt-Buy, loss: 0.04421471804380417
step: 50, task: Textual/Abt-Buy, loss: 0.19519972801208496
step: 60, task: Textual/Abt-Buy, loss: 0.10283885896205902
step: 70, task: Textual/Abt-Buy, loss: 0.042393818497657776
step: 80, task: Textual/Abt-Buy, loss: 0.03590286523103714
step: 90, task: Textual/Abt-Buy, loss: 0.008419491350650787
step: 100, task: Textual/Abt-Buy, loss: 0.17039862275123596
step: 110, task: Textual/Abt-Buy, loss: 0.03261468559503555
step: 120, task: Textual/Abt-Buy, loss: 0.029158074408769608
step: 130, task: Textual/Abt-Buy, loss: 0.012675665318965912
step: 140, task: Textual/Abt-Buy, loss: 0.42046135663986206
step: 150, task: Textual/Abt-Buy, loss: 0.060320280492305756
step: 160, task: Textual/Abt-Buy, loss: 0.2679104208946228
step: 170, task: Textual/Abt-Buy, loss: 0.11029720306396484
step: 180, task: Textual/Abt-Buy, loss: 0.0642426609992981
step: 190, task: Textual/Abt-Buy, loss: 0.02015196532011032
step: 200, task: Textual/Abt-Buy, loss: 0.08884948492050171
step: 210, task: Textual/Abt-Buy, loss: 0.273136168718338
step: 220, task: Textual/Abt-Buy, loss: 0.08601242303848267
step: 230, task: Textual/Abt-Buy, loss: 0.17241358757019043
step: 240, task: Textual/Abt-Buy, loss: 0.023901082575321198
step: 250, task: Textual/Abt-Buy, loss: 0.033669523894786835
step: 260, task: Textual/Abt-Buy, loss: 0.12694139778614044
step: 270, task: Textual/Abt-Buy, loss: 0.03982469439506531
step: 280, task: Textual/Abt-Buy, loss: 0.020311415195465088
step: 290, task: Textual/Abt-Buy, loss: 0.1939675360918045
step: 300, task: Textual/Abt-Buy, loss: 0.03135666251182556
step: 310, task: Textual/Abt-Buy, loss: 0.14006969332695007
step: 320, task: Textual/Abt-Buy, loss: 0.1467805802822113
step: 330, task: Textual/Abt-Buy, loss: 0.022055841982364655
step: 340, task: Textual/Abt-Buy, loss: 0.0156446173787117
step: 350, task: Textual/Abt-Buy, loss: 0.018061727285385132
=========eval at epoch=2=========
Validation:
=============Textual/Abt-Buy==================
accuracy=0.949
precision=0.929
recall=0.568
f1=0.705
======================================
Test:
=============Textual/Abt-Buy==================
accuracy=0.953
precision=0.914
recall=0.621
f1=0.740
======================================
=====sanity check======
words: COL name VAL canon 580exii speedlite in black 1946b002 COL description VAL canon 580exii speedlite in black 1946b002 newly designed to match with the eos-1d mark iii approx. 20 % faster recycling time compared to 580ex black finish COL price VAL   [SEP] COL name VAL canon speedlite 580ex ii flash light 1946b002 COL description VAL ttl , e-ttl COL price VAL  
x: [    0 18047   766 27445 32839 34240  3463  4132  2078 33701    11   909
 27723   428 19130 14857  8194 27445 32839 34240  3463  4132  2078 33701
    11   909 27723   428 19130  3862  1887     7   914    19     5   364
   366    12   134   417  2458 46814 36612     4   291  7606  3845 11690
    86  1118     7 34240  3463   909  2073 14857   425 27445  1437  1437
     2     2 18047   766 27445 32839  2078 33701 34240  3463 42661  7462
  1109 27723   428 19130 14857  8194 27445   326 34842  2156   364    12
  5967   462 14857   425 27445  1437  1437     2]
tokens: ['<s>', 'COL', 'Ġname', 'ĠVAL', 'Ġcanon', 'Ġ580', 'ex', 'ii', 'Ġspeed', 'lite', 'Ġin', 'Ġblack', 'Ġ1946', 'b', '002', 'ĠCOL', 'Ġdescription', 'ĠVAL', 'Ġcanon', 'Ġ580', 'ex', 'ii', 'Ġspeed', 'lite', 'Ġin', 'Ġblack', 'Ġ1946', 'b', '002', 'Ġnewly', 'Ġdesigned', 'Ġto', 'Ġmatch', 'Ġwith', 'Ġthe', 'Ġe', 'os', '-', '1', 'd', 'Ġmark', 'Ġiii', 'Ġapprox', '.', 'Ġ20', 'Ġ%', 'Ġfaster', 'Ġrecycling', 'Ġtime', 'Ġcompared', 'Ġto', 'Ġ580', 'ex', 'Ġblack', 'Ġfinish', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ', 'Ġ', '</s>', '</s>', 'COL', 'Ġname', 'ĠVAL', 'Ġcanon', 'Ġspeed', 'lite', 'Ġ580', 'ex', 'Ġii', 'Ġflash', 'Ġlight', 'Ġ1946', 'b', '002', 'ĠCOL', 'Ġdescription', 'ĠVAL', 'Ġt', 'tl', 'Ġ,', 'Ġe', '-', 'tt', 'l', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ', 'Ġ', '</s>']
is_heads: [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
y: 1
tags: 1
mask: tensor([1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1])
seqlen: 92
task_name: Textual/Abt-Buy
=======================
step: 0, task: Textual/Abt-Buy, loss: 0.01871534436941147
step: 10, task: Textual/Abt-Buy, loss: 0.02838195115327835
step: 20, task: Textual/Abt-Buy, loss: 0.02522099018096924
step: 30, task: Textual/Abt-Buy, loss: 0.0023904144763946533
step: 40, task: Textual/Abt-Buy, loss: 0.16060692071914673
step: 50, task: Textual/Abt-Buy, loss: 0.3035271465778351
step: 60, task: Textual/Abt-Buy, loss: 0.00668131560087204
step: 70, task: Textual/Abt-Buy, loss: 0.012730240821838379
step: 80, task: Textual/Abt-Buy, loss: 0.01432308554649353
step: 90, task: Textual/Abt-Buy, loss: 0.013597585260868073
step: 100, task: Textual/Abt-Buy, loss: 0.00495312362909317
step: 110, task: Textual/Abt-Buy, loss: 0.051127299666404724
step: 120, task: Textual/Abt-Buy, loss: 0.0021817386150360107
step: 130, task: Textual/Abt-Buy, loss: 0.044393375515937805
step: 140, task: Textual/Abt-Buy, loss: 0.028393521904945374
step: 150, task: Textual/Abt-Buy, loss: 0.00402001291513443
step: 160, task: Textual/Abt-Buy, loss: 0.39625364542007446
step: 170, task: Textual/Abt-Buy, loss: 0.015388913452625275
step: 180, task: Textual/Abt-Buy, loss: 0.00521513819694519
step: 190, task: Textual/Abt-Buy, loss: 0.001621335744857788
step: 200, task: Textual/Abt-Buy, loss: 0.070734903216362
step: 210, task: Textual/Abt-Buy, loss: 0.015860654413700104
step: 220, task: Textual/Abt-Buy, loss: 0.007950641214847565
step: 230, task: Textual/Abt-Buy, loss: 0.030553564429283142
step: 240, task: Textual/Abt-Buy, loss: 0.016300439834594727
step: 250, task: Textual/Abt-Buy, loss: 0.009457364678382874
step: 260, task: Textual/Abt-Buy, loss: 0.07644392549991608
step: 270, task: Textual/Abt-Buy, loss: 0.006713837385177612
step: 280, task: Textual/Abt-Buy, loss: 0.010605722665786743
step: 290, task: Textual/Abt-Buy, loss: 0.027768827974796295
step: 300, task: Textual/Abt-Buy, loss: 0.01220056414604187
step: 310, task: Textual/Abt-Buy, loss: 0.010366998612880707
step: 320, task: Textual/Abt-Buy, loss: 0.12468332052230835
step: 330, task: Textual/Abt-Buy, loss: 0.018718525767326355
step: 340, task: Textual/Abt-Buy, loss: 0.0016862452030181885
step: 350, task: Textual/Abt-Buy, loss: 0.15389667451381683
=========eval at epoch=3=========
Validation:
=============Textual/Abt-Buy==================
accuracy=0.958
precision=0.811
recall=0.791
f1=0.801
======================================
Test:
=============Textual/Abt-Buy==================
accuracy=0.959
precision=0.802
recall=0.825
f1=0.813
======================================
=====sanity check======
words: COL name VAL panasonic dect 6.0 expandable digital cordless phone with all-digital answering system kxtg9341t COL description VAL panasonic dect 6.0 expandable digital cordless phone with all-digital answering system kxtg9341t up to 6 multi-handset capability digital answering machine system ringer id call waiting caller id voicemail hold voice menu marker message mute clock alarm led lighting night mode call block speakerphone 11 days standby 5 hours talk time black metallic finish COL price VAL   [SEP] COL name VAL panasonic kx-tga101s dect 6.0 expansion handset COL description VAL  COL price VAL 36.04 
x: [    0 18047   766 27445  5730 38703   263  3894   231     4   288  3003
   868  1778 13051  1672  1028    19    70    12 29563 15635   467   449
 11483   571   466 34801    90 14857  8194 27445  5730 38703   263  3894
   231     4   288  3003   868  1778 13051  1672  1028    19    70    12
 29563 15635   467   449 11483   571   466 34801    90    62     7   231
  3228    12 34055   594  9388  1778 15635  3563   467   910  6082 13561
   486  2445 17017 13561 30118 10555   946  2236  5765 17540  1579 33758
  6700  8054   669  7526   363  5745   486  1803  5385 17283   365   360
 28611   195   722  1067    86   909 24117  2073 14857   425 27445  1437
  1437     2     2 18047   766 27445  5730 38703   449  1178    12    90
  2538 12636    29   263  3894   231     4   288  2919 17621 14857  8194
 27445  1437 14857   425 27445  2491     4  3387  1437     2]
tokens: ['<s>', 'COL', 'Ġname', 'ĠVAL', 'Ġpan', 'asonic', 'Ġde', 'ct', 'Ġ6', '.', '0', 'Ġexpand', 'able', 'Ġdigital', 'Ġcord', 'less', 'Ġphone', 'Ġwith', 'Ġall', '-', 'digital', 'Ġanswering', 'Ġsystem', 'Ġk', 'xt', 'g', '9', '341', 't', 'ĠCOL', 'Ġdescription', 'ĠVAL', 'Ġpan', 'asonic', 'Ġde', 'ct', 'Ġ6', '.', '0', 'Ġexpand', 'able', 'Ġdigital', 'Ġcord', 'less', 'Ġphone', 'Ġwith', 'Ġall', '-', 'digital', 'Ġanswering', 'Ġsystem', 'Ġk', 'xt', 'g', '9', '341', 't', 'Ġup', 'Ġto', 'Ġ6', 'Ġmulti', '-', 'hands', 'et', 'Ġcapability', 'Ġdigital', 'Ġanswering', 'Ġmachine', 'Ġsystem', 'Ġr', 'inger', 'Ġid', 'Ġcall', 'Ġwaiting', 'Ġcaller', 'Ġid', 'Ġvoic', 'email', 'Ġhold', 'Ġvoice', 'Ġmenu', 'Ġmarker', 'Ġmessage', 'Ġmute', 'Ġclock', 'Ġalarm', 'Ġled', 'Ġlighting', 'Ġnight', 'Ġmode', 'Ġcall', 'Ġblock', 'Ġspeaker', 'phone', 'Ġ11', 'Ġdays', 'Ġstandby', 'Ġ5', 'Ġhours', 'Ġtalk', 'Ġtime', 'Ġblack', 'Ġmetallic', 'Ġfinish', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ', 'Ġ', '</s>', '</s>', 'COL', 'Ġname', 'ĠVAL', 'Ġpan', 'asonic', 'Ġk', 'x', '-', 't', 'ga', '101', 's', 'Ġde', 'ct', 'Ġ6', '.', '0', 'Ġexpansion', 'Ġhandset', 'ĠCOL', 'Ġdescription', 'ĠVAL', 'Ġ', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ36', '.', '04', 'Ġ', '</s>']
is_heads: [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
y: 0
tags: 0
mask: tensor([1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1])
seqlen: 142
task_name: Textual/Abt-Buy
=======================
step: 0, task: Textual/Abt-Buy, loss: 0.007654137909412384
step: 10, task: Textual/Abt-Buy, loss: 0.03539017215371132
step: 20, task: Textual/Abt-Buy, loss: 0.0007043927907943726
step: 30, task: Textual/Abt-Buy, loss: 0.00680561363697052
step: 40, task: Textual/Abt-Buy, loss: 0.02849718928337097
step: 50, task: Textual/Abt-Buy, loss: 0.0023702532052993774
step: 60, task: Textual/Abt-Buy, loss: 0.026560313999652863
step: 70, task: Textual/Abt-Buy, loss: 0.0036907345056533813
step: 80, task: Textual/Abt-Buy, loss: 0.0014024972915649414
step: 90, task: Textual/Abt-Buy, loss: 0.001298069953918457
step: 100, task: Textual/Abt-Buy, loss: 0.0007853955030441284
step: 110, task: Textual/Abt-Buy, loss: 0.06340630352497101
step: 120, task: Textual/Abt-Buy, loss: 0.014433547854423523
step: 130, task: Textual/Abt-Buy, loss: 0.013603076338768005
step: 140, task: Textual/Abt-Buy, loss: 0.0017082393169403076
step: 150, task: Textual/Abt-Buy, loss: 0.001317441463470459
step: 160, task: Textual/Abt-Buy, loss: 0.0013691037893295288
step: 170, task: Textual/Abt-Buy, loss: 0.00032474100589752197
step: 180, task: Textual/Abt-Buy, loss: 0.0006040483713150024
step: 190, task: Textual/Abt-Buy, loss: 0.0019398927688598633
step: 200, task: Textual/Abt-Buy, loss: 0.014722183346748352
step: 210, task: Textual/Abt-Buy, loss: 0.026826336979866028
step: 220, task: Textual/Abt-Buy, loss: 0.0074273571372032166
step: 230, task: Textual/Abt-Buy, loss: 0.0012250393629074097
step: 240, task: Textual/Abt-Buy, loss: 0.0359630286693573
step: 250, task: Textual/Abt-Buy, loss: 0.015943024307489395
step: 260, task: Textual/Abt-Buy, loss: 0.08722299337387085
step: 270, task: Textual/Abt-Buy, loss: 0.0039863064885139465
step: 280, task: Textual/Abt-Buy, loss: 0.009974464774131775
step: 290, task: Textual/Abt-Buy, loss: 0.02698412537574768
step: 300, task: Textual/Abt-Buy, loss: 0.0020270943641662598
step: 310, task: Textual/Abt-Buy, loss: 0.0016523003578186035
step: 320, task: Textual/Abt-Buy, loss: 0.012725695967674255
step: 330, task: Textual/Abt-Buy, loss: 0.0118885338306427
step: 340, task: Textual/Abt-Buy, loss: 0.0015555620193481445
step: 350, task: Textual/Abt-Buy, loss: 0.0014718323945999146
=========eval at epoch=4=========
Validation:
=============Textual/Abt-Buy==================
accuracy=0.946
precision=0.876
recall=0.583
f1=0.700
======================================
Test:
=============Textual/Abt-Buy==================
accuracy=0.947
precision=0.895
recall=0.578
f1=0.702
======================================
=====sanity check======
words: COL name VAL uniden dect 6.0 accessory handset and charging cradle dcx200 COL description VAL uniden dect 6.0 accessory handset and charging cradle dcx200 caller id/call waiting dect 6.0 interference free cordless frequency handset speakerphone intercom or call transfer between handsets 30 number caller id memory clock display COL price VAL   [SEP] COL name VAL uniden dcx300 dect 6.0 accessory handset and cradle for the dect2000 series COL description VAL  COL price VAL  
x: [    0 18047   766 27445   542 12145   263  3894   231     4   288 21883
 17621     8  6489 39111 46773  1178  2619 14857  8194 27445   542 12145
   263  3894   231     4   288 21883 17621     8  6489 39111 46773  1178
  2619 17017 13561    73 16395  2445   263  3894   231     4   288  8149
   481 13051  1672 13135 17621  5385 17283  3222   175    50   486  2937
   227  1420  2580   389   346 17017 13561  3783  6700  2332 14857   425
 27445  1437  1437     2     2 18047   766 27445   542 12145 46773  1178
  2965   263  3894   231     4   288 21883 17621     8 39111    13     5
   263  3894 17472   651 14857  8194 27445  1437 14857   425 27445  1437
  1437     2]
tokens: ['<s>', 'COL', 'Ġname', 'ĠVAL', 'Ġun', 'iden', 'Ġde', 'ct', 'Ġ6', '.', '0', 'Ġaccessory', 'Ġhandset', 'Ġand', 'Ġcharging', 'Ġcradle', 'Ġdc', 'x', '200', 'ĠCOL', 'Ġdescription', 'ĠVAL', 'Ġun', 'iden', 'Ġde', 'ct', 'Ġ6', '.', '0', 'Ġaccessory', 'Ġhandset', 'Ġand', 'Ġcharging', 'Ġcradle', 'Ġdc', 'x', '200', 'Ġcaller', 'Ġid', '/', 'call', 'Ġwaiting', 'Ġde', 'ct', 'Ġ6', '.', '0', 'Ġinterference', 'Ġfree', 'Ġcord', 'less', 'Ġfrequency', 'Ġhandset', 'Ġspeaker', 'phone', 'Ġinter', 'com', 'Ġor', 'Ġcall', 'Ġtransfer', 'Ġbetween', 'Ġhands', 'ets', 'Ġ30', 'Ġnumber', 'Ġcaller', 'Ġid', 'Ġmemory', 'Ġclock', 'Ġdisplay', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ', 'Ġ', '</s>', '</s>', 'COL', 'Ġname', 'ĠVAL', 'Ġun', 'iden', 'Ġdc', 'x', '300', 'Ġde', 'ct', 'Ġ6', '.', '0', 'Ġaccessory', 'Ġhandset', 'Ġand', 'Ġcradle', 'Ġfor', 'Ġthe', 'Ġde', 'ct', '2000', 'Ġseries', 'ĠCOL', 'Ġdescription', 'ĠVAL', 'Ġ', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ', 'Ġ', '</s>']
is_heads: [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
y: 0
tags: 0
mask: tensor([1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1])
seqlen: 110
task_name: Textual/Abt-Buy
=======================
step: 0, task: Textual/Abt-Buy, loss: 0.002260342240333557
step: 10, task: Textual/Abt-Buy, loss: 0.029244273900985718
step: 20, task: Textual/Abt-Buy, loss: 0.0031483620405197144
step: 30, task: Textual/Abt-Buy, loss: 0.13836248219013214
step: 40, task: Textual/Abt-Buy, loss: 0.0007489323616027832
step: 50, task: Textual/Abt-Buy, loss: 0.0021667182445526123
step: 60, task: Textual/Abt-Buy, loss: 0.0009678155183792114
step: 70, task: Textual/Abt-Buy, loss: 0.01326730102300644
step: 80, task: Textual/Abt-Buy, loss: 0.00046025216579437256
step: 90, task: Textual/Abt-Buy, loss: 0.010178349912166595
step: 100, task: Textual/Abt-Buy, loss: 0.0004434138536453247
step: 110, task: Textual/Abt-Buy, loss: 0.0011395066976547241
step: 120, task: Textual/Abt-Buy, loss: 0.0002092421054840088
step: 130, task: Textual/Abt-Buy, loss: 0.0005030184984207153
step: 140, task: Textual/Abt-Buy, loss: 0.0006131082773208618
step: 150, task: Textual/Abt-Buy, loss: 0.0005133450031280518
step: 160, task: Textual/Abt-Buy, loss: 0.003511756658554077
step: 170, task: Textual/Abt-Buy, loss: 0.0002012401819229126
step: 180, task: Textual/Abt-Buy, loss: 0.00014126300811767578
step: 190, task: Textual/Abt-Buy, loss: 0.04087323695421219
step: 200, task: Textual/Abt-Buy, loss: 0.0007826238870620728
step: 210, task: Textual/Abt-Buy, loss: 0.2692221999168396
step: 220, task: Textual/Abt-Buy, loss: 0.0005145072937011719
step: 230, task: Textual/Abt-Buy, loss: 0.0007874071598052979
step: 240, task: Textual/Abt-Buy, loss: 0.0026204437017440796
step: 250, task: Textual/Abt-Buy, loss: 0.011395301669836044
step: 260, task: Textual/Abt-Buy, loss: 0.0003509819507598877
step: 270, task: Textual/Abt-Buy, loss: 0.020205650478601456
step: 280, task: Textual/Abt-Buy, loss: 0.07051126658916473
step: 290, task: Textual/Abt-Buy, loss: 0.29292094707489014
step: 300, task: Textual/Abt-Buy, loss: 0.06311356276273727
step: 310, task: Textual/Abt-Buy, loss: 0.024911239743232727
step: 320, task: Textual/Abt-Buy, loss: 0.019838228821754456
step: 330, task: Textual/Abt-Buy, loss: 0.00361613929271698
step: 340, task: Textual/Abt-Buy, loss: 0.0184226855635643
step: 350, task: Textual/Abt-Buy, loss: 0.00613509863615036
=========eval at epoch=5=========
Validation:
=============Textual/Abt-Buy==================
accuracy=0.945
precision=0.911
recall=0.544
f1=0.681
======================================
Test:
=============Textual/Abt-Buy==================
accuracy=0.948
precision=0.915
recall=0.573
f1=0.704
======================================
=====sanity check======
words: COL name VAL lg 30 ' black freestanding gas range lrg30357bk COL description VAL lg 30 ' black freestanding gas range lrg30357bk 5.0 cu . ft. capacity oven superboil burner 5 burner system smoothtouch controls warming drawer electronic ignition system one piece recessed cooktop self-cleaning oven white finish COL price VAL   [SEP] COL name VAL weber genesis series 3770001 60 ' freestanding gas grill COL description VAL  COL price VAL  
x: [    0 18047   766 27445   784   571   389   128   909  7619   990 20515
  1123  1186   784 17865   541 30628   428   330 14857  8194 27445   784
   571   389   128   909  7619   990 20515  1123  1186   784 17865   541
 30628   428   330   195     4   288  3729   479 16935     4  2148 12941
  2422  3983   718 35285   195 35285   467  6921 26673  5656  8232 31807
  5175 32026   467    65  2125  3872 18502  7142  8766  1403    12 16008
 19266 12941  1104  2073 14857   425 27445  1437  1437     2     2 18047
   766 27445    52  1943 39577   651 37494 27623  1191   128  7619   990
 20515  1123 20212 14857  8194 27445  1437 14857   425 27445  1437  1437
     2]
tokens: ['<s>', 'COL', 'Ġname', 'ĠVAL', 'Ġl', 'g', 'Ġ30', "Ġ'", 'Ġblack', 'Ġfre', 'est', 'anding', 'Ġgas', 'Ġrange', 'Ġl', 'rg', '30', '357', 'b', 'k', 'ĠCOL', 'Ġdescription', 'ĠVAL', 'Ġl', 'g', 'Ġ30', "Ġ'", 'Ġblack', 'Ġfre', 'est', 'anding', 'Ġgas', 'Ġrange', 'Ġl', 'rg', '30', '357', 'b', 'k', 'Ġ5', '.', '0', 'Ġcu', 'Ġ.', 'Ġft', '.', 'Ġcapacity', 'Ġoven', 'Ġsuper', 'bo', 'il', 'Ġburner', 'Ġ5', 'Ġburner', 'Ġsystem', 'Ġsmooth', 'touch', 'Ġcontrols', 'Ġwarming', 'Ġdrawer', 'Ġelectronic', 'Ġignition', 'Ġsystem', 'Ġone', 'Ġpiece', 'Ġrec', 'essed', 'Ġcook', 'top', 'Ġself', '-', 'cle', 'aning', 'Ġoven', 'Ġwhite', 'Ġfinish', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ', 'Ġ', '</s>', '</s>', 'COL', 'Ġname', 'ĠVAL', 'Ġwe', 'ber', 'Ġgenesis', 'Ġseries', 'Ġ377', '0001', 'Ġ60', "Ġ'", 'Ġfre', 'est', 'anding', 'Ġgas', 'Ġgrill', 'ĠCOL', 'Ġdescription', 'ĠVAL', 'Ġ', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ', 'Ġ', '</s>']
is_heads: [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
y: 0
tags: 0
mask: tensor([1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1])
seqlen: 109
task_name: Textual/Abt-Buy
=======================
step: 0, task: Textual/Abt-Buy, loss: 0.00026522576808929443
step: 10, task: Textual/Abt-Buy, loss: 0.00020451843738555908
step: 20, task: Textual/Abt-Buy, loss: 0.0009529739618301392
step: 30, task: Textual/Abt-Buy, loss: 0.002947106957435608
step: 40, task: Textual/Abt-Buy, loss: 0.0025461167097091675
step: 50, task: Textual/Abt-Buy, loss: 0.0008129328489303589
step: 60, task: Textual/Abt-Buy, loss: 0.0005122274160385132
step: 70, task: Textual/Abt-Buy, loss: 0.004758395254611969
step: 80, task: Textual/Abt-Buy, loss: 0.00044029951095581055
step: 90, task: Textual/Abt-Buy, loss: 0.006671182811260223
step: 100, task: Textual/Abt-Buy, loss: 0.0020349547266960144
step: 110, task: Textual/Abt-Buy, loss: 0.013994075357913971
step: 120, task: Textual/Abt-Buy, loss: 0.0006597340106964111
step: 130, task: Textual/Abt-Buy, loss: 0.004389412701129913
step: 140, task: Textual/Abt-Buy, loss: 0.0007271319627761841
step: 150, task: Textual/Abt-Buy, loss: 0.0008822828531265259
step: 160, task: Textual/Abt-Buy, loss: 0.0004940778017044067
step: 170, task: Textual/Abt-Buy, loss: 0.0003970712423324585
step: 180, task: Textual/Abt-Buy, loss: 0.0003404170274734497
step: 190, task: Textual/Abt-Buy, loss: 0.0002644658088684082
step: 200, task: Textual/Abt-Buy, loss: 0.00022986531257629395
step: 210, task: Textual/Abt-Buy, loss: 0.000919833779335022
step: 220, task: Textual/Abt-Buy, loss: 0.0003953874111175537
step: 230, task: Textual/Abt-Buy, loss: 0.0014851093292236328
step: 240, task: Textual/Abt-Buy, loss: 0.06846483051776886
step: 250, task: Textual/Abt-Buy, loss: 0.0001913309097290039
step: 260, task: Textual/Abt-Buy, loss: 0.0003315061330795288
step: 270, task: Textual/Abt-Buy, loss: 0.0004219561815261841
step: 280, task: Textual/Abt-Buy, loss: 9.325146675109863e-05
step: 290, task: Textual/Abt-Buy, loss: 0.05778123438358307
step: 300, task: Textual/Abt-Buy, loss: 0.0004248321056365967
step: 310, task: Textual/Abt-Buy, loss: 0.004457071423530579
step: 320, task: Textual/Abt-Buy, loss: 0.015376567840576172
step: 330, task: Textual/Abt-Buy, loss: 8.0108642578125e-05
step: 340, task: Textual/Abt-Buy, loss: 0.004054181277751923
step: 350, task: Textual/Abt-Buy, loss: 0.003245346248149872
=========eval at epoch=6=========
Validation:
=============Textual/Abt-Buy==================
accuracy=0.951
precision=0.906
recall=0.612
f1=0.730
======================================
Test:
=============Textual/Abt-Buy==================
accuracy=0.962
precision=0.919
recall=0.714
f1=0.803
======================================
=====sanity check======
words: COL name VAL panasonic viera 42 ' plasma flat panel 1080p hdtv in black th42pz80u COL description VAL panasonic viera 42 ' plasma flat panel 1080p hdtv in black th42pz80u 1080p display 1920 x 1080 native resolution color purity optimizer surround sound anti-reflective filter viera link hdavi control built-in ntsc/atsc/qam tuners 3 hdmi inputs built-in galleryplayer capable sd card memory slot pedestal stand included black finish COL price VAL   [SEP] COL name VAL panasonic viera th-50pz80u 50 ' plasma tv COL description VAL 50 ' atsc , ntsc 16:9 1920 x 1080 surround hdtv COL price VAL 1364.96 
x: [    0 18047   766 27445  5730 38703   748 16432  3330   128 29051  3269
  2798 21083   642  1368   417 18724    11   909  3553  3714   642   329
  2940   257 14857  8194 27445  5730 38703   748 16432  3330   128 29051
  3269  2798 21083   642  1368   417 18724    11   909  3553  3714   642
   329  2940   257 21083   642  2332 18283  3023 21083  3763  3547  3195
 32195 17775  6315 21104  2369  1475    12 39878  2088 14929   748 16432
  3104  1368   417 11132   797  1490    12   179   295  1872   438    73
  2923   438    73  1343   424 27115   268   155  1368   417  5408 16584
  1490    12   179  7294 23233  4453 46409  1886  3783  8534 38238   337
  1413  1165   909  2073 14857   425 27445  1437  1437     2     2 18047
   766 27445  5730 38703   748 16432  3553    12  1096   642   329  2940
   257   654   128 29051 30016 14857  8194 27445   654   128    23  3866
  2156   295  1872   438   545    35   466 18283  3023 21083 21104  1368
   417 18724 14857   425 27445   508  4027     4  5607  1437     2]
tokens: ['<s>', 'COL', 'Ġname', 'ĠVAL', 'Ġpan', 'asonic', 'Ġv', 'iera', 'Ġ42', "Ġ'", 'Ġplasma', 'Ġflat', 'Ġpanel', 'Ġ1080', 'p', 'Ġh', 'd', 'tv', 'Ġin', 'Ġblack', 'Ġth', '42', 'p', 'z', '80', 'u', 'ĠCOL', 'Ġdescription', 'ĠVAL', 'Ġpan', 'asonic', 'Ġv', 'iera', 'Ġ42', "Ġ'", 'Ġplasma', 'Ġflat', 'Ġpanel', 'Ġ1080', 'p', 'Ġh', 'd', 'tv', 'Ġin', 'Ġblack', 'Ġth', '42', 'p', 'z', '80', 'u', 'Ġ1080', 'p', 'Ġdisplay', 'Ġ1920', 'Ġx', 'Ġ1080', 'Ġnative', 'Ġresolution', 'Ġcolor', 'Ġpurity', 'Ġoptim', 'izer', 'Ġsurround', 'Ġsound', 'Ġanti', '-', 'reflect', 'ive', 'Ġfilter', 'Ġv', 'iera', 'Ġlink', 'Ġh', 'd', 'avi', 'Ġcontrol', 'Ġbuilt', '-', 'in', 'Ġn', 'ts', 'c', '/', 'ats', 'c', '/', 'q', 'am', 'Ġtun', 'ers', 'Ġ3', 'Ġh', 'd', 'mi', 'Ġinputs', 'Ġbuilt', '-', 'in', 'Ġgallery', 'player', 'Ġcapable', 'Ġsd', 'Ġcard', 'Ġmemory', 'Ġslot', 'Ġpedest', 'al', 'Ġstand', 'Ġincluded', 'Ġblack', 'Ġfinish', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ', 'Ġ', '</s>', '</s>', 'COL', 'Ġname', 'ĠVAL', 'Ġpan', 'asonic', 'Ġv', 'iera', 'Ġth', '-', '50', 'p', 'z', '80', 'u', 'Ġ50', "Ġ'", 'Ġplasma', 'Ġtv', 'ĠCOL', 'Ġdescription', 'ĠVAL', 'Ġ50', "Ġ'", 'Ġat', 'sc', 'Ġ,', 'Ġn', 'ts', 'c', 'Ġ16', ':', '9', 'Ġ1920', 'Ġx', 'Ġ1080', 'Ġsurround', 'Ġh', 'd', 'tv', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ13', '64', '.', '96', 'Ġ', '</s>']
is_heads: [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
y: 0
tags: 0
mask: tensor([1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1])
seqlen: 167
task_name: Textual/Abt-Buy
=======================
step: 0, task: Textual/Abt-Buy, loss: 0.01016119122505188
step: 10, task: Textual/Abt-Buy, loss: 0.038369059562683105
step: 20, task: Textual/Abt-Buy, loss: 0.003993779420852661
step: 30, task: Textual/Abt-Buy, loss: 0.0018751472234725952
step: 40, task: Textual/Abt-Buy, loss: 0.0014631301164627075
step: 50, task: Textual/Abt-Buy, loss: 0.0014651566743850708
step: 60, task: Textual/Abt-Buy, loss: 0.0013118386268615723
step: 70, task: Textual/Abt-Buy, loss: 0.00018873810768127441
step: 80, task: Textual/Abt-Buy, loss: 0.005003772675991058
step: 90, task: Textual/Abt-Buy, loss: 0.02802383527159691
step: 100, task: Textual/Abt-Buy, loss: 0.018114283680915833
step: 110, task: Textual/Abt-Buy, loss: 0.014086052775382996
step: 120, task: Textual/Abt-Buy, loss: 0.0006906241178512573
step: 130, task: Textual/Abt-Buy, loss: 0.0001093745231628418
step: 140, task: Textual/Abt-Buy, loss: 0.005562320351600647
step: 150, task: Textual/Abt-Buy, loss: 0.0004325658082962036
step: 160, task: Textual/Abt-Buy, loss: 0.00032423436641693115
step: 170, task: Textual/Abt-Buy, loss: 0.00042162835597991943
step: 180, task: Textual/Abt-Buy, loss: 0.0003360658884048462
step: 190, task: Textual/Abt-Buy, loss: 0.11554636061191559
step: 200, task: Textual/Abt-Buy, loss: 7.203221321105957e-05
step: 210, task: Textual/Abt-Buy, loss: 0.00029186904430389404
step: 220, task: Textual/Abt-Buy, loss: 0.0012085437774658203
step: 230, task: Textual/Abt-Buy, loss: 8.678436279296875e-05
step: 240, task: Textual/Abt-Buy, loss: 0.0004271268844604492
step: 250, task: Textual/Abt-Buy, loss: 0.0014607980847358704
step: 260, task: Textual/Abt-Buy, loss: 0.0003231316804885864
step: 270, task: Textual/Abt-Buy, loss: 0.10567077994346619
step: 280, task: Textual/Abt-Buy, loss: 0.00020049512386322021
step: 290, task: Textual/Abt-Buy, loss: 0.0009806454181671143
step: 300, task: Textual/Abt-Buy, loss: 0.00015541911125183105
step: 310, task: Textual/Abt-Buy, loss: 0.02907455712556839
step: 320, task: Textual/Abt-Buy, loss: 0.0026016831398010254
step: 330, task: Textual/Abt-Buy, loss: 0.0006646811962127686
step: 340, task: Textual/Abt-Buy, loss: 0.0005846172571182251
step: 350, task: Textual/Abt-Buy, loss: 0.00013546645641326904
=========eval at epoch=7=========
Validation:
=============Textual/Abt-Buy==================
accuracy=0.950
precision=0.944
recall=0.573
f1=0.713
======================================
Test:
=============Textual/Abt-Buy==================
accuracy=0.956
precision=0.929
recall=0.636
f1=0.755
======================================
=====sanity check======
words: COL name VAL olympus silver digital voice recorder vn4100pc COL description VAL olympus silver digital voice recorder vn4100pc 144 hours 20 minutes recording time pc link file management timer recording four recording modes voice activation silver finish COL price VAL   [SEP] COL name VAL sony vrdmc5 digital video recorder COL description VAL dvd + rw , dvd-rw , dvd + r , memory stick , memory stick duo , secure digital ( sd ) card , xd-picture card , compactflash ( cf ) dvd video , mp3 1 disc 12hour recording COL price VAL 166.29 
x: [    0 18047   766 27445  1021 31434   687  4334  1778  2236 32017   748
   282   306  1866 17426 14857  8194 27445  1021 31434   687  4334  1778
  2236 32017   748   282   306  1866 17426 19641   722   291   728  5492
    86 46213  3104  2870  1052 35809  5492   237  5492 19180  2236 29997
  4334  2073 14857   425 27445  1437  1437     2     2 18047   766 27445
   579  6119   748  2586 29297   245  1778   569 32017 14857  8194 27445
   385 40311  2055   910   605  2156   385 40311    12 43926  2156   385
 40311  2055   910  2156  3783  4757  2156  3783  4757  6458  2156  2823
  1778    36 46409  4839  1886  2156  3023   417    12 37587  1886  2156
 12549 39837    36 46470  4839   385 40311   569  2156 44857   246   112
  9553   316  4509  5492 14857   425 27445 27459     4  2890  1437     2]
tokens: ['<s>', 'COL', 'Ġname', 'ĠVAL', 'Ġo', 'lymp', 'us', 'Ġsilver', 'Ġdigital', 'Ġvoice', 'Ġrecorder', 'Ġv', 'n', '4', '100', 'pc', 'ĠCOL', 'Ġdescription', 'ĠVAL', 'Ġo', 'lymp', 'us', 'Ġsilver', 'Ġdigital', 'Ġvoice', 'Ġrecorder', 'Ġv', 'n', '4', '100', 'pc', 'Ġ144', 'Ġhours', 'Ġ20', 'Ġminutes', 'Ġrecording', 'Ġtime', 'Ġpc', 'Ġlink', 'Ġfile', 'Ġmanagement', 'Ġtimer', 'Ġrecording', 'Ġfour', 'Ġrecording', 'Ġmodes', 'Ġvoice', 'Ġactivation', 'Ġsilver', 'Ġfinish', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ', 'Ġ', '</s>', '</s>', 'COL', 'Ġname', 'ĠVAL', 'Ġs', 'ony', 'Ġv', 'rd', 'mc', '5', 'Ġdigital', 'Ġvideo', 'Ġrecorder', 'ĠCOL', 'Ġdescription', 'ĠVAL', 'Ġd', 'vd', 'Ġ+', 'Ġr', 'w', 'Ġ,', 'Ġd', 'vd', '-', 'rw', 'Ġ,', 'Ġd', 'vd', 'Ġ+', 'Ġr', 'Ġ,', 'Ġmemory', 'Ġstick', 'Ġ,', 'Ġmemory', 'Ġstick', 'Ġduo', 'Ġ,', 'Ġsecure', 'Ġdigital', 'Ġ(', 'Ġsd', 'Ġ)', 'Ġcard', 'Ġ,', 'Ġx', 'd', '-', 'picture', 'Ġcard', 'Ġ,', 'Ġcompact', 'flash', 'Ġ(', 'Ġcf', 'Ġ)', 'Ġd', 'vd', 'Ġvideo', 'Ġ,', 'Ġmp', '3', 'Ġ1', 'Ġdisc', 'Ġ12', 'hour', 'Ġrecording', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ166', '.', '29', 'Ġ', '</s>']
is_heads: [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
y: 0
tags: 0
mask: tensor([1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1])
seqlen: 132
task_name: Textual/Abt-Buy
=======================
step: 0, task: Textual/Abt-Buy, loss: 9.998679161071777e-05
step: 10, task: Textual/Abt-Buy, loss: 0.00016945600509643555
step: 20, task: Textual/Abt-Buy, loss: 0.0017877668142318726
step: 30, task: Textual/Abt-Buy, loss: 0.0005912929773330688
step: 40, task: Textual/Abt-Buy, loss: 0.00013786554336547852
step: 50, task: Textual/Abt-Buy, loss: 0.0002307295799255371
step: 60, task: Textual/Abt-Buy, loss: 0.000147894024848938
step: 70, task: Textual/Abt-Buy, loss: 0.00011926889419555664
step: 80, task: Textual/Abt-Buy, loss: 0.00016348063945770264
step: 90, task: Textual/Abt-Buy, loss: 0.00017027556896209717
step: 100, task: Textual/Abt-Buy, loss: 0.0001360774040222168
step: 110, task: Textual/Abt-Buy, loss: 0.00033479928970336914
Gradient overflow.  Skipping step, loss scaler 0 reducing loss scale to 8192.0
step: 120, task: Textual/Abt-Buy, loss: 0.00010141730308532715
step: 130, task: Textual/Abt-Buy, loss: 0.00012725591659545898
step: 140, task: Textual/Abt-Buy, loss: 0.012484051287174225
step: 150, task: Textual/Abt-Buy, loss: 0.016011476516723633
step: 160, task: Textual/Abt-Buy, loss: 0.00016182661056518555
step: 170, task: Textual/Abt-Buy, loss: 0.00033588707447052
step: 180, task: Textual/Abt-Buy, loss: 0.007271632552146912
step: 190, task: Textual/Abt-Buy, loss: 0.0002069622278213501
step: 200, task: Textual/Abt-Buy, loss: 0.0004909038543701172
step: 210, task: Textual/Abt-Buy, loss: 7.674098014831543e-05
step: 220, task: Textual/Abt-Buy, loss: 0.03409469872713089
step: 230, task: Textual/Abt-Buy, loss: 0.0010887086391448975
step: 240, task: Textual/Abt-Buy, loss: 0.005808480083942413
step: 250, task: Textual/Abt-Buy, loss: 0.00013786554336547852
step: 260, task: Textual/Abt-Buy, loss: 0.00027242302894592285
step: 270, task: Textual/Abt-Buy, loss: 0.0006199777126312256
step: 280, task: Textual/Abt-Buy, loss: 0.0005869865417480469
step: 290, task: Textual/Abt-Buy, loss: 0.0011808425188064575
step: 300, task: Textual/Abt-Buy, loss: 0.00013059377670288086
step: 310, task: Textual/Abt-Buy, loss: 0.02167407050728798
step: 320, task: Textual/Abt-Buy, loss: 8.589029312133789e-05
step: 330, task: Textual/Abt-Buy, loss: 0.00022958219051361084
step: 340, task: Textual/Abt-Buy, loss: 0.011669561266899109
step: 350, task: Textual/Abt-Buy, loss: 0.007387146353721619
=========eval at epoch=8=========
Validation:
=============Textual/Abt-Buy==================
accuracy=0.943
precision=0.915
recall=0.519
f1=0.663
======================================
Test:
=============Textual/Abt-Buy==================
accuracy=0.950
precision=0.910
recall=0.592
f1=0.718
======================================
Selected optimization level O2:  FP16 training with FP32 batchnorm and FP32 master weights.

Defaults for this optimization level are:
enabled                : True
opt_level              : O2
cast_model_type        : torch.float16
patch_torch_functions  : False
keep_batchnorm_fp32    : True
master_weights         : True
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O2
cast_model_type        : torch.float16
patch_torch_functions  : False
keep_batchnorm_fp32    : True
master_weights         : True
loss_scale             : dynamic
Warning:  multi_tensor_applier fused unscale kernel is unavailable, possibly because apex was installed without --cuda_ext --cpp_ext. Using Python fallback.  Original ImportError was: ModuleNotFoundError("No module named 'amp_C'")
Gradient overflow.  Skipping step, loss scaler 0 reducing loss scale to 32768.0
=====sanity check======
words: COL name VAL samsung 52 ' series 7 black flat panel lcd hdtv ln52a750 COL description VAL samsung 52 ' series 7 black flat panel lcd hdtv ln52a750 1920 x 1080 full hd resolution 50,000:1 dynamic contrast ratio 4ms response time srs trusurround xt touch of color design auto motion plus 120hz ultra clear panel pre-loaded content black finish COL price VAL   [SEP] COL name VAL samsung 4 series ln26a450 26 ' lcd tv COL description VAL samsung ln26a450 26 ' widescreen 720p lcd hdtv 5000:1 dynamic contrast ratio 8ms response time piano black COL price VAL 549.0 
x: [    0 18047   766 27445   579 48545  3135   128   651   262   909  3269
  2798   784 28690  1368   417 18724   784   282  4429   102 10569 14857
  8194 27445   579 48545  3135   128   651   262   909  3269  2798   784
 28690  1368   417 18724   784   282  4429   102 10569 18283  3023 21083
   455  1368   417  3547   654     6   151    35   134  6878  5709  1750
   204  4339  1263    86   579  4926  2664   687   710  3431  1437 11483
  2842     9  3195  1521  4485  4298  2704  5962 39569  9620   699  2798
  1198    12 24919  1383   909  2073 14857   425 27445  1437  1437     2
     2 18047   766 27445   579 48545   204   651   784   282  2481   102
 13872   973   128   784 28690 30016 14857  8194 27445   579 48545   784
   282  2481   102 13872   973   128   885  4376 37346 26180   642   784
 28690  1368   417 18724 23221    35   134  6878  5709  1750   290  4339
  1263    86 13305   909 14857   425 27445   195  3414     4   288  1437
     2]
tokens: ['<s>', 'COL', 'Ġname', 'ĠVAL', 'Ġs', 'amsung', 'Ġ52', "Ġ'", 'Ġseries', 'Ġ7', 'Ġblack', 'Ġflat', 'Ġpanel', 'Ġl', 'cd', 'Ġh', 'd', 'tv', 'Ġl', 'n', '52', 'a', '750', 'ĠCOL', 'Ġdescription', 'ĠVAL', 'Ġs', 'amsung', 'Ġ52', "Ġ'", 'Ġseries', 'Ġ7', 'Ġblack', 'Ġflat', 'Ġpanel', 'Ġl', 'cd', 'Ġh', 'd', 'tv', 'Ġl', 'n', '52', 'a', '750', 'Ġ1920', 'Ġx', 'Ġ1080', 'Ġfull', 'Ġh', 'd', 'Ġresolution', 'Ġ50', ',', '000', ':', '1', 'Ġdynamic', 'Ġcontrast', 'Ġratio', 'Ġ4', 'ms', 'Ġresponse', 'Ġtime', 'Ġs', 'rs', 'Ġtr', 'us', 'ur', 'round', 'Ġ', 'xt', 'Ġtouch', 'Ġof', 'Ġcolor', 'Ġdesign', 'Ġauto', 'Ġmotion', 'Ġplus', 'Ġ120', 'hz', 'Ġultra', 'Ġclear', 'Ġpanel', 'Ġpre', '-', 'loaded', 'Ġcontent', 'Ġblack', 'Ġfinish', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ', 'Ġ', '</s>', '</s>', 'COL', 'Ġname', 'ĠVAL', 'Ġs', 'amsung', 'Ġ4', 'Ġseries', 'Ġl', 'n', '26', 'a', '450', 'Ġ26', "Ġ'", 'Ġl', 'cd', 'Ġtv', 'ĠCOL', 'Ġdescription', 'ĠVAL', 'Ġs', 'amsung', 'Ġl', 'n', '26', 'a', '450', 'Ġ26', "Ġ'", 'Ġw', 'ides', 'creen', 'Ġ720', 'p', 'Ġl', 'cd', 'Ġh', 'd', 'tv', 'Ġ5000', ':', '1', 'Ġdynamic', 'Ġcontrast', 'Ġratio', 'Ġ8', 'ms', 'Ġresponse', 'Ġtime', 'Ġpiano', 'Ġblack', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ5', '49', '.', '0', 'Ġ', '</s>']
is_heads: [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
y: 0
tags: 0
mask: tensor([1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1])
seqlen: 157
task_name: Textual/Abt-Buy
=======================
step: 0, task: Textual/Abt-Buy, loss: 0.6801187992095947
Gradient overflow.  Skipping step, loss scaler 0 reducing loss scale to 16384.0
Gradient overflow.  Skipping step, loss scaler 0 reducing loss scale to 8192.0
step: 10, task: Textual/Abt-Buy, loss: 0.6538974642753601
step: 20, task: Textual/Abt-Buy, loss: 0.6172678470611572
step: 30, task: Textual/Abt-Buy, loss: 0.4287387430667877
step: 40, task: Textual/Abt-Buy, loss: 0.5321593880653381
step: 50, task: Textual/Abt-Buy, loss: 0.6741998195648193
step: 60, task: Textual/Abt-Buy, loss: 0.23776288330554962
step: 70, task: Textual/Abt-Buy, loss: 0.3568112552165985
step: 80, task: Textual/Abt-Buy, loss: 0.4976837635040283
step: 90, task: Textual/Abt-Buy, loss: 0.4705517888069153
step: 100, task: Textual/Abt-Buy, loss: 0.2741660177707672
step: 110, task: Textual/Abt-Buy, loss: 0.10344307124614716
step: 120, task: Textual/Abt-Buy, loss: 0.4830475449562073
step: 130, task: Textual/Abt-Buy, loss: 0.4390539228916168
step: 140, task: Textual/Abt-Buy, loss: 0.4717858135700226
step: 150, task: Textual/Abt-Buy, loss: 0.22002294659614563
step: 160, task: Textual/Abt-Buy, loss: 0.38564783334732056
step: 170, task: Textual/Abt-Buy, loss: 0.5976371765136719
step: 180, task: Textual/Abt-Buy, loss: 0.29179954528808594
step: 190, task: Textual/Abt-Buy, loss: 0.22338320314884186
step: 200, task: Textual/Abt-Buy, loss: 0.7584570050239563
step: 210, task: Textual/Abt-Buy, loss: 0.7706133127212524
step: 220, task: Textual/Abt-Buy, loss: 0.496049165725708
step: 230, task: Textual/Abt-Buy, loss: 0.26573455333709717
step: 240, task: Textual/Abt-Buy, loss: 0.4239407479763031
step: 250, task: Textual/Abt-Buy, loss: 0.532990038394928
step: 260, task: Textual/Abt-Buy, loss: 0.4086924195289612
step: 270, task: Textual/Abt-Buy, loss: 0.5516670346260071
step: 280, task: Textual/Abt-Buy, loss: 0.7336381077766418
step: 290, task: Textual/Abt-Buy, loss: 0.19025546312332153
step: 300, task: Textual/Abt-Buy, loss: 0.6167620420455933
step: 310, task: Textual/Abt-Buy, loss: 0.37178313732147217
step: 320, task: Textual/Abt-Buy, loss: 0.35876503586769104
step: 330, task: Textual/Abt-Buy, loss: 0.37931427359580994
step: 340, task: Textual/Abt-Buy, loss: 0.4081552028656006
step: 350, task: Textual/Abt-Buy, loss: 0.4211439788341522
=========eval at epoch=1=========
Validation:
=============Textual/Abt-Buy==================
accuracy=0.892
precision=0.000
recall=0.000
f1=0.000
======================================
Test:
=============Textual/Abt-Buy==================
accuracy=0.892
precision=0.000
recall=0.000
f1=0.000
======================================
/w/246/tianyu2020/miniconda2/envs/ditto/lib/python3.7/site-packages/apex/amp/_initialize.py:24: UserWarning: An input tensor was not cuda.
  warnings.warn("An input tensor was not cuda.")
/w/246/tianyu2020/miniconda2/envs/ditto/lib/python3.7/site-packages/torch/optim/lr_scheduler.py:122: UserWarning: Detected call of `lr_scheduler.step()` before `optimizer.step()`. In PyTorch 1.1.0 and later, you should call them in the opposite order: `optimizer.step()` before `lr_scheduler.step()`.  Failure to do this will result in PyTorch skipping the first value of the learning rate schedule. See more details at https://pytorch.org/docs/stable/optim.html#how-to-adjust-learning-rate
  "https://pytorch.org/docs/stable/optim.html#how-to-adjust-learning-rate", UserWarning)
/w/246/tianyu2020/miniconda2/envs/ditto/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1221: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
=====sanity check======
words: COL name VAL lg titanium bottom-freezer refrigerator lrbp1031tt COL description VAL lg 10 cu . ft.titanium bottom-freezer refrigerator lrbp1031tt 2 tempered glass shelves 3 see-thru freezer drawers with ice trays 2 vegetable crispers electronic temperature controls multi-air flow cooling quick freezing drawer door open alarm energy saving vacation mode COL price VAL   [SEP] COL name VAL lg 24.7 cu . ft. stainless steel french door bottom mount refrigerator COL description VAL  COL price VAL  
x: [    0 18047   766 27445   784   571 35216  2576    12  3743  6403 25572
   784 20815   642   698  2983  5967 14857  8194 27445   784   571   158
  3729   479 16935     4    90   405 42649  2576    12  3743  6403 25572
   784 20815   642   698  2983  5967   132 31380  4049 14169   155   192
    12   212  2070 26430  2451   268    19  2480  2664  4113   132 16090
 37968 16414  5175  5181  5656  3228    12  2456  3041 13281  2119 11074
 31807  1883   490  8054  1007  6549  7196  5745 14857   425 27445  1437
  1437     2     2 18047   766 27445   784   571   706     4   406  3729
   479 16935     4 23486  3689 41259  1883  2576 14206 25572 14857  8194
 27445  1437 14857   425 27445  1437  1437     2]
tokens: ['<s>', 'COL', 'Ġname', 'ĠVAL', 'Ġl', 'g', 'Ġtitanium', 'Ġbottom', '-', 'free', 'zer', 'Ġrefrigerator', 'Ġl', 'rb', 'p', '10', '31', 'tt', 'ĠCOL', 'Ġdescription', 'ĠVAL', 'Ġl', 'g', 'Ġ10', 'Ġcu', 'Ġ.', 'Ġft', '.', 't', 'it', 'anium', 'Ġbottom', '-', 'free', 'zer', 'Ġrefrigerator', 'Ġl', 'rb', 'p', '10', '31', 'tt', 'Ġ2', 'Ġtempered', 'Ġglass', 'Ġshelves', 'Ġ3', 'Ġsee', '-', 'th', 'ru', 'Ġfreezer', 'Ġdraw', 'ers', 'Ġwith', 'Ġice', 'Ġtr', 'ays', 'Ġ2', 'Ġvegetable', 'Ġcris', 'pers', 'Ġelectronic', 'Ġtemperature', 'Ġcontrols', 'Ġmulti', '-', 'air', 'Ġflow', 'Ġcooling', 'Ġquick', 'Ġfreezing', 'Ġdrawer', 'Ġdoor', 'Ġopen', 'Ġalarm', 'Ġenergy', 'Ġsaving', 'Ġvacation', 'Ġmode', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ', 'Ġ', '</s>', '</s>', 'COL', 'Ġname', 'ĠVAL', 'Ġl', 'g', 'Ġ24', '.', '7', 'Ġcu', 'Ġ.', 'Ġft', '.', 'Ġstainless', 'Ġsteel', 'Ġfrench', 'Ġdoor', 'Ġbottom', 'Ġmount', 'Ġrefrigerator', 'ĠCOL', 'Ġdescription', 'ĠVAL', 'Ġ', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ', 'Ġ', '</s>']
is_heads: [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
y: 0
tags: 0
mask: tensor([1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1])
seqlen: 116
task_name: Textual/Abt-Buy
=======================
step: 0, task: Textual/Abt-Buy, loss: 0.36998406052589417
step: 10, task: Textual/Abt-Buy, loss: 0.14418309926986694
step: 20, task: Textual/Abt-Buy, loss: 0.3628048598766327
step: 30, task: Textual/Abt-Buy, loss: 0.39430129528045654
step: 40, task: Textual/Abt-Buy, loss: 0.09234598278999329
step: 50, task: Textual/Abt-Buy, loss: 0.09646997600793839
step: 60, task: Textual/Abt-Buy, loss: 0.6442586779594421
step: 70, task: Textual/Abt-Buy, loss: 0.38513460755348206
step: 80, task: Textual/Abt-Buy, loss: 0.33967354893684387
step: 90, task: Textual/Abt-Buy, loss: 0.3756139576435089
step: 100, task: Textual/Abt-Buy, loss: 0.23400965332984924
step: 110, task: Textual/Abt-Buy, loss: 0.44266098737716675
step: 120, task: Textual/Abt-Buy, loss: 0.2752273976802826
step: 130, task: Textual/Abt-Buy, loss: 0.5536813139915466
step: 140, task: Textual/Abt-Buy, loss: 0.2470092475414276
step: 150, task: Textual/Abt-Buy, loss: 0.4721829295158386
step: 160, task: Textual/Abt-Buy, loss: 0.3761219084262848
step: 170, task: Textual/Abt-Buy, loss: 0.22462746500968933
step: 180, task: Textual/Abt-Buy, loss: 0.3417128920555115
step: 190, task: Textual/Abt-Buy, loss: 0.39832445979118347
step: 200, task: Textual/Abt-Buy, loss: 0.4671216607093811
step: 210, task: Textual/Abt-Buy, loss: 0.05791202932596207
step: 220, task: Textual/Abt-Buy, loss: 0.2339775264263153
step: 230, task: Textual/Abt-Buy, loss: 0.1786317229270935
step: 240, task: Textual/Abt-Buy, loss: 0.14838382601737976
step: 250, task: Textual/Abt-Buy, loss: 0.2009916454553604
step: 260, task: Textual/Abt-Buy, loss: 0.5074212551116943
step: 270, task: Textual/Abt-Buy, loss: 0.08026448637247086
step: 280, task: Textual/Abt-Buy, loss: 0.1356465369462967
step: 290, task: Textual/Abt-Buy, loss: 0.2282526046037674
step: 300, task: Textual/Abt-Buy, loss: 0.3405725657939911
step: 310, task: Textual/Abt-Buy, loss: 0.14810369908809662
step: 320, task: Textual/Abt-Buy, loss: 0.30467963218688965
step: 330, task: Textual/Abt-Buy, loss: 0.26378333568573
step: 340, task: Textual/Abt-Buy, loss: 0.04571886360645294
step: 350, task: Textual/Abt-Buy, loss: 0.13936221599578857
=========eval at epoch=1=========
Validation:
=============Textual/Abt-Buy==================
accuracy=0.932
precision=0.678
recall=0.704
f1=0.690
======================================
Test:
=============Textual/Abt-Buy==================
accuracy=0.930
precision=0.665
recall=0.694
f1=0.679
======================================
=====sanity check======
words: COL name VAL sony bud style headphones in black mdrex85lpblk COL description VAL sony bud style headphones in black mdrex85lpblk 13.5 mm drivers super-light weight studio monitor quality soft silicone earbuds gold-plated mini plug 3.9 ft. cord length frequency response of 5-24 ,000 hz black finish COL price VAL   [SEP] COL name VAL sony mdrex81lp comfort fit ear hanger headphones - choose color ( black ) COL description VAL  COL price VAL  
x: [    0 18047   766 27445   579  6119 18464  2496 15684    11   909 46627
 19633  4531 39031  3662   330 14857  8194 27445   579  6119 18464  2496
 15684    11   909 46627 19633  4531 39031  3662   330   508     4   245
 15408  2377  2422    12  6991  2408  4535  5271  1318  3793 35453  5567
   428 23082  1637    12  2911  1070  7983 10242   155     4   466 16935
     4 13051  5933 13135  1263     9   195    12  1978  2156   151  1368
   329   909  2073 14857   425 27445  1437  1437     2     2 18047   766
 27445   579  6119 46627 19633  6668 39031  5863  2564  5567  1368  8395
 15684   111  2807  3195    36   909  4839 14857  8194 27445  1437 14857
   425 27445  1437  1437     2]
tokens: ['<s>', 'COL', 'Ġname', 'ĠVAL', 'Ġs', 'ony', 'Ġbud', 'Ġstyle', 'Ġheadphones', 'Ġin', 'Ġblack', 'Ġmd', 'rex', '85', 'lp', 'bl', 'k', 'ĠCOL', 'Ġdescription', 'ĠVAL', 'Ġs', 'ony', 'Ġbud', 'Ġstyle', 'Ġheadphones', 'Ġin', 'Ġblack', 'Ġmd', 'rex', '85', 'lp', 'bl', 'k', 'Ġ13', '.', '5', 'Ġmm', 'Ġdrivers', 'Ġsuper', '-', 'light', 'Ġweight', 'Ġstudio', 'Ġmonitor', 'Ġquality', 'Ġsoft', 'Ġsilicone', 'Ġear', 'b', 'uds', 'Ġgold', '-', 'pl', 'ated', 'Ġmini', 'Ġplug', 'Ġ3', '.', '9', 'Ġft', '.', 'Ġcord', 'Ġlength', 'Ġfrequency', 'Ġresponse', 'Ġof', 'Ġ5', '-', '24', 'Ġ,', '000', 'Ġh', 'z', 'Ġblack', 'Ġfinish', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ', 'Ġ', '</s>', '</s>', 'COL', 'Ġname', 'ĠVAL', 'Ġs', 'ony', 'Ġmd', 'rex', '81', 'lp', 'Ġcomfort', 'Ġfit', 'Ġear', 'Ġh', 'anger', 'Ġheadphones', 'Ġ-', 'Ġchoose', 'Ġcolor', 'Ġ(', 'Ġblack', 'Ġ)', 'ĠCOL', 'Ġdescription', 'ĠVAL', 'Ġ', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ', 'Ġ', '</s>']
is_heads: [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
y: 1
tags: 1
mask: tensor([1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1])
seqlen: 113
task_name: Textual/Abt-Buy
=======================
step: 0, task: Textual/Abt-Buy, loss: 0.5028154253959656
step: 10, task: Textual/Abt-Buy, loss: 0.03731278330087662
step: 20, task: Textual/Abt-Buy, loss: 0.018222399055957794
step: 30, task: Textual/Abt-Buy, loss: 0.010218024253845215
step: 40, task: Textual/Abt-Buy, loss: 0.3644435703754425
step: 50, task: Textual/Abt-Buy, loss: 0.06150324270129204
step: 60, task: Textual/Abt-Buy, loss: 0.025700457394123077
step: 70, task: Textual/Abt-Buy, loss: 0.019216477870941162
step: 80, task: Textual/Abt-Buy, loss: 0.2573291063308716
step: 90, task: Textual/Abt-Buy, loss: 0.014642998576164246
step: 100, task: Textual/Abt-Buy, loss: 0.035895250737667084
step: 110, task: Textual/Abt-Buy, loss: 0.3832525610923767
step: 120, task: Textual/Abt-Buy, loss: 0.020481958985328674
step: 130, task: Textual/Abt-Buy, loss: 0.03445550054311752
step: 140, task: Textual/Abt-Buy, loss: 0.5201285481452942
step: 150, task: Textual/Abt-Buy, loss: 0.20779086649417877
step: 160, task: Textual/Abt-Buy, loss: 0.10043448209762573
step: 170, task: Textual/Abt-Buy, loss: 0.20378607511520386
step: 180, task: Textual/Abt-Buy, loss: 0.014092333614826202
step: 190, task: Textual/Abt-Buy, loss: 0.09236155450344086
step: 200, task: Textual/Abt-Buy, loss: 0.03222699463367462
step: 210, task: Textual/Abt-Buy, loss: 0.23261727392673492
step: 220, task: Textual/Abt-Buy, loss: 0.39117100834846497
step: 230, task: Textual/Abt-Buy, loss: 0.05166228860616684
step: 240, task: Textual/Abt-Buy, loss: 0.039308786392211914
step: 250, task: Textual/Abt-Buy, loss: 0.2277546525001526
step: 260, task: Textual/Abt-Buy, loss: 0.062315747141838074
step: 270, task: Textual/Abt-Buy, loss: 0.016618654131889343
step: 280, task: Textual/Abt-Buy, loss: 0.019975125789642334
step: 290, task: Textual/Abt-Buy, loss: 0.012419164180755615
step: 300, task: Textual/Abt-Buy, loss: 0.0518585704267025
step: 310, task: Textual/Abt-Buy, loss: 0.06752720475196838
step: 320, task: Textual/Abt-Buy, loss: 0.047503381967544556
step: 330, task: Textual/Abt-Buy, loss: 0.011627048254013062
step: 340, task: Textual/Abt-Buy, loss: 0.09239763766527176
step: 350, task: Textual/Abt-Buy, loss: 0.013952098786830902
=========eval at epoch=2=========
Validation:
=============Textual/Abt-Buy==================
accuracy=0.945
precision=0.869
recall=0.578
f1=0.694
======================================
Test:
=============Textual/Abt-Buy==================
accuracy=0.949
precision=0.852
recall=0.641
f1=0.731
======================================
=====sanity check======
words: COL name VAL samsung 42 ' black flat panel series 4 plasma hdtv pn42a450p COL description VAL samsung 42 ' black flat panel series 4 plasma hdtv pn42a450p 1024 x 768p resolution 1,000,000:1 dynamic contrast ratio filterbright anti glare filter dnie technology acesilhouette editor anti burn-in technology 3d technology srs trusurround xt atsc/ntsc/clear qam built-in tuners black finish COL price VAL   [SEP] COL name VAL samsung 4 series ln22a451 22 ' lcd tv COL description VAL samsung ln22a451 22 ' widescreen lcd hdtv 3,000:1 dynamic contrast ratio 8ms response time white COL price VAL 399.0 
x: [    0 18047   766 27445   579 48545  3330   128   909  3269  2798   651
   204 29051  1368   417 18724   181   282  3714   102 13872   642 14857
  8194 27445   579 48545  3330   128   909  3269  2798   651   204 29051
  1368   417 18724   181   282  3714   102 13872   642 46959  3023 43751
   642  3547   112     6   151     6   151    35   134  6878  5709  1750
 14929 23471  1475 37355 14929   385  7468   806    10  4643   718 24181
  3398  4474  1475  7403    12   179   806   155   417   806   579  4926
  2664   687   710  3431  1437 11483    23  3866    73  3999  3866    73
 18763  2231   424  1490    12   179 27115   268   909  2073 14857   425
 27445  1437  1437     2     2 18047   766 27445   579 48545   204   651
   784   282  2036   102 36860   820   128   784 28690 30016 14857  8194
 27445   579 48545   784   282  2036   102 36860   820   128   885  4376
 37346   784 28690  1368   417 18724   155     6   151    35   134  6878
  5709  1750   290  4339  1263    86  1104 14857   425 27445 41279     4
   288  1437     2]
tokens: ['<s>', 'COL', 'Ġname', 'ĠVAL', 'Ġs', 'amsung', 'Ġ42', "Ġ'", 'Ġblack', 'Ġflat', 'Ġpanel', 'Ġseries', 'Ġ4', 'Ġplasma', 'Ġh', 'd', 'tv', 'Ġp', 'n', '42', 'a', '450', 'p', 'ĠCOL', 'Ġdescription', 'ĠVAL', 'Ġs', 'amsung', 'Ġ42', "Ġ'", 'Ġblack', 'Ġflat', 'Ġpanel', 'Ġseries', 'Ġ4', 'Ġplasma', 'Ġh', 'd', 'tv', 'Ġp', 'n', '42', 'a', '450', 'p', 'Ġ1024', 'Ġx', 'Ġ768', 'p', 'Ġresolution', 'Ġ1', ',', '000', ',', '000', ':', '1', 'Ġdynamic', 'Ġcontrast', 'Ġratio', 'Ġfilter', 'bright', 'Ġanti', 'Ġglare', 'Ġfilter', 'Ġd', 'nie', 'Ġtechnology', 'Ġa', 'ces', 'il', 'hou', 'ette', 'Ġeditor', 'Ġanti', 'Ġburn', '-', 'in', 'Ġtechnology', 'Ġ3', 'd', 'Ġtechnology', 'Ġs', 'rs', 'Ġtr', 'us', 'ur', 'round', 'Ġ', 'xt', 'Ġat', 'sc', '/', 'nt', 'sc', '/', 'clear', 'Ġq', 'am', 'Ġbuilt', '-', 'in', 'Ġtun', 'ers', 'Ġblack', 'Ġfinish', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ', 'Ġ', '</s>', '</s>', 'COL', 'Ġname', 'ĠVAL', 'Ġs', 'amsung', 'Ġ4', 'Ġseries', 'Ġl', 'n', '22', 'a', '451', 'Ġ22', "Ġ'", 'Ġl', 'cd', 'Ġtv', 'ĠCOL', 'Ġdescription', 'ĠVAL', 'Ġs', 'amsung', 'Ġl', 'n', '22', 'a', '451', 'Ġ22', "Ġ'", 'Ġw', 'ides', 'creen', 'Ġl', 'cd', 'Ġh', 'd', 'tv', 'Ġ3', ',', '000', ':', '1', 'Ġdynamic', 'Ġcontrast', 'Ġratio', 'Ġ8', 'ms', 'Ġresponse', 'Ġtime', 'Ġwhite', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ399', '.', '0', 'Ġ', '</s>']
is_heads: [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
y: 0
tags: 0
mask: tensor([1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1])
seqlen: 171
task_name: Textual/Abt-Buy
=======================
step: 0, task: Textual/Abt-Buy, loss: 0.013944439589977264
step: 10, task: Textual/Abt-Buy, loss: 0.0884343683719635
step: 20, task: Textual/Abt-Buy, loss: 0.0038695186376571655
step: 30, task: Textual/Abt-Buy, loss: 0.053807567805051804
step: 40, task: Textual/Abt-Buy, loss: 0.425439715385437
step: 50, task: Textual/Abt-Buy, loss: 0.051479823887348175
step: 60, task: Textual/Abt-Buy, loss: 0.013089090585708618
step: 70, task: Textual/Abt-Buy, loss: 0.04801258444786072
step: 80, task: Textual/Abt-Buy, loss: 0.004893921315670013
step: 90, task: Textual/Abt-Buy, loss: 0.025815285742282867
step: 100, task: Textual/Abt-Buy, loss: 0.03575309365987778
step: 110, task: Textual/Abt-Buy, loss: 0.0027923285961151123
step: 120, task: Textual/Abt-Buy, loss: 0.6759790182113647
step: 130, task: Textual/Abt-Buy, loss: 0.08537747710943222
step: 140, task: Textual/Abt-Buy, loss: 0.09585234522819519
step: 150, task: Textual/Abt-Buy, loss: 0.46368712186813354
step: 160, task: Textual/Abt-Buy, loss: 0.14277298748493195
step: 170, task: Textual/Abt-Buy, loss: 0.026712913066148758
step: 180, task: Textual/Abt-Buy, loss: 0.002821490168571472
step: 190, task: Textual/Abt-Buy, loss: 0.15399599075317383
step: 200, task: Textual/Abt-Buy, loss: 0.00041781365871429443
step: 210, task: Textual/Abt-Buy, loss: 0.045636773109436035
step: 220, task: Textual/Abt-Buy, loss: 0.3221540153026581
step: 230, task: Textual/Abt-Buy, loss: 0.002492770552635193
step: 240, task: Textual/Abt-Buy, loss: 0.03491354361176491
step: 250, task: Textual/Abt-Buy, loss: 0.14803797006607056
step: 260, task: Textual/Abt-Buy, loss: 0.10298223793506622
step: 270, task: Textual/Abt-Buy, loss: 0.01729065552353859
step: 280, task: Textual/Abt-Buy, loss: 0.11634696274995804
step: 290, task: Textual/Abt-Buy, loss: 0.07460004836320877
step: 300, task: Textual/Abt-Buy, loss: 0.0968087837100029
step: 310, task: Textual/Abt-Buy, loss: 0.014989536255598068
step: 320, task: Textual/Abt-Buy, loss: 0.0175410695374012
step: 330, task: Textual/Abt-Buy, loss: 0.0839407742023468
step: 340, task: Textual/Abt-Buy, loss: 0.19214467704296112
step: 350, task: Textual/Abt-Buy, loss: 0.0494142584502697
=========eval at epoch=3=========
Validation:
=============Textual/Abt-Buy==================
accuracy=0.938
precision=0.922
recall=0.461
f1=0.615
======================================
Test:
=============Textual/Abt-Buy==================
accuracy=0.945
precision=0.932
recall=0.529
f1=0.675
======================================
=====sanity check======
words: COL name VAL sony digital photo printer paper 120 pack svmf120p COL description VAL sony digital photo printer paper 120 pack svmf120p 4 ' x 6 ' print paper with snap-off edges super coat 2 protective lamination water damage and fingerprint resistant prints 120 sheets of paper and print ribbon for dppf series digital photo printers only COL price VAL 35.0  [SEP] COL name VAL sony ribbon and paper with snap-off edges for dpp-fp50 digital photo printer svmf120p COL description VAL ribbon , sheet COL price VAL  
x: [    0 18047   766 27445   579  6119  1778  1345 24079  2225  5962  6356
   579 38486   506 10213   642 14857  8194 27445   579  6119  1778  1345
 24079  2225  5962  6356   579 38486   506 10213   642   204   128  3023
   231   128  5780  2225    19  6788    12  1529 15716  2422  9540   132
 11775   784 41121   514  1880     8 15406 19152 19553  5962 12208     9
  2225     8  5780 21041    13   385  3807   506   651  1778  1345 29379
   129 14857   425 27445  1718     4   288  1437     2     2 18047   766
 27445   579  6119 21041     8  2225    19  6788    12  1529 15716    13
   385  3807    12 46004  1096  1778  1345 24079   579 38486   506 10213
   642 14857  8194 27445 21041  2156  5462 14857   425 27445  1437  1437
     2]
tokens: ['<s>', 'COL', 'Ġname', 'ĠVAL', 'Ġs', 'ony', 'Ġdigital', 'Ġphoto', 'Ġprinter', 'Ġpaper', 'Ġ120', 'Ġpack', 'Ġs', 'vm', 'f', '120', 'p', 'ĠCOL', 'Ġdescription', 'ĠVAL', 'Ġs', 'ony', 'Ġdigital', 'Ġphoto', 'Ġprinter', 'Ġpaper', 'Ġ120', 'Ġpack', 'Ġs', 'vm', 'f', '120', 'p', 'Ġ4', "Ġ'", 'Ġx', 'Ġ6', "Ġ'", 'Ġprint', 'Ġpaper', 'Ġwith', 'Ġsnap', '-', 'off', 'Ġedges', 'Ġsuper', 'Ġcoat', 'Ġ2', 'Ġprotective', 'Ġl', 'amination', 'Ġwater', 'Ġdamage', 'Ġand', 'Ġfingerprint', 'Ġresistant', 'Ġprints', 'Ġ120', 'Ġsheets', 'Ġof', 'Ġpaper', 'Ġand', 'Ġprint', 'Ġribbon', 'Ġfor', 'Ġd', 'pp', 'f', 'Ġseries', 'Ġdigital', 'Ġphoto', 'Ġprinters', 'Ġonly', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ35', '.', '0', 'Ġ', '</s>', '</s>', 'COL', 'Ġname', 'ĠVAL', 'Ġs', 'ony', 'Ġribbon', 'Ġand', 'Ġpaper', 'Ġwith', 'Ġsnap', '-', 'off', 'Ġedges', 'Ġfor', 'Ġd', 'pp', '-', 'fp', '50', 'Ġdigital', 'Ġphoto', 'Ġprinter', 'Ġs', 'vm', 'f', '120', 'p', 'ĠCOL', 'Ġdescription', 'ĠVAL', 'Ġribbon', 'Ġ,', 'Ġsheet', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ', 'Ġ', '</s>']
is_heads: [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
y: 1
tags: 1
mask: tensor([1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1])
seqlen: 121
task_name: Textual/Abt-Buy
=======================
step: 0, task: Textual/Abt-Buy, loss: 0.02709610015153885
step: 10, task: Textual/Abt-Buy, loss: 0.003245808184146881
step: 20, task: Textual/Abt-Buy, loss: 0.004674628376960754
step: 30, task: Textual/Abt-Buy, loss: 0.005813136696815491
step: 40, task: Textual/Abt-Buy, loss: 0.02090083435177803
step: 50, task: Textual/Abt-Buy, loss: 0.004893101751804352
step: 60, task: Textual/Abt-Buy, loss: 0.025746643543243408
step: 70, task: Textual/Abt-Buy, loss: 0.016173452138900757
step: 80, task: Textual/Abt-Buy, loss: 0.1291409134864807
step: 90, task: Textual/Abt-Buy, loss: 0.02177528291940689
step: 100, task: Textual/Abt-Buy, loss: 0.0138009712100029
step: 110, task: Textual/Abt-Buy, loss: 0.0010547041893005371
step: 120, task: Textual/Abt-Buy, loss: 0.008632473647594452
step: 130, task: Textual/Abt-Buy, loss: 0.008022315800189972
step: 140, task: Textual/Abt-Buy, loss: 0.011674359440803528
step: 150, task: Textual/Abt-Buy, loss: 0.03131939098238945
step: 160, task: Textual/Abt-Buy, loss: 0.004157707095146179
step: 170, task: Textual/Abt-Buy, loss: 0.0011386573314666748
step: 180, task: Textual/Abt-Buy, loss: 0.000516161322593689
step: 190, task: Textual/Abt-Buy, loss: 0.08821018785238266
step: 200, task: Textual/Abt-Buy, loss: 0.04027393460273743
step: 210, task: Textual/Abt-Buy, loss: 0.004737108945846558
step: 220, task: Textual/Abt-Buy, loss: 0.0009670257568359375
step: 230, task: Textual/Abt-Buy, loss: 0.002374604344367981
step: 240, task: Textual/Abt-Buy, loss: 0.0004646480083465576
step: 250, task: Textual/Abt-Buy, loss: 0.026961755007505417
step: 260, task: Textual/Abt-Buy, loss: 0.030032366514205933
step: 270, task: Textual/Abt-Buy, loss: 0.011182248592376709
step: 280, task: Textual/Abt-Buy, loss: 0.0007062405347824097
step: 290, task: Textual/Abt-Buy, loss: 0.021196477115154266
step: 300, task: Textual/Abt-Buy, loss: 0.0009040087461471558
step: 310, task: Textual/Abt-Buy, loss: 0.024826914072036743
step: 320, task: Textual/Abt-Buy, loss: 0.008604004979133606
step: 330, task: Textual/Abt-Buy, loss: 0.003719225525856018
step: 340, task: Textual/Abt-Buy, loss: 0.0045142099261283875
step: 350, task: Textual/Abt-Buy, loss: 0.09766009449958801
=========eval at epoch=4=========
Validation:
=============Textual/Abt-Buy==================
accuracy=0.944
precision=0.938
recall=0.515
f1=0.665
======================================
Test:
=============Textual/Abt-Buy==================
accuracy=0.948
precision=0.957
recall=0.544
f1=0.693
======================================
=====sanity check======
words: COL name VAL toshiba 19 ' black lcd hdtv with built in dvd player 19lv505 COL description VAL toshiba 19 ' lcd hdtv with built in dvd player 19lv505 built-in slot loading dvd player built-in atsc/ntsc/qam digital tuning official divx ® certified jpeg viewer bottom mount stereo speakers black finish COL price VAL   [SEP] COL name VAL toshiba 42rv535u 42 ' widescreen 1080p lcd hdtv w / cinespeed piano black COL description VAL  COL price VAL 789.98 
x: [    0 18047   766 27445     7  1193 15577   753   128   909   784 28690
  1368   417 18724    19  1490    11   385 40311   869   753 25091 35255
 14857  8194 27445     7  1193 15577   753   128   784 28690  1368   417
 18724    19  1490    11   385 40311   869   753 25091 35255  1490    12
   179  8534 16761   385 40311   869  1490    12   179    23  3866    73
  3999  3866    73  1343   424  1778 28927   781 14445  1178 39110  9785
  1236 41191 18754  2576 14206 31436  6864   909  2073 14857   425 27445
  1437  1437     2     2 18047   766 27445     7  1193 15577  3330   338
   705 37020   257  3330   128   885  4376 37346 21083   642   784 28690
  1368   417 18724   885  1589   740  3141 39640 13305   909 14857  8194
 27445  1437 14857   425 27445   262  5046     4  5208  1437     2]
tokens: ['<s>', 'COL', 'Ġname', 'ĠVAL', 'Ġto', 'sh', 'iba', 'Ġ19', "Ġ'", 'Ġblack', 'Ġl', 'cd', 'Ġh', 'd', 'tv', 'Ġwith', 'Ġbuilt', 'Ġin', 'Ġd', 'vd', 'Ġplayer', 'Ġ19', 'lv', '505', 'ĠCOL', 'Ġdescription', 'ĠVAL', 'Ġto', 'sh', 'iba', 'Ġ19', "Ġ'", 'Ġl', 'cd', 'Ġh', 'd', 'tv', 'Ġwith', 'Ġbuilt', 'Ġin', 'Ġd', 'vd', 'Ġplayer', 'Ġ19', 'lv', '505', 'Ġbuilt', '-', 'in', 'Ġslot', 'Ġloading', 'Ġd', 'vd', 'Ġplayer', 'Ġbuilt', '-', 'in', 'Ġat', 'sc', '/', 'nt', 'sc', '/', 'q', 'am', 'Ġdigital', 'Ġtuning', 'Ġofficial', 'Ġdiv', 'x', 'ĠÂ®', 'Ġcertified', 'Ġj', 'peg', 'Ġviewer', 'Ġbottom', 'Ġmount', 'Ġstereo', 'Ġspeakers', 'Ġblack', 'Ġfinish', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ', 'Ġ', '</s>', '</s>', 'COL', 'Ġname', 'ĠVAL', 'Ġto', 'sh', 'iba', 'Ġ42', 'r', 'v', '535', 'u', 'Ġ42', "Ġ'", 'Ġw', 'ides', 'creen', 'Ġ1080', 'p', 'Ġl', 'cd', 'Ġh', 'd', 'tv', 'Ġw', 'Ġ/', 'Ġc', 'ines', 'peed', 'Ġpiano', 'Ġblack', 'ĠCOL', 'Ġdescription', 'ĠVAL', 'Ġ', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ7', '89', '.', '98', 'Ġ', '</s>']
is_heads: [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
y: 0
tags: 0
mask: tensor([1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1])
seqlen: 131
task_name: Textual/Abt-Buy
=======================
step: 0, task: Textual/Abt-Buy, loss: 0.0007894337177276611
step: 10, task: Textual/Abt-Buy, loss: 0.01609448343515396
step: 20, task: Textual/Abt-Buy, loss: 0.002269059419631958
step: 30, task: Textual/Abt-Buy, loss: 0.00015267729759216309
step: 40, task: Textual/Abt-Buy, loss: 0.0024241507053375244
step: 50, task: Textual/Abt-Buy, loss: 0.001123666763305664
step: 60, task: Textual/Abt-Buy, loss: 0.12902267277240753
step: 70, task: Textual/Abt-Buy, loss: 0.014128245413303375
step: 80, task: Textual/Abt-Buy, loss: 0.02363857626914978
step: 90, task: Textual/Abt-Buy, loss: 0.0018452554941177368
step: 100, task: Textual/Abt-Buy, loss: 0.004992388188838959
step: 110, task: Textual/Abt-Buy, loss: 0.0006573796272277832
step: 120, task: Textual/Abt-Buy, loss: 0.007486514747142792
step: 130, task: Textual/Abt-Buy, loss: 0.0032736361026763916
step: 140, task: Textual/Abt-Buy, loss: 0.002375669777393341
step: 150, task: Textual/Abt-Buy, loss: 0.007566165179014206
step: 160, task: Textual/Abt-Buy, loss: 0.0009189248085021973
step: 170, task: Textual/Abt-Buy, loss: 0.002782382071018219
step: 180, task: Textual/Abt-Buy, loss: 0.00019370019435882568
step: 190, task: Textual/Abt-Buy, loss: 0.0002799779176712036
step: 200, task: Textual/Abt-Buy, loss: 0.005309373140335083
step: 210, task: Textual/Abt-Buy, loss: 0.013731628656387329
step: 220, task: Textual/Abt-Buy, loss: 0.0004040747880935669
step: 230, task: Textual/Abt-Buy, loss: 0.0004097968339920044
step: 240, task: Textual/Abt-Buy, loss: 8.916854858398438e-05
step: 250, task: Textual/Abt-Buy, loss: 0.011134479194879532
step: 260, task: Textual/Abt-Buy, loss: 0.024172089993953705
step: 270, task: Textual/Abt-Buy, loss: 0.0004734843969345093
step: 280, task: Textual/Abt-Buy, loss: 0.00032061338424682617
step: 290, task: Textual/Abt-Buy, loss: 0.0029939264059066772
step: 300, task: Textual/Abt-Buy, loss: 0.0005206018686294556
step: 310, task: Textual/Abt-Buy, loss: 0.0006850659847259521
step: 320, task: Textual/Abt-Buy, loss: 0.0018163174390792847
step: 330, task: Textual/Abt-Buy, loss: 0.0009789615869522095
step: 340, task: Textual/Abt-Buy, loss: 0.027283743023872375
step: 350, task: Textual/Abt-Buy, loss: 0.0007943511009216309
=========eval at epoch=5=========
Validation:
=============Textual/Abt-Buy==================
accuracy=0.933
precision=0.975
recall=0.383
f1=0.551
======================================
Test:
=============Textual/Abt-Buy==================
accuracy=0.932
precision=0.987
recall=0.369
f1=0.537
======================================
=====sanity check======
words: COL name VAL samsung minidv digital camcorder scdc382 COL description VAL samsung minidv digital camcorder scdc382 680k pixel ccd 34x zoom lens 720 x 480 pixel movie resolution digital image stabilizer 23 language options 80 minute battery life COL price VAL   [SEP] COL name VAL sony handycam dcr-hc52 digital camcorder dcrhc52 COL description VAL 16:9 2.5 ' color lcd COL price VAL 229.0 
x: [    0 18047   766 27445   579 48545  5251   808   705  1778 11021   438
 10337  2850 34836 35178 14857  8194 27445   579 48545  5251   808   705
  1778 11021   438 10337  2850 34836 35178 37326   330 29597   740 28690
  2631  1178 21762 10373 26180  3023 26754 29597  1569  3547  1778  2274
 12964  6315   883  2777  1735  1812  2289  3822   301 14857   425 27445
  1437  1437     2     2 18047   766 27445   579  6119 14732 16767   385
  8344    12   298   438  4429  1778 11021   438 10337   385  8344   298
   438  4429 14857  8194 27445   545    35   466   132     4   245   128
  3195   784 28690 14857   425 27445 26972     4   288  1437     2]
tokens: ['<s>', 'COL', 'Ġname', 'ĠVAL', 'Ġs', 'amsung', 'Ġmin', 'id', 'v', 'Ġdigital', 'Ġcam', 'c', 'order', 'Ġsc', 'dc', '382', 'ĠCOL', 'Ġdescription', 'ĠVAL', 'Ġs', 'amsung', 'Ġmin', 'id', 'v', 'Ġdigital', 'Ġcam', 'c', 'order', 'Ġsc', 'dc', '382', 'Ġ680', 'k', 'Ġpixel', 'Ġc', 'cd', 'Ġ34', 'x', 'Ġzoom', 'Ġlens', 'Ġ720', 'Ġx', 'Ġ480', 'Ġpixel', 'Ġmovie', 'Ġresolution', 'Ġdigital', 'Ġimage', 'Ġstabil', 'izer', 'Ġ23', 'Ġlanguage', 'Ġoptions', 'Ġ80', 'Ġminute', 'Ġbattery', 'Ġlife', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ', 'Ġ', '</s>', '</s>', 'COL', 'Ġname', 'ĠVAL', 'Ġs', 'ony', 'Ġhandy', 'cam', 'Ġd', 'cr', '-', 'h', 'c', '52', 'Ġdigital', 'Ġcam', 'c', 'order', 'Ġd', 'cr', 'h', 'c', '52', 'ĠCOL', 'Ġdescription', 'ĠVAL', 'Ġ16', ':', '9', 'Ġ2', '.', '5', "Ġ'", 'Ġcolor', 'Ġl', 'cd', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ229', '.', '0', 'Ġ', '</s>']
is_heads: [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
y: 0
tags: 0
mask: tensor([1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1])
seqlen: 107
task_name: Textual/Abt-Buy
=======================
step: 0, task: Textual/Abt-Buy, loss: 0.0009508728981018066
step: 10, task: Textual/Abt-Buy, loss: 0.011478930711746216
step: 20, task: Textual/Abt-Buy, loss: 0.0007447302341461182
step: 30, task: Textual/Abt-Buy, loss: 0.0009301751852035522
step: 40, task: Textual/Abt-Buy, loss: 0.0005384832620620728
step: 50, task: Textual/Abt-Buy, loss: 0.0049000754952430725
step: 60, task: Textual/Abt-Buy, loss: 0.00044348835945129395
step: 70, task: Textual/Abt-Buy, loss: 0.0036522820591926575
step: 80, task: Textual/Abt-Buy, loss: 0.0007057338953018188
step: 90, task: Textual/Abt-Buy, loss: 0.002788044512271881
step: 100, task: Textual/Abt-Buy, loss: 0.0018168985843658447
step: 110, task: Textual/Abt-Buy, loss: 0.0016470402479171753
step: 120, task: Textual/Abt-Buy, loss: 0.010771851986646652
step: 130, task: Textual/Abt-Buy, loss: 0.059628404676914215
step: 140, task: Textual/Abt-Buy, loss: 0.0013467371463775635
step: 150, task: Textual/Abt-Buy, loss: 0.036765702068805695
step: 160, task: Textual/Abt-Buy, loss: 0.0005216598510742188
step: 170, task: Textual/Abt-Buy, loss: 0.0002021491527557373
step: 180, task: Textual/Abt-Buy, loss: 0.008048929274082184
step: 190, task: Textual/Abt-Buy, loss: 0.00011026859283447266
step: 200, task: Textual/Abt-Buy, loss: 0.0011557713150978088
step: 210, task: Textual/Abt-Buy, loss: 0.00019365549087524414
step: 220, task: Textual/Abt-Buy, loss: 0.05578630417585373
step: 230, task: Textual/Abt-Buy, loss: 0.00010961294174194336
step: 240, task: Textual/Abt-Buy, loss: 0.00022362172603607178
step: 250, task: Textual/Abt-Buy, loss: 0.0006448477506637573
step: 260, task: Textual/Abt-Buy, loss: 0.0133286714553833
step: 270, task: Textual/Abt-Buy, loss: 0.00042520463466644287
step: 280, task: Textual/Abt-Buy, loss: 0.00016671419143676758
step: 290, task: Textual/Abt-Buy, loss: 0.10359092056751251
step: 300, task: Textual/Abt-Buy, loss: 0.00015376508235931396
step: 310, task: Textual/Abt-Buy, loss: 0.0007272660732269287
step: 320, task: Textual/Abt-Buy, loss: 0.02360934019088745
step: 330, task: Textual/Abt-Buy, loss: 0.011184245347976685
step: 340, task: Textual/Abt-Buy, loss: 0.00028401613235473633
step: 350, task: Textual/Abt-Buy, loss: 0.016629062592983246
=========eval at epoch=6=========
Validation:
=============Textual/Abt-Buy==================
accuracy=0.953
precision=0.926
recall=0.612
f1=0.737
======================================
Test:
=============Textual/Abt-Buy==================
accuracy=0.955
precision=0.899
recall=0.650
f1=0.755
======================================
=====sanity check======
words: COL name VAL at & t aliph jawbone ii silver bluetooth headset jawbone2s COL description VAL at & t aliph jawbone ii silver bluetooth headset jawbone2s voice activity sensor magnetic usb and wall charger includes 4 different ear loops and 3 ear buds over 4 hours talk time and 8 days standby time supports bluetooth 1.1 , 1.2 and 2.0 silver finish COL price VAL   [SEP] COL name VAL jabra bt2070 bluetooth headset 100-92070000-02 COL description VAL  COL price VAL  
x: [    0 18047   766 27445    23   359   326  1076 28778 15345 18026 42661
  4334 42034 44969 20084 15345 18026   176    29 14857  8194 27445    23
   359   326  1076 28778 15345 18026 42661  4334 42034 44969 20084 15345
 18026   176    29  2236  1940  9626 17512 49030     8  2204 27362  1171
   204   430  5567 37482     8   155  5567 32964    81   204   722  1067
    86     8   290   360 28611    86  4548 42034 44969   112     4   134
  2156   112     4   176     8   132     4   288  4334  2073 14857   425
 27445  1437  1437     2     2 18047   766 27445 27916   763   741    90
   844  3083 42034 44969 20084   727    12   466 22782 14200    12  4197
 14857  8194 27445  1437 14857   425 27445  1437  1437     2]
tokens: ['<s>', 'COL', 'Ġname', 'ĠVAL', 'Ġat', 'Ġ&', 'Ġt', 'Ġal', 'iph', 'Ġjaw', 'bone', 'Ġii', 'Ġsilver', 'Ġblu', 'etooth', 'Ġheadset', 'Ġjaw', 'bone', '2', 's', 'ĠCOL', 'Ġdescription', 'ĠVAL', 'Ġat', 'Ġ&', 'Ġt', 'Ġal', 'iph', 'Ġjaw', 'bone', 'Ġii', 'Ġsilver', 'Ġblu', 'etooth', 'Ġheadset', 'Ġjaw', 'bone', '2', 's', 'Ġvoice', 'Ġactivity', 'Ġsensor', 'Ġmagnetic', 'Ġusb', 'Ġand', 'Ġwall', 'Ġcharger', 'Ġincludes', 'Ġ4', 'Ġdifferent', 'Ġear', 'Ġloops', 'Ġand', 'Ġ3', 'Ġear', 'Ġbuds', 'Ġover', 'Ġ4', 'Ġhours', 'Ġtalk', 'Ġtime', 'Ġand', 'Ġ8', 'Ġdays', 'Ġstandby', 'Ġtime', 'Ġsupports', 'Ġblu', 'etooth', 'Ġ1', '.', '1', 'Ġ,', 'Ġ1', '.', '2', 'Ġand', 'Ġ2', '.', '0', 'Ġsilver', 'Ġfinish', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ', 'Ġ', '</s>', '</s>', 'COL', 'Ġname', 'ĠVAL', 'Ġjab', 'ra', 'Ġb', 't', '20', '70', 'Ġblu', 'etooth', 'Ġheadset', 'Ġ100', '-', '9', '207', '0000', '-', '02', 'ĠCOL', 'Ġdescription', 'ĠVAL', 'Ġ', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ', 'Ġ', '</s>']
is_heads: [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
y: 0
tags: 0
mask: tensor([1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1])
seqlen: 118
task_name: Textual/Abt-Buy
=======================
step: 0, task: Textual/Abt-Buy, loss: 0.0006580203771591187
step: 10, task: Textual/Abt-Buy, loss: 0.00021970272064208984
step: 20, task: Textual/Abt-Buy, loss: 0.00016492605209350586
step: 30, task: Textual/Abt-Buy, loss: 0.00019381940364837646
step: 40, task: Textual/Abt-Buy, loss: 0.017392762005329132
step: 50, task: Textual/Abt-Buy, loss: 0.0028380081057548523
step: 60, task: Textual/Abt-Buy, loss: 0.00017280876636505127
step: 70, task: Textual/Abt-Buy, loss: 0.0024511292576789856
step: 80, task: Textual/Abt-Buy, loss: 0.012808721512556076
step: 90, task: Textual/Abt-Buy, loss: 0.012455105781555176
step: 100, task: Textual/Abt-Buy, loss: 0.0009891092777252197
step: 110, task: Textual/Abt-Buy, loss: 0.00040262937545776367
step: 120, task: Textual/Abt-Buy, loss: 0.0013187229633331299
step: 130, task: Textual/Abt-Buy, loss: 0.0006381869316101074
Gradient overflow.  Skipping step, loss scaler 0 reducing loss scale to 8192.0
step: 140, task: Textual/Abt-Buy, loss: 0.37296971678733826
step: 150, task: Textual/Abt-Buy, loss: 0.00031238794326782227
step: 160, task: Textual/Abt-Buy, loss: 0.09965436160564423
step: 170, task: Textual/Abt-Buy, loss: 0.00014378130435943604
step: 180, task: Textual/Abt-Buy, loss: 0.00021514296531677246
step: 190, task: Textual/Abt-Buy, loss: 0.00950215756893158
step: 200, task: Textual/Abt-Buy, loss: 0.0697745680809021
step: 210, task: Textual/Abt-Buy, loss: 0.018304258584976196
step: 220, task: Textual/Abt-Buy, loss: 0.0007840991020202637
step: 230, task: Textual/Abt-Buy, loss: 9.930133819580078e-05
step: 240, task: Textual/Abt-Buy, loss: 0.00017882883548736572
step: 250, task: Textual/Abt-Buy, loss: 0.00014685094356536865
step: 260, task: Textual/Abt-Buy, loss: 0.00015045702457427979
step: 270, task: Textual/Abt-Buy, loss: 0.10278704762458801
step: 280, task: Textual/Abt-Buy, loss: 0.0011412575840950012
step: 290, task: Textual/Abt-Buy, loss: 0.0001894533634185791
step: 300, task: Textual/Abt-Buy, loss: 0.005441009998321533
step: 310, task: Textual/Abt-Buy, loss: 0.00010727345943450928
step: 320, task: Textual/Abt-Buy, loss: 0.0051686689257621765
step: 330, task: Textual/Abt-Buy, loss: 0.00019501149654388428
step: 340, task: Textual/Abt-Buy, loss: 0.0003623664379119873
step: 350, task: Textual/Abt-Buy, loss: 0.028649110347032547
=========eval at epoch=7=========
Validation:
=============Textual/Abt-Buy==================
accuracy=0.937
precision=0.957
recall=0.437
f1=0.600
======================================
Test:
=============Textual/Abt-Buy==================
accuracy=0.946
precision=0.955
recall=0.519
f1=0.673
======================================
=====sanity check======
words: COL name VAL panasonic 5.8 ghz black expandable digital cordless phone kxtg4321b COL description VAL panasonic 5.8 ghz black expandable digital cordless phone kxtg4321b multi-handset capability digital answering machine system ringer id call waiting caller id voicemail hold mute clock alarm led lighting speakerphone intercom 11 days standby 5 hours talk time black finish COL price VAL   [SEP] COL name VAL panasonic kx-tg1034s dect 6.0 cordless phone kx-tg1034s COL description VAL panasonic dect 6.0 series 4 handset cordless phone system with answering system COL price VAL 89.45 
x: [    0 18047   766 27445  5730 38703   195     4   398 34648   329   909
  3003   868  1778 13051  1672  1028   449 11483   571  3897  2146   428
 14857  8194 27445  5730 38703   195     4   398 34648   329   909  3003
   868  1778 13051  1672  1028   449 11483   571  3897  2146   428  3228
    12 34055   594  9388  1778 15635  3563   467   910  6082 13561   486
  2445 17017 13561 30118 10555   946 33758  6700  8054   669  7526  5385
 17283  3222   175   365   360 28611   195   722  1067    86   909  2073
 14857   425 27445  1437  1437     2     2 18047   766 27445  5730 38703
   449  1178    12 42698   698  3079    29   263  3894   231     4   288
 13051  1672  1028   449  1178    12 42698   698  3079    29 14857  8194
 27445  5730 38703   263  3894   231     4   288   651   204 17621 13051
  1672  1028   467    19 15635   467 14857   425 27445  8572     4  1898
  1437     2]
tokens: ['<s>', 'COL', 'Ġname', 'ĠVAL', 'Ġpan', 'asonic', 'Ġ5', '.', '8', 'Ġgh', 'z', 'Ġblack', 'Ġexpand', 'able', 'Ġdigital', 'Ġcord', 'less', 'Ġphone', 'Ġk', 'xt', 'g', '43', '21', 'b', 'ĠCOL', 'Ġdescription', 'ĠVAL', 'Ġpan', 'asonic', 'Ġ5', '.', '8', 'Ġgh', 'z', 'Ġblack', 'Ġexpand', 'able', 'Ġdigital', 'Ġcord', 'less', 'Ġphone', 'Ġk', 'xt', 'g', '43', '21', 'b', 'Ġmulti', '-', 'hands', 'et', 'Ġcapability', 'Ġdigital', 'Ġanswering', 'Ġmachine', 'Ġsystem', 'Ġr', 'inger', 'Ġid', 'Ġcall', 'Ġwaiting', 'Ġcaller', 'Ġid', 'Ġvoic', 'email', 'Ġhold', 'Ġmute', 'Ġclock', 'Ġalarm', 'Ġled', 'Ġlighting', 'Ġspeaker', 'phone', 'Ġinter', 'com', 'Ġ11', 'Ġdays', 'Ġstandby', 'Ġ5', 'Ġhours', 'Ġtalk', 'Ġtime', 'Ġblack', 'Ġfinish', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ', 'Ġ', '</s>', '</s>', 'COL', 'Ġname', 'ĠVAL', 'Ġpan', 'asonic', 'Ġk', 'x', '-', 'tg', '10', '34', 's', 'Ġde', 'ct', 'Ġ6', '.', '0', 'Ġcord', 'less', 'Ġphone', 'Ġk', 'x', '-', 'tg', '10', '34', 's', 'ĠCOL', 'Ġdescription', 'ĠVAL', 'Ġpan', 'asonic', 'Ġde', 'ct', 'Ġ6', '.', '0', 'Ġseries', 'Ġ4', 'Ġhandset', 'Ġcord', 'less', 'Ġphone', 'Ġsystem', 'Ġwith', 'Ġanswering', 'Ġsystem', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ89', '.', '45', 'Ġ', '</s>']
is_heads: [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
y: 0
tags: 0
mask: tensor([1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1])
seqlen: 146
task_name: Textual/Abt-Buy
=======================
step: 0, task: Textual/Abt-Buy, loss: 0.009210236370563507
step: 10, task: Textual/Abt-Buy, loss: 0.029620524495840073
step: 20, task: Textual/Abt-Buy, loss: 7.224082946777344e-05
step: 30, task: Textual/Abt-Buy, loss: 0.00014406442642211914
step: 40, task: Textual/Abt-Buy, loss: 0.00023815035820007324
step: 50, task: Textual/Abt-Buy, loss: 0.0001577436923980713
step: 60, task: Textual/Abt-Buy, loss: 0.00029650330543518066
step: 70, task: Textual/Abt-Buy, loss: 0.008157134056091309
step: 80, task: Textual/Abt-Buy, loss: 0.00018587708473205566
step: 90, task: Textual/Abt-Buy, loss: 0.003970153629779816
step: 100, task: Textual/Abt-Buy, loss: 0.00014798343181610107
step: 110, task: Textual/Abt-Buy, loss: 0.00018930435180664062
step: 120, task: Textual/Abt-Buy, loss: 0.0001812279224395752
step: 130, task: Textual/Abt-Buy, loss: 0.001689411699771881
step: 140, task: Textual/Abt-Buy, loss: 0.0017522946000099182
step: 150, task: Textual/Abt-Buy, loss: 0.006788425147533417
step: 160, task: Textual/Abt-Buy, loss: 0.06389705836772919
step: 170, task: Textual/Abt-Buy, loss: 8.07642936706543e-05
step: 180, task: Textual/Abt-Buy, loss: 0.00029878318309783936
step: 190, task: Textual/Abt-Buy, loss: 0.00010061264038085938
step: 200, task: Textual/Abt-Buy, loss: 0.00014303624629974365
step: 210, task: Textual/Abt-Buy, loss: 0.00020013749599456787
step: 220, task: Textual/Abt-Buy, loss: 0.025225773453712463
step: 230, task: Textual/Abt-Buy, loss: 0.0002880990505218506
step: 240, task: Textual/Abt-Buy, loss: 0.00022602081298828125
step: 250, task: Textual/Abt-Buy, loss: 0.00014543533325195312
step: 260, task: Textual/Abt-Buy, loss: 9.077787399291992e-05
step: 270, task: Textual/Abt-Buy, loss: 0.0014315992593765259
step: 280, task: Textual/Abt-Buy, loss: 8.660554885864258e-05
step: 290, task: Textual/Abt-Buy, loss: 0.00017245113849639893
step: 300, task: Textual/Abt-Buy, loss: 0.00013236701488494873
step: 310, task: Textual/Abt-Buy, loss: 8.669495582580566e-05
step: 320, task: Textual/Abt-Buy, loss: 0.0011565685272216797
step: 330, task: Textual/Abt-Buy, loss: 0.00015188753604888916
step: 340, task: Textual/Abt-Buy, loss: 0.0001710653305053711
step: 350, task: Textual/Abt-Buy, loss: 0.0011778026819229126
=========eval at epoch=8=========
Validation:
=============Textual/Abt-Buy==================
accuracy=0.934
precision=0.955
recall=0.408
f1=0.571
======================================
Test:
=============Textual/Abt-Buy==================
accuracy=0.942
precision=0.990
recall=0.466
f1=0.634
======================================
Selected optimization level O2:  FP16 training with FP32 batchnorm and FP32 master weights.

Defaults for this optimization level are:
enabled                : True
opt_level              : O2
cast_model_type        : torch.float16
patch_torch_functions  : False
keep_batchnorm_fp32    : True
master_weights         : True
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O2
cast_model_type        : torch.float16
patch_torch_functions  : False
keep_batchnorm_fp32    : True
master_weights         : True
loss_scale             : dynamic
Warning:  multi_tensor_applier fused unscale kernel is unavailable, possibly because apex was installed without --cuda_ext --cpp_ext. Using Python fallback.  Original ImportError was: ModuleNotFoundError("No module named 'amp_C'")
Gradient overflow.  Skipping step, loss scaler 0 reducing loss scale to 32768.0
=====sanity check======
words: COL name VAL apple 8gb black 4th generation ipod nano mb754lla COL description VAL apple 8gb black 4th generation ipod nano mb754lla holds up to 2,000 songs in 128-kbps aac format , 7,000 ipod-viewable photos and 8 hours of video 2 ' ( diagonal ) liquid crystal display with blue-white led backlight 320-by-240-pixel resolution give it a shake to shuffle your music turn it sideways to view cover flow mac and windows compatible black finish COL price VAL 144.0  [SEP] COL name VAL apple 8gb ipod nano silver ( 4th generation ) mb598ll/a COL description VAL  COL price VAL 146.75 
x: [    0 18047   766 27445 15162   290 19562   909   204   212  2706 36180
  1630 36924   475   428 39382  5104 14857  8194 27445 15162   290 19562
   909   204   212  2706 36180  1630 36924   475   428 39382  5104  3106
    62     7   132     6   151  3686    11 13950    12   330 27072    10
  1043  7390  2156   262     6   151 36180  1630    12  5877   868  2356
     8   290   722     9   569   132   128    36 42539  4839  6936 16155
  2332    19  2440    12  9830   669   124  6991 21947    12  1409    12
 18847    12 44546  3547   492    24    10  8559     7 34321   110   930
  1004    24 29445     7  1217  1719  3041 13418     8  6410 16632   909
  2073 14857   425 27445 19641     4   288  1437     2     2 18047   766
 27445 15162   290 19562 36180  1630 36924  4334    36   204   212  2706
  4839   475   428 38097   890    73   102 14857  8194 27445  1437 14857
   425 27445 24543     4  2545  1437     2]
tokens: ['<s>', 'COL', 'Ġname', 'ĠVAL', 'Ġapple', 'Ġ8', 'gb', 'Ġblack', 'Ġ4', 'th', 'Ġgeneration', 'Ġip', 'od', 'Ġnano', 'Ġm', 'b', '754', 'lla', 'ĠCOL', 'Ġdescription', 'ĠVAL', 'Ġapple', 'Ġ8', 'gb', 'Ġblack', 'Ġ4', 'th', 'Ġgeneration', 'Ġip', 'od', 'Ġnano', 'Ġm', 'b', '754', 'lla', 'Ġholds', 'Ġup', 'Ġto', 'Ġ2', ',', '000', 'Ġsongs', 'Ġin', 'Ġ128', '-', 'k', 'bps', 'Ġa', 'ac', 'Ġformat', 'Ġ,', 'Ġ7', ',', '000', 'Ġip', 'od', '-', 'view', 'able', 'Ġphotos', 'Ġand', 'Ġ8', 'Ġhours', 'Ġof', 'Ġvideo', 'Ġ2', "Ġ'", 'Ġ(', 'Ġdiagonal', 'Ġ)', 'Ġliquid', 'Ġcrystal', 'Ġdisplay', 'Ġwith', 'Ġblue', '-', 'white', 'Ġled', 'Ġback', 'light', 'Ġ320', '-', 'by', '-', '240', '-', 'pixel', 'Ġresolution', 'Ġgive', 'Ġit', 'Ġa', 'Ġshake', 'Ġto', 'Ġshuffle', 'Ġyour', 'Ġmusic', 'Ġturn', 'Ġit', 'Ġsideways', 'Ġto', 'Ġview', 'Ġcover', 'Ġflow', 'Ġmac', 'Ġand', 'Ġwindows', 'Ġcompatible', 'Ġblack', 'Ġfinish', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ144', '.', '0', 'Ġ', '</s>', '</s>', 'COL', 'Ġname', 'ĠVAL', 'Ġapple', 'Ġ8', 'gb', 'Ġip', 'od', 'Ġnano', 'Ġsilver', 'Ġ(', 'Ġ4', 'th', 'Ġgeneration', 'Ġ)', 'Ġm', 'b', '598', 'll', '/', 'a', 'ĠCOL', 'Ġdescription', 'ĠVAL', 'Ġ', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ146', '.', '75', 'Ġ', '</s>']
is_heads: [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
y: 0
tags: 0
mask: tensor([1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1])
seqlen: 151
task_name: Textual/Abt-Buy
=======================
step: 0, task: Textual/Abt-Buy, loss: 0.6534175276756287
Gradient overflow.  Skipping step, loss scaler 0 reducing loss scale to 16384.0
Gradient overflow.  Skipping step, loss scaler 0 reducing loss scale to 8192.0
step: 10, task: Textual/Abt-Buy, loss: 0.657719612121582
step: 20, task: Textual/Abt-Buy, loss: 0.6182945966720581
step: 30, task: Textual/Abt-Buy, loss: 0.46052679419517517
step: 40, task: Textual/Abt-Buy, loss: 0.3370864987373352
step: 50, task: Textual/Abt-Buy, loss: 0.3521852493286133
Gradient overflow.  Skipping step, loss scaler 0 reducing loss scale to 4096.0
step: 60, task: Textual/Abt-Buy, loss: 0.0994887575507164
step: 70, task: Textual/Abt-Buy, loss: 0.2391285002231598
step: 80, task: Textual/Abt-Buy, loss: 0.2373197227716446
step: 90, task: Textual/Abt-Buy, loss: 0.6445484161376953
step: 100, task: Textual/Abt-Buy, loss: 0.4219051003456116
step: 110, task: Textual/Abt-Buy, loss: 0.0853329449892044
step: 120, task: Textual/Abt-Buy, loss: 0.5017324686050415
step: 130, task: Textual/Abt-Buy, loss: 0.5367951393127441
step: 140, task: Textual/Abt-Buy, loss: 0.48010656237602234
step: 150, task: Textual/Abt-Buy, loss: 0.33114469051361084
step: 160, task: Textual/Abt-Buy, loss: 0.5852581262588501
step: 170, task: Textual/Abt-Buy, loss: 0.4546095132827759
step: 180, task: Textual/Abt-Buy, loss: 0.3065432608127594
step: 190, task: Textual/Abt-Buy, loss: 0.42227381467819214
step: 200, task: Textual/Abt-Buy, loss: 0.2677655816078186
step: 210, task: Textual/Abt-Buy, loss: 0.37980881333351135
step: 220, task: Textual/Abt-Buy, loss: 0.20660388469696045
step: 230, task: Textual/Abt-Buy, loss: 0.4271765351295471
step: 240, task: Textual/Abt-Buy, loss: 0.2559955418109894
step: 250, task: Textual/Abt-Buy, loss: 0.37088465690612793
step: 260, task: Textual/Abt-Buy, loss: 0.4490325450897217
step: 270, task: Textual/Abt-Buy, loss: 0.4423033595085144
step: 280, task: Textual/Abt-Buy, loss: 0.05264277756214142
step: 290, task: Textual/Abt-Buy, loss: 0.34925469756126404
step: 300, task: Textual/Abt-Buy, loss: 0.15776899456977844
step: 310, task: Textual/Abt-Buy, loss: 0.17709189653396606
step: 320, task: Textual/Abt-Buy, loss: 0.07942972332239151
step: 330, task: Textual/Abt-Buy, loss: 0.07474834471940994
step: 340, task: Textual/Abt-Buy, loss: 0.0689743235707283
step: 350, task: Textual/Abt-Buy, loss: 0.5142921805381775
=========eval at epoch=1=========
Validation:
=============Textual/Abt-Buy==================
accuracy=0.917
precision=0.851
recall=0.277
f1=0.418
======================================
Test:
=============Textual/Abt-Buy==================
accuracy=0.912
precision=0.788
recall=0.252
f1=0.382
======================================
/w/246/tianyu2020/miniconda2/envs/ditto/lib/python3.7/site-packages/apex/amp/_initialize.py:24: UserWarning: An input tensor was not cuda.
  warnings.warn("An input tensor was not cuda.")
/w/246/tianyu2020/miniconda2/envs/ditto/lib/python3.7/site-packages/torch/optim/lr_scheduler.py:122: UserWarning: Detected call of `lr_scheduler.step()` before `optimizer.step()`. In PyTorch 1.1.0 and later, you should call them in the opposite order: `optimizer.step()` before `lr_scheduler.step()`.  Failure to do this will result in PyTorch skipping the first value of the learning rate schedule. See more details at https://pytorch.org/docs/stable/optim.html#how-to-adjust-learning-rate
  "https://pytorch.org/docs/stable/optim.html#how-to-adjust-learning-rate", UserWarning)
=====sanity check======
words: COL name VAL panasonic 5.8 ghz black expandable digital cordless phone system kxtg4324b COL description VAL panasonic 5.8 ghz black expandable digital cordless phone system kxtg4324b 4 handsets system digital answering machine ringer id call waiting caller id voicemail hold mute clock alarm led lighting night mode speakerphone intercom 11 days standby 5 hours talk time black finish COL price VAL   [SEP] COL name VAL panasonic kx-tg9333t cordless phone kx-tg9333t COL description VAL panasonic dect 6.0 1.9 ghz expandable cordless phone with digital answering system COL price VAL  
x: [    0 18047   766 27445  5730 38703   195     4   398 34648   329   909
  3003   868  1778 13051  1672  1028   467   449 11483   571  3897  1978
   428 14857  8194 27445  5730 38703   195     4   398 34648   329   909
  3003   868  1778 13051  1672  1028   467   449 11483   571  3897  1978
   428   204  1420  2580   467  1778 15635  3563   910  6082 13561   486
  2445 17017 13561 30118 10555   946 33758  6700  8054   669  7526   363
  5745  5385 17283  3222   175   365   360 28611   195   722  1067    86
   909  2073 14857   425 27445  1437  1437     2     2 18047   766 27445
  5730 38703   449  1178    12 42698   466 25631    90 13051  1672  1028
   449  1178    12 42698   466 25631    90 14857  8194 27445  5730 38703
   263  3894   231     4   288   112     4   466 34648   329  3003   868
 13051  1672  1028    19  1778 15635   467 14857   425 27445  1437  1437
     2]
tokens: ['<s>', 'COL', 'Ġname', 'ĠVAL', 'Ġpan', 'asonic', 'Ġ5', '.', '8', 'Ġgh', 'z', 'Ġblack', 'Ġexpand', 'able', 'Ġdigital', 'Ġcord', 'less', 'Ġphone', 'Ġsystem', 'Ġk', 'xt', 'g', '43', '24', 'b', 'ĠCOL', 'Ġdescription', 'ĠVAL', 'Ġpan', 'asonic', 'Ġ5', '.', '8', 'Ġgh', 'z', 'Ġblack', 'Ġexpand', 'able', 'Ġdigital', 'Ġcord', 'less', 'Ġphone', 'Ġsystem', 'Ġk', 'xt', 'g', '43', '24', 'b', 'Ġ4', 'Ġhands', 'ets', 'Ġsystem', 'Ġdigital', 'Ġanswering', 'Ġmachine', 'Ġr', 'inger', 'Ġid', 'Ġcall', 'Ġwaiting', 'Ġcaller', 'Ġid', 'Ġvoic', 'email', 'Ġhold', 'Ġmute', 'Ġclock', 'Ġalarm', 'Ġled', 'Ġlighting', 'Ġnight', 'Ġmode', 'Ġspeaker', 'phone', 'Ġinter', 'com', 'Ġ11', 'Ġdays', 'Ġstandby', 'Ġ5', 'Ġhours', 'Ġtalk', 'Ġtime', 'Ġblack', 'Ġfinish', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ', 'Ġ', '</s>', '</s>', 'COL', 'Ġname', 'ĠVAL', 'Ġpan', 'asonic', 'Ġk', 'x', '-', 'tg', '9', '333', 't', 'Ġcord', 'less', 'Ġphone', 'Ġk', 'x', '-', 'tg', '9', '333', 't', 'ĠCOL', 'Ġdescription', 'ĠVAL', 'Ġpan', 'asonic', 'Ġde', 'ct', 'Ġ6', '.', '0', 'Ġ1', '.', '9', 'Ġgh', 'z', 'Ġexpand', 'able', 'Ġcord', 'less', 'Ġphone', 'Ġwith', 'Ġdigital', 'Ġanswering', 'Ġsystem', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ', 'Ġ', '</s>']
is_heads: [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
y: 0
tags: 0
mask: tensor([1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1])
seqlen: 145
task_name: Textual/Abt-Buy
=======================
step: 0, task: Textual/Abt-Buy, loss: 0.15698283910751343
step: 10, task: Textual/Abt-Buy, loss: 0.38080257177352905
step: 20, task: Textual/Abt-Buy, loss: 0.013108767569065094
step: 30, task: Textual/Abt-Buy, loss: 0.008844755589962006
step: 40, task: Textual/Abt-Buy, loss: 0.3323940932750702
step: 50, task: Textual/Abt-Buy, loss: 0.20273646712303162
step: 60, task: Textual/Abt-Buy, loss: 0.28129154443740845
step: 70, task: Textual/Abt-Buy, loss: 0.1035040020942688
step: 80, task: Textual/Abt-Buy, loss: 0.18145599961280823
step: 90, task: Textual/Abt-Buy, loss: 0.08266375213861465
step: 100, task: Textual/Abt-Buy, loss: 0.07894279062747955
step: 110, task: Textual/Abt-Buy, loss: 0.4630756080150604
step: 120, task: Textual/Abt-Buy, loss: 0.1687983274459839
step: 130, task: Textual/Abt-Buy, loss: 0.11316005885601044
step: 140, task: Textual/Abt-Buy, loss: 0.0960288867354393
step: 150, task: Textual/Abt-Buy, loss: 0.06715978682041168
step: 160, task: Textual/Abt-Buy, loss: 0.013064540922641754
step: 170, task: Textual/Abt-Buy, loss: 0.06085015833377838
step: 180, task: Textual/Abt-Buy, loss: 0.012912943959236145
step: 190, task: Textual/Abt-Buy, loss: 0.059795014560222626
step: 200, task: Textual/Abt-Buy, loss: 0.1565898358821869
step: 210, task: Textual/Abt-Buy, loss: 0.03553572669625282
step: 220, task: Textual/Abt-Buy, loss: 0.1994248330593109
step: 230, task: Textual/Abt-Buy, loss: 0.1746039241552353
step: 240, task: Textual/Abt-Buy, loss: 0.05198128521442413
step: 250, task: Textual/Abt-Buy, loss: 0.1646423041820526
step: 260, task: Textual/Abt-Buy, loss: 0.14525055885314941
step: 270, task: Textual/Abt-Buy, loss: 0.005388349294662476
step: 280, task: Textual/Abt-Buy, loss: 0.14048755168914795
step: 290, task: Textual/Abt-Buy, loss: 0.0007740408182144165
step: 300, task: Textual/Abt-Buy, loss: 0.11208262294530869
step: 310, task: Textual/Abt-Buy, loss: 0.02438017725944519
step: 320, task: Textual/Abt-Buy, loss: 0.04566381871700287
step: 330, task: Textual/Abt-Buy, loss: 0.08906514942646027
step: 340, task: Textual/Abt-Buy, loss: 0.015946775674819946
step: 350, task: Textual/Abt-Buy, loss: 0.05644995719194412
=========eval at epoch=2=========
Validation:
=============Textual/Abt-Buy==================
accuracy=0.944
precision=0.754
recall=0.714
f1=0.733
======================================
Test:
=============Textual/Abt-Buy==================
accuracy=0.952
precision=0.782
recall=0.767
f1=0.775
======================================
=====sanity check======
words: COL name VAL canon pixma mx850 multifunction printer mx850c COL description VAL canon pixma mx850 multifunction printer mx850c advanced 5 in 1 printer , scanner , copier , fax machine high resolution up to 9600 x 2400 color prints auto-image fix quick start memory card slot grey and black finish COL price VAL   [SEP] COL name VAL canon pixma mp620 wireless photo all-in-one inkjet printer 2921b002 COL description VAL  COL price VAL  
x: [    0 18047   766 27445 32839   181  3181  1916   475  1178 19270 26323
 38665 24079   475  1178 19270   438 14857  8194 27445 32839   181  3181
  1916   475  1178 19270 26323 38665 24079   475  1178 19270   438  3319
   195    11   112 24079  2156 22373  2156  9212   906  2156 30561  3563
   239  3547    62     7   361  4697  3023 40977  3195 19553  4485    12
 20094  4190  2119   386  3783  1886  8534 10521     8   909  2073 14857
   425 27445  1437  1437     2     2 18047   766 27445 32839   181  3181
  1916 44857 32994  6955  1345    70    12   179    12  1264 16019  6622
 24079  1132  2146   428 19130 14857  8194 27445  1437 14857   425 27445
  1437  1437     2]
tokens: ['<s>', 'COL', 'Ġname', 'ĠVAL', 'Ġcanon', 'Ġp', 'ix', 'ma', 'Ġm', 'x', '850', 'Ġmultif', 'unction', 'Ġprinter', 'Ġm', 'x', '850', 'c', 'ĠCOL', 'Ġdescription', 'ĠVAL', 'Ġcanon', 'Ġp', 'ix', 'ma', 'Ġm', 'x', '850', 'Ġmultif', 'unction', 'Ġprinter', 'Ġm', 'x', '850', 'c', 'Ġadvanced', 'Ġ5', 'Ġin', 'Ġ1', 'Ġprinter', 'Ġ,', 'Ġscanner', 'Ġ,', 'Ġcop', 'ier', 'Ġ,', 'Ġfax', 'Ġmachine', 'Ġhigh', 'Ġresolution', 'Ġup', 'Ġto', 'Ġ9', '600', 'Ġx', 'Ġ2400', 'Ġcolor', 'Ġprints', 'Ġauto', '-', 'image', 'Ġfix', 'Ġquick', 'Ġstart', 'Ġmemory', 'Ġcard', 'Ġslot', 'Ġgrey', 'Ġand', 'Ġblack', 'Ġfinish', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ', 'Ġ', '</s>', '</s>', 'COL', 'Ġname', 'ĠVAL', 'Ġcanon', 'Ġp', 'ix', 'ma', 'Ġmp', '620', 'Ġwireless', 'Ġphoto', 'Ġall', '-', 'in', '-', 'one', 'Ġink', 'jet', 'Ġprinter', 'Ġ29', '21', 'b', '002', 'ĠCOL', 'Ġdescription', 'ĠVAL', 'Ġ', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ', 'Ġ', '</s>']
is_heads: [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
y: 0
tags: 0
mask: tensor([1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1])
seqlen: 111
task_name: Textual/Abt-Buy
=======================
step: 0, task: Textual/Abt-Buy, loss: 0.1527668982744217
step: 10, task: Textual/Abt-Buy, loss: 0.1371007263660431
step: 20, task: Textual/Abt-Buy, loss: 0.017852403223514557
step: 30, task: Textual/Abt-Buy, loss: 0.33659660816192627
step: 40, task: Textual/Abt-Buy, loss: 0.012729726731777191
step: 50, task: Textual/Abt-Buy, loss: 0.16115736961364746
step: 60, task: Textual/Abt-Buy, loss: 0.02909528836607933
step: 70, task: Textual/Abt-Buy, loss: 0.01851847767829895
step: 80, task: Textual/Abt-Buy, loss: 0.35460060834884644
step: 90, task: Textual/Abt-Buy, loss: 0.09462393820285797
step: 100, task: Textual/Abt-Buy, loss: 0.122984878718853
step: 110, task: Textual/Abt-Buy, loss: 0.04515260457992554
step: 120, task: Textual/Abt-Buy, loss: 0.011857457458972931
step: 130, task: Textual/Abt-Buy, loss: 0.0033669546246528625
step: 140, task: Textual/Abt-Buy, loss: 0.013429079204797745
step: 150, task: Textual/Abt-Buy, loss: 0.02488056570291519
step: 160, task: Textual/Abt-Buy, loss: 0.025252431631088257
step: 170, task: Textual/Abt-Buy, loss: 0.09926581382751465
step: 180, task: Textual/Abt-Buy, loss: 0.00600220263004303
step: 190, task: Textual/Abt-Buy, loss: 0.010309666395187378
step: 200, task: Textual/Abt-Buy, loss: 0.009643718600273132
step: 210, task: Textual/Abt-Buy, loss: 0.02310723438858986
step: 220, task: Textual/Abt-Buy, loss: 0.004900038242340088
step: 230, task: Textual/Abt-Buy, loss: 0.04185621067881584
step: 240, task: Textual/Abt-Buy, loss: 0.026799984276294708
step: 250, task: Textual/Abt-Buy, loss: 0.12993124127388
step: 260, task: Textual/Abt-Buy, loss: 0.0016151070594787598
step: 270, task: Textual/Abt-Buy, loss: 0.003371007740497589
step: 280, task: Textual/Abt-Buy, loss: 0.014503128826618195
step: 290, task: Textual/Abt-Buy, loss: 0.012541696429252625
step: 300, task: Textual/Abt-Buy, loss: 0.0337425097823143
step: 310, task: Textual/Abt-Buy, loss: 0.10493919998407364
step: 320, task: Textual/Abt-Buy, loss: 0.0011956393718719482
step: 330, task: Textual/Abt-Buy, loss: 0.019177310168743134
step: 340, task: Textual/Abt-Buy, loss: 0.035727813839912415
step: 350, task: Textual/Abt-Buy, loss: 0.008280955255031586
=========eval at epoch=3=========
Validation:
=============Textual/Abt-Buy==================
accuracy=0.929
precision=0.917
recall=0.374
f1=0.531
======================================
Test:
=============Textual/Abt-Buy==================
accuracy=0.936
precision=0.967
recall=0.422
f1=0.588
======================================
=====sanity check======
words: COL name VAL speck seethru black hard shell case for 13 ' macbook mb13blkseev2 COL description VAL speck seethru black hard shell case for 13 ' macbook mb13blkseev2 translucent hard plastic shell gives great protection full access to all controls rubber feet for added support black finish COL price VAL   [SEP] COL name VAL speck products seethru case for apple 15 ' macbook pro mb15-grn-see-v2 COL description VAL plastic green COL price VAL  
x: [    0 18047   766 27445 25227  2420   842  4774  2070   909   543 10785
   403    13   508   128 13418  6298   475   428  1558  3662   330  1090
  3623   176 14857  8194 27445 25227  2420   842  4774  2070   909   543
 10785   403    13   508   128 13418  6298   475   428  1558  3662   330
  1090  3623   176 42026   543  4136 10785  2029   372  2591   455   899
     7    70  5656 11283  1730    13   355   323   909  2073 14857   425
 27445  1437  1437     2     2 18047   766 27445 25227  2420   785   842
  4774  2070   403    13 15162   379   128 13418  6298  1759   475   428
   996    12  6504   282    12  7048    12   705   176 14857  8194 27445
  4136  2272 14857   425 27445  1437  1437     2]
tokens: ['<s>', 'COL', 'Ġname', 'ĠVAL', 'Ġspe', 'ck', 'Ġse', 'eth', 'ru', 'Ġblack', 'Ġhard', 'Ġshell', 'Ġcase', 'Ġfor', 'Ġ13', "Ġ'", 'Ġmac', 'book', 'Ġm', 'b', '13', 'bl', 'k', 'se', 'ev', '2', 'ĠCOL', 'Ġdescription', 'ĠVAL', 'Ġspe', 'ck', 'Ġse', 'eth', 'ru', 'Ġblack', 'Ġhard', 'Ġshell', 'Ġcase', 'Ġfor', 'Ġ13', "Ġ'", 'Ġmac', 'book', 'Ġm', 'b', '13', 'bl', 'k', 'se', 'ev', '2', 'Ġtranslucent', 'Ġhard', 'Ġplastic', 'Ġshell', 'Ġgives', 'Ġgreat', 'Ġprotection', 'Ġfull', 'Ġaccess', 'Ġto', 'Ġall', 'Ġcontrols', 'Ġrubber', 'Ġfeet', 'Ġfor', 'Ġadded', 'Ġsupport', 'Ġblack', 'Ġfinish', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ', 'Ġ', '</s>', '</s>', 'COL', 'Ġname', 'ĠVAL', 'Ġspe', 'ck', 'Ġproducts', 'Ġse', 'eth', 'ru', 'Ġcase', 'Ġfor', 'Ġapple', 'Ġ15', "Ġ'", 'Ġmac', 'book', 'Ġpro', 'Ġm', 'b', '15', '-', 'gr', 'n', '-', 'see', '-', 'v', '2', 'ĠCOL', 'Ġdescription', 'ĠVAL', 'Ġplastic', 'Ġgreen', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ', 'Ġ', '</s>']
is_heads: [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
y: 0
tags: 0
mask: tensor([1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1])
seqlen: 116
task_name: Textual/Abt-Buy
=======================
step: 0, task: Textual/Abt-Buy, loss: 0.0035843774676322937
step: 10, task: Textual/Abt-Buy, loss: 0.23778465390205383
step: 20, task: Textual/Abt-Buy, loss: 0.014973945915699005
step: 30, task: Textual/Abt-Buy, loss: 0.0945022776722908
step: 40, task: Textual/Abt-Buy, loss: 0.004944831132888794
step: 50, task: Textual/Abt-Buy, loss: 0.00709177553653717
step: 60, task: Textual/Abt-Buy, loss: 0.002916470170021057
step: 70, task: Textual/Abt-Buy, loss: 0.0014882087707519531
step: 80, task: Textual/Abt-Buy, loss: 0.0012081265449523926
step: 90, task: Textual/Abt-Buy, loss: 0.012357324361801147
step: 100, task: Textual/Abt-Buy, loss: 0.08668994158506393
step: 110, task: Textual/Abt-Buy, loss: 0.024847175925970078
step: 120, task: Textual/Abt-Buy, loss: 0.0007984936237335205
step: 130, task: Textual/Abt-Buy, loss: 0.0014356672763824463
step: 140, task: Textual/Abt-Buy, loss: 0.029229607433080673
step: 150, task: Textual/Abt-Buy, loss: 0.18930156528949738
step: 160, task: Textual/Abt-Buy, loss: 0.5219939947128296
step: 170, task: Textual/Abt-Buy, loss: 0.006115131080150604
step: 180, task: Textual/Abt-Buy, loss: 0.17014706134796143
step: 190, task: Textual/Abt-Buy, loss: 0.7742903828620911
step: 200, task: Textual/Abt-Buy, loss: 0.010267876088619232
step: 210, task: Textual/Abt-Buy, loss: 0.003645956516265869
step: 220, task: Textual/Abt-Buy, loss: 0.005790591239929199
step: 230, task: Textual/Abt-Buy, loss: 0.010838262736797333
step: 240, task: Textual/Abt-Buy, loss: 0.3140827417373657
step: 250, task: Textual/Abt-Buy, loss: 0.0018181949853897095
step: 260, task: Textual/Abt-Buy, loss: 0.018820345401763916
step: 270, task: Textual/Abt-Buy, loss: 0.0008244514465332031
step: 280, task: Textual/Abt-Buy, loss: 0.003913760185241699
step: 290, task: Textual/Abt-Buy, loss: 0.0055351778864860535
step: 300, task: Textual/Abt-Buy, loss: 0.0029206275939941406
step: 310, task: Textual/Abt-Buy, loss: 0.05458834767341614
step: 320, task: Textual/Abt-Buy, loss: 0.0017648935317993164
step: 330, task: Textual/Abt-Buy, loss: 0.0005488842725753784
step: 340, task: Textual/Abt-Buy, loss: 0.07807044684886932
step: 350, task: Textual/Abt-Buy, loss: 0.002065792679786682
=========eval at epoch=4=========
Validation:
=============Textual/Abt-Buy==================
accuracy=0.949
precision=0.871
recall=0.621
f1=0.725
======================================
Test:
=============Textual/Abt-Buy==================
accuracy=0.953
precision=0.914
recall=0.621
f1=0.740
======================================
=====sanity check======
words: COL name VAL panasonic dect 6.0 black expandable digital cordless phone system kxtg9372b COL description VAL panasonic dect 6.0 black expandable digital cordless phone system kxtg9372b drop and splash resistant 2 handsets up to 6 multi-handset capability digital answering machine system ringer id call waiting caller id voicemail hold mute clock alarm led lighting night mode call block speakerphone 11 days standby 5 hours talk time black finish COL price VAL   [SEP] COL name VAL panasonic kx-tg9341t cordless phone COL description VAL 1 x phone line ( s ) black , metallic COL price VAL  
x: [    0 18047   766 27445  5730 38703   263  3894   231     4   288   909
  3003   868  1778 13051  1672  1028   467   449 11483   571   466 34322
   428 14857  8194 27445  5730 38703   263  3894   231     4   288   909
  3003   868  1778 13051  1672  1028   467   449 11483   571   466 34322
   428  1874     8 17158 19152   132  1420  2580    62     7   231  3228
    12 34055   594  9388  1778 15635  3563   467   910  6082 13561   486
  2445 17017 13561 30118 10555   946 33758  6700  8054   669  7526   363
  5745   486  1803  5385 17283   365   360 28611   195   722  1067    86
   909  2073 14857   425 27445  1437  1437     2     2 18047   766 27445
  5730 38703   449  1178    12 42698   466 34801    90 13051  1672  1028
 14857  8194 27445   112  3023  1028   516    36   579  4839   909  2156
 24117 14857   425 27445  1437  1437     2]
tokens: ['<s>', 'COL', 'Ġname', 'ĠVAL', 'Ġpan', 'asonic', 'Ġde', 'ct', 'Ġ6', '.', '0', 'Ġblack', 'Ġexpand', 'able', 'Ġdigital', 'Ġcord', 'less', 'Ġphone', 'Ġsystem', 'Ġk', 'xt', 'g', '9', '372', 'b', 'ĠCOL', 'Ġdescription', 'ĠVAL', 'Ġpan', 'asonic', 'Ġde', 'ct', 'Ġ6', '.', '0', 'Ġblack', 'Ġexpand', 'able', 'Ġdigital', 'Ġcord', 'less', 'Ġphone', 'Ġsystem', 'Ġk', 'xt', 'g', '9', '372', 'b', 'Ġdrop', 'Ġand', 'Ġsplash', 'Ġresistant', 'Ġ2', 'Ġhands', 'ets', 'Ġup', 'Ġto', 'Ġ6', 'Ġmulti', '-', 'hands', 'et', 'Ġcapability', 'Ġdigital', 'Ġanswering', 'Ġmachine', 'Ġsystem', 'Ġr', 'inger', 'Ġid', 'Ġcall', 'Ġwaiting', 'Ġcaller', 'Ġid', 'Ġvoic', 'email', 'Ġhold', 'Ġmute', 'Ġclock', 'Ġalarm', 'Ġled', 'Ġlighting', 'Ġnight', 'Ġmode', 'Ġcall', 'Ġblock', 'Ġspeaker', 'phone', 'Ġ11', 'Ġdays', 'Ġstandby', 'Ġ5', 'Ġhours', 'Ġtalk', 'Ġtime', 'Ġblack', 'Ġfinish', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ', 'Ġ', '</s>', '</s>', 'COL', 'Ġname', 'ĠVAL', 'Ġpan', 'asonic', 'Ġk', 'x', '-', 'tg', '9', '341', 't', 'Ġcord', 'less', 'Ġphone', 'ĠCOL', 'Ġdescription', 'ĠVAL', 'Ġ1', 'Ġx', 'Ġphone', 'Ġline', 'Ġ(', 'Ġs', 'Ġ)', 'Ġblack', 'Ġ,', 'Ġmetallic', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ', 'Ġ', '</s>']
is_heads: [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
y: 0
tags: 0
mask: tensor([1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1])
seqlen: 139
task_name: Textual/Abt-Buy
=======================
step: 0, task: Textual/Abt-Buy, loss: 0.0012378543615341187
step: 10, task: Textual/Abt-Buy, loss: 0.15415476262569427
step: 20, task: Textual/Abt-Buy, loss: 0.09653353691101074
step: 30, task: Textual/Abt-Buy, loss: 0.007096767425537109
step: 40, task: Textual/Abt-Buy, loss: 0.05568661168217659
step: 50, task: Textual/Abt-Buy, loss: 0.007505692541599274
step: 60, task: Textual/Abt-Buy, loss: 0.003104887902736664
step: 70, task: Textual/Abt-Buy, loss: 0.00584140419960022
step: 80, task: Textual/Abt-Buy, loss: 0.0067128390073776245
step: 90, task: Textual/Abt-Buy, loss: 0.02574107050895691
step: 100, task: Textual/Abt-Buy, loss: 0.0008574873208999634
step: 110, task: Textual/Abt-Buy, loss: 0.0010502338409423828
step: 120, task: Textual/Abt-Buy, loss: 0.001850128173828125
step: 130, task: Textual/Abt-Buy, loss: 0.0005078762769699097
step: 140, task: Textual/Abt-Buy, loss: 0.0005115270614624023
step: 150, task: Textual/Abt-Buy, loss: 0.0007278323173522949
step: 160, task: Textual/Abt-Buy, loss: 0.029175639152526855
step: 170, task: Textual/Abt-Buy, loss: 0.0013791322708129883
step: 180, task: Textual/Abt-Buy, loss: 0.001427769660949707
step: 190, task: Textual/Abt-Buy, loss: 0.022098608314990997
step: 200, task: Textual/Abt-Buy, loss: 0.0010166913270950317
step: 210, task: Textual/Abt-Buy, loss: 0.0269884392619133
step: 220, task: Textual/Abt-Buy, loss: 0.02086089551448822
step: 230, task: Textual/Abt-Buy, loss: 0.001218155026435852
step: 240, task: Textual/Abt-Buy, loss: 0.0009816288948059082
step: 250, task: Textual/Abt-Buy, loss: 0.00119057297706604
step: 260, task: Textual/Abt-Buy, loss: 0.011372141540050507
step: 270, task: Textual/Abt-Buy, loss: 0.0009676069021224976
step: 280, task: Textual/Abt-Buy, loss: 0.059160079807043076
step: 290, task: Textual/Abt-Buy, loss: 0.0018954426050186157
step: 300, task: Textual/Abt-Buy, loss: 0.0006724148988723755
step: 310, task: Textual/Abt-Buy, loss: 0.023414067924022675
step: 320, task: Textual/Abt-Buy, loss: 0.0020367056131362915
step: 330, task: Textual/Abt-Buy, loss: 0.10333684086799622
step: 340, task: Textual/Abt-Buy, loss: 0.05499967560172081
step: 350, task: Textual/Abt-Buy, loss: 0.03508729487657547
=========eval at epoch=5=========
Validation:
=============Textual/Abt-Buy==================
accuracy=0.944
precision=0.745
recall=0.723
f1=0.734
======================================
Test:
=============Textual/Abt-Buy==================
accuracy=0.943
precision=0.712
recall=0.782
f1=0.745
======================================
=====sanity check======
words: COL name VAL panasonic kx-tga820b black dect 6.0 cordless handset kxtga820b COL description VAL panasonic kx-tga820b black dect 6.0 cordless handset kxtga820b compatible with dect kx-tg8231 / 8232 series phone systems dect 6.0 technology answering system with compatible base unit call waiting caller id join in/privacy full color backlit lcd display black finish COL price VAL   [SEP] COL name VAL panasonic kx-tga101s dect 6.0 expansion handset COL description VAL  COL price VAL 36.04 
x: [    0 18047   766 27445  5730 38703   449  1178    12    90  2538 34212
   428   909   263  3894   231     4   288 13051  1672 17621   449 11483
  2538 34212   428 14857  8194 27445  5730 38703   449  1178    12    90
  2538 34212   428   909   263  3894   231     4   288 13051  1672 17621
   449 11483  2538 34212   428 16632    19   263  3894   449  1178    12
 42698   398 29949  1589   290 28503   651  1028  1743   263  3894   231
     4   288   806 15635   467    19 16632  1542  1933   486  2445 17017
 13561  1962    11    73 25943  5073   455  3195   124 13534   784 28690
  2332   909  2073 14857   425 27445  1437  1437     2     2 18047   766
 27445  5730 38703   449  1178    12    90  2538 12636    29   263  3894
   231     4   288  2919 17621 14857  8194 27445  1437 14857   425 27445
  2491     4  3387  1437     2]
tokens: ['<s>', 'COL', 'Ġname', 'ĠVAL', 'Ġpan', 'asonic', 'Ġk', 'x', '-', 't', 'ga', '820', 'b', 'Ġblack', 'Ġde', 'ct', 'Ġ6', '.', '0', 'Ġcord', 'less', 'Ġhandset', 'Ġk', 'xt', 'ga', '820', 'b', 'ĠCOL', 'Ġdescription', 'ĠVAL', 'Ġpan', 'asonic', 'Ġk', 'x', '-', 't', 'ga', '820', 'b', 'Ġblack', 'Ġde', 'ct', 'Ġ6', '.', '0', 'Ġcord', 'less', 'Ġhandset', 'Ġk', 'xt', 'ga', '820', 'b', 'Ġcompatible', 'Ġwith', 'Ġde', 'ct', 'Ġk', 'x', '-', 'tg', '8', '231', 'Ġ/', 'Ġ8', '232', 'Ġseries', 'Ġphone', 'Ġsystems', 'Ġde', 'ct', 'Ġ6', '.', '0', 'Ġtechnology', 'Ġanswering', 'Ġsystem', 'Ġwith', 'Ġcompatible', 'Ġbase', 'Ġunit', 'Ġcall', 'Ġwaiting', 'Ġcaller', 'Ġid', 'Ġjoin', 'Ġin', '/', 'priv', 'acy', 'Ġfull', 'Ġcolor', 'Ġback', 'lit', 'Ġl', 'cd', 'Ġdisplay', 'Ġblack', 'Ġfinish', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ', 'Ġ', '</s>', '</s>', 'COL', 'Ġname', 'ĠVAL', 'Ġpan', 'asonic', 'Ġk', 'x', '-', 't', 'ga', '101', 's', 'Ġde', 'ct', 'Ġ6', '.', '0', 'Ġexpansion', 'Ġhandset', 'ĠCOL', 'Ġdescription', 'ĠVAL', 'Ġ', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ36', '.', '04', 'Ġ', '</s>']
is_heads: [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
y: 0
tags: 0
mask: tensor([1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1])
seqlen: 137
task_name: Textual/Abt-Buy
=======================
step: 0, task: Textual/Abt-Buy, loss: 0.002371653914451599
step: 10, task: Textual/Abt-Buy, loss: 0.010092362761497498
step: 20, task: Textual/Abt-Buy, loss: 0.06933043897151947
step: 30, task: Textual/Abt-Buy, loss: 0.039388079196214676
step: 40, task: Textual/Abt-Buy, loss: 0.0038913264870643616
step: 50, task: Textual/Abt-Buy, loss: 0.10356994718313217
step: 60, task: Textual/Abt-Buy, loss: 0.004104107618331909
step: 70, task: Textual/Abt-Buy, loss: 0.0020575672388076782
step: 80, task: Textual/Abt-Buy, loss: 0.0010313093662261963
step: 90, task: Textual/Abt-Buy, loss: 0.004053167998790741
step: 100, task: Textual/Abt-Buy, loss: 0.014630012214183807
step: 110, task: Textual/Abt-Buy, loss: 0.002743855118751526
step: 120, task: Textual/Abt-Buy, loss: 0.0003405362367630005
step: 130, task: Textual/Abt-Buy, loss: 0.0011993050575256348
step: 140, task: Textual/Abt-Buy, loss: 0.01685032621026039
step: 150, task: Textual/Abt-Buy, loss: 0.0015934333205223083
step: 160, task: Textual/Abt-Buy, loss: 0.008615881204605103
step: 170, task: Textual/Abt-Buy, loss: 0.0005311369895935059
step: 180, task: Textual/Abt-Buy, loss: 0.001259148120880127
step: 190, task: Textual/Abt-Buy, loss: 0.008128315210342407
step: 200, task: Textual/Abt-Buy, loss: 0.004767574369907379
step: 210, task: Textual/Abt-Buy, loss: 0.001483827829360962
step: 220, task: Textual/Abt-Buy, loss: 0.04684861749410629
step: 230, task: Textual/Abt-Buy, loss: 0.0005158483982086182
step: 240, task: Textual/Abt-Buy, loss: 0.0005137473344802856
step: 250, task: Textual/Abt-Buy, loss: 0.00034768879413604736
step: 260, task: Textual/Abt-Buy, loss: 0.23447617888450623
step: 270, task: Textual/Abt-Buy, loss: 0.06283576786518097
step: 280, task: Textual/Abt-Buy, loss: 0.00019948184490203857
step: 290, task: Textual/Abt-Buy, loss: 0.0014155730605125427
step: 300, task: Textual/Abt-Buy, loss: 0.0003214925527572632
step: 310, task: Textual/Abt-Buy, loss: 0.00025069713592529297
step: 320, task: Textual/Abt-Buy, loss: 0.000276222825050354
step: 330, task: Textual/Abt-Buy, loss: 0.00017876923084259033
step: 340, task: Textual/Abt-Buy, loss: 0.10586822777986526
step: 350, task: Textual/Abt-Buy, loss: 0.0002455860376358032
=========eval at epoch=6=========
Validation:
=============Textual/Abt-Buy==================
accuracy=0.942
precision=0.836
recall=0.568
f1=0.676
======================================
Test:
=============Textual/Abt-Buy==================
accuracy=0.947
precision=0.883
recall=0.587
f1=0.706
======================================
=====sanity check======
words: COL name VAL vmware fusion 2 for mac vmfm20bx2 COL description VAL vmware fusion 2 for mac vmfm20bx2 run windows side-by-side with mac os x without rebooting 3d and high definition video acceleration usb device support multiple display support seamless keyboard mapping embedded antivirus and antispyware protection mac os x leopard integration boot camp support multiple cpu virtual machines COL price VAL 79.0  [SEP] COL name VAL vmware fusion 2 vmfm20bx2 COL description VAL  COL price VAL  
x: [    0 18047   766 27445 48643 10680 24904   132    13 13418 48643 40523
   844   428  1178   176 14857  8194 27445 48643 10680 24904   132    13
 13418 48643 40523   844   428  1178   176   422  6410   526    12  1409
    12  3730    19 13418 11988  3023   396  5898 23894   155   417     8
   239  8515   569 19308 49030  2187   323  1533  2332   323 19745 12722
 20410 14224 33561 19473     8  9876 19291   219 10680  2591 13418 11988
  3023  2084 23364  7465  9759  2205   323  1533 49357  6229  6271 14857
   425 27445  7589     4   288  1437     2     2 18047   766 27445 48643
 10680 24904   132 48643 40523   844   428  1178   176 14857  8194 27445
  1437 14857   425 27445  1437  1437     2]
tokens: ['<s>', 'COL', 'Ġname', 'ĠVAL', 'Ġvm', 'ware', 'Ġfusion', 'Ġ2', 'Ġfor', 'Ġmac', 'Ġvm', 'fm', '20', 'b', 'x', '2', 'ĠCOL', 'Ġdescription', 'ĠVAL', 'Ġvm', 'ware', 'Ġfusion', 'Ġ2', 'Ġfor', 'Ġmac', 'Ġvm', 'fm', '20', 'b', 'x', '2', 'Ġrun', 'Ġwindows', 'Ġside', '-', 'by', '-', 'side', 'Ġwith', 'Ġmac', 'Ġos', 'Ġx', 'Ġwithout', 'Ġreb', 'ooting', 'Ġ3', 'd', 'Ġand', 'Ġhigh', 'Ġdefinition', 'Ġvideo', 'Ġacceleration', 'Ġusb', 'Ġdevice', 'Ġsupport', 'Ġmultiple', 'Ġdisplay', 'Ġsupport', 'Ġseamless', 'Ġkeyboard', 'Ġmapping', 'Ġembedded', 'Ġantiv', 'irus', 'Ġand', 'Ġant', 'isp', 'y', 'ware', 'Ġprotection', 'Ġmac', 'Ġos', 'Ġx', 'Ġle', 'opard', 'Ġintegration', 'Ġboot', 'Ġcamp', 'Ġsupport', 'Ġmultiple', 'Ġcpu', 'Ġvirtual', 'Ġmachines', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ79', '.', '0', 'Ġ', '</s>', '</s>', 'COL', 'Ġname', 'ĠVAL', 'Ġvm', 'ware', 'Ġfusion', 'Ġ2', 'Ġvm', 'fm', '20', 'b', 'x', '2', 'ĠCOL', 'Ġdescription', 'ĠVAL', 'Ġ', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ', 'Ġ', '</s>']
is_heads: [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
y: 1
tags: 1
mask: tensor([1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1])
seqlen: 115
task_name: Textual/Abt-Buy
=======================
step: 0, task: Textual/Abt-Buy, loss: 0.0013138055801391602
step: 10, task: Textual/Abt-Buy, loss: 0.00020805001258850098
step: 20, task: Textual/Abt-Buy, loss: 0.00037334859371185303
step: 30, task: Textual/Abt-Buy, loss: 0.00027948617935180664
step: 40, task: Textual/Abt-Buy, loss: 0.0026337355375289917
step: 50, task: Textual/Abt-Buy, loss: 0.00020250678062438965
step: 60, task: Textual/Abt-Buy, loss: 0.0001678168773651123
step: 70, task: Textual/Abt-Buy, loss: 0.00022517144680023193
step: 80, task: Textual/Abt-Buy, loss: 0.00023220479488372803
step: 90, task: Textual/Abt-Buy, loss: 0.0003563910722732544
step: 100, task: Textual/Abt-Buy, loss: 0.00017677247524261475
step: 110, task: Textual/Abt-Buy, loss: 0.00015182793140411377
step: 120, task: Textual/Abt-Buy, loss: 0.19833961129188538
step: 130, task: Textual/Abt-Buy, loss: 0.00017537176609039307
step: 140, task: Textual/Abt-Buy, loss: 0.00026351213455200195
step: 150, task: Textual/Abt-Buy, loss: 0.0001455843448638916
step: 160, task: Textual/Abt-Buy, loss: 0.00025579333305358887
step: 170, task: Textual/Abt-Buy, loss: 0.00011554360389709473
step: 180, task: Textual/Abt-Buy, loss: 0.018896326422691345
step: 190, task: Textual/Abt-Buy, loss: 0.0001544952392578125
step: 200, task: Textual/Abt-Buy, loss: 0.00033092498779296875
step: 210, task: Textual/Abt-Buy, loss: 0.0003256946802139282
step: 220, task: Textual/Abt-Buy, loss: 0.005329906940460205
step: 230, task: Textual/Abt-Buy, loss: 0.0011600852012634277
step: 240, task: Textual/Abt-Buy, loss: 0.0005200356245040894
step: 250, task: Textual/Abt-Buy, loss: 0.0004257708787918091
step: 260, task: Textual/Abt-Buy, loss: 0.12653902173042297
step: 270, task: Textual/Abt-Buy, loss: 0.006244145333766937
step: 280, task: Textual/Abt-Buy, loss: 0.0009936094284057617
step: 290, task: Textual/Abt-Buy, loss: 0.0005201995372772217
step: 300, task: Textual/Abt-Buy, loss: 0.00035144388675689697
step: 310, task: Textual/Abt-Buy, loss: 0.0006601959466934204
step: 320, task: Textual/Abt-Buy, loss: 0.000795900821685791
step: 330, task: Textual/Abt-Buy, loss: 0.0009163767099380493
step: 340, task: Textual/Abt-Buy, loss: 0.2242729365825653
step: 350, task: Textual/Abt-Buy, loss: 0.00025856494903564453
=========eval at epoch=7=========
Validation:
=============Textual/Abt-Buy==================
accuracy=0.944
precision=0.915
recall=0.524
f1=0.667
======================================
Test:
=============Textual/Abt-Buy==================
accuracy=0.949
precision=0.943
recall=0.563
f1=0.705
======================================
=====sanity check======
words: COL name VAL samsung 50 ' widescreen plasma hdtv pn50a650 COL description VAL samsung 50 ' widescreen plasma hdtv pn50a650 touch of color ultra filterbright anti glare technology 1,000,000:1 dynamic contrast ratio picture-in-picture anti-burn-in technology sports/game/movie modes single integrated user interface with wheel-key remote atsc/ntsc/clear qa tuners COL price VAL   [SEP] COL name VAL samsung pn50a450 50 ' plasma tv COL description VAL samsung pn50a450 50 ' widescreen 720p plasma hdtv 1,000,000:1 dynamic contrast ratio piano black COL price VAL 995.0 
x: [    0 18047   766 27445   579 48545   654   128   885  4376 37346 29051
  1368   417 18724   181   282  1096   102 16316 14857  8194 27445   579
 48545   654   128   885  4376 37346 29051  1368   417 18724   181   282
  1096   102 16316  2842     9  3195  9620 14929 23471  1475 37355   806
   112     6   151     6   151    35   134  6878  5709  1750  2170    12
   179    12 37587  1475    12  7554    12   179   806  1612    73  2670
    73 38428 19180   881  6818  3018 12332    19  5964    12  5282  6063
    23  3866    73  3999  3866    73 18763  2231   102 27115   268 14857
   425 27445  1437  1437     2     2 18047   766 27445   579 48545   181
   282  1096   102 13872   654   128 29051 30016 14857  8194 27445   579
 48545   181   282  1096   102 13872   654   128   885  4376 37346 26180
   642 29051  1368   417 18724   112     6   151     6   151    35   134
  6878  5709  1750 13305   909 14857   425 27445   361  4015     4   288
  1437     2]
tokens: ['<s>', 'COL', 'Ġname', 'ĠVAL', 'Ġs', 'amsung', 'Ġ50', "Ġ'", 'Ġw', 'ides', 'creen', 'Ġplasma', 'Ġh', 'd', 'tv', 'Ġp', 'n', '50', 'a', '650', 'ĠCOL', 'Ġdescription', 'ĠVAL', 'Ġs', 'amsung', 'Ġ50', "Ġ'", 'Ġw', 'ides', 'creen', 'Ġplasma', 'Ġh', 'd', 'tv', 'Ġp', 'n', '50', 'a', '650', 'Ġtouch', 'Ġof', 'Ġcolor', 'Ġultra', 'Ġfilter', 'bright', 'Ġanti', 'Ġglare', 'Ġtechnology', 'Ġ1', ',', '000', ',', '000', ':', '1', 'Ġdynamic', 'Ġcontrast', 'Ġratio', 'Ġpicture', '-', 'in', '-', 'picture', 'Ġanti', '-', 'burn', '-', 'in', 'Ġtechnology', 'Ġsports', '/', 'game', '/', 'movie', 'Ġmodes', 'Ġsingle', 'Ġintegrated', 'Ġuser', 'Ġinterface', 'Ġwith', 'Ġwheel', '-', 'key', 'Ġremote', 'Ġat', 'sc', '/', 'nt', 'sc', '/', 'clear', 'Ġq', 'a', 'Ġtun', 'ers', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ', 'Ġ', '</s>', '</s>', 'COL', 'Ġname', 'ĠVAL', 'Ġs', 'amsung', 'Ġp', 'n', '50', 'a', '450', 'Ġ50', "Ġ'", 'Ġplasma', 'Ġtv', 'ĠCOL', 'Ġdescription', 'ĠVAL', 'Ġs', 'amsung', 'Ġp', 'n', '50', 'a', '450', 'Ġ50', "Ġ'", 'Ġw', 'ides', 'creen', 'Ġ720', 'p', 'Ġplasma', 'Ġh', 'd', 'tv', 'Ġ1', ',', '000', ',', '000', ':', '1', 'Ġdynamic', 'Ġcontrast', 'Ġratio', 'Ġpiano', 'Ġblack', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ9', '95', '.', '0', 'Ġ', '</s>']
is_heads: [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
y: 0
tags: 0
mask: tensor([1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1])
seqlen: 158
task_name: Textual/Abt-Buy
=======================
step: 0, task: Textual/Abt-Buy, loss: 0.0002664625644683838
step: 10, task: Textual/Abt-Buy, loss: 0.13058966398239136
step: 20, task: Textual/Abt-Buy, loss: 0.00025232136249542236
Gradient overflow.  Skipping step, loss scaler 0 reducing loss scale to 4096.0
step: 30, task: Textual/Abt-Buy, loss: 0.003883756697177887
step: 40, task: Textual/Abt-Buy, loss: 0.002958253026008606
step: 50, task: Textual/Abt-Buy, loss: 0.0002971738576889038
step: 60, task: Textual/Abt-Buy, loss: 0.000262334942817688
step: 70, task: Textual/Abt-Buy, loss: 0.00030957162380218506
step: 80, task: Textual/Abt-Buy, loss: 0.052485786378383636
step: 90, task: Textual/Abt-Buy, loss: 0.0002750605344772339
step: 100, task: Textual/Abt-Buy, loss: 0.0005770176649093628
step: 110, task: Textual/Abt-Buy, loss: 0.0017230212688446045
step: 120, task: Textual/Abt-Buy, loss: 0.00027939677238464355
step: 130, task: Textual/Abt-Buy, loss: 0.0003514587879180908
step: 140, task: Textual/Abt-Buy, loss: 0.0004412531852722168
step: 150, task: Textual/Abt-Buy, loss: 0.005743764340877533
step: 160, task: Textual/Abt-Buy, loss: 0.0003319978713989258
step: 170, task: Textual/Abt-Buy, loss: 0.008813504129648209
step: 180, task: Textual/Abt-Buy, loss: 0.04060240834951401
step: 190, task: Textual/Abt-Buy, loss: 0.001312151551246643
step: 200, task: Textual/Abt-Buy, loss: 0.00036238133907318115
step: 210, task: Textual/Abt-Buy, loss: 0.00021503865718841553
step: 220, task: Textual/Abt-Buy, loss: 0.4084106385707855
step: 230, task: Textual/Abt-Buy, loss: 0.07357331365346909
step: 240, task: Textual/Abt-Buy, loss: 0.06351914256811142
step: 250, task: Textual/Abt-Buy, loss: 0.0026725977659225464
step: 260, task: Textual/Abt-Buy, loss: 0.005081996321678162
step: 270, task: Textual/Abt-Buy, loss: 0.004170157015323639
step: 280, task: Textual/Abt-Buy, loss: 0.0001630038022994995
step: 290, task: Textual/Abt-Buy, loss: 0.0002732276916503906
step: 300, task: Textual/Abt-Buy, loss: 0.0003236234188079834
step: 310, task: Textual/Abt-Buy, loss: 0.00015963613986968994
step: 320, task: Textual/Abt-Buy, loss: 0.0006911903619766235
step: 330, task: Textual/Abt-Buy, loss: 0.000982031226158142
step: 340, task: Textual/Abt-Buy, loss: 0.027786709368228912
step: 350, task: Textual/Abt-Buy, loss: 0.0025751665234565735
=========eval at epoch=8=========
Validation:
=============Textual/Abt-Buy==================
accuracy=0.946
precision=0.887
recall=0.573
f1=0.696
======================================
Test:
=============Textual/Abt-Buy==================
accuracy=0.951
precision=0.918
recall=0.597
f1=0.724
======================================
Selected optimization level O2:  FP16 training with FP32 batchnorm and FP32 master weights.

Defaults for this optimization level are:
enabled                : True
opt_level              : O2
cast_model_type        : torch.float16
patch_torch_functions  : False
keep_batchnorm_fp32    : True
master_weights         : True
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O2
cast_model_type        : torch.float16
patch_torch_functions  : False
keep_batchnorm_fp32    : True
master_weights         : True
loss_scale             : dynamic
Warning:  multi_tensor_applier fused unscale kernel is unavailable, possibly because apex was installed without --cuda_ext --cpp_ext. Using Python fallback.  Original ImportError was: ModuleNotFoundError("No module named 'amp_C'")
Gradient overflow.  Skipping step, loss scaler 0 reducing loss scale to 32768.0
=====sanity check======
words: COL name VAL sony silver cyber-shot digital camera dscw150 COL description VAL sony silver cyber-shot digital camera dscw150 8.1 megapixels 2.7 ' lcd display 15 mb internal memory carl zeiss 5x optical zoom lens 16:9 high-resolution mode 9-point auto focus automatic macro shooting high sensitivity mode burst mode face detection intelligent scene recognition mode in-camera retouching super steadyshot optical image stabilization with anti-blur solution music slideshow hdtv compatibility beginner-friendly function guide silver finish COL price VAL   [SEP] COL name VAL sony infolithium d-type np-fd1 digital camera battery npfd1 COL description VAL lithium ion ( li-ion ) 4.2 v dc photo battery COL price VAL 41.72 
x: [    0 18047   766 27445   579  6119  4334  5381    12 10393  1778  2280
   385  3866   605  6115 14857  8194 27445   579  6119  4334  5381    12
 10393  1778  2280   385  3866   605  6115   290     4   134 10721  1115
 41699   132     4   406   128   784 28690  2332   379   475   428  3425
  3783   512   462 20025  3006   195  1178 17547 21762 10373   545    35
   466   239    12 29646  5745   361    12  2300  4485  1056  8408 12303
  1094   239 15608  5745 10084  5745   652 12673 12038  1310  4972  5745
    11    12 25092  5494 12746   154  2422 23789  2459 10120 17547  2274
 29632    19  1475    12  3662   710  2472   930 13150  1368   417 18724
 29988 37239    12  6928  5043  4704  4334  2073 14857   425 27445  1437
  1437     2     2 18047   766 27445   579  6119  4047 41894  4031   385
    12 12528 46446    12 37379   134  1778  2280  3822 46446 37379   134
 14857  8194 27445 16904 31973    36 16787    12  1499  4839   204     4
   176   748 46773  1345  3822 14857   425 27445  3492     4  4956  1437
     2]
tokens: ['<s>', 'COL', 'Ġname', 'ĠVAL', 'Ġs', 'ony', 'Ġsilver', 'Ġcyber', '-', 'shot', 'Ġdigital', 'Ġcamera', 'Ġd', 'sc', 'w', '150', 'ĠCOL', 'Ġdescription', 'ĠVAL', 'Ġs', 'ony', 'Ġsilver', 'Ġcyber', '-', 'shot', 'Ġdigital', 'Ġcamera', 'Ġd', 'sc', 'w', '150', 'Ġ8', '.', '1', 'Ġmeg', 'ap', 'ixels', 'Ġ2', '.', '7', "Ġ'", 'Ġl', 'cd', 'Ġdisplay', 'Ġ15', 'Ġm', 'b', 'Ġinternal', 'Ġmemory', 'Ġcar', 'l', 'Ġze', 'iss', 'Ġ5', 'x', 'Ġoptical', 'Ġzoom', 'Ġlens', 'Ġ16', ':', '9', 'Ġhigh', '-', 'resolution', 'Ġmode', 'Ġ9', '-', 'point', 'Ġauto', 'Ġfocus', 'Ġautomatic', 'Ġmacro', 'Ġshooting', 'Ġhigh', 'Ġsensitivity', 'Ġmode', 'Ġburst', 'Ġmode', 'Ġface', 'Ġdetection', 'Ġintelligent', 'Ġscene', 'Ġrecognition', 'Ġmode', 'Ġin', '-', 'camera', 'Ġret', 'ouch', 'ing', 'Ġsuper', 'Ġstead', 'ys', 'hot', 'Ġoptical', 'Ġimage', 'Ġstabilization', 'Ġwith', 'Ġanti', '-', 'bl', 'ur', 'Ġsolution', 'Ġmusic', 'Ġslideshow', 'Ġh', 'd', 'tv', 'Ġcompatibility', 'Ġbeginner', '-', 'friendly', 'Ġfunction', 'Ġguide', 'Ġsilver', 'Ġfinish', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ', 'Ġ', '</s>', '</s>', 'COL', 'Ġname', 'ĠVAL', 'Ġs', 'ony', 'Ġinf', 'olith', 'ium', 'Ġd', '-', 'type', 'Ġnp', '-', 'fd', '1', 'Ġdigital', 'Ġcamera', 'Ġbattery', 'Ġnp', 'fd', '1', 'ĠCOL', 'Ġdescription', 'ĠVAL', 'Ġlithium', 'Ġion', 'Ġ(', 'Ġli', '-', 'ion', 'Ġ)', 'Ġ4', '.', '2', 'Ġv', 'Ġdc', 'Ġphoto', 'Ġbattery', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ41', '.', '72', 'Ġ', '</s>']
is_heads: [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
y: 0
tags: 0
mask: tensor([1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1])
seqlen: 169
task_name: Textual/Abt-Buy
=======================
step: 0, task: Textual/Abt-Buy, loss: 0.6609261631965637
Gradient overflow.  Skipping step, loss scaler 0 reducing loss scale to 16384.0
Gradient overflow.  Skipping step, loss scaler 0 reducing loss scale to 8192.0
step: 10, task: Textual/Abt-Buy, loss: 0.6187713742256165
step: 20, task: Textual/Abt-Buy, loss: 0.5594120025634766
step: 30, task: Textual/Abt-Buy, loss: 0.18707382678985596
step: 40, task: Textual/Abt-Buy, loss: 0.25974521040916443
step: 50, task: Textual/Abt-Buy, loss: 0.46977388858795166
step: 60, task: Textual/Abt-Buy, loss: 0.2504718601703644
step: 70, task: Textual/Abt-Buy, loss: 0.16012299060821533
step: 80, task: Textual/Abt-Buy, loss: 0.3819660544395447
step: 90, task: Textual/Abt-Buy, loss: 0.2782789468765259
step: 100, task: Textual/Abt-Buy, loss: 0.31573477387428284
step: 110, task: Textual/Abt-Buy, loss: 0.42088815569877625
step: 120, task: Textual/Abt-Buy, loss: 0.5439417958259583
step: 130, task: Textual/Abt-Buy, loss: 0.3894619345664978
step: 140, task: Textual/Abt-Buy, loss: 0.07767642289400101
step: 150, task: Textual/Abt-Buy, loss: 0.2644365727901459
step: 160, task: Textual/Abt-Buy, loss: 0.03842160850763321
step: 170, task: Textual/Abt-Buy, loss: 0.3079072833061218
step: 180, task: Textual/Abt-Buy, loss: 0.6576371192932129
step: 190, task: Textual/Abt-Buy, loss: 0.23657074570655823
step: 200, task: Textual/Abt-Buy, loss: 0.3992481529712677
step: 210, task: Textual/Abt-Buy, loss: 0.4500117897987366
step: 220, task: Textual/Abt-Buy, loss: 0.1337141990661621
step: 230, task: Textual/Abt-Buy, loss: 0.09399290382862091
step: 240, task: Textual/Abt-Buy, loss: 0.47861430048942566
step: 250, task: Textual/Abt-Buy, loss: 0.6379793286323547
step: 260, task: Textual/Abt-Buy, loss: 0.233524352312088
step: 270, task: Textual/Abt-Buy, loss: 0.2775566875934601
step: 280, task: Textual/Abt-Buy, loss: 0.27333927154541016
step: 290, task: Textual/Abt-Buy, loss: 0.34678250551223755
step: 300, task: Textual/Abt-Buy, loss: 0.3928723931312561
step: 310, task: Textual/Abt-Buy, loss: 0.4045547842979431
step: 320, task: Textual/Abt-Buy, loss: 0.13058830797672272
step: 330, task: Textual/Abt-Buy, loss: 0.25990426540374756
step: 340, task: Textual/Abt-Buy, loss: 0.36284977197647095
step: 350, task: Textual/Abt-Buy, loss: 0.23353663086891174
=========eval at epoch=1=========
Validation:
=============Textual/Abt-Buy==================
accuracy=0.892
precision=0.000
recall=0.000
f1=0.000
======================================
Test:
=============Textual/Abt-Buy==================
accuracy=0.892
precision=0.000
recall=0.000
f1=0.000
======================================
/w/246/tianyu2020/miniconda2/envs/ditto/lib/python3.7/site-packages/apex/amp/_initialize.py:24: UserWarning: An input tensor was not cuda.
  warnings.warn("An input tensor was not cuda.")
/w/246/tianyu2020/miniconda2/envs/ditto/lib/python3.7/site-packages/torch/optim/lr_scheduler.py:122: UserWarning: Detected call of `lr_scheduler.step()` before `optimizer.step()`. In PyTorch 1.1.0 and later, you should call them in the opposite order: `optimizer.step()` before `lr_scheduler.step()`.  Failure to do this will result in PyTorch skipping the first value of the learning rate schedule. See more details at https://pytorch.org/docs/stable/optim.html#how-to-adjust-learning-rate
  "https://pytorch.org/docs/stable/optim.html#how-to-adjust-learning-rate", UserWarning)
/w/246/tianyu2020/miniconda2/envs/ditto/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1221: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
=====sanity check======
words: COL name VAL sony 7 ' digital photo frame in black dpfd70 COL description VAL sony 7 ' digital photo frame dpfd70 7 ' lcd with 800 x 480 resolution 15:9 aspect ratio 256mb internal memory supports most memory cards variety of display modes auto image rotation feature view mode button fast digital picture decoding handles large data files usb b-type connection remote control black finish COL price VAL 139.0  [SEP] COL name VAL sony picture station digital photo printer dppfp95 COL description VAL  COL price VAL  
x: [    0 18047   766 27445   579  6119   262   128  1778  1345  5120    11
   909   385   642 37379  3083 14857  8194 27445   579  6119   262   128
  1778  1345  5120   385   642 37379  3083   262   128   784 28690    19
  5735  3023 26754  3547   379    35   466  6659  1750 22078  6648  3425
  3783  4548   144  3783  3591  3143     9  2332 19180  4485  2274 10134
  1905  1217  5745  6148  1769  1778  2170 46133 14617   739   414  6773
 49030   741    12 12528  2748  6063   797   909  2073 14857   425 27445
 24404     4   288  1437     2     2 18047   766 27445   579  6119  2170
  1992  1778  1345 24079   385  3807 46004  4015 14857  8194 27445  1437
 14857   425 27445  1437  1437     2]
tokens: ['<s>', 'COL', 'Ġname', 'ĠVAL', 'Ġs', 'ony', 'Ġ7', "Ġ'", 'Ġdigital', 'Ġphoto', 'Ġframe', 'Ġin', 'Ġblack', 'Ġd', 'p', 'fd', '70', 'ĠCOL', 'Ġdescription', 'ĠVAL', 'Ġs', 'ony', 'Ġ7', "Ġ'", 'Ġdigital', 'Ġphoto', 'Ġframe', 'Ġd', 'p', 'fd', '70', 'Ġ7', "Ġ'", 'Ġl', 'cd', 'Ġwith', 'Ġ800', 'Ġx', 'Ġ480', 'Ġresolution', 'Ġ15', ':', '9', 'Ġaspect', 'Ġratio', 'Ġ256', 'mb', 'Ġinternal', 'Ġmemory', 'Ġsupports', 'Ġmost', 'Ġmemory', 'Ġcards', 'Ġvariety', 'Ġof', 'Ġdisplay', 'Ġmodes', 'Ġauto', 'Ġimage', 'Ġrotation', 'Ġfeature', 'Ġview', 'Ġmode', 'Ġbutton', 'Ġfast', 'Ġdigital', 'Ġpicture', 'Ġdecoding', 'Ġhandles', 'Ġlarge', 'Ġdata', 'Ġfiles', 'Ġusb', 'Ġb', '-', 'type', 'Ġconnection', 'Ġremote', 'Ġcontrol', 'Ġblack', 'Ġfinish', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ139', '.', '0', 'Ġ', '</s>', '</s>', 'COL', 'Ġname', 'ĠVAL', 'Ġs', 'ony', 'Ġpicture', 'Ġstation', 'Ġdigital', 'Ġphoto', 'Ġprinter', 'Ġd', 'pp', 'fp', '95', 'ĠCOL', 'Ġdescription', 'ĠVAL', 'Ġ', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ', 'Ġ', '</s>']
is_heads: [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
y: 0
tags: 0
mask: tensor([1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1])
seqlen: 114
task_name: Textual/Abt-Buy
=======================
step: 0, task: Textual/Abt-Buy, loss: 0.09134013950824738
step: 10, task: Textual/Abt-Buy, loss: 0.08049976825714111
step: 20, task: Textual/Abt-Buy, loss: 0.23856842517852783
step: 30, task: Textual/Abt-Buy, loss: 0.5582497119903564
step: 40, task: Textual/Abt-Buy, loss: 0.21782571077346802
step: 50, task: Textual/Abt-Buy, loss: 0.3668232560157776
step: 60, task: Textual/Abt-Buy, loss: 0.2911822497844696
step: 70, task: Textual/Abt-Buy, loss: 0.22550562024116516
step: 80, task: Textual/Abt-Buy, loss: 0.3952420949935913
step: 90, task: Textual/Abt-Buy, loss: 0.29648298025131226
step: 100, task: Textual/Abt-Buy, loss: 0.4963713586330414
step: 110, task: Textual/Abt-Buy, loss: 0.2581091523170471
step: 120, task: Textual/Abt-Buy, loss: 0.190195232629776
step: 130, task: Textual/Abt-Buy, loss: 0.15329718589782715
step: 140, task: Textual/Abt-Buy, loss: 0.4573628902435303
step: 150, task: Textual/Abt-Buy, loss: 0.42267248034477234
step: 160, task: Textual/Abt-Buy, loss: 0.1885465383529663
step: 170, task: Textual/Abt-Buy, loss: 0.2688973844051361
step: 180, task: Textual/Abt-Buy, loss: 0.0812910944223404
step: 190, task: Textual/Abt-Buy, loss: 0.08808945119380951
step: 200, task: Textual/Abt-Buy, loss: 0.05920814350247383
step: 210, task: Textual/Abt-Buy, loss: 0.25892719626426697
step: 220, task: Textual/Abt-Buy, loss: 0.6767193675041199
step: 230, task: Textual/Abt-Buy, loss: 0.21344175934791565
step: 240, task: Textual/Abt-Buy, loss: 0.22089681029319763
step: 250, task: Textual/Abt-Buy, loss: 0.0850013941526413
step: 260, task: Textual/Abt-Buy, loss: 0.19764763116836548
step: 270, task: Textual/Abt-Buy, loss: 0.305487722158432
Gradient overflow.  Skipping step, loss scaler 0 reducing loss scale to 4096.0
step: 280, task: Textual/Abt-Buy, loss: 0.04538830369710922
step: 290, task: Textual/Abt-Buy, loss: 0.2211916744709015
step: 300, task: Textual/Abt-Buy, loss: 0.00487847626209259
step: 310, task: Textual/Abt-Buy, loss: 0.2467702031135559
step: 320, task: Textual/Abt-Buy, loss: 0.28587615489959717
step: 330, task: Textual/Abt-Buy, loss: 0.1391415148973465
step: 340, task: Textual/Abt-Buy, loss: 0.11935223639011383
step: 350, task: Textual/Abt-Buy, loss: 0.10650842636823654
=========eval at epoch=1=========
Validation:
=============Textual/Abt-Buy==================
accuracy=0.926
precision=0.651
recall=0.670
f1=0.660
======================================
Test:
=============Textual/Abt-Buy==================
accuracy=0.922
precision=0.641
recall=0.617
f1=0.629
======================================
=====sanity check======
words: COL name VAL lg wm2233w 4.0 cu ft white front load washer wm2233wh COL description VAL lg wm2233w 4.0 cu ft white front load washer wm2233wh 4.0 cu . ft. capacity senseclean system water heater 7 washing programs 5 temperature levels 4 tray detergent dispenser sanitary cycle 1100 rpm maximum spin white finish COL price VAL   [SEP] COL name VAL lg 4.0 cu . ft. capacity front load washer w / sanitary cycle COL description VAL  COL price VAL  
x: [    0 18047   766 27445   784   571   885   119  2036  3103   605   204
     4   288  3729 16935  1104   760  7511    21  1843   885   119  2036
  3103 11613 14857  8194 27445   784   571   885   119  2036  3103   605
   204     4   288  3729 16935  1104   760  7511    21  1843   885   119
  2036  3103 11613   204     4   288  3729   479 16935     4  2148  1472
 28401   467   514 33013   262 14784  1767   195  5181  1389   204 27483
 10922 13907 22946   254 15610 16669  4943 28658 36461  4532  6287  1104
  2073 14857   425 27445  1437  1437     2     2 18047   766 27445   784
   571   204     4   288  3729   479 16935     4  2148   760  7511    21
  1843   885  1589 15610 16669  4943 14857  8194 27445  1437 14857   425
 27445  1437  1437     2]
tokens: ['<s>', 'COL', 'Ġname', 'ĠVAL', 'Ġl', 'g', 'Ġw', 'm', '22', '33', 'w', 'Ġ4', '.', '0', 'Ġcu', 'Ġft', 'Ġwhite', 'Ġfront', 'Ġload', 'Ġwas', 'her', 'Ġw', 'm', '22', '33', 'wh', 'ĠCOL', 'Ġdescription', 'ĠVAL', 'Ġl', 'g', 'Ġw', 'm', '22', '33', 'w', 'Ġ4', '.', '0', 'Ġcu', 'Ġft', 'Ġwhite', 'Ġfront', 'Ġload', 'Ġwas', 'her', 'Ġw', 'm', '22', '33', 'wh', 'Ġ4', '.', '0', 'Ġcu', 'Ġ.', 'Ġft', '.', 'Ġcapacity', 'Ġsense', 'clean', 'Ġsystem', 'Ġwater', 'Ġheater', 'Ġ7', 'Ġwashing', 'Ġprograms', 'Ġ5', 'Ġtemperature', 'Ġlevels', 'Ġ4', 'Ġtray', 'Ġdeter', 'gent', 'Ġdispens', 'er', 'Ġsan', 'itary', 'Ġcycle', 'Ġ1100', 'Ġrpm', 'Ġmaximum', 'Ġspin', 'Ġwhite', 'Ġfinish', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ', 'Ġ', '</s>', '</s>', 'COL', 'Ġname', 'ĠVAL', 'Ġl', 'g', 'Ġ4', '.', '0', 'Ġcu', 'Ġ.', 'Ġft', '.', 'Ġcapacity', 'Ġfront', 'Ġload', 'Ġwas', 'her', 'Ġw', 'Ġ/', 'Ġsan', 'itary', 'Ġcycle', 'ĠCOL', 'Ġdescription', 'ĠVAL', 'Ġ', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ', 'Ġ', '</s>']
is_heads: [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
y: 0
tags: 0
mask: tensor([1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1])
seqlen: 124
task_name: Textual/Abt-Buy
=======================
step: 0, task: Textual/Abt-Buy, loss: 0.38387686014175415
step: 10, task: Textual/Abt-Buy, loss: 0.16976617276668549
step: 20, task: Textual/Abt-Buy, loss: 0.008938468992710114
step: 30, task: Textual/Abt-Buy, loss: 0.09208457171916962
step: 40, task: Textual/Abt-Buy, loss: 0.24439166486263275
step: 50, task: Textual/Abt-Buy, loss: 0.1822238266468048
step: 60, task: Textual/Abt-Buy, loss: 0.41638708114624023
step: 70, task: Textual/Abt-Buy, loss: 0.17813098430633545
step: 80, task: Textual/Abt-Buy, loss: 0.11212030053138733
step: 90, task: Textual/Abt-Buy, loss: 0.15023773908615112
step: 100, task: Textual/Abt-Buy, loss: 0.07931487262248993
step: 110, task: Textual/Abt-Buy, loss: 0.39765504002571106
step: 120, task: Textual/Abt-Buy, loss: 0.34560564160346985
step: 130, task: Textual/Abt-Buy, loss: 0.07030204683542252
step: 140, task: Textual/Abt-Buy, loss: 0.15652699768543243
step: 150, task: Textual/Abt-Buy, loss: 0.07272453606128693
step: 160, task: Textual/Abt-Buy, loss: 0.2505282163619995
step: 170, task: Textual/Abt-Buy, loss: 0.049649935215711594
step: 180, task: Textual/Abt-Buy, loss: 0.06638868898153305
step: 190, task: Textual/Abt-Buy, loss: 0.09904632717370987
step: 200, task: Textual/Abt-Buy, loss: 0.010997999459505081
step: 210, task: Textual/Abt-Buy, loss: 0.02412724867463112
step: 220, task: Textual/Abt-Buy, loss: 0.066371850669384
step: 230, task: Textual/Abt-Buy, loss: 0.24455580115318298
step: 240, task: Textual/Abt-Buy, loss: 0.0937100201845169
step: 250, task: Textual/Abt-Buy, loss: 0.046236444264650345
step: 260, task: Textual/Abt-Buy, loss: 0.04379529133439064
step: 270, task: Textual/Abt-Buy, loss: 0.44253891706466675
step: 280, task: Textual/Abt-Buy, loss: 0.24740293622016907
step: 290, task: Textual/Abt-Buy, loss: 0.035451583564281464
step: 300, task: Textual/Abt-Buy, loss: 0.018116049468517303
step: 310, task: Textual/Abt-Buy, loss: 0.4539065957069397
step: 320, task: Textual/Abt-Buy, loss: 0.19339130818843842
step: 330, task: Textual/Abt-Buy, loss: 0.3003740906715393
step: 340, task: Textual/Abt-Buy, loss: 0.4235508441925049
step: 350, task: Textual/Abt-Buy, loss: 0.10446011275053024
=========eval at epoch=2=========
Validation:
=============Textual/Abt-Buy==================
accuracy=0.937
precision=0.906
recall=0.466
f1=0.615
======================================
Test:
=============Textual/Abt-Buy==================
accuracy=0.941
precision=0.883
recall=0.515
f1=0.650
======================================
=====sanity check======
words: COL name VAL samsung 5 disc home theater surround sound system httz515 COL description VAL samsung 5 disc home theater surround sound system httz515 5.1 channel 5 disc capability usb host play ipod dock divx playback dolby digital , dolby pro logic and dts system black finish COL price VAL   [SEP] COL name VAL samsung ht-z510 home theater system COL description VAL dvd player , 5.1 speakers 5 disc ( s ) progressive scan 1200w rms dolby digital , dolby pro logic ii , dts COL price VAL 321.55 
x: [    0 18047   766 27445   579 48545   195  9553   184  7364 21104  2369
   467 49805   329 36565 14857  8194 27445   579 48545   195  9553   184
  7364 21104  2369   467 49805   329 36565   195     4   134  4238   195
  9553  9388 49030  1482   310 36180  1630 15261 14445  1178 20083   385
  1168  1409  1778  2156   385  1168  1409  1759 14578     8   385  1872
   467   909  2073 14857   425 27445  1437  1437     2     2 18047   766
 27445   579 48545  1368    90    12   329 32380   184  7364   467 14857
  8194 27445   385 40311   869  2156   195     4   134  6864   195  9553
    36   579  4839  8212 14194 23777   605   910  4339   385  1168  1409
  1778  2156   385  1168  1409  1759 14578 42661  2156   385  1872 14857
   425 27445 36219     4  3118  1437     2]
tokens: ['<s>', 'COL', 'Ġname', 'ĠVAL', 'Ġs', 'amsung', 'Ġ5', 'Ġdisc', 'Ġhome', 'Ġtheater', 'Ġsurround', 'Ġsound', 'Ġsystem', 'Ġhtt', 'z', '515', 'ĠCOL', 'Ġdescription', 'ĠVAL', 'Ġs', 'amsung', 'Ġ5', 'Ġdisc', 'Ġhome', 'Ġtheater', 'Ġsurround', 'Ġsound', 'Ġsystem', 'Ġhtt', 'z', '515', 'Ġ5', '.', '1', 'Ġchannel', 'Ġ5', 'Ġdisc', 'Ġcapability', 'Ġusb', 'Ġhost', 'Ġplay', 'Ġip', 'od', 'Ġdock', 'Ġdiv', 'x', 'Ġplayback', 'Ġd', 'ol', 'by', 'Ġdigital', 'Ġ,', 'Ġd', 'ol', 'by', 'Ġpro', 'Ġlogic', 'Ġand', 'Ġd', 'ts', 'Ġsystem', 'Ġblack', 'Ġfinish', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ', 'Ġ', '</s>', '</s>', 'COL', 'Ġname', 'ĠVAL', 'Ġs', 'amsung', 'Ġh', 't', '-', 'z', '510', 'Ġhome', 'Ġtheater', 'Ġsystem', 'ĠCOL', 'Ġdescription', 'ĠVAL', 'Ġd', 'vd', 'Ġplayer', 'Ġ,', 'Ġ5', '.', '1', 'Ġspeakers', 'Ġ5', 'Ġdisc', 'Ġ(', 'Ġs', 'Ġ)', 'Ġprogressive', 'Ġscan', 'Ġ1200', 'w', 'Ġr', 'ms', 'Ġd', 'ol', 'by', 'Ġdigital', 'Ġ,', 'Ġd', 'ol', 'by', 'Ġpro', 'Ġlogic', 'Ġii', 'Ġ,', 'Ġd', 'ts', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ321', '.', '55', 'Ġ', '</s>']
is_heads: [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
y: 0
tags: 0
mask: tensor([1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1])
seqlen: 127
task_name: Textual/Abt-Buy
=======================
step: 0, task: Textual/Abt-Buy, loss: 0.10275222361087799
step: 10, task: Textual/Abt-Buy, loss: 0.01871545799076557
step: 20, task: Textual/Abt-Buy, loss: 0.04550032317638397
step: 30, task: Textual/Abt-Buy, loss: 0.1424635499715805
step: 40, task: Textual/Abt-Buy, loss: 0.18369366228580475
step: 50, task: Textual/Abt-Buy, loss: 0.05504966527223587
step: 60, task: Textual/Abt-Buy, loss: 0.04211863502860069
step: 70, task: Textual/Abt-Buy, loss: 0.03811700642108917
step: 80, task: Textual/Abt-Buy, loss: 0.29414862394332886
step: 90, task: Textual/Abt-Buy, loss: 0.03280729427933693
step: 100, task: Textual/Abt-Buy, loss: 0.113855741918087
step: 110, task: Textual/Abt-Buy, loss: 0.1653214693069458
step: 120, task: Textual/Abt-Buy, loss: 0.017578665167093277
step: 130, task: Textual/Abt-Buy, loss: 0.002550467848777771
step: 140, task: Textual/Abt-Buy, loss: 0.07974977046251297
step: 150, task: Textual/Abt-Buy, loss: 0.029548224061727524
step: 160, task: Textual/Abt-Buy, loss: 0.03699580579996109
step: 170, task: Textual/Abt-Buy, loss: 0.017597172409296036
step: 180, task: Textual/Abt-Buy, loss: 0.18995435535907745
step: 190, task: Textual/Abt-Buy, loss: 0.0915689691901207
step: 200, task: Textual/Abt-Buy, loss: 0.1460113674402237
step: 210, task: Textual/Abt-Buy, loss: 0.016240529716014862
step: 220, task: Textual/Abt-Buy, loss: 0.00611027330160141
step: 230, task: Textual/Abt-Buy, loss: 0.1804138720035553
step: 240, task: Textual/Abt-Buy, loss: 0.453489750623703
step: 250, task: Textual/Abt-Buy, loss: 0.05288457125425339
step: 260, task: Textual/Abt-Buy, loss: 0.011038199067115784
step: 270, task: Textual/Abt-Buy, loss: 0.012708917260169983
step: 280, task: Textual/Abt-Buy, loss: 0.06583605706691742
step: 290, task: Textual/Abt-Buy, loss: 0.14108452200889587
step: 300, task: Textual/Abt-Buy, loss: 0.04144981876015663
step: 310, task: Textual/Abt-Buy, loss: 0.11804334819316864
step: 320, task: Textual/Abt-Buy, loss: 0.02236224338412285
step: 330, task: Textual/Abt-Buy, loss: 0.011276677250862122
step: 340, task: Textual/Abt-Buy, loss: 0.00840892642736435
step: 350, task: Textual/Abt-Buy, loss: 0.020888470113277435
=========eval at epoch=3=========
Validation:
=============Textual/Abt-Buy==================
accuracy=0.933
precision=0.933
recall=0.408
f1=0.568
======================================
Test:
=============Textual/Abt-Buy==================
accuracy=0.938
precision=0.949
recall=0.451
f1=0.612
======================================
=====sanity check======
words: COL name VAL sony pink cyber-shot 7.2 megapixel digital camera dscw120p COL description VAL sony pink cyber-shot 7.2 megapixel digital camera dscw120p 7.2 megapixel 4x optical zoom 2.5 ' tft lcd 15 mb internal memory face detection super steadyshot image stabilization smile shutter mode smart zoom pink finish COL price VAL   [SEP] COL name VAL canon powershot sd1100 is digital elph camera melody pink 2509b001 COL description VAL canon powershot sd1100 is 8 megapixels , iso 1600 , 3x optical zoom digital camera pink melody COL price VAL  
x: [    0 18047   766 27445   579  6119  6907  5381    12 10393   262     4
   176 10721 21424  1778  2280   385  3866   605 10213   642 14857  8194
 27445   579  6119  6907  5381    12 10393   262     4   176 10721 21424
  1778  2280   385  3866   605 10213   642   262     4   176 10721 21424
   204  1178 17547 21762   132     4   245   128   326  2543   784 28690
   379   475   428  3425  3783   652 12673  2422 23789  2459 10120  2274
 29632  6675 27349  5745  2793 21762  6907  2073 14857   425 27445  1437
  1437     2     2 18047   766 27445 32839  4361 10120 46409 40830    16
  1778  1615  3792  2280 33301  6907  5773   466   428 19089 14857  8194
 27445 32839  4361 10120 46409 40830    16   290 10721  1115 41699  2156
 47191 25183  2156   155  1178 17547 21762  1778  2280  6907 33301 14857
   425 27445  1437  1437     2]
tokens: ['<s>', 'COL', 'Ġname', 'ĠVAL', 'Ġs', 'ony', 'Ġpink', 'Ġcyber', '-', 'shot', 'Ġ7', '.', '2', 'Ġmeg', 'apixel', 'Ġdigital', 'Ġcamera', 'Ġd', 'sc', 'w', '120', 'p', 'ĠCOL', 'Ġdescription', 'ĠVAL', 'Ġs', 'ony', 'Ġpink', 'Ġcyber', '-', 'shot', 'Ġ7', '.', '2', 'Ġmeg', 'apixel', 'Ġdigital', 'Ġcamera', 'Ġd', 'sc', 'w', '120', 'p', 'Ġ7', '.', '2', 'Ġmeg', 'apixel', 'Ġ4', 'x', 'Ġoptical', 'Ġzoom', 'Ġ2', '.', '5', "Ġ'", 'Ġt', 'ft', 'Ġl', 'cd', 'Ġ15', 'Ġm', 'b', 'Ġinternal', 'Ġmemory', 'Ġface', 'Ġdetection', 'Ġsuper', 'Ġstead', 'ys', 'hot', 'Ġimage', 'Ġstabilization', 'Ġsmile', 'Ġshutter', 'Ġmode', 'Ġsmart', 'Ġzoom', 'Ġpink', 'Ġfinish', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ', 'Ġ', '</s>', '</s>', 'COL', 'Ġname', 'ĠVAL', 'Ġcanon', 'Ġpowers', 'hot', 'Ġsd', '1100', 'Ġis', 'Ġdigital', 'Ġel', 'ph', 'Ġcamera', 'Ġmelody', 'Ġpink', 'Ġ250', '9', 'b', '001', 'ĠCOL', 'Ġdescription', 'ĠVAL', 'Ġcanon', 'Ġpowers', 'hot', 'Ġsd', '1100', 'Ġis', 'Ġ8', 'Ġmeg', 'ap', 'ixels', 'Ġ,', 'Ġiso', 'Ġ1600', 'Ġ,', 'Ġ3', 'x', 'Ġoptical', 'Ġzoom', 'Ġdigital', 'Ġcamera', 'Ġpink', 'Ġmelody', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ', 'Ġ', '</s>']
is_heads: [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
y: 0
tags: 0
mask: tensor([1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1])
seqlen: 137
task_name: Textual/Abt-Buy
=======================
step: 0, task: Textual/Abt-Buy, loss: 0.07533413916826248
step: 10, task: Textual/Abt-Buy, loss: 0.13718178868293762
step: 20, task: Textual/Abt-Buy, loss: 0.011183205991983414
step: 30, task: Textual/Abt-Buy, loss: 0.052991896867752075
step: 40, task: Textual/Abt-Buy, loss: 0.0034258663654327393
step: 50, task: Textual/Abt-Buy, loss: 0.15160177648067474
step: 60, task: Textual/Abt-Buy, loss: 0.27677521109580994
step: 70, task: Textual/Abt-Buy, loss: 0.05493536964058876
step: 80, task: Textual/Abt-Buy, loss: 0.07365568727254868
step: 90, task: Textual/Abt-Buy, loss: 0.0009671598672866821
step: 100, task: Textual/Abt-Buy, loss: 0.004775181412696838
step: 110, task: Textual/Abt-Buy, loss: 0.0020394325256347656
step: 120, task: Textual/Abt-Buy, loss: 0.039199717342853546
step: 130, task: Textual/Abt-Buy, loss: 0.005728073418140411
step: 140, task: Textual/Abt-Buy, loss: 0.006459668278694153
step: 150, task: Textual/Abt-Buy, loss: 0.5129180550575256
step: 160, task: Textual/Abt-Buy, loss: 0.050312358886003494
step: 170, task: Textual/Abt-Buy, loss: 0.07248860597610474
step: 180, task: Textual/Abt-Buy, loss: 0.008319132030010223
step: 190, task: Textual/Abt-Buy, loss: 0.24233955144882202
step: 200, task: Textual/Abt-Buy, loss: 0.019779376685619354
step: 210, task: Textual/Abt-Buy, loss: 0.002337723970413208
step: 220, task: Textual/Abt-Buy, loss: 0.026600396260619164
step: 230, task: Textual/Abt-Buy, loss: 0.06392417848110199
step: 240, task: Textual/Abt-Buy, loss: 0.05472233146429062
step: 250, task: Textual/Abt-Buy, loss: 0.008335299789905548
step: 260, task: Textual/Abt-Buy, loss: 0.0073403604328632355
step: 270, task: Textual/Abt-Buy, loss: 0.11336246132850647
step: 280, task: Textual/Abt-Buy, loss: 0.04425495117902756
step: 290, task: Textual/Abt-Buy, loss: 0.041361235082149506
step: 300, task: Textual/Abt-Buy, loss: 0.001318126916885376
step: 310, task: Textual/Abt-Buy, loss: 0.017593514174222946
step: 320, task: Textual/Abt-Buy, loss: 0.06646393239498138
step: 330, task: Textual/Abt-Buy, loss: 0.0049551501870155334
step: 340, task: Textual/Abt-Buy, loss: 0.01643383502960205
step: 350, task: Textual/Abt-Buy, loss: 0.021024882793426514
=========eval at epoch=4=========
Validation:
=============Textual/Abt-Buy==================
accuracy=0.941
precision=0.872
recall=0.529
f1=0.659
======================================
Test:
=============Textual/Abt-Buy==================
accuracy=0.955
precision=0.880
recall=0.675
f1=0.764
======================================
=====sanity check======
words: COL name VAL samsung l200 black 10.2 megapixel digital camera ecl200zbba COL description VAL samsung l200 black 10.2 megapixel digital camera ecl200zbba 2.5 ' intelligent lcd screen 1/2 .33 ' high resolution ccd sensor 3x optical zoom lens dis ( digital image stabilization ) face detection function black finish COL price VAL   [SEP] COL name VAL samsung nv30 digital camera silver ec-nv30zsba / us COL description VAL samsung nv30 8 megapixel digital camera with schneider lens , dual image stabilization , smart touch , and face detection silver COL price VAL 139.0 
x: [    0 18047   766 27445   579 48545   784  2619   909   158     4   176
 10721 21424  1778  2280   364  3998  2619 19831  3178 14857  8194 27445
   579 48545   784  2619   909   158     4   176 10721 21424  1778  2280
   364  3998  2619 19831  3178   132     4   245   128 12038   784 28690
  2441   112    73   176   479  3103   128   239  3547   740 28690  9626
   155  1178 17547 21762 10373  2982    36  1778  2274 29632  4839   652
 12673  5043   909  2073 14857   425 27445  1437  1437     2     2 18047
   766 27445   579 48545   295   705   541  1778  2280  4334 20508    12
 37594   541   329    29  3178  1589   201 14857  8194 27445   579 48545
   295   705   541   290 10721 21424  1778  2280    19  8447   858  5326
 10373  2156  6594  2274 29632  2156  2793  2842  2156     8   652 12673
  4334 14857   425 27445 24404     4   288  1437     2]
tokens: ['<s>', 'COL', 'Ġname', 'ĠVAL', 'Ġs', 'amsung', 'Ġl', '200', 'Ġblack', 'Ġ10', '.', '2', 'Ġmeg', 'apixel', 'Ġdigital', 'Ġcamera', 'Ġe', 'cl', '200', 'zb', 'ba', 'ĠCOL', 'Ġdescription', 'ĠVAL', 'Ġs', 'amsung', 'Ġl', '200', 'Ġblack', 'Ġ10', '.', '2', 'Ġmeg', 'apixel', 'Ġdigital', 'Ġcamera', 'Ġe', 'cl', '200', 'zb', 'ba', 'Ġ2', '.', '5', "Ġ'", 'Ġintelligent', 'Ġl', 'cd', 'Ġscreen', 'Ġ1', '/', '2', 'Ġ.', '33', "Ġ'", 'Ġhigh', 'Ġresolution', 'Ġc', 'cd', 'Ġsensor', 'Ġ3', 'x', 'Ġoptical', 'Ġzoom', 'Ġlens', 'Ġdis', 'Ġ(', 'Ġdigital', 'Ġimage', 'Ġstabilization', 'Ġ)', 'Ġface', 'Ġdetection', 'Ġfunction', 'Ġblack', 'Ġfinish', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ', 'Ġ', '</s>', '</s>', 'COL', 'Ġname', 'ĠVAL', 'Ġs', 'amsung', 'Ġn', 'v', '30', 'Ġdigital', 'Ġcamera', 'Ġsilver', 'Ġec', '-', 'nv', '30', 'z', 's', 'ba', 'Ġ/', 'Ġus', 'ĠCOL', 'Ġdescription', 'ĠVAL', 'Ġs', 'amsung', 'Ġn', 'v', '30', 'Ġ8', 'Ġmeg', 'apixel', 'Ġdigital', 'Ġcamera', 'Ġwith', 'Ġsch', 'ne', 'ider', 'Ġlens', 'Ġ,', 'Ġdual', 'Ġimage', 'Ġstabilization', 'Ġ,', 'Ġsmart', 'Ġtouch', 'Ġ,', 'Ġand', 'Ġface', 'Ġdetection', 'Ġsilver', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ139', '.', '0', 'Ġ', '</s>']
is_heads: [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
y: 0
tags: 0
mask: tensor([1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1])
seqlen: 141
task_name: Textual/Abt-Buy
=======================
step: 0, task: Textual/Abt-Buy, loss: 0.3447452783584595
step: 10, task: Textual/Abt-Buy, loss: 0.0007855892181396484
step: 20, task: Textual/Abt-Buy, loss: 0.027922436594963074
step: 30, task: Textual/Abt-Buy, loss: 0.025281591340899467
step: 40, task: Textual/Abt-Buy, loss: 0.018480494618415833
step: 50, task: Textual/Abt-Buy, loss: 0.039414774626493454
step: 60, task: Textual/Abt-Buy, loss: 0.004458233714103699
step: 70, task: Textual/Abt-Buy, loss: 0.0011942684650421143
step: 80, task: Textual/Abt-Buy, loss: 0.0045221298933029175
step: 90, task: Textual/Abt-Buy, loss: 0.29678118228912354
step: 100, task: Textual/Abt-Buy, loss: 0.06436610221862793
step: 110, task: Textual/Abt-Buy, loss: 0.001834571361541748
step: 120, task: Textual/Abt-Buy, loss: 0.04136725887656212
step: 130, task: Textual/Abt-Buy, loss: 0.001925341784954071
step: 140, task: Textual/Abt-Buy, loss: 0.009476665407419205
step: 150, task: Textual/Abt-Buy, loss: 0.0011183619499206543
step: 160, task: Textual/Abt-Buy, loss: 0.0010459274053573608
step: 170, task: Textual/Abt-Buy, loss: 0.056061744689941406
step: 180, task: Textual/Abt-Buy, loss: 0.004423327744007111
step: 190, task: Textual/Abt-Buy, loss: 0.00058726966381073
step: 200, task: Textual/Abt-Buy, loss: 0.004678256809711456
step: 210, task: Textual/Abt-Buy, loss: 0.18763624131679535
step: 220, task: Textual/Abt-Buy, loss: 0.0030867382884025574
step: 230, task: Textual/Abt-Buy, loss: 0.029913902282714844
step: 240, task: Textual/Abt-Buy, loss: 0.12315550446510315
step: 250, task: Textual/Abt-Buy, loss: 0.006818611174821854
step: 260, task: Textual/Abt-Buy, loss: 0.015139445662498474
step: 270, task: Textual/Abt-Buy, loss: 0.0017366930842399597
step: 280, task: Textual/Abt-Buy, loss: 0.0008400529623031616
step: 290, task: Textual/Abt-Buy, loss: 0.051618460565805435
step: 300, task: Textual/Abt-Buy, loss: 0.008960876613855362
step: 310, task: Textual/Abt-Buy, loss: 0.003228798508644104
step: 320, task: Textual/Abt-Buy, loss: 0.00180739164352417
step: 330, task: Textual/Abt-Buy, loss: 0.0004338175058364868
step: 340, task: Textual/Abt-Buy, loss: 0.0010243207216262817
step: 350, task: Textual/Abt-Buy, loss: 0.00739351287484169
=========eval at epoch=5=========
Validation:
=============Textual/Abt-Buy==================
accuracy=0.937
precision=0.989
recall=0.422
f1=0.592
======================================
Test:
=============Textual/Abt-Buy==================
accuracy=0.938
precision=0.958
recall=0.447
f1=0.609
======================================
=====sanity check======
words: COL name VAL panasonic dect 6.0 expandable digital cordless phone with all-digital answering system kxtg9343t COL description VAL panasonic dect 6.0 expandable digital cordless phone with all-digital answering system kxtg9343t 3 handsets system up to 6 multi-handset capability digital answering machine system ringer id call waiting caller id voicemail hold voice menu marker message mute clock alarm led lighting night mode call block speakerphone 11 days standby 5 hours talk time black metallic finish COL price VAL   [SEP] COL name VAL panasonic kx-tg9391t dect 6.0 two-line corded/cordless phone combo kx-tg9391t COL description VAL  COL price VAL 149.72 
x: [    0 18047   766 27445  5730 38703   263  3894   231     4   288  3003
   868  1778 13051  1672  1028    19    70    12 29563 15635   467   449
 11483   571   466 31920    90 14857  8194 27445  5730 38703   263  3894
   231     4   288  3003   868  1778 13051  1672  1028    19    70    12
 29563 15635   467   449 11483   571   466 31920    90   155  1420  2580
   467    62     7   231  3228    12 34055   594  9388  1778 15635  3563
   467   910  6082 13561   486  2445 17017 13561 30118 10555   946  2236
  5765 17540  1579 33758  6700  8054   669  7526   363  5745   486  1803
  5385 17283   365   360 28611   195   722  1067    86   909 24117  2073
 14857   425 27445  1437  1437     2     2 18047   766 27445  5730 38703
   449  1178    12 42698   466 35848    90   263  3894   231     4   288
    80    12  1902 13051   196    73   438  3109  1672  1028 23358   449
  1178    12 42698   466 35848    90 14857  8194 27445  1437 14857   425
 27445 24621     4  4956  1437     2]
tokens: ['<s>', 'COL', 'Ġname', 'ĠVAL', 'Ġpan', 'asonic', 'Ġde', 'ct', 'Ġ6', '.', '0', 'Ġexpand', 'able', 'Ġdigital', 'Ġcord', 'less', 'Ġphone', 'Ġwith', 'Ġall', '-', 'digital', 'Ġanswering', 'Ġsystem', 'Ġk', 'xt', 'g', '9', '343', 't', 'ĠCOL', 'Ġdescription', 'ĠVAL', 'Ġpan', 'asonic', 'Ġde', 'ct', 'Ġ6', '.', '0', 'Ġexpand', 'able', 'Ġdigital', 'Ġcord', 'less', 'Ġphone', 'Ġwith', 'Ġall', '-', 'digital', 'Ġanswering', 'Ġsystem', 'Ġk', 'xt', 'g', '9', '343', 't', 'Ġ3', 'Ġhands', 'ets', 'Ġsystem', 'Ġup', 'Ġto', 'Ġ6', 'Ġmulti', '-', 'hands', 'et', 'Ġcapability', 'Ġdigital', 'Ġanswering', 'Ġmachine', 'Ġsystem', 'Ġr', 'inger', 'Ġid', 'Ġcall', 'Ġwaiting', 'Ġcaller', 'Ġid', 'Ġvoic', 'email', 'Ġhold', 'Ġvoice', 'Ġmenu', 'Ġmarker', 'Ġmessage', 'Ġmute', 'Ġclock', 'Ġalarm', 'Ġled', 'Ġlighting', 'Ġnight', 'Ġmode', 'Ġcall', 'Ġblock', 'Ġspeaker', 'phone', 'Ġ11', 'Ġdays', 'Ġstandby', 'Ġ5', 'Ġhours', 'Ġtalk', 'Ġtime', 'Ġblack', 'Ġmetallic', 'Ġfinish', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ', 'Ġ', '</s>', '</s>', 'COL', 'Ġname', 'ĠVAL', 'Ġpan', 'asonic', 'Ġk', 'x', '-', 'tg', '9', '391', 't', 'Ġde', 'ct', 'Ġ6', '.', '0', 'Ġtwo', '-', 'line', 'Ġcord', 'ed', '/', 'c', 'ord', 'less', 'Ġphone', 'Ġcombo', 'Ġk', 'x', '-', 'tg', '9', '391', 't', 'ĠCOL', 'Ġdescription', 'ĠVAL', 'Ġ', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ149', '.', '72', 'Ġ', '</s>']
is_heads: [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
y: 0
tags: 0
mask: tensor([1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1])
seqlen: 162
task_name: Textual/Abt-Buy
=======================
step: 0, task: Textual/Abt-Buy, loss: 0.0039573535323143005
step: 10, task: Textual/Abt-Buy, loss: 0.005629308521747589
step: 20, task: Textual/Abt-Buy, loss: 0.0026024430990219116
step: 30, task: Textual/Abt-Buy, loss: 0.025502201169729233
step: 40, task: Textual/Abt-Buy, loss: 0.001312166452407837
step: 50, task: Textual/Abt-Buy, loss: 0.06521887332201004
step: 60, task: Textual/Abt-Buy, loss: 0.005782797932624817
step: 70, task: Textual/Abt-Buy, loss: 0.011969715356826782
step: 80, task: Textual/Abt-Buy, loss: 0.0006789416074752808
step: 90, task: Textual/Abt-Buy, loss: 0.02981671690940857
step: 100, task: Textual/Abt-Buy, loss: 0.066764697432518
step: 110, task: Textual/Abt-Buy, loss: 0.0005010217428207397
step: 120, task: Textual/Abt-Buy, loss: 0.004898078739643097
step: 130, task: Textual/Abt-Buy, loss: 0.0006093382835388184
step: 140, task: Textual/Abt-Buy, loss: 0.002025879919528961
step: 150, task: Textual/Abt-Buy, loss: 0.00512097030878067
step: 160, task: Textual/Abt-Buy, loss: 0.017177429050207138
step: 170, task: Textual/Abt-Buy, loss: 0.0020275115966796875
step: 180, task: Textual/Abt-Buy, loss: 0.0003880113363265991
step: 190, task: Textual/Abt-Buy, loss: 0.058718740940093994
step: 200, task: Textual/Abt-Buy, loss: 0.03816831111907959
step: 210, task: Textual/Abt-Buy, loss: 0.00023815035820007324
step: 220, task: Textual/Abt-Buy, loss: 0.00014506280422210693
step: 230, task: Textual/Abt-Buy, loss: 0.0005596354603767395
step: 240, task: Textual/Abt-Buy, loss: 0.0004323720932006836
step: 250, task: Textual/Abt-Buy, loss: 0.0032062754034996033
step: 260, task: Textual/Abt-Buy, loss: 0.0002922862768173218
step: 270, task: Textual/Abt-Buy, loss: 0.013427574187517166
step: 280, task: Textual/Abt-Buy, loss: 0.004917338490486145
step: 290, task: Textual/Abt-Buy, loss: 0.00016666948795318604
step: 300, task: Textual/Abt-Buy, loss: 0.0015990063548088074
step: 310, task: Textual/Abt-Buy, loss: 0.0013308674097061157
step: 320, task: Textual/Abt-Buy, loss: 0.0025806427001953125
step: 330, task: Textual/Abt-Buy, loss: 0.00013208389282226562
step: 340, task: Textual/Abt-Buy, loss: 0.00040866434574127197
step: 350, task: Textual/Abt-Buy, loss: 0.003675021231174469
=========eval at epoch=6=========
Validation:
=============Textual/Abt-Buy==================
accuracy=0.941
precision=0.890
recall=0.510
f1=0.648
======================================
Test:
=============Textual/Abt-Buy==================
accuracy=0.945
precision=0.880
recall=0.568
f1=0.690
======================================
=====sanity check======
words: COL name VAL panasonic 26 ' lcd hdtv in black tc26lx85 COL description VAL panasonic viera 26 ' lcd hdtv in black tc26lx85 ips high-definition lcd panel 10000:1 contrast ratio 178 ° wide viewing angle 8ms response intelligent scene controller built-in sd card slot 3 hdmi inputs and viera link hdavi control simulated surround sound black finish COL price VAL   [SEP] COL name VAL panasonic viera tc-32lz800 32 ' lcd tv COL description VAL 32 ' 16:9 1920 x 1080 COL price VAL  
x: [    0 18047   766 27445  5730 38703   973   128   784 28690  1368   417
 18724    11   909 48965  2481   462  1178  4531 14857  8194 27445  5730
 38703   748 16432   973   128   784 28690  1368   417 18724    11   909
 48965  2481   462  1178  4531  1437  7418   239    12 38835   784 28690
  2798 45563    35   134  5709  1750 29065 33397  1810  7603 11792   290
  4339  1263 12038  1310 17554  1490    12   179 46409  1886  8534   155
  1368   417  5408 16584     8   748 16432  3104  1368   417 11132   797
 27361 21104  2369   909  2073 14857   425 27445  1437  1437     2     2
 18047   766 27445  5730 38703   748 16432 48965    12  2881   462   329
  3913  2107   128   784 28690 30016 14857  8194 27445  2107   128   545
    35   466 18283  3023 21083 14857   425 27445  1437  1437     2]
tokens: ['<s>', 'COL', 'Ġname', 'ĠVAL', 'Ġpan', 'asonic', 'Ġ26', "Ġ'", 'Ġl', 'cd', 'Ġh', 'd', 'tv', 'Ġin', 'Ġblack', 'Ġtc', '26', 'l', 'x', '85', 'ĠCOL', 'Ġdescription', 'ĠVAL', 'Ġpan', 'asonic', 'Ġv', 'iera', 'Ġ26', "Ġ'", 'Ġl', 'cd', 'Ġh', 'd', 'tv', 'Ġin', 'Ġblack', 'Ġtc', '26', 'l', 'x', '85', 'Ġ', 'ips', 'Ġhigh', '-', 'definition', 'Ġl', 'cd', 'Ġpanel', 'Ġ10000', ':', '1', 'Ġcontrast', 'Ġratio', 'Ġ178', 'ĠÂ°', 'Ġwide', 'Ġviewing', 'Ġangle', 'Ġ8', 'ms', 'Ġresponse', 'Ġintelligent', 'Ġscene', 'Ġcontroller', 'Ġbuilt', '-', 'in', 'Ġsd', 'Ġcard', 'Ġslot', 'Ġ3', 'Ġh', 'd', 'mi', 'Ġinputs', 'Ġand', 'Ġv', 'iera', 'Ġlink', 'Ġh', 'd', 'avi', 'Ġcontrol', 'Ġsimulated', 'Ġsurround', 'Ġsound', 'Ġblack', 'Ġfinish', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ', 'Ġ', '</s>', '</s>', 'COL', 'Ġname', 'ĠVAL', 'Ġpan', 'asonic', 'Ġv', 'iera', 'Ġtc', '-', '32', 'l', 'z', '800', 'Ġ32', "Ġ'", 'Ġl', 'cd', 'Ġtv', 'ĠCOL', 'Ġdescription', 'ĠVAL', 'Ġ32', "Ġ'", 'Ġ16', ':', '9', 'Ġ1920', 'Ġx', 'Ġ1080', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ', 'Ġ', '</s>']
is_heads: [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
y: 0
tags: 0
mask: tensor([1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1])
seqlen: 131
task_name: Textual/Abt-Buy
=======================
step: 0, task: Textual/Abt-Buy, loss: 0.0003387033939361572
step: 10, task: Textual/Abt-Buy, loss: 0.0006040781736373901
step: 20, task: Textual/Abt-Buy, loss: 0.00150347501039505
step: 30, task: Textual/Abt-Buy, loss: 0.002099931240081787
step: 40, task: Textual/Abt-Buy, loss: 0.0002474933862686157
step: 50, task: Textual/Abt-Buy, loss: 0.001399606466293335
step: 60, task: Textual/Abt-Buy, loss: 0.0003273487091064453
step: 70, task: Textual/Abt-Buy, loss: 0.014013700187206268
step: 80, task: Textual/Abt-Buy, loss: 0.002287745475769043
step: 90, task: Textual/Abt-Buy, loss: 0.010164611041545868
step: 100, task: Textual/Abt-Buy, loss: 0.000512540340423584
step: 110, task: Textual/Abt-Buy, loss: 0.4927925169467926
step: 120, task: Textual/Abt-Buy, loss: 0.0005554407835006714
step: 130, task: Textual/Abt-Buy, loss: 0.0008151382207870483
step: 140, task: Textual/Abt-Buy, loss: 0.007925055921077728
step: 150, task: Textual/Abt-Buy, loss: 0.08365528285503387
step: 160, task: Textual/Abt-Buy, loss: 0.036891985684633255
step: 170, task: Textual/Abt-Buy, loss: 0.00016394257545471191
step: 180, task: Textual/Abt-Buy, loss: 0.0006648004055023193
step: 190, task: Textual/Abt-Buy, loss: 0.009351246058940887
step: 200, task: Textual/Abt-Buy, loss: 0.0003028959035873413
step: 210, task: Textual/Abt-Buy, loss: 0.0252224113792181
step: 220, task: Textual/Abt-Buy, loss: 0.01464764028787613
step: 230, task: Textual/Abt-Buy, loss: 0.0017709434032440186
step: 240, task: Textual/Abt-Buy, loss: 0.021314943209290504
step: 250, task: Textual/Abt-Buy, loss: 0.0005337148904800415
step: 260, task: Textual/Abt-Buy, loss: 0.02347763441503048
step: 270, task: Textual/Abt-Buy, loss: 0.0011089816689491272
step: 280, task: Textual/Abt-Buy, loss: 0.0001528412103652954
step: 290, task: Textual/Abt-Buy, loss: 0.0003377199172973633
step: 300, task: Textual/Abt-Buy, loss: 0.0003072470426559448
step: 310, task: Textual/Abt-Buy, loss: 0.016565080732107162
step: 320, task: Textual/Abt-Buy, loss: 0.0002483874559402466
step: 330, task: Textual/Abt-Buy, loss: 0.001211315393447876
step: 340, task: Textual/Abt-Buy, loss: 0.08202841877937317
step: 350, task: Textual/Abt-Buy, loss: 0.0015119314193725586
=========eval at epoch=7=========
Validation:
=============Textual/Abt-Buy==================
accuracy=0.939
precision=0.917
recall=0.481
f1=0.631
======================================
Test:
=============Textual/Abt-Buy==================
accuracy=0.944
precision=0.908
recall=0.529
f1=0.669
======================================
=====sanity check======
words: COL name VAL sony cyber-shot black digital camera dsct500b COL description VAL sony cyber-shot black digital camera dsct500b 10.1 megapixels 720p hd video recording 3.5 ' lcd plus touch screen display 4mb internal memory carl zeiss 5x optical zoom lens 16:9 high-resolution mode high sensitivity mode burst mode face detection technology high sensitivity iso 3200 in-camera retouching optical steadyshot image stabilization with double anti-blur solution hdtv compatibility bravia sync phototv hd stamina battery power black finish COL price VAL   [SEP] COL name VAL canon fs100 digital camera 2699b001 COL description VAL canon fs100 flash memory camcorder COL price VAL 299.95 
x: [    0 18047   766 27445   579  6119  5381    12 10393   909  1778  2280
   385    29  3894  1497   428 14857  8194 27445   579  6119  5381    12
 10393   909  1778  2280   385    29  3894  1497   428   158     4   134
 10721  1115 41699 26180   642  1368   417   569  5492   155     4   245
   128   784 28690  2704  2842  2441  2332   204  6648  3425  3783   512
   462 20025  3006   195  1178 17547 21762 10373   545    35   466   239
    12 29646  5745   239 15608  5745 10084  5745   652 12673   806   239
 15608 47191   155  2619    11    12 25092  5494 12746   154 17547 23789
  2459 10120  2274 29632    19  1457  1475    12  3662   710  2472  1368
   417 18724 29988 35977   493 22785 17190  1242   705  1368   417 34745
  3822   476   909  2073 14857   425 27445  1437  1437     2     2 18047
   766 27445 32839 48415  1866  1778  2280   973  2831   428 19089 14857
  8194 27445 32839 48415  1866  7462  3783 11021   438 10337 14857   425
 27445 35768     4  4015  1437     2]
tokens: ['<s>', 'COL', 'Ġname', 'ĠVAL', 'Ġs', 'ony', 'Ġcyber', '-', 'shot', 'Ġblack', 'Ġdigital', 'Ġcamera', 'Ġd', 's', 'ct', '500', 'b', 'ĠCOL', 'Ġdescription', 'ĠVAL', 'Ġs', 'ony', 'Ġcyber', '-', 'shot', 'Ġblack', 'Ġdigital', 'Ġcamera', 'Ġd', 's', 'ct', '500', 'b', 'Ġ10', '.', '1', 'Ġmeg', 'ap', 'ixels', 'Ġ720', 'p', 'Ġh', 'd', 'Ġvideo', 'Ġrecording', 'Ġ3', '.', '5', "Ġ'", 'Ġl', 'cd', 'Ġplus', 'Ġtouch', 'Ġscreen', 'Ġdisplay', 'Ġ4', 'mb', 'Ġinternal', 'Ġmemory', 'Ġcar', 'l', 'Ġze', 'iss', 'Ġ5', 'x', 'Ġoptical', 'Ġzoom', 'Ġlens', 'Ġ16', ':', '9', 'Ġhigh', '-', 'resolution', 'Ġmode', 'Ġhigh', 'Ġsensitivity', 'Ġmode', 'Ġburst', 'Ġmode', 'Ġface', 'Ġdetection', 'Ġtechnology', 'Ġhigh', 'Ġsensitivity', 'Ġiso', 'Ġ3', '200', 'Ġin', '-', 'camera', 'Ġret', 'ouch', 'ing', 'Ġoptical', 'Ġstead', 'ys', 'hot', 'Ġimage', 'Ġstabilization', 'Ġwith', 'Ġdouble', 'Ġanti', '-', 'bl', 'ur', 'Ġsolution', 'Ġh', 'd', 'tv', 'Ġcompatibility', 'Ġbrav', 'ia', 'Ġsync', 'Ġphot', 'ot', 'v', 'Ġh', 'd', 'Ġstamina', 'Ġbattery', 'Ġpower', 'Ġblack', 'Ġfinish', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ', 'Ġ', '</s>', '</s>', 'COL', 'Ġname', 'ĠVAL', 'Ġcanon', 'Ġfs', '100', 'Ġdigital', 'Ġcamera', 'Ġ26', '99', 'b', '001', 'ĠCOL', 'Ġdescription', 'ĠVAL', 'Ġcanon', 'Ġfs', '100', 'Ġflash', 'Ġmemory', 'Ġcam', 'c', 'order', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ299', '.', '95', 'Ġ', '</s>']
is_heads: [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
y: 0
tags: 0
mask: tensor([1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1])
seqlen: 162
task_name: Textual/Abt-Buy
=======================
step: 0, task: Textual/Abt-Buy, loss: 0.004457980394363403
step: 10, task: Textual/Abt-Buy, loss: 0.0016637444496154785
step: 20, task: Textual/Abt-Buy, loss: 0.019102707505226135
step: 30, task: Textual/Abt-Buy, loss: 0.0010830536484718323
step: 40, task: Textual/Abt-Buy, loss: 0.00017780065536499023
step: 50, task: Textual/Abt-Buy, loss: 0.002600640058517456
step: 60, task: Textual/Abt-Buy, loss: 0.00011810660362243652
step: 70, task: Textual/Abt-Buy, loss: 0.002822183072566986
step: 80, task: Textual/Abt-Buy, loss: 0.008815821260213852
step: 90, task: Textual/Abt-Buy, loss: 0.006238721311092377
step: 100, task: Textual/Abt-Buy, loss: 0.0005275309085845947
step: 110, task: Textual/Abt-Buy, loss: 0.0005569308996200562
step: 120, task: Textual/Abt-Buy, loss: 0.00010499358177185059
step: 130, task: Textual/Abt-Buy, loss: 0.009635716676712036
step: 140, task: Textual/Abt-Buy, loss: 0.0002788156270980835
step: 150, task: Textual/Abt-Buy, loss: 0.00027319788932800293
step: 160, task: Textual/Abt-Buy, loss: 0.0036385804414749146
step: 170, task: Textual/Abt-Buy, loss: 0.013911239802837372
step: 180, task: Textual/Abt-Buy, loss: 9.59932804107666e-05
step: 190, task: Textual/Abt-Buy, loss: 0.01013929396867752
step: 200, task: Textual/Abt-Buy, loss: 0.00010538101196289062
step: 210, task: Textual/Abt-Buy, loss: 0.0005340278148651123
step: 220, task: Textual/Abt-Buy, loss: 0.00027361512184143066
step: 230, task: Textual/Abt-Buy, loss: 0.0005047321319580078
step: 240, task: Textual/Abt-Buy, loss: 0.002286650240421295
step: 250, task: Textual/Abt-Buy, loss: 0.0002205967903137207
step: 260, task: Textual/Abt-Buy, loss: 0.002288438379764557
step: 270, task: Textual/Abt-Buy, loss: 0.12763425707817078
step: 280, task: Textual/Abt-Buy, loss: 0.0002101808786392212
step: 290, task: Textual/Abt-Buy, loss: 0.00029881298542022705
step: 300, task: Textual/Abt-Buy, loss: 0.0006243586540222168
step: 310, task: Textual/Abt-Buy, loss: 0.0017220154404640198
step: 320, task: Textual/Abt-Buy, loss: 0.021693015471100807
step: 330, task: Textual/Abt-Buy, loss: 9.685754776000977e-05
step: 340, task: Textual/Abt-Buy, loss: 0.00919358804821968
step: 350, task: Textual/Abt-Buy, loss: 0.0003027915954589844
=========eval at epoch=8=========
Validation:
=============Textual/Abt-Buy==================
accuracy=0.939
precision=0.909
recall=0.485
f1=0.633
======================================
Test:
=============Textual/Abt-Buy==================
accuracy=0.948
precision=0.942
recall=0.553
f1=0.697
======================================
Selected optimization level O2:  FP16 training with FP32 batchnorm and FP32 master weights.

Defaults for this optimization level are:
enabled                : True
opt_level              : O2
cast_model_type        : torch.float16
patch_torch_functions  : False
keep_batchnorm_fp32    : True
master_weights         : True
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O2
cast_model_type        : torch.float16
patch_torch_functions  : False
keep_batchnorm_fp32    : True
master_weights         : True
loss_scale             : dynamic
Warning:  multi_tensor_applier fused unscale kernel is unavailable, possibly because apex was installed without --cuda_ext --cpp_ext. Using Python fallback.  Original ImportError was: ModuleNotFoundError("No module named 'amp_C'")
Gradient overflow.  Skipping step, loss scaler 0 reducing loss scale to 32768.0
=====sanity check======
words: COL name VAL nikon d90 black digital slr camera with nikkor 18-105mm lens d90outfit COL description VAL nikon d90 black digital slr camera with nikkor 18-105mm lens d90outfit 12.3 megapixel 3 ' tft lcd display d-movie shooting function expeed image processing scene recognition system in-camera retouch menu low-noise performance active d-lighting viewfinder compatible with hdmi output included af-s dx nikkor 18-105mm vr lens black finish COL price VAL   [SEP] COL name VAL canon eos rebel xs digital slr camera with ef-s 18-55mm 1:3.5 -5.6 is lens black 2762b003 COL description VAL canon eos rebel xs digital slr camera with 10 megapixel , 2.5 ' lcd , 3 frames per sec & live view mode black COL price VAL 461.96 
x: [    0 18047   766 27445   295   967   261   385  3248   909  1778  3369
   338  2280    19   295 21609   368   504    12 15274  5471 10373   385
  3248   995 14307 14857  8194 27445   295   967   261   385  3248   909
  1778  3369   338  2280    19   295 21609   368   504    12 15274  5471
 10373   385  3248   995 14307   316     4   246 10721 21424   155   128
   326  2543   784 28690  2332   385    12 38428  1094  5043  1931 39640
  2274  5774  1310  4972   467    11    12 25092  5494 12746  5765   614
    12  2362  1496   819  2171   385    12 30181  1217 38116 16632    19
  1368   417  5408  4195  1165  9724    12    29 49386   295 21609   368
   504    12 15274  5471   748   338 10373   909  2073 14857   425 27445
  1437  1437     2     2 18047   766 27445 32839   364   366  8829  3023
    29  1778  3369   338  2280    19   364   506    12    29   504    12
  3118  5471   112    35   246     4   245   111   245     4   401    16
 10373   909   974  5379   428 33490 14857  8194 27445 32839   364   366
  8829  3023    29  1778  3369   338  2280    19   158 10721 21424  2156
   132     4   245   128   784 28690  2156   155 16420   228 15636   359
   697  1217  5745   909 14857   425 27445   204  5606     4  5607  1437
     2]
tokens: ['<s>', 'COL', 'Ġname', 'ĠVAL', 'Ġn', 'ik', 'on', 'Ġd', '90', 'Ġblack', 'Ġdigital', 'Ġsl', 'r', 'Ġcamera', 'Ġwith', 'Ġn', 'ikk', 'or', 'Ġ18', '-', '105', 'mm', 'Ġlens', 'Ġd', '90', 'out', 'fit', 'ĠCOL', 'Ġdescription', 'ĠVAL', 'Ġn', 'ik', 'on', 'Ġd', '90', 'Ġblack', 'Ġdigital', 'Ġsl', 'r', 'Ġcamera', 'Ġwith', 'Ġn', 'ikk', 'or', 'Ġ18', '-', '105', 'mm', 'Ġlens', 'Ġd', '90', 'out', 'fit', 'Ġ12', '.', '3', 'Ġmeg', 'apixel', 'Ġ3', "Ġ'", 'Ġt', 'ft', 'Ġl', 'cd', 'Ġdisplay', 'Ġd', '-', 'movie', 'Ġshooting', 'Ġfunction', 'Ġex', 'peed', 'Ġimage', 'Ġprocessing', 'Ġscene', 'Ġrecognition', 'Ġsystem', 'Ġin', '-', 'camera', 'Ġret', 'ouch', 'Ġmenu', 'Ġlow', '-', 'no', 'ise', 'Ġperformance', 'Ġactive', 'Ġd', '-', 'lighting', 'Ġview', 'finder', 'Ġcompatible', 'Ġwith', 'Ġh', 'd', 'mi', 'Ġoutput', 'Ġincluded', 'Ġaf', '-', 's', 'Ġdx', 'Ġn', 'ikk', 'or', 'Ġ18', '-', '105', 'mm', 'Ġv', 'r', 'Ġlens', 'Ġblack', 'Ġfinish', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ', 'Ġ', '</s>', '</s>', 'COL', 'Ġname', 'ĠVAL', 'Ġcanon', 'Ġe', 'os', 'Ġrebel', 'Ġx', 's', 'Ġdigital', 'Ġsl', 'r', 'Ġcamera', 'Ġwith', 'Ġe', 'f', '-', 's', 'Ġ18', '-', '55', 'mm', 'Ġ1', ':', '3', '.', '5', 'Ġ-', '5', '.', '6', 'Ġis', 'Ġlens', 'Ġblack', 'Ġ27', '62', 'b', '003', 'ĠCOL', 'Ġdescription', 'ĠVAL', 'Ġcanon', 'Ġe', 'os', 'Ġrebel', 'Ġx', 's', 'Ġdigital', 'Ġsl', 'r', 'Ġcamera', 'Ġwith', 'Ġ10', 'Ġmeg', 'apixel', 'Ġ,', 'Ġ2', '.', '5', "Ġ'", 'Ġl', 'cd', 'Ġ,', 'Ġ3', 'Ġframes', 'Ġper', 'Ġsec', 'Ġ&', 'Ġlive', 'Ġview', 'Ġmode', 'Ġblack', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ4', '61', '.', '96', 'Ġ', '</s>']
is_heads: [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
y: 0
tags: 0
mask: tensor([1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1])
seqlen: 205
task_name: Textual/Abt-Buy
=======================
step: 0, task: Textual/Abt-Buy, loss: 0.9415732622146606
Gradient overflow.  Skipping step, loss scaler 0 reducing loss scale to 16384.0
Gradient overflow.  Skipping step, loss scaler 0 reducing loss scale to 8192.0
Gradient overflow.  Skipping step, loss scaler 0 reducing loss scale to 4096.0
step: 10, task: Textual/Abt-Buy, loss: 0.9675344228744507
step: 20, task: Textual/Abt-Buy, loss: 0.9253772497177124
step: 30, task: Textual/Abt-Buy, loss: 0.5426086187362671
step: 40, task: Textual/Abt-Buy, loss: 0.2716352939605713
step: 50, task: Textual/Abt-Buy, loss: 0.6998221278190613
step: 60, task: Textual/Abt-Buy, loss: 0.2529453635215759
step: 70, task: Textual/Abt-Buy, loss: 0.4854435622692108
step: 80, task: Textual/Abt-Buy, loss: 0.3519488573074341
step: 90, task: Textual/Abt-Buy, loss: 0.785487949848175
step: 100, task: Textual/Abt-Buy, loss: 0.2726280093193054
step: 110, task: Textual/Abt-Buy, loss: 0.2566322386264801
step: 120, task: Textual/Abt-Buy, loss: 0.14486223459243774
step: 130, task: Textual/Abt-Buy, loss: 0.3085470497608185
step: 140, task: Textual/Abt-Buy, loss: 0.24471701681613922
step: 150, task: Textual/Abt-Buy, loss: 0.42071306705474854
step: 160, task: Textual/Abt-Buy, loss: 0.24992498755455017
step: 170, task: Textual/Abt-Buy, loss: 0.28472861647605896
step: 180, task: Textual/Abt-Buy, loss: 0.4549780488014221
step: 190, task: Textual/Abt-Buy, loss: 0.6159274578094482
step: 200, task: Textual/Abt-Buy, loss: 0.245343416929245
step: 210, task: Textual/Abt-Buy, loss: 0.9586778879165649
step: 220, task: Textual/Abt-Buy, loss: 0.20973427593708038
step: 230, task: Textual/Abt-Buy, loss: 0.19719667732715607
step: 240, task: Textual/Abt-Buy, loss: 0.3874899744987488
step: 250, task: Textual/Abt-Buy, loss: 0.6018847823143005
step: 260, task: Textual/Abt-Buy, loss: 0.24739152193069458
step: 270, task: Textual/Abt-Buy, loss: 0.252456396818161
step: 280, task: Textual/Abt-Buy, loss: 0.36112546920776367
step: 290, task: Textual/Abt-Buy, loss: 0.16628526151180267
step: 300, task: Textual/Abt-Buy, loss: 0.17477254569530487
step: 310, task: Textual/Abt-Buy, loss: 0.37269192934036255
step: 320, task: Textual/Abt-Buy, loss: 0.5036996603012085
step: 330, task: Textual/Abt-Buy, loss: 0.40914347767829895
step: 340, task: Textual/Abt-Buy, loss: 0.18869802355766296
step: 350, task: Textual/Abt-Buy, loss: 0.24251967668533325
=========eval at epoch=1=========
Validation:
=============Textual/Abt-Buy==================
accuracy=0.892
precision=0.000
recall=0.000
f1=0.000
======================================
Test:
=============Textual/Abt-Buy==================
accuracy=0.892
precision=0.000
recall=0.000
f1=0.000
======================================
/w/246/tianyu2020/miniconda2/envs/ditto/lib/python3.7/site-packages/apex/amp/_initialize.py:24: UserWarning: An input tensor was not cuda.
  warnings.warn("An input tensor was not cuda.")
/w/246/tianyu2020/miniconda2/envs/ditto/lib/python3.7/site-packages/torch/optim/lr_scheduler.py:122: UserWarning: Detected call of `lr_scheduler.step()` before `optimizer.step()`. In PyTorch 1.1.0 and later, you should call them in the opposite order: `optimizer.step()` before `lr_scheduler.step()`.  Failure to do this will result in PyTorch skipping the first value of the learning rate schedule. See more details at https://pytorch.org/docs/stable/optim.html#how-to-adjust-learning-rate
  "https://pytorch.org/docs/stable/optim.html#how-to-adjust-learning-rate", UserWarning)
/w/246/tianyu2020/miniconda2/envs/ditto/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1221: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
=====sanity check======
words: COL name VAL panasonic dect 6.0 expandable digital cordless phone with all-digital answering system kxtg9343t COL description VAL panasonic dect 6.0 expandable digital cordless phone with all-digital answering system kxtg9343t 3 handsets system up to 6 multi-handset capability digital answering machine system ringer id call waiting caller id voicemail hold voice menu marker message mute clock alarm led lighting night mode call block speakerphone 11 days standby 5 hours talk time black metallic finish COL price VAL   [SEP] COL name VAL panasonic kx-tg9333t cordless phone kx-tg9333t COL description VAL panasonic dect 6.0 1.9 ghz expandable cordless phone with digital answering system COL price VAL  
x: [    0 18047   766 27445  5730 38703   263  3894   231     4   288  3003
   868  1778 13051  1672  1028    19    70    12 29563 15635   467   449
 11483   571   466 31920    90 14857  8194 27445  5730 38703   263  3894
   231     4   288  3003   868  1778 13051  1672  1028    19    70    12
 29563 15635   467   449 11483   571   466 31920    90   155  1420  2580
   467    62     7   231  3228    12 34055   594  9388  1778 15635  3563
   467   910  6082 13561   486  2445 17017 13561 30118 10555   946  2236
  5765 17540  1579 33758  6700  8054   669  7526   363  5745   486  1803
  5385 17283   365   360 28611   195   722  1067    86   909 24117  2073
 14857   425 27445  1437  1437     2     2 18047   766 27445  5730 38703
   449  1178    12 42698   466 25631    90 13051  1672  1028   449  1178
    12 42698   466 25631    90 14857  8194 27445  5730 38703   263  3894
   231     4   288   112     4   466 34648   329  3003   868 13051  1672
  1028    19  1778 15635   467 14857   425 27445  1437  1437     2]
tokens: ['<s>', 'COL', 'Ġname', 'ĠVAL', 'Ġpan', 'asonic', 'Ġde', 'ct', 'Ġ6', '.', '0', 'Ġexpand', 'able', 'Ġdigital', 'Ġcord', 'less', 'Ġphone', 'Ġwith', 'Ġall', '-', 'digital', 'Ġanswering', 'Ġsystem', 'Ġk', 'xt', 'g', '9', '343', 't', 'ĠCOL', 'Ġdescription', 'ĠVAL', 'Ġpan', 'asonic', 'Ġde', 'ct', 'Ġ6', '.', '0', 'Ġexpand', 'able', 'Ġdigital', 'Ġcord', 'less', 'Ġphone', 'Ġwith', 'Ġall', '-', 'digital', 'Ġanswering', 'Ġsystem', 'Ġk', 'xt', 'g', '9', '343', 't', 'Ġ3', 'Ġhands', 'ets', 'Ġsystem', 'Ġup', 'Ġto', 'Ġ6', 'Ġmulti', '-', 'hands', 'et', 'Ġcapability', 'Ġdigital', 'Ġanswering', 'Ġmachine', 'Ġsystem', 'Ġr', 'inger', 'Ġid', 'Ġcall', 'Ġwaiting', 'Ġcaller', 'Ġid', 'Ġvoic', 'email', 'Ġhold', 'Ġvoice', 'Ġmenu', 'Ġmarker', 'Ġmessage', 'Ġmute', 'Ġclock', 'Ġalarm', 'Ġled', 'Ġlighting', 'Ġnight', 'Ġmode', 'Ġcall', 'Ġblock', 'Ġspeaker', 'phone', 'Ġ11', 'Ġdays', 'Ġstandby', 'Ġ5', 'Ġhours', 'Ġtalk', 'Ġtime', 'Ġblack', 'Ġmetallic', 'Ġfinish', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ', 'Ġ', '</s>', '</s>', 'COL', 'Ġname', 'ĠVAL', 'Ġpan', 'asonic', 'Ġk', 'x', '-', 'tg', '9', '333', 't', 'Ġcord', 'less', 'Ġphone', 'Ġk', 'x', '-', 'tg', '9', '333', 't', 'ĠCOL', 'Ġdescription', 'ĠVAL', 'Ġpan', 'asonic', 'Ġde', 'ct', 'Ġ6', '.', '0', 'Ġ1', '.', '9', 'Ġgh', 'z', 'Ġexpand', 'able', 'Ġcord', 'less', 'Ġphone', 'Ġwith', 'Ġdigital', 'Ġanswering', 'Ġsystem', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ', 'Ġ', '</s>']
is_heads: [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
y: 0
tags: 0
mask: tensor([1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1])
seqlen: 167
task_name: Textual/Abt-Buy
=======================
step: 0, task: Textual/Abt-Buy, loss: 0.26708152890205383
step: 10, task: Textual/Abt-Buy, loss: 0.28616347908973694
step: 20, task: Textual/Abt-Buy, loss: 0.501231849193573
step: 30, task: Textual/Abt-Buy, loss: 0.17745408415794373
step: 40, task: Textual/Abt-Buy, loss: 0.2368515431880951
step: 50, task: Textual/Abt-Buy, loss: 0.20726442337036133
step: 60, task: Textual/Abt-Buy, loss: 0.19841334223747253
step: 70, task: Textual/Abt-Buy, loss: 0.09653802216053009
step: 80, task: Textual/Abt-Buy, loss: 0.02177996188402176
step: 90, task: Textual/Abt-Buy, loss: 0.14219848811626434
step: 100, task: Textual/Abt-Buy, loss: 0.040089838206768036
step: 110, task: Textual/Abt-Buy, loss: 0.1319284588098526
step: 120, task: Textual/Abt-Buy, loss: 0.12172200530767441
step: 130, task: Textual/Abt-Buy, loss: 0.27099427580833435
step: 140, task: Textual/Abt-Buy, loss: 0.13512201607227325
step: 150, task: Textual/Abt-Buy, loss: 0.05603119730949402
step: 160, task: Textual/Abt-Buy, loss: 0.009185560047626495
step: 170, task: Textual/Abt-Buy, loss: 0.13750745356082916
step: 180, task: Textual/Abt-Buy, loss: 0.10151537507772446
step: 190, task: Textual/Abt-Buy, loss: 0.5857498645782471
step: 200, task: Textual/Abt-Buy, loss: 0.34351980686187744
step: 210, task: Textual/Abt-Buy, loss: 0.13938403129577637
step: 220, task: Textual/Abt-Buy, loss: 0.08040975779294968
step: 230, task: Textual/Abt-Buy, loss: 0.043614134192466736
step: 240, task: Textual/Abt-Buy, loss: 0.02045407146215439
step: 250, task: Textual/Abt-Buy, loss: 0.11628182977437973
step: 260, task: Textual/Abt-Buy, loss: 0.20799818634986877
step: 270, task: Textual/Abt-Buy, loss: 0.25994324684143066
step: 280, task: Textual/Abt-Buy, loss: 0.028933793306350708
step: 290, task: Textual/Abt-Buy, loss: 0.05631320923566818
step: 300, task: Textual/Abt-Buy, loss: 0.034361615777015686
step: 310, task: Textual/Abt-Buy, loss: 0.06666678190231323
step: 320, task: Textual/Abt-Buy, loss: 0.1401921808719635
step: 330, task: Textual/Abt-Buy, loss: 0.03599033132195473
step: 340, task: Textual/Abt-Buy, loss: 0.09993459284305573
step: 350, task: Textual/Abt-Buy, loss: 0.06859998404979706
=========eval at epoch=1=========
Validation:
=============Textual/Abt-Buy==================
accuracy=0.932
precision=0.688
recall=0.675
f1=0.681
======================================
Test:
=============Textual/Abt-Buy==================
accuracy=0.938
precision=0.708
recall=0.728
f1=0.718
======================================
=====sanity check======
words: COL name VAL panasonic corded phone kxts3282b COL description VAL panasonic corded phone kxts3282b 2 phone lines call waiting 50-station caller id speakerphone 3-line lcd display black finish COL price VAL   [SEP] COL name VAL panasonic kx-tg9344t expandable digital cordless phone COL description VAL 1 x phone line ( s ) COL price VAL 116.21 
x: [    0 18047   766 27445  5730 38703 13051   196  1028   449 11483    29
   246 31219   428 14857  8194 27445  5730 38703 13051   196  1028   449
 11483    29   246 31219   428   132  1028  2301   486  2445   654    12
 30650 17017 13561  5385 17283   155    12  1902   784 28690  2332   909
  2073 14857   425 27445  1437  1437     2     2 18047   766 27445  5730
 38703   449  1178    12 42698  6478  3305    90  3003   868  1778 13051
  1672  1028 14857  8194 27445   112  3023  1028   516    36   579  4839
 14857   425 27445 15966     4  2146  1437     2]
tokens: ['<s>', 'COL', 'Ġname', 'ĠVAL', 'Ġpan', 'asonic', 'Ġcord', 'ed', 'Ġphone', 'Ġk', 'xt', 's', '3', '282', 'b', 'ĠCOL', 'Ġdescription', 'ĠVAL', 'Ġpan', 'asonic', 'Ġcord', 'ed', 'Ġphone', 'Ġk', 'xt', 's', '3', '282', 'b', 'Ġ2', 'Ġphone', 'Ġlines', 'Ġcall', 'Ġwaiting', 'Ġ50', '-', 'station', 'Ġcaller', 'Ġid', 'Ġspeaker', 'phone', 'Ġ3', '-', 'line', 'Ġl', 'cd', 'Ġdisplay', 'Ġblack', 'Ġfinish', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ', 'Ġ', '</s>', '</s>', 'COL', 'Ġname', 'ĠVAL', 'Ġpan', 'asonic', 'Ġk', 'x', '-', 'tg', '93', '44', 't', 'Ġexpand', 'able', 'Ġdigital', 'Ġcord', 'less', 'Ġphone', 'ĠCOL', 'Ġdescription', 'ĠVAL', 'Ġ1', 'Ġx', 'Ġphone', 'Ġline', 'Ġ(', 'Ġs', 'Ġ)', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ116', '.', '21', 'Ġ', '</s>']
is_heads: [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
y: 0
tags: 0
mask: tensor([1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1])
seqlen: 92
task_name: Textual/Abt-Buy
=======================
step: 0, task: Textual/Abt-Buy, loss: 0.21263015270233154
step: 10, task: Textual/Abt-Buy, loss: 0.2915286421775818
step: 20, task: Textual/Abt-Buy, loss: 0.08818341791629791
step: 30, task: Textual/Abt-Buy, loss: 0.25626590847969055
step: 40, task: Textual/Abt-Buy, loss: 0.0068298205733299255
step: 50, task: Textual/Abt-Buy, loss: 0.02527005225419998
step: 60, task: Textual/Abt-Buy, loss: 0.027645651251077652
step: 70, task: Textual/Abt-Buy, loss: 0.09592227637767792
step: 80, task: Textual/Abt-Buy, loss: 0.07169199734926224
step: 90, task: Textual/Abt-Buy, loss: 0.0530703105032444
step: 100, task: Textual/Abt-Buy, loss: 0.03910001367330551
step: 110, task: Textual/Abt-Buy, loss: 0.24147453904151917
step: 120, task: Textual/Abt-Buy, loss: 0.022130422294139862
step: 130, task: Textual/Abt-Buy, loss: 0.19412899017333984
step: 140, task: Textual/Abt-Buy, loss: 0.04754449799656868
step: 150, task: Textual/Abt-Buy, loss: 0.011644609272480011
step: 160, task: Textual/Abt-Buy, loss: 0.0500258207321167
step: 170, task: Textual/Abt-Buy, loss: 0.0034347325563430786
step: 180, task: Textual/Abt-Buy, loss: 0.011075742542743683
step: 190, task: Textual/Abt-Buy, loss: 0.11988651752471924
step: 200, task: Textual/Abt-Buy, loss: 0.1525157243013382
step: 210, task: Textual/Abt-Buy, loss: 0.17764028906822205
step: 220, task: Textual/Abt-Buy, loss: 0.018383808434009552
step: 230, task: Textual/Abt-Buy, loss: 0.009261585772037506
step: 240, task: Textual/Abt-Buy, loss: 0.09886763989925385
step: 250, task: Textual/Abt-Buy, loss: 0.3175426125526428
step: 260, task: Textual/Abt-Buy, loss: 0.2219752073287964
step: 270, task: Textual/Abt-Buy, loss: 0.02167307585477829
step: 280, task: Textual/Abt-Buy, loss: 0.003466486930847168
step: 290, task: Textual/Abt-Buy, loss: 0.011780127882957458
step: 300, task: Textual/Abt-Buy, loss: 0.07786239683628082
step: 310, task: Textual/Abt-Buy, loss: 0.015387147665023804
step: 320, task: Textual/Abt-Buy, loss: 0.050997063517570496
step: 330, task: Textual/Abt-Buy, loss: 0.15463222563266754
step: 340, task: Textual/Abt-Buy, loss: 0.026948481798171997
step: 350, task: Textual/Abt-Buy, loss: 0.006553821265697479
=========eval at epoch=2=========
Validation:
=============Textual/Abt-Buy==================
accuracy=0.933
precision=0.890
recall=0.432
f1=0.582
======================================
Test:
=============Textual/Abt-Buy==================
accuracy=0.942
precision=0.928
recall=0.500
f1=0.650
======================================
=====sanity check======
words: COL name VAL canon digital eos rebel xs starter kit 9320a010 COL description VAL canon digital eos rebel xs starter kit 9320a010 includes digital gadget bag 200dg , battery pack nb-2lh , 58mm uv haze filter COL price VAL   [SEP] COL name VAL canon eos rebel xsi digital slr camera with ef-s 18-55mm f/3 .5 -5.6 is lens black 2756b003 COL description VAL canon eos rebel xsi 12 megapixel digital slr camera with 18-55mm is lens black COL price VAL 649.88 
x: [    0 18047   766 27445 32839  1778   364   366  8829  3023    29  6135
 10549  8060   844   102 30583 14857  8194 27445 32839  1778   364   366
  8829  3023    29  6135 10549  8060   844   102 30583  1171  1778 29580
  3298  1878   417   571  2156  3822  6356   295   428    12   176   462
   298  2156  4893  5471  1717   705 34008 14929 14857   425 27445  1437
  1437     2     2 18047   766 27445 32839   364   366  8829  3023 11000
  1778  3369   338  2280    19   364   506    12    29   504    12  3118
  5471   856    73   246   479   245   111   245     4   401    16 10373
   909 25949   401   428 33490 14857  8194 27445 32839   364   366  8829
  3023 11000   316 10721 21424  1778  3369   338  2280    19   504    12
  3118  5471    16 10373   909 14857   425 27445   231  3414     4  4652
  1437     2]
tokens: ['<s>', 'COL', 'Ġname', 'ĠVAL', 'Ġcanon', 'Ġdigital', 'Ġe', 'os', 'Ġrebel', 'Ġx', 's', 'Ġstarter', 'Ġkit', 'Ġ93', '20', 'a', '010', 'ĠCOL', 'Ġdescription', 'ĠVAL', 'Ġcanon', 'Ġdigital', 'Ġe', 'os', 'Ġrebel', 'Ġx', 's', 'Ġstarter', 'Ġkit', 'Ġ93', '20', 'a', '010', 'Ġincludes', 'Ġdigital', 'Ġgadget', 'Ġbag', 'Ġ200', 'd', 'g', 'Ġ,', 'Ġbattery', 'Ġpack', 'Ġn', 'b', '-', '2', 'l', 'h', 'Ġ,', 'Ġ58', 'mm', 'Ġu', 'v', 'Ġhaze', 'Ġfilter', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ', 'Ġ', '</s>', '</s>', 'COL', 'Ġname', 'ĠVAL', 'Ġcanon', 'Ġe', 'os', 'Ġrebel', 'Ġx', 'si', 'Ġdigital', 'Ġsl', 'r', 'Ġcamera', 'Ġwith', 'Ġe', 'f', '-', 's', 'Ġ18', '-', '55', 'mm', 'Ġf', '/', '3', 'Ġ.', '5', 'Ġ-', '5', '.', '6', 'Ġis', 'Ġlens', 'Ġblack', 'Ġ275', '6', 'b', '003', 'ĠCOL', 'Ġdescription', 'ĠVAL', 'Ġcanon', 'Ġe', 'os', 'Ġrebel', 'Ġx', 'si', 'Ġ12', 'Ġmeg', 'apixel', 'Ġdigital', 'Ġsl', 'r', 'Ġcamera', 'Ġwith', 'Ġ18', '-', '55', 'mm', 'Ġis', 'Ġlens', 'Ġblack', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ6', '49', '.', '88', 'Ġ', '</s>']
is_heads: [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
y: 0
tags: 0
mask: tensor([1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1])
seqlen: 134
task_name: Textual/Abt-Buy
=======================
step: 0, task: Textual/Abt-Buy, loss: 0.10363693535327911
step: 10, task: Textual/Abt-Buy, loss: 0.005112841725349426
step: 20, task: Textual/Abt-Buy, loss: 0.005639038980007172
step: 30, task: Textual/Abt-Buy, loss: 0.036679208278656006
step: 40, task: Textual/Abt-Buy, loss: 0.038901664316654205
step: 50, task: Textual/Abt-Buy, loss: 0.232054203748703
step: 60, task: Textual/Abt-Buy, loss: 0.01846444606781006
step: 70, task: Textual/Abt-Buy, loss: 0.012202039361000061
step: 80, task: Textual/Abt-Buy, loss: 0.09656792879104614
step: 90, task: Textual/Abt-Buy, loss: 0.008996382355690002
step: 100, task: Textual/Abt-Buy, loss: 0.0011045187711715698
step: 110, task: Textual/Abt-Buy, loss: 0.36996546387672424
step: 120, task: Textual/Abt-Buy, loss: 0.03653094917535782
step: 130, task: Textual/Abt-Buy, loss: 0.007063910365104675
step: 140, task: Textual/Abt-Buy, loss: 0.0349455252289772
step: 150, task: Textual/Abt-Buy, loss: 0.0162288099527359
step: 160, task: Textual/Abt-Buy, loss: 0.03324440121650696
step: 170, task: Textual/Abt-Buy, loss: 0.09569008648395538
step: 180, task: Textual/Abt-Buy, loss: 0.26661407947540283
step: 190, task: Textual/Abt-Buy, loss: 0.3648269474506378
step: 200, task: Textual/Abt-Buy, loss: 0.18499261140823364
step: 210, task: Textual/Abt-Buy, loss: 0.3911597430706024
step: 220, task: Textual/Abt-Buy, loss: 0.0129905566573143
step: 230, task: Textual/Abt-Buy, loss: 0.023981191217899323
step: 240, task: Textual/Abt-Buy, loss: 0.0054361820220947266
step: 250, task: Textual/Abt-Buy, loss: 0.0037666186690330505
step: 260, task: Textual/Abt-Buy, loss: 0.0012773796916007996
step: 270, task: Textual/Abt-Buy, loss: 0.010038308799266815
step: 280, task: Textual/Abt-Buy, loss: 0.0028688237071037292
step: 290, task: Textual/Abt-Buy, loss: 0.0016091912984848022
step: 300, task: Textual/Abt-Buy, loss: 0.0019003599882125854
step: 310, task: Textual/Abt-Buy, loss: 0.011493474245071411
step: 320, task: Textual/Abt-Buy, loss: 0.013511590659618378
step: 330, task: Textual/Abt-Buy, loss: 0.012105345726013184
step: 340, task: Textual/Abt-Buy, loss: 0.023320499807596207
step: 350, task: Textual/Abt-Buy, loss: 0.023781005293130875
=========eval at epoch=3=========
Validation:
=============Textual/Abt-Buy==================
accuracy=0.953
precision=0.946
recall=0.592
f1=0.728
======================================
Test:
=============Textual/Abt-Buy==================
accuracy=0.947
precision=0.852
recall=0.617
f1=0.715
======================================
=====sanity check======
words: COL name VAL pioneer sirius bus interface cdsb10 COL description VAL pioneer sirius bus interface cdsb10 sirius connect ' compatibility replay function game alert game zone COL price VAL 68.0  [SEP] COL name VAL pioneer ibus interface cable for ipod cd-i200 COL description VAL 6.56 ft 1 x ip-bus , 1 x proprietary audio cable COL price VAL 26.5 
x: [    0 18047   766 27445 18133 21958  6125  2353 12332   740 11622   428
   698 14857  8194 27445 18133 21958  6125  2353 12332   740 11622   428
   698 21958  6125  4686   128 29988 16462  5043   177  5439   177  2056
 14857   425 27445  5595     4   288  1437     2     2 18047   766 27445
 18133 34154   687 12332  6129    13 36180  1630 45584    12   118  2619
 14857  8194 27445   231     4  4419 16935   112  3023 36180    12 18924
  2156   112  3023 14101  6086  6129 14857   425 27445   973     4   245
  1437     2]
tokens: ['<s>', 'COL', 'Ġname', 'ĠVAL', 'Ġpioneer', 'Ġsir', 'ius', 'Ġbus', 'Ġinterface', 'Ġc', 'ds', 'b', '10', 'ĠCOL', 'Ġdescription', 'ĠVAL', 'Ġpioneer', 'Ġsir', 'ius', 'Ġbus', 'Ġinterface', 'Ġc', 'ds', 'b', '10', 'Ġsir', 'ius', 'Ġconnect', "Ġ'", 'Ġcompatibility', 'Ġreplay', 'Ġfunction', 'Ġgame', 'Ġalert', 'Ġgame', 'Ġzone', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ68', '.', '0', 'Ġ', '</s>', '</s>', 'COL', 'Ġname', 'ĠVAL', 'Ġpioneer', 'Ġib', 'us', 'Ġinterface', 'Ġcable', 'Ġfor', 'Ġip', 'od', 'Ġcd', '-', 'i', '200', 'ĠCOL', 'Ġdescription', 'ĠVAL', 'Ġ6', '.', '56', 'Ġft', 'Ġ1', 'Ġx', 'Ġip', '-', 'bus', 'Ġ,', 'Ġ1', 'Ġx', 'Ġproprietary', 'Ġaudio', 'Ġcable', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ26', '.', '5', 'Ġ', '</s>']
is_heads: [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
y: 0
tags: 0
mask: tensor([1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1])
seqlen: 86
task_name: Textual/Abt-Buy
=======================
step: 0, task: Textual/Abt-Buy, loss: 0.0065393224358558655
step: 10, task: Textual/Abt-Buy, loss: 0.056453168392181396
step: 20, task: Textual/Abt-Buy, loss: 0.01638857275247574
step: 30, task: Textual/Abt-Buy, loss: 0.003125399351119995
step: 40, task: Textual/Abt-Buy, loss: 0.08308442682027817
step: 50, task: Textual/Abt-Buy, loss: 0.004318743944168091
step: 60, task: Textual/Abt-Buy, loss: 0.03265593200922012
step: 70, task: Textual/Abt-Buy, loss: 0.0033690333366394043
step: 80, task: Textual/Abt-Buy, loss: 0.010902516543865204
step: 90, task: Textual/Abt-Buy, loss: 0.0020542293787002563
step: 100, task: Textual/Abt-Buy, loss: 0.00282365083694458
step: 110, task: Textual/Abt-Buy, loss: 0.000243455171585083
step: 120, task: Textual/Abt-Buy, loss: 0.0009249746799468994
step: 130, task: Textual/Abt-Buy, loss: 0.0260598324239254
step: 140, task: Textual/Abt-Buy, loss: 0.09346073865890503
step: 150, task: Textual/Abt-Buy, loss: 0.0711078867316246
step: 160, task: Textual/Abt-Buy, loss: 0.25102144479751587
step: 170, task: Textual/Abt-Buy, loss: 0.01217622309923172
step: 180, task: Textual/Abt-Buy, loss: 0.10552568733692169
step: 190, task: Textual/Abt-Buy, loss: 0.13363215327262878
step: 200, task: Textual/Abt-Buy, loss: 0.001009523868560791
step: 210, task: Textual/Abt-Buy, loss: 0.00945650041103363
step: 220, task: Textual/Abt-Buy, loss: 0.021888021379709244
step: 230, task: Textual/Abt-Buy, loss: 0.0036641210317611694
step: 240, task: Textual/Abt-Buy, loss: 0.0036226585507392883
step: 250, task: Textual/Abt-Buy, loss: 0.002758696675300598
step: 260, task: Textual/Abt-Buy, loss: 0.0006827712059020996
step: 270, task: Textual/Abt-Buy, loss: 0.010057792067527771
step: 280, task: Textual/Abt-Buy, loss: 0.0006609410047531128
step: 290, task: Textual/Abt-Buy, loss: 0.04255974665284157
step: 300, task: Textual/Abt-Buy, loss: 0.006455175578594208
step: 310, task: Textual/Abt-Buy, loss: 0.0005539953708648682
step: 320, task: Textual/Abt-Buy, loss: 0.027087248861789703
step: 330, task: Textual/Abt-Buy, loss: 0.0003109872341156006
step: 340, task: Textual/Abt-Buy, loss: 0.017195530235767365
step: 350, task: Textual/Abt-Buy, loss: 0.00041863322257995605
=========eval at epoch=4=========
Validation:
=============Textual/Abt-Buy==================
accuracy=0.939
precision=0.941
recall=0.461
f1=0.619
======================================
Test:
=============Textual/Abt-Buy==================
accuracy=0.947
precision=0.964
recall=0.524
f1=0.679
======================================
=====sanity check======
words: COL name VAL speck seethru orange hard shell case for 15 ' macbook mb15orgseev2 COL description VAL speck seethru orange hard shell case for 15 ' macbook mb15orgseev2 translucent hard plastic shell gives great protection full access to all controls rubber feet for added support orange finish COL price VAL   [SEP] COL name VAL speck products seethru case for apple 15 ' macbook pro mb15-pnk-see-v2 COL description VAL plastic pink COL price VAL  
x: [    0 18047   766 27445 25227  2420   842  4774  2070  8978   543 10785
   403    13   379   128 13418  6298   475   428   996  1957  1090  3623
   176 14857  8194 27445 25227  2420   842  4774  2070  8978   543 10785
   403    13   379   128 13418  6298   475   428   996  1957  1090  3623
   176 42026   543  4136 10785  2029   372  2591   455   899     7    70
  5656 11283  1730    13   355   323  8978  2073 14857   425 27445  1437
  1437     2     2 18047   766 27445 25227  2420   785   842  4774  2070
   403    13 15162   379   128 13418  6298  1759   475   428   996    12
 35857   330    12  7048    12   705   176 14857  8194 27445  4136  6907
 14857   425 27445  1437  1437     2]
tokens: ['<s>', 'COL', 'Ġname', 'ĠVAL', 'Ġspe', 'ck', 'Ġse', 'eth', 'ru', 'Ġorange', 'Ġhard', 'Ġshell', 'Ġcase', 'Ġfor', 'Ġ15', "Ġ'", 'Ġmac', 'book', 'Ġm', 'b', '15', 'org', 'se', 'ev', '2', 'ĠCOL', 'Ġdescription', 'ĠVAL', 'Ġspe', 'ck', 'Ġse', 'eth', 'ru', 'Ġorange', 'Ġhard', 'Ġshell', 'Ġcase', 'Ġfor', 'Ġ15', "Ġ'", 'Ġmac', 'book', 'Ġm', 'b', '15', 'org', 'se', 'ev', '2', 'Ġtranslucent', 'Ġhard', 'Ġplastic', 'Ġshell', 'Ġgives', 'Ġgreat', 'Ġprotection', 'Ġfull', 'Ġaccess', 'Ġto', 'Ġall', 'Ġcontrols', 'Ġrubber', 'Ġfeet', 'Ġfor', 'Ġadded', 'Ġsupport', 'Ġorange', 'Ġfinish', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ', 'Ġ', '</s>', '</s>', 'COL', 'Ġname', 'ĠVAL', 'Ġspe', 'ck', 'Ġproducts', 'Ġse', 'eth', 'ru', 'Ġcase', 'Ġfor', 'Ġapple', 'Ġ15', "Ġ'", 'Ġmac', 'book', 'Ġpro', 'Ġm', 'b', '15', '-', 'pn', 'k', '-', 'see', '-', 'v', '2', 'ĠCOL', 'Ġdescription', 'ĠVAL', 'Ġplastic', 'Ġpink', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ', 'Ġ', '</s>']
is_heads: [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
y: 0
tags: 0
mask: tensor([1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1])
seqlen: 114
task_name: Textual/Abt-Buy
=======================
step: 0, task: Textual/Abt-Buy, loss: 0.0007022470235824585
step: 10, task: Textual/Abt-Buy, loss: 0.0006534010171890259
step: 20, task: Textual/Abt-Buy, loss: 0.0004533827304840088
step: 30, task: Textual/Abt-Buy, loss: 0.0006302148103713989
step: 40, task: Textual/Abt-Buy, loss: 0.00020250678062438965
step: 50, task: Textual/Abt-Buy, loss: 0.006200872361660004
step: 60, task: Textual/Abt-Buy, loss: 0.006605565547943115
step: 70, task: Textual/Abt-Buy, loss: 0.0005346685647964478
step: 80, task: Textual/Abt-Buy, loss: 0.08483743667602539
step: 90, task: Textual/Abt-Buy, loss: 0.09779330343008041
step: 100, task: Textual/Abt-Buy, loss: 0.004741497337818146
step: 110, task: Textual/Abt-Buy, loss: 0.016774654388427734
step: 120, task: Textual/Abt-Buy, loss: 0.0010677725076675415
step: 130, task: Textual/Abt-Buy, loss: 0.0005662441253662109
step: 140, task: Textual/Abt-Buy, loss: 0.0019985586404800415
step: 150, task: Textual/Abt-Buy, loss: 0.0011084377765655518
step: 160, task: Textual/Abt-Buy, loss: 0.012914858758449554
step: 170, task: Textual/Abt-Buy, loss: 0.0038346126675605774
step: 180, task: Textual/Abt-Buy, loss: 0.0005179047584533691
step: 190, task: Textual/Abt-Buy, loss: 0.16104045510292053
step: 200, task: Textual/Abt-Buy, loss: 0.0003805011510848999
step: 210, task: Textual/Abt-Buy, loss: 0.0002222806215286255
step: 220, task: Textual/Abt-Buy, loss: 0.0017213523387908936
step: 230, task: Textual/Abt-Buy, loss: 0.0007051378488540649
step: 240, task: Textual/Abt-Buy, loss: 0.0015589594841003418
step: 250, task: Textual/Abt-Buy, loss: 0.000687137246131897
step: 260, task: Textual/Abt-Buy, loss: 0.004935994744300842
step: 270, task: Textual/Abt-Buy, loss: 0.00028683245182037354
step: 280, task: Textual/Abt-Buy, loss: 0.127084881067276
step: 290, task: Textual/Abt-Buy, loss: 0.1105564758181572
step: 300, task: Textual/Abt-Buy, loss: 0.009761914610862732
step: 310, task: Textual/Abt-Buy, loss: 0.000337749719619751
step: 320, task: Textual/Abt-Buy, loss: 0.0009264647960662842
step: 330, task: Textual/Abt-Buy, loss: 0.00020417571067810059
step: 340, task: Textual/Abt-Buy, loss: 0.0007108971476554871
step: 350, task: Textual/Abt-Buy, loss: 0.0006916522979736328
=========eval at epoch=5=========
Validation:
=============Textual/Abt-Buy==================
accuracy=0.938
precision=0.788
recall=0.578
f1=0.667
======================================
Test:
=============Textual/Abt-Buy==================
accuracy=0.947
precision=0.803
recall=0.675
f1=0.734
======================================
=====sanity check======
words: COL name VAL sony vaio cs series red notebook computer vgncs110er COL description VAL sony vaio cs series red notebook computer vgncs110er 2.0 ghz intel core 2 duo processor t5800 14.1 ' ( 1280 x 800 ) xbrite-eco widescreen display 250gb serial ata 5400rpm hard drive built-in 1.3 megapixel motion eye camera and microphone 3gb pc2-6400 ( 2gbx1 + 1gbx1 ) installed memory integrated stereo a2dp bluetooth 800mhz front side bus speed 2mb l2 cache genuine microsoft windows vista home premium 32-bit with sp1 red finish COL price VAL   [SEP] COL name VAL sony z591u/b notebook vgnz591u/b COL description VAL sony vaio z591u/b laptop intel centrino 2 core 2 duo p9500 2.53 ghz , 4gb ddr3 , 320gb sata hdd , 13.1 ' lcd , br-rom/dvdrw , 802.11 a/b/g / n , bluetooth , windows vista ultimate COL price VAL 2849.99 
x: [    0 18047   766 27445   579  6119 13205  1020 42123   651  1275 27276
  3034   748 16993 11365 11670   254 14857  8194 27445   579  6119 13205
  1020 42123   651  1275 27276  3034   748 16993 11365 11670   254   132
     4   288 34648   329 33238  2731   132  6458 10655   326  4432   612
   501     4   134   128    36 45576  3023  5735  4839  3023  3809  1459
    12 30701   885  4376 37346  2332  5773 19562 13603    23   102   195
  4017 43773   543  1305  1490    12   179   112     4   246 10721 21424
  4298  2295  2280     8 18896   155 19562 46213   176    12  4027   612
    36   132 19562  1178   134  2055   112 19562  1178   134  4839  5923
  3783  6818 31436    10   176 43923 42034 44969  5735   119 39569   760
   526  2353  2078   132  6648   784   176 30283  8916  5177 24810  6410
   748  6377   184  4549  2107    12  5881    19  2292   134  1275  2073
 14857   425 27445  1437  1437     2     2 18047   766 27445   579  6119
   992 40284   257    73   428 27276   748 16993   329 40284   257    73
   428 14857  8194 27445   579  6119 13205  1020   992 40284   257    73
   428  9972 33238 41248  1696   132  2731   132  6458   181  4015   612
   132     4  4540 34648   329  2156   204 19562   385 10232   246  2156
 21947 19562   579  2186  1368 16134  2156   508     4   134   128   784
 28690  2156  5378    12  5638    73   417   705 10232   605  2156 31551
     4  1225    10    73   428    73   571  1589   295  2156 42034 44969
  2156  6410   748  6377  7017 14857   425 27445   971  3414     4  2831
  1437     2]
tokens: ['<s>', 'COL', 'Ġname', 'ĠVAL', 'Ġs', 'ony', 'Ġva', 'io', 'Ġcs', 'Ġseries', 'Ġred', 'Ġnotebook', 'Ġcomputer', 'Ġv', 'gn', 'cs', '110', 'er', 'ĠCOL', 'Ġdescription', 'ĠVAL', 'Ġs', 'ony', 'Ġva', 'io', 'Ġcs', 'Ġseries', 'Ġred', 'Ġnotebook', 'Ġcomputer', 'Ġv', 'gn', 'cs', '110', 'er', 'Ġ2', '.', '0', 'Ġgh', 'z', 'Ġintel', 'Ġcore', 'Ġ2', 'Ġduo', 'Ġprocessor', 'Ġt', '58', '00', 'Ġ14', '.', '1', "Ġ'", 'Ġ(', 'Ġ1280', 'Ġx', 'Ġ800', 'Ġ)', 'Ġx', 'br', 'ite', '-', 'eco', 'Ġw', 'ides', 'creen', 'Ġdisplay', 'Ġ250', 'gb', 'Ġserial', 'Ġat', 'a', 'Ġ5', '400', 'rpm', 'Ġhard', 'Ġdrive', 'Ġbuilt', '-', 'in', 'Ġ1', '.', '3', 'Ġmeg', 'apixel', 'Ġmotion', 'Ġeye', 'Ġcamera', 'Ġand', 'Ġmicrophone', 'Ġ3', 'gb', 'Ġpc', '2', '-', '64', '00', 'Ġ(', 'Ġ2', 'gb', 'x', '1', 'Ġ+', 'Ġ1', 'gb', 'x', '1', 'Ġ)', 'Ġinstalled', 'Ġmemory', 'Ġintegrated', 'Ġstereo', 'Ġa', '2', 'dp', 'Ġblu', 'etooth', 'Ġ800', 'm', 'hz', 'Ġfront', 'Ġside', 'Ġbus', 'Ġspeed', 'Ġ2', 'mb', 'Ġl', '2', 'Ġcache', 'Ġgenuine', 'Ġmicro', 'soft', 'Ġwindows', 'Ġv', 'ista', 'Ġhome', 'Ġpremium', 'Ġ32', '-', 'bit', 'Ġwith', 'Ġsp', '1', 'Ġred', 'Ġfinish', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ', 'Ġ', '</s>', '</s>', 'COL', 'Ġname', 'ĠVAL', 'Ġs', 'ony', 'Ġz', '591', 'u', '/', 'b', 'Ġnotebook', 'Ġv', 'gn', 'z', '591', 'u', '/', 'b', 'ĠCOL', 'Ġdescription', 'ĠVAL', 'Ġs', 'ony', 'Ġva', 'io', 'Ġz', '591', 'u', '/', 'b', 'Ġlaptop', 'Ġintel', 'Ġcentr', 'ino', 'Ġ2', 'Ġcore', 'Ġ2', 'Ġduo', 'Ġp', '95', '00', 'Ġ2', '.', '53', 'Ġgh', 'z', 'Ġ,', 'Ġ4', 'gb', 'Ġd', 'dr', '3', 'Ġ,', 'Ġ320', 'gb', 'Ġs', 'ata', 'Ġh', 'dd', 'Ġ,', 'Ġ13', '.', '1', "Ġ'", 'Ġl', 'cd', 'Ġ,', 'Ġbr', '-', 'rom', '/', 'd', 'v', 'dr', 'w', 'Ġ,', 'Ġ802', '.', '11', 'Ġa', '/', 'b', '/', 'g', 'Ġ/', 'Ġn', 'Ġ,', 'Ġblu', 'etooth', 'Ġ,', 'Ġwindows', 'Ġv', 'ista', 'Ġultimate', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ28', '49', '.', '99', 'Ġ', '</s>']
is_heads: [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
y: 0
tags: 0
mask: tensor([1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1])
seqlen: 254
task_name: Textual/Abt-Buy
=======================
step: 0, task: Textual/Abt-Buy, loss: 0.0006758570671081543
step: 10, task: Textual/Abt-Buy, loss: 0.0017588883638381958
step: 20, task: Textual/Abt-Buy, loss: 0.005640953779220581
step: 30, task: Textual/Abt-Buy, loss: 0.001132771372795105
step: 40, task: Textual/Abt-Buy, loss: 0.0010844916105270386
step: 50, task: Textual/Abt-Buy, loss: 0.013460420072078705
step: 60, task: Textual/Abt-Buy, loss: 0.00025072693824768066
step: 70, task: Textual/Abt-Buy, loss: 0.008011698722839355
step: 80, task: Textual/Abt-Buy, loss: 0.06689122319221497
step: 90, task: Textual/Abt-Buy, loss: 0.000825539231300354
step: 100, task: Textual/Abt-Buy, loss: 0.0003260374069213867
step: 110, task: Textual/Abt-Buy, loss: 0.0007627308368682861
step: 120, task: Textual/Abt-Buy, loss: 0.0034761428833007812
step: 130, task: Textual/Abt-Buy, loss: 8.192658424377441e-05
step: 140, task: Textual/Abt-Buy, loss: 0.0006298422813415527
step: 150, task: Textual/Abt-Buy, loss: 0.0008077472448348999
step: 160, task: Textual/Abt-Buy, loss: 0.018774956464767456
step: 170, task: Textual/Abt-Buy, loss: 0.0005377978086471558
step: 180, task: Textual/Abt-Buy, loss: 0.00025394558906555176
step: 190, task: Textual/Abt-Buy, loss: 0.0007046163082122803
step: 200, task: Textual/Abt-Buy, loss: 0.030539054423570633
step: 210, task: Textual/Abt-Buy, loss: 0.0007178783416748047
step: 220, task: Textual/Abt-Buy, loss: 0.07616251707077026
step: 230, task: Textual/Abt-Buy, loss: 0.03385436534881592
step: 240, task: Textual/Abt-Buy, loss: 0.0012502297759056091
step: 250, task: Textual/Abt-Buy, loss: 0.0005720555782318115
step: 260, task: Textual/Abt-Buy, loss: 0.053603582084178925
step: 270, task: Textual/Abt-Buy, loss: 0.13972580432891846
step: 280, task: Textual/Abt-Buy, loss: 0.00048744678497314453
step: 290, task: Textual/Abt-Buy, loss: 0.02258513867855072
step: 300, task: Textual/Abt-Buy, loss: 0.00028724968433380127
step: 310, task: Textual/Abt-Buy, loss: 0.014461472630500793
step: 320, task: Textual/Abt-Buy, loss: 0.005543380975723267
step: 330, task: Textual/Abt-Buy, loss: 0.0010079890489578247
step: 340, task: Textual/Abt-Buy, loss: 0.0006730854511260986
step: 350, task: Textual/Abt-Buy, loss: 0.0005151629447937012
=========eval at epoch=6=========
Validation:
=============Textual/Abt-Buy==================
accuracy=0.935
precision=0.886
recall=0.451
f1=0.598
======================================
Test:
=============Textual/Abt-Buy==================
accuracy=0.944
precision=0.930
recall=0.515
f1=0.662
======================================
=====sanity check======
words: COL name VAL panasonic dect 6.0 expandable digital cordless phone with all-digital answering system kxtg9342t COL description VAL panasonic dect 6.0 expandable digital cordless phone with all-digital answering system kxtg9342t 2 handsets system up to 6 multi-handset capability digital answering machine system ringer id call waiting caller id voicemail hold voice menu marker message mute clock alarm led lighting night mode call block speakerphone 11 days standby 5 hours talk time black metallic finish COL price VAL   [SEP] COL name VAL panasonic kx-tg6700b cordless telephone COL description VAL panasonic kx-tg6700b 5.8 ghz 2-line fhss gigarange expandable digital cordless phone with answering system & call waiting caller id COL price VAL 106.14 
x: [    0 18047   766 27445  5730 38703   263  3894   231     4   288  3003
   868  1778 13051  1672  1028    19    70    12 29563 15635   467   449
 11483   571   466 33192    90 14857  8194 27445  5730 38703   263  3894
   231     4   288  3003   868  1778 13051  1672  1028    19    70    12
 29563 15635   467   449 11483   571   466 33192    90   132  1420  2580
   467    62     7   231  3228    12 34055   594  9388  1778 15635  3563
   467   910  6082 13561   486  2445 17017 13561 30118 10555   946  2236
  5765 17540  1579 33758  6700  8054   669  7526   363  5745   486  1803
  5385 17283   365   360 28611   195   722  1067    86   909 24117  2073
 14857   425 27445  1437  1437     2     2 18047   766 27445  5730 38703
   449  1178    12 42698  4111   612   428 13051  1672  7377 14857  8194
 27445  5730 38703   449  1178    12 42698  4111   612   428   195     4
   398 34648   329   132    12  1902   856   298  7485 10196   271 10987
  3003   868  1778 13051  1672  1028    19 15635   467   359   486  2445
 17017 13561 14857   425 27445 13442     4  1570  1437     2]
tokens: ['<s>', 'COL', 'Ġname', 'ĠVAL', 'Ġpan', 'asonic', 'Ġde', 'ct', 'Ġ6', '.', '0', 'Ġexpand', 'able', 'Ġdigital', 'Ġcord', 'less', 'Ġphone', 'Ġwith', 'Ġall', '-', 'digital', 'Ġanswering', 'Ġsystem', 'Ġk', 'xt', 'g', '9', '342', 't', 'ĠCOL', 'Ġdescription', 'ĠVAL', 'Ġpan', 'asonic', 'Ġde', 'ct', 'Ġ6', '.', '0', 'Ġexpand', 'able', 'Ġdigital', 'Ġcord', 'less', 'Ġphone', 'Ġwith', 'Ġall', '-', 'digital', 'Ġanswering', 'Ġsystem', 'Ġk', 'xt', 'g', '9', '342', 't', 'Ġ2', 'Ġhands', 'ets', 'Ġsystem', 'Ġup', 'Ġto', 'Ġ6', 'Ġmulti', '-', 'hands', 'et', 'Ġcapability', 'Ġdigital', 'Ġanswering', 'Ġmachine', 'Ġsystem', 'Ġr', 'inger', 'Ġid', 'Ġcall', 'Ġwaiting', 'Ġcaller', 'Ġid', 'Ġvoic', 'email', 'Ġhold', 'Ġvoice', 'Ġmenu', 'Ġmarker', 'Ġmessage', 'Ġmute', 'Ġclock', 'Ġalarm', 'Ġled', 'Ġlighting', 'Ġnight', 'Ġmode', 'Ġcall', 'Ġblock', 'Ġspeaker', 'phone', 'Ġ11', 'Ġdays', 'Ġstandby', 'Ġ5', 'Ġhours', 'Ġtalk', 'Ġtime', 'Ġblack', 'Ġmetallic', 'Ġfinish', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ', 'Ġ', '</s>', '</s>', 'COL', 'Ġname', 'ĠVAL', 'Ġpan', 'asonic', 'Ġk', 'x', '-', 'tg', '67', '00', 'b', 'Ġcord', 'less', 'Ġtelephone', 'ĠCOL', 'Ġdescription', 'ĠVAL', 'Ġpan', 'asonic', 'Ġk', 'x', '-', 'tg', '67', '00', 'b', 'Ġ5', '.', '8', 'Ġgh', 'z', 'Ġ2', '-', 'line', 'Ġf', 'h', 'ss', 'Ġgig', 'ar', 'ange', 'Ġexpand', 'able', 'Ġdigital', 'Ġcord', 'less', 'Ġphone', 'Ġwith', 'Ġanswering', 'Ġsystem', 'Ġ&', 'Ġcall', 'Ġwaiting', 'Ġcaller', 'Ġid', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ106', '.', '14', 'Ġ', '</s>']
is_heads: [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
y: 0
tags: 0
mask: tensor([1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1])
seqlen: 178
task_name: Textual/Abt-Buy
=======================
step: 0, task: Textual/Abt-Buy, loss: 0.000510290265083313
step: 10, task: Textual/Abt-Buy, loss: 0.0010713189840316772
step: 20, task: Textual/Abt-Buy, loss: 0.0006481260061264038
step: 30, task: Textual/Abt-Buy, loss: 8.544325828552246e-05
step: 40, task: Textual/Abt-Buy, loss: 0.001497223973274231
step: 50, task: Textual/Abt-Buy, loss: 0.012329574674367905
step: 60, task: Textual/Abt-Buy, loss: 0.00016763806343078613
step: 70, task: Textual/Abt-Buy, loss: 0.00030840933322906494
step: 80, task: Textual/Abt-Buy, loss: 0.0012948811054229736
step: 90, task: Textual/Abt-Buy, loss: 0.22600911557674408
step: 100, task: Textual/Abt-Buy, loss: 0.00046528875827789307
step: 110, task: Textual/Abt-Buy, loss: 0.11068595945835114
step: 120, task: Textual/Abt-Buy, loss: 0.05059022828936577
step: 130, task: Textual/Abt-Buy, loss: 6.046891212463379e-05
step: 140, task: Textual/Abt-Buy, loss: 0.0003382563591003418
step: 150, task: Textual/Abt-Buy, loss: 0.0004976838827133179
step: 160, task: Textual/Abt-Buy, loss: 0.0013140738010406494
step: 170, task: Textual/Abt-Buy, loss: 0.006862647831439972
step: 180, task: Textual/Abt-Buy, loss: 0.0002852529287338257
step: 190, task: Textual/Abt-Buy, loss: 0.0006193965673446655
step: 200, task: Textual/Abt-Buy, loss: 0.00025953352451324463
step: 210, task: Textual/Abt-Buy, loss: 0.11056138575077057
step: 220, task: Textual/Abt-Buy, loss: 0.00044937431812286377
step: 230, task: Textual/Abt-Buy, loss: 0.00017742812633514404
step: 240, task: Textual/Abt-Buy, loss: 0.00229489803314209
step: 250, task: Textual/Abt-Buy, loss: 0.00021602213382720947
step: 260, task: Textual/Abt-Buy, loss: 0.0476316399872303
step: 270, task: Textual/Abt-Buy, loss: 0.0004301220178604126
step: 280, task: Textual/Abt-Buy, loss: 0.036685556173324585
step: 290, task: Textual/Abt-Buy, loss: 0.000224381685256958
step: 300, task: Textual/Abt-Buy, loss: 0.0066489651799201965
step: 310, task: Textual/Abt-Buy, loss: 0.0003970712423324585
step: 320, task: Textual/Abt-Buy, loss: 0.0002298802137374878
step: 330, task: Textual/Abt-Buy, loss: 0.0003031045198440552
step: 340, task: Textual/Abt-Buy, loss: 0.03700611740350723
step: 350, task: Textual/Abt-Buy, loss: 0.00025010108947753906
=========eval at epoch=7=========
Validation:
=============Textual/Abt-Buy==================
accuracy=0.941
precision=0.877
recall=0.519
f1=0.652
======================================
Test:
=============Textual/Abt-Buy==================
accuracy=0.941
precision=0.865
recall=0.529
f1=0.657
======================================
=====sanity check======
words: COL name VAL sony 3.1 channel home theater surround system in black htct100 COL description VAL sony 3.1 channel home theater surround system in black htct100 hdmi active intelligence lpcm playback 3.1 channel s-force surround bravia ® sync digital media port black finish eta mid january 2009 COL price VAL 299.0  [SEP] COL name VAL denon dht-589ba home theater system COL description VAL , a/v receiver , 5.1 speakers dolby pro logic ii , dts COL price VAL 448.8 
x: [    0 18047   766 27445   579  6119   155     4   134  4238   184  7364
 21104   467    11   909  1368    90  3894  1866 14857  8194 27445   579
  6119   155     4   134  4238   184  7364 21104   467    11   909  1368
    90  3894  1866  1368   417  5408  2171  2316   784   642 13753 20083
   155     4   134  4238   579    12  9091 21104 35977   493 39110 22785
  1778   433  4103   909  2073  4400   102  1084 10408 16705  2338 14857
   425 27445 35768     4   288  1437     2     2 18047   766 27445  3069
   261   385  6083    12 40017  3178   184  7364   467 14857  8194 27445
  2156    10    73   705  4797  2156   195     4   134  6864   385  1168
  1409  1759 14578 42661  2156   385  1872 14857   425 27445 42482     4
   398  1437     2]
tokens: ['<s>', 'COL', 'Ġname', 'ĠVAL', 'Ġs', 'ony', 'Ġ3', '.', '1', 'Ġchannel', 'Ġhome', 'Ġtheater', 'Ġsurround', 'Ġsystem', 'Ġin', 'Ġblack', 'Ġh', 't', 'ct', '100', 'ĠCOL', 'Ġdescription', 'ĠVAL', 'Ġs', 'ony', 'Ġ3', '.', '1', 'Ġchannel', 'Ġhome', 'Ġtheater', 'Ġsurround', 'Ġsystem', 'Ġin', 'Ġblack', 'Ġh', 't', 'ct', '100', 'Ġh', 'd', 'mi', 'Ġactive', 'Ġintelligence', 'Ġl', 'p', 'cm', 'Ġplayback', 'Ġ3', '.', '1', 'Ġchannel', 'Ġs', '-', 'force', 'Ġsurround', 'Ġbrav', 'ia', 'ĠÂ®', 'Ġsync', 'Ġdigital', 'Ġmedia', 'Ġport', 'Ġblack', 'Ġfinish', 'Ġet', 'a', 'Ġmid', 'Ġjan', 'uary', 'Ġ2009', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ299', '.', '0', 'Ġ', '</s>', '</s>', 'COL', 'Ġname', 'ĠVAL', 'Ġden', 'on', 'Ġd', 'ht', '-', '589', 'ba', 'Ġhome', 'Ġtheater', 'Ġsystem', 'ĠCOL', 'Ġdescription', 'ĠVAL', 'Ġ,', 'Ġa', '/', 'v', 'Ġreceiver', 'Ġ,', 'Ġ5', '.', '1', 'Ġspeakers', 'Ġd', 'ol', 'by', 'Ġpro', 'Ġlogic', 'Ġii', 'Ġ,', 'Ġd', 'ts', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ448', '.', '8', 'Ġ', '</s>']
is_heads: [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
y: 0
tags: 0
mask: tensor([1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1])
seqlen: 123
task_name: Textual/Abt-Buy
=======================
step: 0, task: Textual/Abt-Buy, loss: 0.0001434534788131714
step: 10, task: Textual/Abt-Buy, loss: 0.00010792911052703857
step: 20, task: Textual/Abt-Buy, loss: 0.0001423954963684082
step: 30, task: Textual/Abt-Buy, loss: 0.00020185112953186035
step: 40, task: Textual/Abt-Buy, loss: 0.008877195417881012
step: 50, task: Textual/Abt-Buy, loss: 0.001003950834274292
step: 60, task: Textual/Abt-Buy, loss: 0.0001691281795501709
step: 70, task: Textual/Abt-Buy, loss: 0.013111017644405365
step: 80, task: Textual/Abt-Buy, loss: 0.06649942696094513
step: 90, task: Textual/Abt-Buy, loss: 0.0002709329128265381
step: 100, task: Textual/Abt-Buy, loss: 0.000293925404548645
step: 110, task: Textual/Abt-Buy, loss: 0.11806380748748779
step: 120, task: Textual/Abt-Buy, loss: 0.0010229945182800293
step: 130, task: Textual/Abt-Buy, loss: 0.0020066946744918823
step: 140, task: Textual/Abt-Buy, loss: 0.07006914168596268
step: 150, task: Textual/Abt-Buy, loss: 0.0001598149538040161
step: 160, task: Textual/Abt-Buy, loss: 0.022182270884513855
step: 170, task: Textual/Abt-Buy, loss: 0.0007702857255935669
step: 180, task: Textual/Abt-Buy, loss: 0.0008705258369445801
step: 190, task: Textual/Abt-Buy, loss: 0.00031594932079315186
step: 200, task: Textual/Abt-Buy, loss: 6.848573684692383e-05
step: 210, task: Textual/Abt-Buy, loss: 0.00017054378986358643
step: 220, task: Textual/Abt-Buy, loss: 0.0003831535577774048
step: 230, task: Textual/Abt-Buy, loss: 0.043691977858543396
step: 240, task: Textual/Abt-Buy, loss: 0.00040200352668762207
step: 250, task: Textual/Abt-Buy, loss: 0.0001274198293685913
step: 260, task: Textual/Abt-Buy, loss: 0.0009119659662246704
step: 270, task: Textual/Abt-Buy, loss: 0.005712501704692841
step: 280, task: Textual/Abt-Buy, loss: 0.00037366151809692383
step: 290, task: Textual/Abt-Buy, loss: 0.0001655369997024536
step: 300, task: Textual/Abt-Buy, loss: 0.00035324692726135254
step: 310, task: Textual/Abt-Buy, loss: 0.0007539093494415283
step: 320, task: Textual/Abt-Buy, loss: 0.00012512505054473877
step: 330, task: Textual/Abt-Buy, loss: 0.0028153732419013977
step: 340, task: Textual/Abt-Buy, loss: 0.0006997734308242798
step: 350, task: Textual/Abt-Buy, loss: 0.0005308538675308228
=========eval at epoch=8=========
Validation:
=============Textual/Abt-Buy==================
accuracy=0.937
precision=0.906
recall=0.466
f1=0.615
======================================
Test:
=============Textual/Abt-Buy==================
accuracy=0.936
precision=0.862
recall=0.485
f1=0.621
======================================
Selected optimization level O2:  FP16 training with FP32 batchnorm and FP32 master weights.

Defaults for this optimization level are:
enabled                : True
opt_level              : O2
cast_model_type        : torch.float16
patch_torch_functions  : False
keep_batchnorm_fp32    : True
master_weights         : True
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O2
cast_model_type        : torch.float16
patch_torch_functions  : False
keep_batchnorm_fp32    : True
master_weights         : True
loss_scale             : dynamic
Warning:  multi_tensor_applier fused unscale kernel is unavailable, possibly because apex was installed without --cuda_ext --cpp_ext. Using Python fallback.  Original ImportError was: ModuleNotFoundError("No module named 'amp_C'")
Gradient overflow.  Skipping step, loss scaler 0 reducing loss scale to 32768.0
=====sanity check======
words: COL name VAL panasonic dect 6.0 pearl silver expandable digital cordless phone system kxtg6313s COL description VAL panasonic dect 6.0 pearl silver expandable digital cordless phone system kxtg6313s 3 handsets up to 6 multi-handset capability dect 6.0 technology ringer id call waiting caller id voicemail hold mute clock alarm led lighting night mode speakerphone 11 days standby 5 hours talk time pearl silver finish COL price VAL 69.0  [SEP] COL name VAL panasonic kx-tg9348t expandable digital cordless phone COL description VAL 1 x phone line ( s ) metallic black COL price VAL  
x: [    0 18047   766 27445  5730 38703   263  3894   231     4   288 36679
  4334  3003   868  1778 13051  1672  1028   467   449 11483   571  5449
  1558    29 14857  8194 27445  5730 38703   263  3894   231     4   288
 36679  4334  3003   868  1778 13051  1672  1028   467   449 11483   571
  5449  1558    29   155  1420  2580    62     7   231  3228    12 34055
   594  9388   263  3894   231     4   288   806   910  6082 13561   486
  2445 17017 13561 30118 10555   946 33758  6700  8054   669  7526   363
  5745  5385 17283   365   360 28611   195   722  1067    86 36679  4334
  2073 14857   425 27445  5913     4   288  1437     2     2 18047   766
 27445  5730 38703   449  1178    12 42698   466 27765    90  3003   868
  1778 13051  1672  1028 14857  8194 27445   112  3023  1028   516    36
   579  4839 24117   909 14857   425 27445  1437  1437     2]
tokens: ['<s>', 'COL', 'Ġname', 'ĠVAL', 'Ġpan', 'asonic', 'Ġde', 'ct', 'Ġ6', '.', '0', 'Ġpearl', 'Ġsilver', 'Ġexpand', 'able', 'Ġdigital', 'Ġcord', 'less', 'Ġphone', 'Ġsystem', 'Ġk', 'xt', 'g', '63', '13', 's', 'ĠCOL', 'Ġdescription', 'ĠVAL', 'Ġpan', 'asonic', 'Ġde', 'ct', 'Ġ6', '.', '0', 'Ġpearl', 'Ġsilver', 'Ġexpand', 'able', 'Ġdigital', 'Ġcord', 'less', 'Ġphone', 'Ġsystem', 'Ġk', 'xt', 'g', '63', '13', 's', 'Ġ3', 'Ġhands', 'ets', 'Ġup', 'Ġto', 'Ġ6', 'Ġmulti', '-', 'hands', 'et', 'Ġcapability', 'Ġde', 'ct', 'Ġ6', '.', '0', 'Ġtechnology', 'Ġr', 'inger', 'Ġid', 'Ġcall', 'Ġwaiting', 'Ġcaller', 'Ġid', 'Ġvoic', 'email', 'Ġhold', 'Ġmute', 'Ġclock', 'Ġalarm', 'Ġled', 'Ġlighting', 'Ġnight', 'Ġmode', 'Ġspeaker', 'phone', 'Ġ11', 'Ġdays', 'Ġstandby', 'Ġ5', 'Ġhours', 'Ġtalk', 'Ġtime', 'Ġpearl', 'Ġsilver', 'Ġfinish', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ69', '.', '0', 'Ġ', '</s>', '</s>', 'COL', 'Ġname', 'ĠVAL', 'Ġpan', 'asonic', 'Ġk', 'x', '-', 'tg', '9', '348', 't', 'Ġexpand', 'able', 'Ġdigital', 'Ġcord', 'less', 'Ġphone', 'ĠCOL', 'Ġdescription', 'ĠVAL', 'Ġ1', 'Ġx', 'Ġphone', 'Ġline', 'Ġ(', 'Ġs', 'Ġ)', 'Ġmetallic', 'Ġblack', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ', 'Ġ', '</s>']
is_heads: [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
y: 0
tags: 0
mask: tensor([1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1])
seqlen: 142
task_name: Textual/Abt-Buy
=======================
step: 0, task: Textual/Abt-Buy, loss: 0.7350452542304993
Gradient overflow.  Skipping step, loss scaler 0 reducing loss scale to 16384.0
Gradient overflow.  Skipping step, loss scaler 0 reducing loss scale to 8192.0
Gradient overflow.  Skipping step, loss scaler 0 reducing loss scale to 4096.0
step: 10, task: Textual/Abt-Buy, loss: 0.7250927090644836
step: 20, task: Textual/Abt-Buy, loss: 0.6762878894805908
step: 30, task: Textual/Abt-Buy, loss: 0.5280171632766724
step: 40, task: Textual/Abt-Buy, loss: 0.23200596868991852
step: 50, task: Textual/Abt-Buy, loss: 0.31536608934402466
step: 60, task: Textual/Abt-Buy, loss: 0.3063943684101105
step: 70, task: Textual/Abt-Buy, loss: 0.09176768362522125
step: 80, task: Textual/Abt-Buy, loss: 0.18641872704029083
step: 90, task: Textual/Abt-Buy, loss: 0.14439097046852112
step: 100, task: Textual/Abt-Buy, loss: 0.3530275821685791
step: 110, task: Textual/Abt-Buy, loss: 0.4926237165927887
step: 120, task: Textual/Abt-Buy, loss: 0.14759409427642822
step: 130, task: Textual/Abt-Buy, loss: 0.14428022503852844
step: 140, task: Textual/Abt-Buy, loss: 0.09907814115285873
step: 150, task: Textual/Abt-Buy, loss: 0.3803022503852844
step: 160, task: Textual/Abt-Buy, loss: 0.24660655856132507
step: 170, task: Textual/Abt-Buy, loss: 0.24367398023605347
step: 180, task: Textual/Abt-Buy, loss: 0.28036874532699585
step: 190, task: Textual/Abt-Buy, loss: 0.5154610872268677
step: 200, task: Textual/Abt-Buy, loss: 0.25940942764282227
step: 210, task: Textual/Abt-Buy, loss: 0.09205342084169388
step: 220, task: Textual/Abt-Buy, loss: 0.10816755890846252
step: 230, task: Textual/Abt-Buy, loss: 0.12329579889774323
step: 240, task: Textual/Abt-Buy, loss: 0.893013060092926
step: 250, task: Textual/Abt-Buy, loss: 0.4820506274700165
step: 260, task: Textual/Abt-Buy, loss: 0.2953418493270874
step: 270, task: Textual/Abt-Buy, loss: 0.32639700174331665
step: 280, task: Textual/Abt-Buy, loss: 0.4732319116592407
step: 290, task: Textual/Abt-Buy, loss: 0.7026228904724121
step: 300, task: Textual/Abt-Buy, loss: 0.5779294371604919
step: 310, task: Textual/Abt-Buy, loss: 0.46831461787223816
step: 320, task: Textual/Abt-Buy, loss: 0.1298457831144333
step: 330, task: Textual/Abt-Buy, loss: 0.15968015789985657
step: 340, task: Textual/Abt-Buy, loss: 0.13332447409629822
step: 350, task: Textual/Abt-Buy, loss: 0.26921379566192627
=========eval at epoch=1=========
Validation:
=============Textual/Abt-Buy==================
accuracy=0.892
precision=0.000
recall=0.000
f1=0.000
======================================
Test:
=============Textual/Abt-Buy==================
accuracy=0.892
precision=0.000
recall=0.000
f1=0.000
======================================
/w/246/tianyu2020/miniconda2/envs/ditto/lib/python3.7/site-packages/apex/amp/_initialize.py:24: UserWarning: An input tensor was not cuda.
  warnings.warn("An input tensor was not cuda.")
/w/246/tianyu2020/miniconda2/envs/ditto/lib/python3.7/site-packages/torch/optim/lr_scheduler.py:122: UserWarning: Detected call of `lr_scheduler.step()` before `optimizer.step()`. In PyTorch 1.1.0 and later, you should call them in the opposite order: `optimizer.step()` before `lr_scheduler.step()`.  Failure to do this will result in PyTorch skipping the first value of the learning rate schedule. See more details at https://pytorch.org/docs/stable/optim.html#how-to-adjust-learning-rate
  "https://pytorch.org/docs/stable/optim.html#how-to-adjust-learning-rate", UserWarning)
/w/246/tianyu2020/miniconda2/envs/ditto/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1221: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
=====sanity check======
words: COL name VAL panasonic dect 6.0 expandable digital cordless phone with all-digital answering system kxtg9341t COL description VAL panasonic dect 6.0 expandable digital cordless phone with all-digital answering system kxtg9341t up to 6 multi-handset capability digital answering machine system ringer id call waiting caller id voicemail hold voice menu marker message mute clock alarm led lighting night mode call block speakerphone 11 days standby 5 hours talk time black metallic finish COL price VAL   [SEP] COL name VAL panasonic kx-tg9341t cordless phone COL description VAL 1 x phone line ( s ) black , metallic COL price VAL  
x: [    0 18047   766 27445  5730 38703   263  3894   231     4   288  3003
   868  1778 13051  1672  1028    19    70    12 29563 15635   467   449
 11483   571   466 34801    90 14857  8194 27445  5730 38703   263  3894
   231     4   288  3003   868  1778 13051  1672  1028    19    70    12
 29563 15635   467   449 11483   571   466 34801    90    62     7   231
  3228    12 34055   594  9388  1778 15635  3563   467   910  6082 13561
   486  2445 17017 13561 30118 10555   946  2236  5765 17540  1579 33758
  6700  8054   669  7526   363  5745   486  1803  5385 17283   365   360
 28611   195   722  1067    86   909 24117  2073 14857   425 27445  1437
  1437     2     2 18047   766 27445  5730 38703   449  1178    12 42698
   466 34801    90 13051  1672  1028 14857  8194 27445   112  3023  1028
   516    36   579  4839   909  2156 24117 14857   425 27445  1437  1437
     2]
tokens: ['<s>', 'COL', 'Ġname', 'ĠVAL', 'Ġpan', 'asonic', 'Ġde', 'ct', 'Ġ6', '.', '0', 'Ġexpand', 'able', 'Ġdigital', 'Ġcord', 'less', 'Ġphone', 'Ġwith', 'Ġall', '-', 'digital', 'Ġanswering', 'Ġsystem', 'Ġk', 'xt', 'g', '9', '341', 't', 'ĠCOL', 'Ġdescription', 'ĠVAL', 'Ġpan', 'asonic', 'Ġde', 'ct', 'Ġ6', '.', '0', 'Ġexpand', 'able', 'Ġdigital', 'Ġcord', 'less', 'Ġphone', 'Ġwith', 'Ġall', '-', 'digital', 'Ġanswering', 'Ġsystem', 'Ġk', 'xt', 'g', '9', '341', 't', 'Ġup', 'Ġto', 'Ġ6', 'Ġmulti', '-', 'hands', 'et', 'Ġcapability', 'Ġdigital', 'Ġanswering', 'Ġmachine', 'Ġsystem', 'Ġr', 'inger', 'Ġid', 'Ġcall', 'Ġwaiting', 'Ġcaller', 'Ġid', 'Ġvoic', 'email', 'Ġhold', 'Ġvoice', 'Ġmenu', 'Ġmarker', 'Ġmessage', 'Ġmute', 'Ġclock', 'Ġalarm', 'Ġled', 'Ġlighting', 'Ġnight', 'Ġmode', 'Ġcall', 'Ġblock', 'Ġspeaker', 'phone', 'Ġ11', 'Ġdays', 'Ġstandby', 'Ġ5', 'Ġhours', 'Ġtalk', 'Ġtime', 'Ġblack', 'Ġmetallic', 'Ġfinish', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ', 'Ġ', '</s>', '</s>', 'COL', 'Ġname', 'ĠVAL', 'Ġpan', 'asonic', 'Ġk', 'x', '-', 'tg', '9', '341', 't', 'Ġcord', 'less', 'Ġphone', 'ĠCOL', 'Ġdescription', 'ĠVAL', 'Ġ1', 'Ġx', 'Ġphone', 'Ġline', 'Ġ(', 'Ġs', 'Ġ)', 'Ġblack', 'Ġ,', 'Ġmetallic', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ', 'Ġ', '</s>']
is_heads: [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
y: 1
tags: 1
mask: tensor([1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1])
seqlen: 145
task_name: Textual/Abt-Buy
=======================
step: 0, task: Textual/Abt-Buy, loss: 0.17392654716968536
step: 10, task: Textual/Abt-Buy, loss: 0.22294588387012482
step: 20, task: Textual/Abt-Buy, loss: 0.03974110260605812
step: 30, task: Textual/Abt-Buy, loss: 0.1051037535071373
step: 40, task: Textual/Abt-Buy, loss: 0.09681019186973572
step: 50, task: Textual/Abt-Buy, loss: 0.09726443141698837
step: 60, task: Textual/Abt-Buy, loss: 0.20380163192749023
step: 70, task: Textual/Abt-Buy, loss: 0.18640217185020447
step: 80, task: Textual/Abt-Buy, loss: 0.517488956451416
step: 90, task: Textual/Abt-Buy, loss: 0.015499860048294067
step: 100, task: Textual/Abt-Buy, loss: 0.0328579843044281
step: 110, task: Textual/Abt-Buy, loss: 0.07355742901563644
step: 120, task: Textual/Abt-Buy, loss: 0.04883795976638794
step: 130, task: Textual/Abt-Buy, loss: 0.05651760846376419
step: 140, task: Textual/Abt-Buy, loss: 0.1883949488401413
step: 150, task: Textual/Abt-Buy, loss: 0.1663065254688263
step: 160, task: Textual/Abt-Buy, loss: 0.00946064293384552
step: 170, task: Textual/Abt-Buy, loss: 0.06575104594230652
step: 180, task: Textual/Abt-Buy, loss: 0.05828159302473068
step: 190, task: Textual/Abt-Buy, loss: 0.033383436501026154
step: 200, task: Textual/Abt-Buy, loss: 0.17470896244049072
step: 210, task: Textual/Abt-Buy, loss: 0.04730033129453659
step: 220, task: Textual/Abt-Buy, loss: 0.17441900074481964
step: 230, task: Textual/Abt-Buy, loss: 0.23015053570270538
step: 240, task: Textual/Abt-Buy, loss: 0.09835521876811981
step: 250, task: Textual/Abt-Buy, loss: 0.2793044447898865
step: 260, task: Textual/Abt-Buy, loss: 0.2823379933834076
step: 270, task: Textual/Abt-Buy, loss: 0.034627459943294525
step: 280, task: Textual/Abt-Buy, loss: 0.23733101785182953
step: 290, task: Textual/Abt-Buy, loss: 0.18949979543685913
step: 300, task: Textual/Abt-Buy, loss: 0.011460360139608383
step: 310, task: Textual/Abt-Buy, loss: 0.35115307569503784
step: 320, task: Textual/Abt-Buy, loss: 0.16776825487613678
step: 330, task: Textual/Abt-Buy, loss: 0.2369069755077362
step: 340, task: Textual/Abt-Buy, loss: 0.07500459253787994
step: 350, task: Textual/Abt-Buy, loss: 0.02638804167509079
=========eval at epoch=1=========
Validation:
=============Textual/Abt-Buy==================
accuracy=0.931
precision=0.911
recall=0.398
f1=0.554
======================================
Test:
=============Textual/Abt-Buy==================
accuracy=0.930
precision=0.928
recall=0.374
f1=0.533
======================================
=====sanity check======
words: COL name VAL sony silver 1080p upscaling dvd player dvpns700hs COL description VAL sony silver 1080p upscaling dvd player dvpns700hs 1080p upscaling video output through hdmi connection bravia sync high resolution jpeg output precision cinema progressive technology precision drive child lock multi disc resume multi brand tv remote control silver finish COL price VAL   [SEP] COL name VAL sony dvp-fx820 / l portable dvd player dvpfx820/l COL description VAL 8 ' lcd dvd + r , dvd + rw , dvd-rw , dvd-r , cd-rw jpeg , mp3 , dvd video playback 1 disc ( s ) blue COL price VAL 131.54 
x: [    0 18047   766 27445   579  6119  4334 21083   642    62  3866  8279
   385 40311   869   385 45883  6852  5987 15354 14857  8194 27445   579
  6119  4334 21083   642    62  3866  8279   385 40311   869   385 45883
  6852  5987 15354 21083   642    62  3866  8279   569  4195   149  1368
   417  5408  2748 35977   493 22785   239  3547  1236 41191  4195 15339
 11605  8212   806 15339  1305   920  7014  3228  9553  6654  3228  1518
 30016  6063   797  4334  2073 14857   425 27445  1437  1437     2     2
 18047   766 27445   579  6119   385 45883    12 44830 34212  1589   784
 15295   385 40311   869   385 45883 44830 34212    73   462 14857  8194
 27445   290   128   784 28690   385 40311  2055   910  2156   385 40311
  2055   910   605  2156   385 40311    12 43926  2156   385 40311    12
   338  2156 45584    12 43926  1236 41191  2156 44857   246  2156   385
 40311   569 20083   112  9553    36   579  4839  2440 14857   425 27445
 22236     4  4283  1437     2]
tokens: ['<s>', 'COL', 'Ġname', 'ĠVAL', 'Ġs', 'ony', 'Ġsilver', 'Ġ1080', 'p', 'Ġup', 'sc', 'aling', 'Ġd', 'vd', 'Ġplayer', 'Ġd', 'vp', 'ns', '700', 'hs', 'ĠCOL', 'Ġdescription', 'ĠVAL', 'Ġs', 'ony', 'Ġsilver', 'Ġ1080', 'p', 'Ġup', 'sc', 'aling', 'Ġd', 'vd', 'Ġplayer', 'Ġd', 'vp', 'ns', '700', 'hs', 'Ġ1080', 'p', 'Ġup', 'sc', 'aling', 'Ġvideo', 'Ġoutput', 'Ġthrough', 'Ġh', 'd', 'mi', 'Ġconnection', 'Ġbrav', 'ia', 'Ġsync', 'Ġhigh', 'Ġresolution', 'Ġj', 'peg', 'Ġoutput', 'Ġprecision', 'Ġcinema', 'Ġprogressive', 'Ġtechnology', 'Ġprecision', 'Ġdrive', 'Ġchild', 'Ġlock', 'Ġmulti', 'Ġdisc', 'Ġresume', 'Ġmulti', 'Ġbrand', 'Ġtv', 'Ġremote', 'Ġcontrol', 'Ġsilver', 'Ġfinish', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ', 'Ġ', '</s>', '</s>', 'COL', 'Ġname', 'ĠVAL', 'Ġs', 'ony', 'Ġd', 'vp', '-', 'fx', '820', 'Ġ/', 'Ġl', 'Ġportable', 'Ġd', 'vd', 'Ġplayer', 'Ġd', 'vp', 'fx', '820', '/', 'l', 'ĠCOL', 'Ġdescription', 'ĠVAL', 'Ġ8', "Ġ'", 'Ġl', 'cd', 'Ġd', 'vd', 'Ġ+', 'Ġr', 'Ġ,', 'Ġd', 'vd', 'Ġ+', 'Ġr', 'w', 'Ġ,', 'Ġd', 'vd', '-', 'rw', 'Ġ,', 'Ġd', 'vd', '-', 'r', 'Ġ,', 'Ġcd', '-', 'rw', 'Ġj', 'peg', 'Ġ,', 'Ġmp', '3', 'Ġ,', 'Ġd', 'vd', 'Ġvideo', 'Ġplayback', 'Ġ1', 'Ġdisc', 'Ġ(', 'Ġs', 'Ġ)', 'Ġblue', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ131', '.', '54', 'Ġ', '</s>']
is_heads: [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
y: 0
tags: 0
mask: tensor([1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1])
seqlen: 161
task_name: Textual/Abt-Buy
=======================
step: 0, task: Textual/Abt-Buy, loss: 0.0249483585357666
step: 10, task: Textual/Abt-Buy, loss: 0.004932567477226257
step: 20, task: Textual/Abt-Buy, loss: 0.14524848759174347
step: 30, task: Textual/Abt-Buy, loss: 0.00950322300195694
step: 40, task: Textual/Abt-Buy, loss: 0.012483589351177216
step: 50, task: Textual/Abt-Buy, loss: 0.15278983116149902
step: 60, task: Textual/Abt-Buy, loss: 0.12497770041227341
step: 70, task: Textual/Abt-Buy, loss: 0.049542758613824844
step: 80, task: Textual/Abt-Buy, loss: 0.4333269000053406
step: 90, task: Textual/Abt-Buy, loss: 0.05248120799660683
step: 100, task: Textual/Abt-Buy, loss: 0.10517556220293045
step: 110, task: Textual/Abt-Buy, loss: 0.00925009697675705
step: 120, task: Textual/Abt-Buy, loss: 0.013678692281246185
step: 130, task: Textual/Abt-Buy, loss: 0.22616791725158691
step: 140, task: Textual/Abt-Buy, loss: 0.18053968250751495
step: 150, task: Textual/Abt-Buy, loss: 0.29139530658721924
step: 160, task: Textual/Abt-Buy, loss: 0.1142568290233612
step: 170, task: Textual/Abt-Buy, loss: 0.0371297188103199
step: 180, task: Textual/Abt-Buy, loss: 0.0013606101274490356
step: 190, task: Textual/Abt-Buy, loss: 0.028005089610815048
step: 200, task: Textual/Abt-Buy, loss: 0.1509765088558197
step: 210, task: Textual/Abt-Buy, loss: 0.01435793936252594
step: 220, task: Textual/Abt-Buy, loss: 0.005243383347988129
step: 230, task: Textual/Abt-Buy, loss: 0.05370733141899109
step: 240, task: Textual/Abt-Buy, loss: 0.004862457513809204
step: 250, task: Textual/Abt-Buy, loss: 0.10927583277225494
step: 260, task: Textual/Abt-Buy, loss: 0.0011485368013381958
step: 270, task: Textual/Abt-Buy, loss: 0.034791164100170135
step: 280, task: Textual/Abt-Buy, loss: 0.4265232980251312
step: 290, task: Textual/Abt-Buy, loss: 0.01896297186613083
step: 300, task: Textual/Abt-Buy, loss: 0.0030600279569625854
step: 310, task: Textual/Abt-Buy, loss: 0.01270005851984024
step: 320, task: Textual/Abt-Buy, loss: 0.019423577934503555
step: 330, task: Textual/Abt-Buy, loss: 0.13955406844615936
step: 340, task: Textual/Abt-Buy, loss: 0.07220752537250519
step: 350, task: Textual/Abt-Buy, loss: 0.0032586604356765747
=========eval at epoch=2=========
Validation:
=============Textual/Abt-Buy==================
accuracy=0.935
precision=0.901
recall=0.442
f1=0.593
======================================
Test:
=============Textual/Abt-Buy==================
accuracy=0.931
precision=0.901
recall=0.398
f1=0.552
======================================
=====sanity check======
words: COL name VAL onkyo 7.1-channel black home theater receiver txsr506b COL description VAL onkyo txsr506 7.1-channel black home theater receiver txsr506b high-definition media capability 3 hdmi inputs audyssey 2eq and audyssey dynamic eq sound correction technologies advanced 32-bit processing dsp chip 4 digital inputs support compressed digital music files double bass function 40 fm-am radio presets ipod compatible black finish COL price VAL   [SEP] COL name VAL onkyo txsr606 a/v receiver COL description VAL dolby digital plus , dolby truehd , dts-hd COL price VAL 399.95 
x: [    0 18047   766 27445    15  4122   139   262     4   134    12 27681
   909   184  7364  4797 48726 37959 36647   428 14857  8194 27445    15
  4122   139 48726 37959 36647   262     4   134    12 27681   909   184
  7364  4797 48726 37959 36647   428   239    12 38835   433  9388   155
  1368   417  5408 16584  9818 42317   132 41456     8  9818 42317  6878
 48234  2369 14921  4233  3319  2107    12  5881  5774   385  4182  6638
   204  1778 16584   323 34307  1778   930  6773  1457  9590  5043   843
   856   119    12   424  3188 45746 36180  1630 16632   909  2073 14857
   425 27445  1437  1437     2     2 18047   766 27445    15  4122   139
 48726 37959 36101    10    73   705  4797 14857  8194 27445   385  1168
  1409  1778  2704  2156   385  1168  1409  1528 35905  2156   385  1872
    12 35905 14857   425 27445 41279     4  4015  1437     2]
tokens: ['<s>', 'COL', 'Ġname', 'ĠVAL', 'Ġon', 'ky', 'o', 'Ġ7', '.', '1', '-', 'channel', 'Ġblack', 'Ġhome', 'Ġtheater', 'Ġreceiver', 'Ġtx', 'sr', '506', 'b', 'ĠCOL', 'Ġdescription', 'ĠVAL', 'Ġon', 'ky', 'o', 'Ġtx', 'sr', '506', 'Ġ7', '.', '1', '-', 'channel', 'Ġblack', 'Ġhome', 'Ġtheater', 'Ġreceiver', 'Ġtx', 'sr', '506', 'b', 'Ġhigh', '-', 'definition', 'Ġmedia', 'Ġcapability', 'Ġ3', 'Ġh', 'd', 'mi', 'Ġinputs', 'Ġaud', 'yssey', 'Ġ2', 'eq', 'Ġand', 'Ġaud', 'yssey', 'Ġdynamic', 'Ġeq', 'Ġsound', 'Ġcorrection', 'Ġtechnologies', 'Ġadvanced', 'Ġ32', '-', 'bit', 'Ġprocessing', 'Ġd', 'sp', 'Ġchip', 'Ġ4', 'Ġdigital', 'Ġinputs', 'Ġsupport', 'Ġcompressed', 'Ġdigital', 'Ġmusic', 'Ġfiles', 'Ġdouble', 'Ġbass', 'Ġfunction', 'Ġ40', 'Ġf', 'm', '-', 'am', 'Ġradio', 'Ġpresets', 'Ġip', 'od', 'Ġcompatible', 'Ġblack', 'Ġfinish', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ', 'Ġ', '</s>', '</s>', 'COL', 'Ġname', 'ĠVAL', 'Ġon', 'ky', 'o', 'Ġtx', 'sr', '606', 'Ġa', '/', 'v', 'Ġreceiver', 'ĠCOL', 'Ġdescription', 'ĠVAL', 'Ġd', 'ol', 'by', 'Ġdigital', 'Ġplus', 'Ġ,', 'Ġd', 'ol', 'by', 'Ġtrue', 'hd', 'Ġ,', 'Ġd', 'ts', '-', 'hd', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ399', '.', '95', 'Ġ', '</s>']
is_heads: [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
y: 0
tags: 0
mask: tensor([1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1])
seqlen: 142
task_name: Textual/Abt-Buy
=======================
step: 0, task: Textual/Abt-Buy, loss: 0.036685410887002945
step: 10, task: Textual/Abt-Buy, loss: 0.007898755371570587
step: 20, task: Textual/Abt-Buy, loss: 0.003109365701675415
step: 30, task: Textual/Abt-Buy, loss: 0.003451108932495117
step: 40, task: Textual/Abt-Buy, loss: 0.03261052817106247
step: 50, task: Textual/Abt-Buy, loss: 0.13889101147651672
step: 60, task: Textual/Abt-Buy, loss: 0.02131883054971695
step: 70, task: Textual/Abt-Buy, loss: 0.0015656203031539917
step: 80, task: Textual/Abt-Buy, loss: 0.001203387975692749
step: 90, task: Textual/Abt-Buy, loss: 0.07873791456222534
step: 100, task: Textual/Abt-Buy, loss: 0.09171651303768158
step: 110, task: Textual/Abt-Buy, loss: 0.12328766286373138
step: 120, task: Textual/Abt-Buy, loss: 0.020937152206897736
step: 130, task: Textual/Abt-Buy, loss: 0.000437319278717041
step: 140, task: Textual/Abt-Buy, loss: 0.029072251170873642
step: 150, task: Textual/Abt-Buy, loss: 0.0691959336400032
step: 160, task: Textual/Abt-Buy, loss: 0.0011791735887527466
step: 170, task: Textual/Abt-Buy, loss: 0.0009896308183670044
step: 180, task: Textual/Abt-Buy, loss: 0.01506756991147995
step: 190, task: Textual/Abt-Buy, loss: 0.0012299120426177979
step: 200, task: Textual/Abt-Buy, loss: 0.002348765730857849
step: 210, task: Textual/Abt-Buy, loss: 0.021841373294591904
step: 220, task: Textual/Abt-Buy, loss: 0.02361052855849266
step: 230, task: Textual/Abt-Buy, loss: 0.05800755321979523
step: 240, task: Textual/Abt-Buy, loss: 0.04788578301668167
step: 250, task: Textual/Abt-Buy, loss: 0.0027974694967269897
step: 260, task: Textual/Abt-Buy, loss: 0.00976988673210144
step: 270, task: Textual/Abt-Buy, loss: 0.13632643222808838
step: 280, task: Textual/Abt-Buy, loss: 0.08573804795742035
step: 290, task: Textual/Abt-Buy, loss: 0.0028498098254203796
step: 300, task: Textual/Abt-Buy, loss: 0.02275264263153076
step: 310, task: Textual/Abt-Buy, loss: 0.005939960479736328
step: 320, task: Textual/Abt-Buy, loss: 0.0945727750658989
step: 330, task: Textual/Abt-Buy, loss: 0.045342955738306046
step: 340, task: Textual/Abt-Buy, loss: 0.2141672670841217
step: 350, task: Textual/Abt-Buy, loss: 0.025329604744911194
=========eval at epoch=3=========
Validation:
=============Textual/Abt-Buy==================
accuracy=0.934
precision=0.682
recall=0.718
f1=0.700
======================================
Test:
=============Textual/Abt-Buy==================
accuracy=0.935
precision=0.696
recall=0.699
f1=0.697
======================================
=====sanity check======
words: COL name VAL samsung 22 ' black flat panel lcd hdtv ln22a450 COL description VAL samsung 22 ' black flat panel series 4 lcd hdtv ln22a450 1680 x 1050 resolution 3000:1 contrast ratio srs trusurround xt cold cathode fluorescent lamp ( ccfl ) 8ms response time hidden bottom speakers pc compatible black finish COL price VAL   [SEP] COL name VAL samsung ln32a550 32 ' lcd tv COL description VAL samsung ln32a550 32 ' widescreen 1080p lcd hdtv 15,000:1 dynamic contrast ratio 5ms response time piano black COL price VAL 849.0 
x: [    0 18047   766 27445   579 48545   820   128   909  3269  2798   784
 28690  1368   417 18724   784   282  2036   102 13872 14857  8194 27445
   579 48545   820   128   909  3269  2798   651   204   784 28690  1368
   417 18724   784   282  2036   102 13872   545  2940  3023 43504  3547
 23513    35   134  5709  1750   579  4926  2664   687   710  3431  1437
 11483  2569 31420  4636 38006 24272    36 41754  4825  4839   290  4339
  1263    86  7397  2576  6864 46213 16632   909  2073 14857   425 27445
  1437  1437     2     2 18047   766 27445   579 48545   784   282  2881
   102 17953  2107   128   784 28690 30016 14857  8194 27445   579 48545
   784   282  2881   102 17953  2107   128   885  4376 37346 21083   642
   784 28690  1368   417 18724   379     6   151    35   134  6878  5709
  1750   195  4339  1263    86 13305   909 14857   425 27445   290  3414
     4   288  1437     2]
tokens: ['<s>', 'COL', 'Ġname', 'ĠVAL', 'Ġs', 'amsung', 'Ġ22', "Ġ'", 'Ġblack', 'Ġflat', 'Ġpanel', 'Ġl', 'cd', 'Ġh', 'd', 'tv', 'Ġl', 'n', '22', 'a', '450', 'ĠCOL', 'Ġdescription', 'ĠVAL', 'Ġs', 'amsung', 'Ġ22', "Ġ'", 'Ġblack', 'Ġflat', 'Ġpanel', 'Ġseries', 'Ġ4', 'Ġl', 'cd', 'Ġh', 'd', 'tv', 'Ġl', 'n', '22', 'a', '450', 'Ġ16', '80', 'Ġx', 'Ġ1050', 'Ġresolution', 'Ġ3000', ':', '1', 'Ġcontrast', 'Ġratio', 'Ġs', 'rs', 'Ġtr', 'us', 'ur', 'round', 'Ġ', 'xt', 'Ġcold', 'Ġcath', 'ode', 'Ġfluorescent', 'Ġlamp', 'Ġ(', 'Ġcc', 'fl', 'Ġ)', 'Ġ8', 'ms', 'Ġresponse', 'Ġtime', 'Ġhidden', 'Ġbottom', 'Ġspeakers', 'Ġpc', 'Ġcompatible', 'Ġblack', 'Ġfinish', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ', 'Ġ', '</s>', '</s>', 'COL', 'Ġname', 'ĠVAL', 'Ġs', 'amsung', 'Ġl', 'n', '32', 'a', '550', 'Ġ32', "Ġ'", 'Ġl', 'cd', 'Ġtv', 'ĠCOL', 'Ġdescription', 'ĠVAL', 'Ġs', 'amsung', 'Ġl', 'n', '32', 'a', '550', 'Ġ32', "Ġ'", 'Ġw', 'ides', 'creen', 'Ġ1080', 'p', 'Ġl', 'cd', 'Ġh', 'd', 'tv', 'Ġ15', ',', '000', ':', '1', 'Ġdynamic', 'Ġcontrast', 'Ġratio', 'Ġ5', 'ms', 'Ġresponse', 'Ġtime', 'Ġpiano', 'Ġblack', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ8', '49', '.', '0', 'Ġ', '</s>']
is_heads: [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
y: 0
tags: 0
mask: tensor([1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1])
seqlen: 148
task_name: Textual/Abt-Buy
=======================
step: 0, task: Textual/Abt-Buy, loss: 0.052929747849702835
step: 10, task: Textual/Abt-Buy, loss: 0.009637922048568726
step: 20, task: Textual/Abt-Buy, loss: 0.0003997534513473511
step: 30, task: Textual/Abt-Buy, loss: 0.0013989657163619995
step: 40, task: Textual/Abt-Buy, loss: 0.021812625229358673
step: 50, task: Textual/Abt-Buy, loss: 0.0006072074174880981
step: 60, task: Textual/Abt-Buy, loss: 0.018371183425188065
step: 70, task: Textual/Abt-Buy, loss: 0.12191026657819748
step: 80, task: Textual/Abt-Buy, loss: 0.0029084086418151855
step: 90, task: Textual/Abt-Buy, loss: 0.000771254301071167
step: 100, task: Textual/Abt-Buy, loss: 0.045394062995910645
step: 110, task: Textual/Abt-Buy, loss: 0.004763737320899963
step: 120, task: Textual/Abt-Buy, loss: 0.007013678550720215
step: 130, task: Textual/Abt-Buy, loss: 0.09367091953754425
step: 140, task: Textual/Abt-Buy, loss: 0.0005873888731002808
step: 150, task: Textual/Abt-Buy, loss: 0.00020776689052581787
step: 160, task: Textual/Abt-Buy, loss: 0.0008577108383178711
step: 170, task: Textual/Abt-Buy, loss: 0.2329055219888687
step: 180, task: Textual/Abt-Buy, loss: 0.025998547673225403
step: 190, task: Textual/Abt-Buy, loss: 0.033811476081609726
step: 200, task: Textual/Abt-Buy, loss: 0.017504483461380005
step: 210, task: Textual/Abt-Buy, loss: 0.017151713371276855
step: 220, task: Textual/Abt-Buy, loss: 0.010210514068603516
step: 230, task: Textual/Abt-Buy, loss: 0.0005713999271392822
step: 240, task: Textual/Abt-Buy, loss: 0.004289910197257996
step: 250, task: Textual/Abt-Buy, loss: 0.0008552223443984985
step: 260, task: Textual/Abt-Buy, loss: 0.0004957616329193115
step: 270, task: Textual/Abt-Buy, loss: 0.0034397318959236145
step: 280, task: Textual/Abt-Buy, loss: 0.027570001780986786
step: 290, task: Textual/Abt-Buy, loss: 0.002996966242790222
step: 300, task: Textual/Abt-Buy, loss: 0.0006993263959884644
step: 310, task: Textual/Abt-Buy, loss: 0.0054144710302352905
step: 320, task: Textual/Abt-Buy, loss: 0.09439297765493393
step: 330, task: Textual/Abt-Buy, loss: 0.006652720272541046
step: 340, task: Textual/Abt-Buy, loss: 0.01805642992258072
step: 350, task: Textual/Abt-Buy, loss: 0.006944678723812103
=========eval at epoch=4=========
Validation:
=============Textual/Abt-Buy==================
accuracy=0.942
precision=0.874
recall=0.539
f1=0.667
======================================
Test:
=============Textual/Abt-Buy==================
accuracy=0.941
precision=0.839
recall=0.558
f1=0.671
======================================
=====sanity check======
words: COL name VAL samsung 42 ' black flat panel series 4 plasma hdtv pn42a450p COL description VAL samsung 42 ' black flat panel series 4 plasma hdtv pn42a450p 1024 x 768p resolution 1,000,000:1 dynamic contrast ratio filterbright anti glare filter dnie technology acesilhouette editor anti burn-in technology 3d technology srs trusurround xt atsc/ntsc/clear qam built-in tuners black finish COL price VAL   [SEP] COL name VAL samsung 4 series ln26a450 26 ' lcd tv COL description VAL samsung ln26a450 26 ' widescreen 720p lcd hdtv 5000:1 dynamic contrast ratio 8ms response time piano black COL price VAL 549.0 
x: [    0 18047   766 27445   579 48545  3330   128   909  3269  2798   651
   204 29051  1368   417 18724   181   282  3714   102 13872   642 14857
  8194 27445   579 48545  3330   128   909  3269  2798   651   204 29051
  1368   417 18724   181   282  3714   102 13872   642 46959  3023 43751
   642  3547   112     6   151     6   151    35   134  6878  5709  1750
 14929 23471  1475 37355 14929   385  7468   806    10  4643   718 24181
  3398  4474  1475  7403    12   179   806   155   417   806   579  4926
  2664   687   710  3431  1437 11483    23  3866    73  3999  3866    73
 18763  2231   424  1490    12   179 27115   268   909  2073 14857   425
 27445  1437  1437     2     2 18047   766 27445   579 48545   204   651
   784   282  2481   102 13872   973   128   784 28690 30016 14857  8194
 27445   579 48545   784   282  2481   102 13872   973   128   885  4376
 37346 26180   642   784 28690  1368   417 18724 23221    35   134  6878
  5709  1750   290  4339  1263    86 13305   909 14857   425 27445   195
  3414     4   288  1437     2]
tokens: ['<s>', 'COL', 'Ġname', 'ĠVAL', 'Ġs', 'amsung', 'Ġ42', "Ġ'", 'Ġblack', 'Ġflat', 'Ġpanel', 'Ġseries', 'Ġ4', 'Ġplasma', 'Ġh', 'd', 'tv', 'Ġp', 'n', '42', 'a', '450', 'p', 'ĠCOL', 'Ġdescription', 'ĠVAL', 'Ġs', 'amsung', 'Ġ42', "Ġ'", 'Ġblack', 'Ġflat', 'Ġpanel', 'Ġseries', 'Ġ4', 'Ġplasma', 'Ġh', 'd', 'tv', 'Ġp', 'n', '42', 'a', '450', 'p', 'Ġ1024', 'Ġx', 'Ġ768', 'p', 'Ġresolution', 'Ġ1', ',', '000', ',', '000', ':', '1', 'Ġdynamic', 'Ġcontrast', 'Ġratio', 'Ġfilter', 'bright', 'Ġanti', 'Ġglare', 'Ġfilter', 'Ġd', 'nie', 'Ġtechnology', 'Ġa', 'ces', 'il', 'hou', 'ette', 'Ġeditor', 'Ġanti', 'Ġburn', '-', 'in', 'Ġtechnology', 'Ġ3', 'd', 'Ġtechnology', 'Ġs', 'rs', 'Ġtr', 'us', 'ur', 'round', 'Ġ', 'xt', 'Ġat', 'sc', '/', 'nt', 'sc', '/', 'clear', 'Ġq', 'am', 'Ġbuilt', '-', 'in', 'Ġtun', 'ers', 'Ġblack', 'Ġfinish', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ', 'Ġ', '</s>', '</s>', 'COL', 'Ġname', 'ĠVAL', 'Ġs', 'amsung', 'Ġ4', 'Ġseries', 'Ġl', 'n', '26', 'a', '450', 'Ġ26', "Ġ'", 'Ġl', 'cd', 'Ġtv', 'ĠCOL', 'Ġdescription', 'ĠVAL', 'Ġs', 'amsung', 'Ġl', 'n', '26', 'a', '450', 'Ġ26', "Ġ'", 'Ġw', 'ides', 'creen', 'Ġ720', 'p', 'Ġl', 'cd', 'Ġh', 'd', 'tv', 'Ġ5000', ':', '1', 'Ġdynamic', 'Ġcontrast', 'Ġratio', 'Ġ8', 'ms', 'Ġresponse', 'Ġtime', 'Ġpiano', 'Ġblack', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ5', '49', '.', '0', 'Ġ', '</s>']
is_heads: [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
y: 0
tags: 0
mask: tensor([1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1])
seqlen: 173
task_name: Textual/Abt-Buy
=======================
step: 0, task: Textual/Abt-Buy, loss: 0.006093032658100128
step: 10, task: Textual/Abt-Buy, loss: 0.015226002782583237
step: 20, task: Textual/Abt-Buy, loss: 0.08600549399852753
step: 30, task: Textual/Abt-Buy, loss: 0.08055257797241211
step: 40, task: Textual/Abt-Buy, loss: 0.001018911600112915
step: 50, task: Textual/Abt-Buy, loss: 0.0007011294364929199
step: 60, task: Textual/Abt-Buy, loss: 0.09311475604772568
step: 70, task: Textual/Abt-Buy, loss: 0.014377810060977936
step: 80, task: Textual/Abt-Buy, loss: 0.059819918125867844
step: 90, task: Textual/Abt-Buy, loss: 0.0388985276222229
step: 100, task: Textual/Abt-Buy, loss: 0.0005339831113815308
step: 110, task: Textual/Abt-Buy, loss: 0.002278938889503479
step: 120, task: Textual/Abt-Buy, loss: 0.03106801211833954
step: 130, task: Textual/Abt-Buy, loss: 0.0007663965225219727
step: 140, task: Textual/Abt-Buy, loss: 0.08209580928087234
step: 150, task: Textual/Abt-Buy, loss: 0.00033220648765563965
step: 160, task: Textual/Abt-Buy, loss: 0.008673787117004395
step: 170, task: Textual/Abt-Buy, loss: 0.0011949241161346436
step: 180, task: Textual/Abt-Buy, loss: 0.00032110512256622314
step: 190, task: Textual/Abt-Buy, loss: 0.0020318254828453064
step: 200, task: Textual/Abt-Buy, loss: 0.00018547475337982178
step: 210, task: Textual/Abt-Buy, loss: 0.00046434998512268066
step: 220, task: Textual/Abt-Buy, loss: 0.0006887763738632202
step: 230, task: Textual/Abt-Buy, loss: 0.019796423614025116
step: 240, task: Textual/Abt-Buy, loss: 0.0009632259607315063
step: 250, task: Textual/Abt-Buy, loss: 0.0011285841464996338
step: 260, task: Textual/Abt-Buy, loss: 0.005042895674705505
step: 270, task: Textual/Abt-Buy, loss: 0.0002966970205307007
step: 280, task: Textual/Abt-Buy, loss: 0.0028879940509796143
step: 290, task: Textual/Abt-Buy, loss: 0.0017672926187515259
step: 300, task: Textual/Abt-Buy, loss: 0.0009280294179916382
step: 310, task: Textual/Abt-Buy, loss: 0.16608771681785583
step: 320, task: Textual/Abt-Buy, loss: 0.00022070109844207764
step: 330, task: Textual/Abt-Buy, loss: 0.03729519620537758
step: 340, task: Textual/Abt-Buy, loss: 0.009076952934265137
step: 350, task: Textual/Abt-Buy, loss: 0.00036422908306121826
=========eval at epoch=5=========
Validation:
=============Textual/Abt-Buy==================
accuracy=0.942
precision=0.842
recall=0.568
f1=0.678
======================================
Test:
=============Textual/Abt-Buy==================
accuracy=0.936
precision=0.809
recall=0.534
f1=0.643
======================================
=====sanity check======
words: COL name VAL panasonic viera 42 ' plasma flat panel 1080p hdtv in black th42pz85u COL description VAL panasonic viera 42 ' plasma flat panel 1080p hdtv in black th42pz85u 1080p display 1920 x 1080 native resolution color purity optimizer surround sound anti-reflective filter viera link hdavi control built-in ntsc/atsc/qam tuners pc input 3 hdmi inputs built-in galleryplayer capable sd card memory slot pedestal stand included black finish COL price VAL   [SEP] COL name VAL panasonic viera tc-37lz85 37 ' lcd tv COL description VAL 37 ' atsc , ntsc 16:9 1920 x 1080 hdtv COL price VAL 799.11 
x: [    0 18047   766 27445  5730 38703   748 16432  3330   128 29051  3269
  2798 21083   642  1368   417 18724    11   909  3553  3714   642   329
  4531   257 14857  8194 27445  5730 38703   748 16432  3330   128 29051
  3269  2798 21083   642  1368   417 18724    11   909  3553  3714   642
   329  4531   257 21083   642  2332 18283  3023 21083  3763  3547  3195
 32195 17775  6315 21104  2369  1475    12 39878  2088 14929   748 16432
  3104  1368   417 11132   797  1490    12   179   295  1872   438    73
  2923   438    73  1343   424 27115   268 46213  8135   155  1368   417
  5408 16584  1490    12   179  7294 23233  4453 46409  1886  3783  8534
 38238   337  1413  1165   909  2073 14857   425 27445  1437  1437     2
     2 18047   766 27445  5730 38703   748 16432 48965    12  3272   462
   329  4531  2908   128   784 28690 30016 14857  8194 27445  2908   128
    23  3866  2156   295  1872   438   545    35   466 18283  3023 21083
  1368   417 18724 14857   425 27445   262  2831     4  1225  1437     2]
tokens: ['<s>', 'COL', 'Ġname', 'ĠVAL', 'Ġpan', 'asonic', 'Ġv', 'iera', 'Ġ42', "Ġ'", 'Ġplasma', 'Ġflat', 'Ġpanel', 'Ġ1080', 'p', 'Ġh', 'd', 'tv', 'Ġin', 'Ġblack', 'Ġth', '42', 'p', 'z', '85', 'u', 'ĠCOL', 'Ġdescription', 'ĠVAL', 'Ġpan', 'asonic', 'Ġv', 'iera', 'Ġ42', "Ġ'", 'Ġplasma', 'Ġflat', 'Ġpanel', 'Ġ1080', 'p', 'Ġh', 'd', 'tv', 'Ġin', 'Ġblack', 'Ġth', '42', 'p', 'z', '85', 'u', 'Ġ1080', 'p', 'Ġdisplay', 'Ġ1920', 'Ġx', 'Ġ1080', 'Ġnative', 'Ġresolution', 'Ġcolor', 'Ġpurity', 'Ġoptim', 'izer', 'Ġsurround', 'Ġsound', 'Ġanti', '-', 'reflect', 'ive', 'Ġfilter', 'Ġv', 'iera', 'Ġlink', 'Ġh', 'd', 'avi', 'Ġcontrol', 'Ġbuilt', '-', 'in', 'Ġn', 'ts', 'c', '/', 'ats', 'c', '/', 'q', 'am', 'Ġtun', 'ers', 'Ġpc', 'Ġinput', 'Ġ3', 'Ġh', 'd', 'mi', 'Ġinputs', 'Ġbuilt', '-', 'in', 'Ġgallery', 'player', 'Ġcapable', 'Ġsd', 'Ġcard', 'Ġmemory', 'Ġslot', 'Ġpedest', 'al', 'Ġstand', 'Ġincluded', 'Ġblack', 'Ġfinish', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ', 'Ġ', '</s>', '</s>', 'COL', 'Ġname', 'ĠVAL', 'Ġpan', 'asonic', 'Ġv', 'iera', 'Ġtc', '-', '37', 'l', 'z', '85', 'Ġ37', "Ġ'", 'Ġl', 'cd', 'Ġtv', 'ĠCOL', 'Ġdescription', 'ĠVAL', 'Ġ37', "Ġ'", 'Ġat', 'sc', 'Ġ,', 'Ġn', 'ts', 'c', 'Ġ16', ':', '9', 'Ġ1920', 'Ġx', 'Ġ1080', 'Ġh', 'd', 'tv', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ7', '99', '.', '11', 'Ġ', '</s>']
is_heads: [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
y: 0
tags: 0
mask: tensor([1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1])
seqlen: 168
task_name: Textual/Abt-Buy
=======================
step: 0, task: Textual/Abt-Buy, loss: 0.1336270570755005
step: 10, task: Textual/Abt-Buy, loss: 0.0014842301607131958
step: 20, task: Textual/Abt-Buy, loss: 0.0019690990447998047
step: 30, task: Textual/Abt-Buy, loss: 0.0002285689115524292
step: 40, task: Textual/Abt-Buy, loss: 0.0009553879499435425
step: 50, task: Textual/Abt-Buy, loss: 0.0005141794681549072
step: 60, task: Textual/Abt-Buy, loss: 0.015594273805618286
step: 70, task: Textual/Abt-Buy, loss: 0.0012840628623962402
step: 80, task: Textual/Abt-Buy, loss: 0.002303667366504669
step: 90, task: Textual/Abt-Buy, loss: 0.005756370723247528
step: 100, task: Textual/Abt-Buy, loss: 0.0002492070198059082
step: 110, task: Textual/Abt-Buy, loss: 0.00024785101413726807
step: 120, task: Textual/Abt-Buy, loss: 0.0012184977531433105
step: 130, task: Textual/Abt-Buy, loss: 0.00015911459922790527
step: 140, task: Textual/Abt-Buy, loss: 0.31337395310401917
step: 150, task: Textual/Abt-Buy, loss: 0.0005625039339065552
step: 160, task: Textual/Abt-Buy, loss: 0.00036035478115081787
step: 170, task: Textual/Abt-Buy, loss: 0.00028324127197265625
step: 180, task: Textual/Abt-Buy, loss: 0.00016993284225463867
step: 190, task: Textual/Abt-Buy, loss: 0.005319543182849884
step: 200, task: Textual/Abt-Buy, loss: 0.00411505252122879
step: 210, task: Textual/Abt-Buy, loss: 0.00021494925022125244
step: 220, task: Textual/Abt-Buy, loss: 0.0002971440553665161
step: 230, task: Textual/Abt-Buy, loss: 0.002133108675479889
step: 240, task: Textual/Abt-Buy, loss: 0.00010859966278076172
step: 250, task: Textual/Abt-Buy, loss: 9.948015213012695e-05
step: 260, task: Textual/Abt-Buy, loss: 0.0004376322031021118
step: 270, task: Textual/Abt-Buy, loss: 0.006797201931476593
step: 280, task: Textual/Abt-Buy, loss: 0.0047873854637146
step: 290, task: Textual/Abt-Buy, loss: 0.024330388754606247
step: 300, task: Textual/Abt-Buy, loss: 0.00023794174194335938
step: 310, task: Textual/Abt-Buy, loss: 0.00012364983558654785
step: 320, task: Textual/Abt-Buy, loss: 0.00024352967739105225
step: 330, task: Textual/Abt-Buy, loss: 0.00018437206745147705
step: 340, task: Textual/Abt-Buy, loss: 0.014620468020439148
step: 350, task: Textual/Abt-Buy, loss: 0.00542818009853363
=========eval at epoch=6=========
Validation:
=============Textual/Abt-Buy==================
accuracy=0.945
precision=0.903
recall=0.544
f1=0.679
======================================
Test:
=============Textual/Abt-Buy==================
accuracy=0.939
precision=0.846
recall=0.534
f1=0.655
======================================
=====sanity check======
words: COL name VAL nikon d90 black digital slr camera d90body COL description VAL nikon d90 black digital slr camera d90body 12.3 megapixel 3 ' tft lcd display d-movie shooting function expeed image processing scene recognition system in-camera retouch menu low-noise performance active d-lighting viewfinder compatible with hdmi output body only lens sold separately black finish COL price VAL   [SEP] COL name VAL canon eos 40d digital slr camera 1901b004 COL description VAL canon eos 40d 10 megapixel digital slr camera body only COL price VAL 849.95 
x: [    0 18047   766 27445   295   967   261   385  3248   909  1778  3369
   338  2280   385  3248  9773 14857  8194 27445   295   967   261   385
  3248   909  1778  3369   338  2280   385  3248  9773   316     4   246
 10721 21424   155   128   326  2543   784 28690  2332   385    12 38428
  1094  5043  1931 39640  2274  5774  1310  4972   467    11    12 25092
  5494 12746  5765   614    12  2362  1496   819  2171   385    12 30181
  1217 38116 16632    19  1368   417  5408  4195   809   129 10373  1088
 12712   909  2073 14857   425 27445  1437  1437     2     2 18047   766
 27445 32839   364   366   843   417  1778  3369   338  2280 40193   428
 37114 14857  8194 27445 32839   364   366   843   417   158 10721 21424
  1778  3369   338  2280   809   129 14857   425 27445   290  3414     4
  4015  1437     2]
tokens: ['<s>', 'COL', 'Ġname', 'ĠVAL', 'Ġn', 'ik', 'on', 'Ġd', '90', 'Ġblack', 'Ġdigital', 'Ġsl', 'r', 'Ġcamera', 'Ġd', '90', 'body', 'ĠCOL', 'Ġdescription', 'ĠVAL', 'Ġn', 'ik', 'on', 'Ġd', '90', 'Ġblack', 'Ġdigital', 'Ġsl', 'r', 'Ġcamera', 'Ġd', '90', 'body', 'Ġ12', '.', '3', 'Ġmeg', 'apixel', 'Ġ3', "Ġ'", 'Ġt', 'ft', 'Ġl', 'cd', 'Ġdisplay', 'Ġd', '-', 'movie', 'Ġshooting', 'Ġfunction', 'Ġex', 'peed', 'Ġimage', 'Ġprocessing', 'Ġscene', 'Ġrecognition', 'Ġsystem', 'Ġin', '-', 'camera', 'Ġret', 'ouch', 'Ġmenu', 'Ġlow', '-', 'no', 'ise', 'Ġperformance', 'Ġactive', 'Ġd', '-', 'lighting', 'Ġview', 'finder', 'Ġcompatible', 'Ġwith', 'Ġh', 'd', 'mi', 'Ġoutput', 'Ġbody', 'Ġonly', 'Ġlens', 'Ġsold', 'Ġseparately', 'Ġblack', 'Ġfinish', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ', 'Ġ', '</s>', '</s>', 'COL', 'Ġname', 'ĠVAL', 'Ġcanon', 'Ġe', 'os', 'Ġ40', 'd', 'Ġdigital', 'Ġsl', 'r', 'Ġcamera', 'Ġ1901', 'b', '004', 'ĠCOL', 'Ġdescription', 'ĠVAL', 'Ġcanon', 'Ġe', 'os', 'Ġ40', 'd', 'Ġ10', 'Ġmeg', 'apixel', 'Ġdigital', 'Ġsl', 'r', 'Ġcamera', 'Ġbody', 'Ġonly', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ8', '49', '.', '95', 'Ġ', '</s>']
is_heads: [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
y: 0
tags: 0
mask: tensor([1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1])
seqlen: 135
task_name: Textual/Abt-Buy
=======================
step: 0, task: Textual/Abt-Buy, loss: 0.00033454596996307373
step: 10, task: Textual/Abt-Buy, loss: 0.06814520061016083
step: 20, task: Textual/Abt-Buy, loss: 0.00017747282981872559
step: 30, task: Textual/Abt-Buy, loss: 0.1006125658750534
step: 40, task: Textual/Abt-Buy, loss: 0.0017368122935295105
step: 50, task: Textual/Abt-Buy, loss: 0.00031904876232147217
step: 60, task: Textual/Abt-Buy, loss: 0.00011833012104034424
step: 70, task: Textual/Abt-Buy, loss: 0.00017020106315612793
step: 80, task: Textual/Abt-Buy, loss: 0.0001645982265472412
step: 90, task: Textual/Abt-Buy, loss: 0.036264754831790924
step: 100, task: Textual/Abt-Buy, loss: 0.004921190440654755
step: 110, task: Textual/Abt-Buy, loss: 0.00014528632164001465
step: 120, task: Textual/Abt-Buy, loss: 0.00015394389629364014
step: 130, task: Textual/Abt-Buy, loss: 0.0005686283111572266
step: 140, task: Textual/Abt-Buy, loss: 0.00022424757480621338
step: 150, task: Textual/Abt-Buy, loss: 0.007631413638591766
step: 160, task: Textual/Abt-Buy, loss: 0.0028897523880004883
step: 170, task: Textual/Abt-Buy, loss: 0.023528508841991425
step: 180, task: Textual/Abt-Buy, loss: 0.00019747018814086914
step: 190, task: Textual/Abt-Buy, loss: 8.121132850646973e-05
step: 200, task: Textual/Abt-Buy, loss: 0.00014531612396240234
step: 210, task: Textual/Abt-Buy, loss: 0.0001909881830215454
step: 220, task: Textual/Abt-Buy, loss: 0.00015337765216827393
step: 230, task: Textual/Abt-Buy, loss: 0.0001824498176574707
step: 240, task: Textual/Abt-Buy, loss: 0.00019413232803344727
step: 250, task: Textual/Abt-Buy, loss: 0.00014266371726989746
step: 260, task: Textual/Abt-Buy, loss: 0.00017057359218597412
step: 270, task: Textual/Abt-Buy, loss: 0.0004035830497741699
step: 280, task: Textual/Abt-Buy, loss: 0.05857986956834793
step: 290, task: Textual/Abt-Buy, loss: 0.007454194128513336
step: 300, task: Textual/Abt-Buy, loss: 0.0003779381513595581
step: 310, task: Textual/Abt-Buy, loss: 0.00027848780155181885
step: 320, task: Textual/Abt-Buy, loss: 0.00014579296112060547
step: 330, task: Textual/Abt-Buy, loss: 0.0002319812774658203
step: 340, task: Textual/Abt-Buy, loss: 0.013695158064365387
step: 350, task: Textual/Abt-Buy, loss: 0.009449660778045654
=========eval at epoch=7=========
Validation:
=============Textual/Abt-Buy==================
accuracy=0.944
precision=0.922
recall=0.519
f1=0.665
======================================
Test:
=============Textual/Abt-Buy==================
accuracy=0.935
precision=0.886
recall=0.451
f1=0.598
======================================
=====sanity check======
words: COL name VAL sony 30gb handycam hard disk drive camcorder dcrsr45 COL description VAL sony 30gb handycam hard disk drive camcorder dcrsr45 1/8 ' advanced had ccd imager 40x optical/2000x digital zoom 2.7 ' wide ( 16:9 ) touch panel clear photo lcd plus display hybrid recording to hard disk drive or memory stick media built-in zoom microphone with 5.1 ch recording carl zeiss vario-tessar lens usb 2.0 interface super nightshot infrared system COL price VAL   [SEP] COL name VAL sony handycam hdr-sr12 high definition digital camcorder hdrsr12 COL description VAL 16:9 3.2 ' color lcd COL price VAL 869.0 
x: [    0 18047   766 27445   579  6119   389 19562 14732 16767   543 21675
  1305 11021   438 10337 46773  4926   338  1898 14857  8194 27445   579
  6119   389 19562 14732 16767   543 21675  1305 11021   438 10337 46773
  4926   338  1898   112    73   398   128  3319    56   740 28690  4356
  6988   843  1178 17547    73 17472  1178  1778 21762   132     4   406
   128  1810    36   545    35   466  4839  2842  2798   699  1345   784
 28690  2704  2332  9284  5492     7   543 21675  1305    50  3783  4757
   433  1490    12   179 21762 18896    19   195     4   134  1855  5492
   512   462 20025  3006 15747  1020    12    90  3361   271 10373 49030
   132     4   288 12332  2422   363 10393 30175   467 14857   425 27445
  1437  1437     2     2 18047   766 27445   579  6119 14732 16767  1368
 10232    12 37959  1092   239  8515  1778 11021   438 10337  1368   417
  4926   338  1092 14857  8194 27445   545    35   466   155     4   176
   128  3195   784 28690 14857   425 27445   290  4563     4   288  1437
     2]
tokens: ['<s>', 'COL', 'Ġname', 'ĠVAL', 'Ġs', 'ony', 'Ġ30', 'gb', 'Ġhandy', 'cam', 'Ġhard', 'Ġdisk', 'Ġdrive', 'Ġcam', 'c', 'order', 'Ġdc', 'rs', 'r', '45', 'ĠCOL', 'Ġdescription', 'ĠVAL', 'Ġs', 'ony', 'Ġ30', 'gb', 'Ġhandy', 'cam', 'Ġhard', 'Ġdisk', 'Ġdrive', 'Ġcam', 'c', 'order', 'Ġdc', 'rs', 'r', '45', 'Ġ1', '/', '8', "Ġ'", 'Ġadvanced', 'Ġhad', 'Ġc', 'cd', 'Ġim', 'ager', 'Ġ40', 'x', 'Ġoptical', '/', '2000', 'x', 'Ġdigital', 'Ġzoom', 'Ġ2', '.', '7', "Ġ'", 'Ġwide', 'Ġ(', 'Ġ16', ':', '9', 'Ġ)', 'Ġtouch', 'Ġpanel', 'Ġclear', 'Ġphoto', 'Ġl', 'cd', 'Ġplus', 'Ġdisplay', 'Ġhybrid', 'Ġrecording', 'Ġto', 'Ġhard', 'Ġdisk', 'Ġdrive', 'Ġor', 'Ġmemory', 'Ġstick', 'Ġmedia', 'Ġbuilt', '-', 'in', 'Ġzoom', 'Ġmicrophone', 'Ġwith', 'Ġ5', '.', '1', 'Ġch', 'Ġrecording', 'Ġcar', 'l', 'Ġze', 'iss', 'Ġvar', 'io', '-', 't', 'ess', 'ar', 'Ġlens', 'Ġusb', 'Ġ2', '.', '0', 'Ġinterface', 'Ġsuper', 'Ġnight', 'shot', 'Ġinfrared', 'Ġsystem', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ', 'Ġ', '</s>', '</s>', 'COL', 'Ġname', 'ĠVAL', 'Ġs', 'ony', 'Ġhandy', 'cam', 'Ġh', 'dr', '-', 'sr', '12', 'Ġhigh', 'Ġdefinition', 'Ġdigital', 'Ġcam', 'c', 'order', 'Ġh', 'd', 'rs', 'r', '12', 'ĠCOL', 'Ġdescription', 'ĠVAL', 'Ġ16', ':', '9', 'Ġ3', '.', '2', "Ġ'", 'Ġcolor', 'Ġl', 'cd', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ8', '69', '.', '0', 'Ġ', '</s>']
is_heads: [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
y: 0
tags: 0
mask: tensor([1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1])
seqlen: 169
task_name: Textual/Abt-Buy
=======================
step: 0, task: Textual/Abt-Buy, loss: 0.00014317035675048828
step: 10, task: Textual/Abt-Buy, loss: 0.0014358162879943848
step: 20, task: Textual/Abt-Buy, loss: 0.00015550851821899414
step: 30, task: Textual/Abt-Buy, loss: 0.05188338831067085
step: 40, task: Textual/Abt-Buy, loss: 0.0002498030662536621
step: 50, task: Textual/Abt-Buy, loss: 0.00013475120067596436
step: 60, task: Textual/Abt-Buy, loss: 0.004487574100494385
step: 70, task: Textual/Abt-Buy, loss: 0.002664998173713684
step: 80, task: Textual/Abt-Buy, loss: 0.0002887994050979614
step: 90, task: Textual/Abt-Buy, loss: 0.0004316866397857666
step: 100, task: Textual/Abt-Buy, loss: 8.985400199890137e-05
step: 110, task: Textual/Abt-Buy, loss: 0.006532721221446991
step: 120, task: Textual/Abt-Buy, loss: 0.000138208270072937
step: 130, task: Textual/Abt-Buy, loss: 8.952617645263672e-05
step: 140, task: Textual/Abt-Buy, loss: 0.0003886222839355469
step: 150, task: Textual/Abt-Buy, loss: 0.00018225610256195068
step: 160, task: Textual/Abt-Buy, loss: 0.006547428667545319
step: 170, task: Textual/Abt-Buy, loss: 0.0002052783966064453
step: 180, task: Textual/Abt-Buy, loss: 0.00013937056064605713
step: 190, task: Textual/Abt-Buy, loss: 0.0024210140109062195
step: 200, task: Textual/Abt-Buy, loss: 9.931623935699463e-05
step: 210, task: Textual/Abt-Buy, loss: 0.02683652937412262
step: 220, task: Textual/Abt-Buy, loss: 0.00015635788440704346
step: 230, task: Textual/Abt-Buy, loss: 0.002927727997303009
step: 240, task: Textual/Abt-Buy, loss: 0.00013449788093566895
step: 250, task: Textual/Abt-Buy, loss: 0.00012493133544921875
step: 260, task: Textual/Abt-Buy, loss: 0.00037117302417755127
step: 270, task: Textual/Abt-Buy, loss: 0.00040768086910247803
step: 280, task: Textual/Abt-Buy, loss: 0.00018255412578582764
step: 290, task: Textual/Abt-Buy, loss: 6.416440010070801e-05
step: 300, task: Textual/Abt-Buy, loss: 0.00011837482452392578
step: 310, task: Textual/Abt-Buy, loss: 9.053945541381836e-05
step: 320, task: Textual/Abt-Buy, loss: 0.0029091015458106995
step: 330, task: Textual/Abt-Buy, loss: 0.03074120730161667
step: 340, task: Textual/Abt-Buy, loss: 6.636977195739746e-05
step: 350, task: Textual/Abt-Buy, loss: 9.828805923461914e-05
=========eval at epoch=8=========
Validation:
=============Textual/Abt-Buy==================
accuracy=0.939
precision=0.932
recall=0.466
f1=0.621
======================================
Test:
=============Textual/Abt-Buy==================
accuracy=0.941
precision=0.919
recall=0.495
f1=0.644
======================================
Selected optimization level O2:  FP16 training with FP32 batchnorm and FP32 master weights.

Defaults for this optimization level are:
enabled                : True
opt_level              : O2
cast_model_type        : torch.float16
patch_torch_functions  : False
keep_batchnorm_fp32    : True
master_weights         : True
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O2
cast_model_type        : torch.float16
patch_torch_functions  : False
keep_batchnorm_fp32    : True
master_weights         : True
loss_scale             : dynamic
Warning:  multi_tensor_applier fused unscale kernel is unavailable, possibly because apex was installed without --cuda_ext --cpp_ext. Using Python fallback.  Original ImportError was: ModuleNotFoundError("No module named 'amp_C'")
Gradient overflow.  Skipping step, loss scaler 0 reducing loss scale to 32768.0
=====sanity check======
words: COL name VAL sanus wms3s silver weather resistant small speaker wall mount wms3s COL description VAL sanus wms3s silver small speaker wall mount wms3s holds up to an 8 pound speaker multiple pivot points weather resistant for indoor/outdoor use silver finish priced per pair COL price VAL 29.99  [SEP] COL name VAL sanus speaker mount wms3b black COL description VAL plastic 8 lb COL price VAL  
x: [    0 18047   766 27445 15610   687   885  4339   246    29  4334  1650
 19152   650  5385  2204 14206   885  4339   246    29 14857  8194 27445
 15610   687   885  4339   246    29  4334   650  5385  2204 14206   885
  4339   246    29  3106    62     7    41   290  6881  5385  1533 27475
   332  1650 19152    13 11894    73   995 11219   304  4334  2073  7663
   228  1763 14857   425 27445  1132     4  2831  1437     2     2 18047
   766 27445 15610   687  5385 14206   885  4339   246   428   909 14857
  8194 27445  4136   290 19821 14857   425 27445  1437  1437     2]
tokens: ['<s>', 'COL', 'Ġname', 'ĠVAL', 'Ġsan', 'us', 'Ġw', 'ms', '3', 's', 'Ġsilver', 'Ġweather', 'Ġresistant', 'Ġsmall', 'Ġspeaker', 'Ġwall', 'Ġmount', 'Ġw', 'ms', '3', 's', 'ĠCOL', 'Ġdescription', 'ĠVAL', 'Ġsan', 'us', 'Ġw', 'ms', '3', 's', 'Ġsilver', 'Ġsmall', 'Ġspeaker', 'Ġwall', 'Ġmount', 'Ġw', 'ms', '3', 's', 'Ġholds', 'Ġup', 'Ġto', 'Ġan', 'Ġ8', 'Ġpound', 'Ġspeaker', 'Ġmultiple', 'Ġpivot', 'Ġpoints', 'Ġweather', 'Ġresistant', 'Ġfor', 'Ġindoor', '/', 'out', 'door', 'Ġuse', 'Ġsilver', 'Ġfinish', 'Ġpriced', 'Ġper', 'Ġpair', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ29', '.', '99', 'Ġ', '</s>', '</s>', 'COL', 'Ġname', 'ĠVAL', 'Ġsan', 'us', 'Ġspeaker', 'Ġmount', 'Ġw', 'ms', '3', 'b', 'Ġblack', 'ĠCOL', 'Ġdescription', 'ĠVAL', 'Ġplastic', 'Ġ8', 'Ġlb', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ', 'Ġ', '</s>']
is_heads: [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
y: 0
tags: 0
mask: tensor([1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1])
seqlen: 95
task_name: Textual/Abt-Buy
=======================
step: 0, task: Textual/Abt-Buy, loss: 0.6117939352989197
Gradient overflow.  Skipping step, loss scaler 0 reducing loss scale to 16384.0
Gradient overflow.  Skipping step, loss scaler 0 reducing loss scale to 8192.0
step: 10, task: Textual/Abt-Buy, loss: 0.6087047457695007
step: 20, task: Textual/Abt-Buy, loss: 0.543336033821106
step: 30, task: Textual/Abt-Buy, loss: 0.4180871844291687
step: 40, task: Textual/Abt-Buy, loss: 0.2579001784324646
step: 50, task: Textual/Abt-Buy, loss: 0.5211966037750244
step: 60, task: Textual/Abt-Buy, loss: 0.36953163146972656
step: 70, task: Textual/Abt-Buy, loss: 0.35965970158576965
step: 80, task: Textual/Abt-Buy, loss: 0.09415127336978912
step: 90, task: Textual/Abt-Buy, loss: 0.27750733494758606
step: 100, task: Textual/Abt-Buy, loss: 0.25101783871650696
step: 110, task: Textual/Abt-Buy, loss: 0.13651596009731293
step: 120, task: Textual/Abt-Buy, loss: 0.42968422174453735
step: 130, task: Textual/Abt-Buy, loss: 0.19450540840625763
step: 140, task: Textual/Abt-Buy, loss: 0.05219506472349167
step: 150, task: Textual/Abt-Buy, loss: 0.15737006068229675
step: 160, task: Textual/Abt-Buy, loss: 0.5862409472465515
step: 170, task: Textual/Abt-Buy, loss: 0.0865810215473175
step: 180, task: Textual/Abt-Buy, loss: 0.5897307395935059
step: 190, task: Textual/Abt-Buy, loss: 0.47077593207359314
step: 200, task: Textual/Abt-Buy, loss: 0.7856494784355164
step: 210, task: Textual/Abt-Buy, loss: 0.3454328179359436
step: 220, task: Textual/Abt-Buy, loss: 0.4352124333381653
Gradient overflow.  Skipping step, loss scaler 0 reducing loss scale to 4096.0
step: 230, task: Textual/Abt-Buy, loss: 0.3806147277355194
step: 240, task: Textual/Abt-Buy, loss: 0.3991605043411255
step: 250, task: Textual/Abt-Buy, loss: 0.44149351119995117
step: 260, task: Textual/Abt-Buy, loss: 0.21368557214736938
step: 270, task: Textual/Abt-Buy, loss: 0.3432499170303345
step: 280, task: Textual/Abt-Buy, loss: 0.22599464654922485
step: 290, task: Textual/Abt-Buy, loss: 0.11574403941631317
step: 300, task: Textual/Abt-Buy, loss: 0.2308308482170105
step: 310, task: Textual/Abt-Buy, loss: 0.5067300796508789
step: 320, task: Textual/Abt-Buy, loss: 0.3139376640319824
step: 330, task: Textual/Abt-Buy, loss: 0.21793222427368164
step: 340, task: Textual/Abt-Buy, loss: 0.49422240257263184
step: 350, task: Textual/Abt-Buy, loss: 0.14144578576087952
=========eval at epoch=1=========
Validation:
=============Textual/Abt-Buy==================
accuracy=0.894
precision=0.636
recall=0.034
f1=0.065
======================================
Test:
=============Textual/Abt-Buy==================
accuracy=0.889
precision=0.312
recall=0.024
f1=0.045
======================================
/w/246/tianyu2020/miniconda2/envs/ditto/lib/python3.7/site-packages/apex/amp/_initialize.py:24: UserWarning: An input tensor was not cuda.
  warnings.warn("An input tensor was not cuda.")
/w/246/tianyu2020/miniconda2/envs/ditto/lib/python3.7/site-packages/torch/optim/lr_scheduler.py:122: UserWarning: Detected call of `lr_scheduler.step()` before `optimizer.step()`. In PyTorch 1.1.0 and later, you should call them in the opposite order: `optimizer.step()` before `lr_scheduler.step()`.  Failure to do this will result in PyTorch skipping the first value of the learning rate schedule. See more details at https://pytorch.org/docs/stable/optim.html#how-to-adjust-learning-rate
  "https://pytorch.org/docs/stable/optim.html#how-to-adjust-learning-rate", UserWarning)
=====sanity check======
words: COL name VAL sony black vaio z series 13.1 ' notebook computer vgnz550nb COL description VAL sony black vaio z series 13.1 ' notebook computer vgnz550nb 2.40 ghz intel core 2 duo p8600 processor 13.3 ' xbrite-duraview lcd integrated stereo a2dp bluetooth technology 250gb hard drive 3gb memory built-in motion eye camera and microphone genuine microsoft windows vista business with sp1/xp downgrade black finish COL price VAL   [SEP] COL name VAL sony vaio ns190j/s notebook vgnns190j/s COL description VAL sony vaio ns series ns190js notebook 2ghz intel core 2 duo t5800 , 4gb ram , 250gb hard drive , dvd + / - r/rw w / blu ray support , wireless link 5100agn , intel graphics media accelerator 4500mhd , 15.4 ' wxga lcd display , windows vista home premium ( silver ) COL price VAL 949.99 
x: [    0 18047   766 27445   579  6119   909 13205  1020   992   651   508
     4   134   128 27276  3034   748 16993   329 17953 40460 14857  8194
 27445   579  6119   909 13205  1020   992   651   508     4   134   128
 27276  3034   748 16993   329 17953 40460   132     4  1749 34648   329
 33238  2731   132  6458   181  5334   612 10655   508     4   246   128
  3023  3809  1459    12   417   710  1469 19420   784 28690  6818 31436
    10   176 43923 42034 44969   806  5773 19562   543  1305   155 19562
  3783  1490    12   179  4298  2295  2280     8 18896  8916  5177 24810
  6410   748  6377   265    19  2292   134    73 44813 19637   909  2073
 14857   425 27445  1437  1437     2     2 18047   766 27445   579  6119
 13205  1020 48286 20109   267    73    29 27276   748 16993  6852 20109
   267    73    29 14857  8194 27445   579  6119 13205  1020 48286   651
 48286 20109 21978 27276   132  4147   329 33238  2731   132  6458   326
  4432   612  2156   204 19562 19634  2156  5773 19562   543  1305  2156
   385 40311  2055  1589   111   910    73 43926   885  1589 42034 33803
   323  2156  6955  3104   195  1866 11244  2156 33238 12774   433 31463
   204  1497   119 35905  2156   379     4   306   128   885  1178  2538
   784 28690  2332  2156  6410   748  6377   184  4549    36  4334  4839
 14857   425 27445   361  3414     4  2831  1437     2]
tokens: ['<s>', 'COL', 'Ġname', 'ĠVAL', 'Ġs', 'ony', 'Ġblack', 'Ġva', 'io', 'Ġz', 'Ġseries', 'Ġ13', '.', '1', "Ġ'", 'Ġnotebook', 'Ġcomputer', 'Ġv', 'gn', 'z', '550', 'nb', 'ĠCOL', 'Ġdescription', 'ĠVAL', 'Ġs', 'ony', 'Ġblack', 'Ġva', 'io', 'Ġz', 'Ġseries', 'Ġ13', '.', '1', "Ġ'", 'Ġnotebook', 'Ġcomputer', 'Ġv', 'gn', 'z', '550', 'nb', 'Ġ2', '.', '40', 'Ġgh', 'z', 'Ġintel', 'Ġcore', 'Ġ2', 'Ġduo', 'Ġp', '86', '00', 'Ġprocessor', 'Ġ13', '.', '3', "Ġ'", 'Ġx', 'br', 'ite', '-', 'd', 'ur', 'av', 'iew', 'Ġl', 'cd', 'Ġintegrated', 'Ġstereo', 'Ġa', '2', 'dp', 'Ġblu', 'etooth', 'Ġtechnology', 'Ġ250', 'gb', 'Ġhard', 'Ġdrive', 'Ġ3', 'gb', 'Ġmemory', 'Ġbuilt', '-', 'in', 'Ġmotion', 'Ġeye', 'Ġcamera', 'Ġand', 'Ġmicrophone', 'Ġgenuine', 'Ġmicro', 'soft', 'Ġwindows', 'Ġv', 'ista', 'Ġbusiness', 'Ġwith', 'Ġsp', '1', '/', 'xp', 'Ġdowngrade', 'Ġblack', 'Ġfinish', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ', 'Ġ', '</s>', '</s>', 'COL', 'Ġname', 'ĠVAL', 'Ġs', 'ony', 'Ġva', 'io', 'Ġns', '190', 'j', '/', 's', 'Ġnotebook', 'Ġv', 'gn', 'ns', '190', 'j', '/', 's', 'ĠCOL', 'Ġdescription', 'ĠVAL', 'Ġs', 'ony', 'Ġva', 'io', 'Ġns', 'Ġseries', 'Ġns', '190', 'js', 'Ġnotebook', 'Ġ2', 'gh', 'z', 'Ġintel', 'Ġcore', 'Ġ2', 'Ġduo', 'Ġt', '58', '00', 'Ġ,', 'Ġ4', 'gb', 'Ġram', 'Ġ,', 'Ġ250', 'gb', 'Ġhard', 'Ġdrive', 'Ġ,', 'Ġd', 'vd', 'Ġ+', 'Ġ/', 'Ġ-', 'Ġr', '/', 'rw', 'Ġw', 'Ġ/', 'Ġblu', 'Ġray', 'Ġsupport', 'Ġ,', 'Ġwireless', 'Ġlink', 'Ġ5', '100', 'agn', 'Ġ,', 'Ġintel', 'Ġgraphics', 'Ġmedia', 'Ġaccelerator', 'Ġ4', '500', 'm', 'hd', 'Ġ,', 'Ġ15', '.', '4', "Ġ'", 'Ġw', 'x', 'ga', 'Ġl', 'cd', 'Ġdisplay', 'Ġ,', 'Ġwindows', 'Ġv', 'ista', 'Ġhome', 'Ġpremium', 'Ġ(', 'Ġsilver', 'Ġ)', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ9', '49', '.', '99', 'Ġ', '</s>']
is_heads: [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
y: 0
tags: 0
mask: tensor([1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1])
seqlen: 225
task_name: Textual/Abt-Buy
=======================
step: 0, task: Textual/Abt-Buy, loss: 0.1749100387096405
step: 10, task: Textual/Abt-Buy, loss: 0.23092570900917053
step: 20, task: Textual/Abt-Buy, loss: 0.21503916382789612
step: 30, task: Textual/Abt-Buy, loss: 0.1837409883737564
step: 40, task: Textual/Abt-Buy, loss: 0.39565712213516235
step: 50, task: Textual/Abt-Buy, loss: 0.18688569962978363
step: 60, task: Textual/Abt-Buy, loss: 0.13671384751796722
step: 70, task: Textual/Abt-Buy, loss: 0.06429645419120789
step: 80, task: Textual/Abt-Buy, loss: 0.030467398464679718
step: 90, task: Textual/Abt-Buy, loss: 0.04869185760617256
step: 100, task: Textual/Abt-Buy, loss: 0.015463635325431824
step: 110, task: Textual/Abt-Buy, loss: 0.14424310624599457
step: 120, task: Textual/Abt-Buy, loss: 0.4275510311126709
step: 130, task: Textual/Abt-Buy, loss: 0.14541688561439514
step: 140, task: Textual/Abt-Buy, loss: 0.1625467836856842
step: 150, task: Textual/Abt-Buy, loss: 0.16195246577262878
step: 160, task: Textual/Abt-Buy, loss: 0.08461395651102066
step: 170, task: Textual/Abt-Buy, loss: 0.21188285946846008
step: 180, task: Textual/Abt-Buy, loss: 0.1686355471611023
step: 190, task: Textual/Abt-Buy, loss: 0.004358954727649689
step: 200, task: Textual/Abt-Buy, loss: 0.07294832915067673
step: 210, task: Textual/Abt-Buy, loss: 0.16041961312294006
step: 220, task: Textual/Abt-Buy, loss: 0.19314062595367432
step: 230, task: Textual/Abt-Buy, loss: 0.13961680233478546
step: 240, task: Textual/Abt-Buy, loss: 0.042211804538965225
step: 250, task: Textual/Abt-Buy, loss: 0.15632739663124084
step: 260, task: Textual/Abt-Buy, loss: 0.00823325663805008
step: 270, task: Textual/Abt-Buy, loss: 0.0016376078128814697
step: 280, task: Textual/Abt-Buy, loss: 0.057938698679208755
step: 290, task: Textual/Abt-Buy, loss: 0.10789240896701813
step: 300, task: Textual/Abt-Buy, loss: 0.016368426382541656
step: 310, task: Textual/Abt-Buy, loss: 0.080217145383358
step: 320, task: Textual/Abt-Buy, loss: 0.013148389756679535
step: 330, task: Textual/Abt-Buy, loss: 0.04569510370492935
step: 340, task: Textual/Abt-Buy, loss: 0.05474117398262024
step: 350, task: Textual/Abt-Buy, loss: 0.016370385885238647
=========eval at epoch=2=========
Validation:
=============Textual/Abt-Buy==================
accuracy=0.918
precision=0.833
recall=0.291
f1=0.432
======================================
Test:
=============Textual/Abt-Buy==================
accuracy=0.923
precision=0.792
recall=0.388
f1=0.521
======================================
=====sanity check======
words: COL name VAL toshiba black 9-inch lcd widescreen portable dvd player sdp91s COL description VAL toshiba black portable dvd player sdp91s 9 ' widescreen tft lcd display up to 5 hour lithium battery life official divx certified switchable audio/video input and output swivel and flip type screen black finish COL price VAL   [SEP] COL name VAL panasonic dvd-ls83 portable dvd player COL description VAL 8.5 ' lcd dvd + rw , dvd-rw , dvd-ram , dvd + r , dvd-r , cd-rw dvd video , cd-da , mp3 , jpeg , mpeg-4 , divx , wma , video cd , svcd , highmat playback COL price VAL 148.69 
x: [    0 18047   766 27445     7  1193 15577   909   361    12  3796   784
 28690   885  4376 37346 15295   385 40311   869   579 43923  6468    29
 14857  8194 27445     7  1193 15577   909 15295   385 40311   869   579
 43923  6468    29   361   128   885  4376 37346   326  2543   784 28690
  2332    62     7   195  1946 16904  3822   301   781 14445  1178  9785
  5405   868  6086    73 14406  8135     8  4195  3514  2088   462     8
 11113  1907  2441   909  2073 14857   425 27445  1437  1437     2     2
 18047   766 27445  5730 38703   385 40311    12  6634  6361 15295   385
 40311   869 14857  8194 27445   290     4   245   128   784 28690   385
 40311  2055   910   605  2156   385 40311    12 43926  2156   385 40311
    12  4040  2156   385 40311  2055   910  2156   385 40311    12   338
  2156 45584    12 43926   385 40311   569  2156 45584    12  6106  2156
 44857   246  2156  1236 41191  2156   475 41191    12   306  2156 14445
  1178  2156   885  1916  2156   569 45584  2156 23119 28690  2156   239
  9244 20083 14857   425 27445 24646     4  4563  1437     2]
tokens: ['<s>', 'COL', 'Ġname', 'ĠVAL', 'Ġto', 'sh', 'iba', 'Ġblack', 'Ġ9', '-', 'inch', 'Ġl', 'cd', 'Ġw', 'ides', 'creen', 'Ġportable', 'Ġd', 'vd', 'Ġplayer', 'Ġs', 'dp', '91', 's', 'ĠCOL', 'Ġdescription', 'ĠVAL', 'Ġto', 'sh', 'iba', 'Ġblack', 'Ġportable', 'Ġd', 'vd', 'Ġplayer', 'Ġs', 'dp', '91', 's', 'Ġ9', "Ġ'", 'Ġw', 'ides', 'creen', 'Ġt', 'ft', 'Ġl', 'cd', 'Ġdisplay', 'Ġup', 'Ġto', 'Ġ5', 'Ġhour', 'Ġlithium', 'Ġbattery', 'Ġlife', 'Ġofficial', 'Ġdiv', 'x', 'Ġcertified', 'Ġswitch', 'able', 'Ġaudio', '/', 'video', 'Ġinput', 'Ġand', 'Ġoutput', 'Ġsw', 'ive', 'l', 'Ġand', 'Ġflip', 'Ġtype', 'Ġscreen', 'Ġblack', 'Ġfinish', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ', 'Ġ', '</s>', '</s>', 'COL', 'Ġname', 'ĠVAL', 'Ġpan', 'asonic', 'Ġd', 'vd', '-', 'ls', '83', 'Ġportable', 'Ġd', 'vd', 'Ġplayer', 'ĠCOL', 'Ġdescription', 'ĠVAL', 'Ġ8', '.', '5', "Ġ'", 'Ġl', 'cd', 'Ġd', 'vd', 'Ġ+', 'Ġr', 'w', 'Ġ,', 'Ġd', 'vd', '-', 'rw', 'Ġ,', 'Ġd', 'vd', '-', 'ram', 'Ġ,', 'Ġd', 'vd', 'Ġ+', 'Ġr', 'Ġ,', 'Ġd', 'vd', '-', 'r', 'Ġ,', 'Ġcd', '-', 'rw', 'Ġd', 'vd', 'Ġvideo', 'Ġ,', 'Ġcd', '-', 'da', 'Ġ,', 'Ġmp', '3', 'Ġ,', 'Ġj', 'peg', 'Ġ,', 'Ġm', 'peg', '-', '4', 'Ġ,', 'Ġdiv', 'x', 'Ġ,', 'Ġw', 'ma', 'Ġ,', 'Ġvideo', 'Ġcd', 'Ġ,', 'Ġsv', 'cd', 'Ġ,', 'Ġhigh', 'mat', 'Ġplayback', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ148', '.', '69', 'Ġ', '</s>']
is_heads: [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
y: 0
tags: 0
mask: tensor([1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1])
seqlen: 178
task_name: Textual/Abt-Buy
=======================
step: 0, task: Textual/Abt-Buy, loss: 0.06090497225522995
step: 10, task: Textual/Abt-Buy, loss: 0.04725424945354462
step: 20, task: Textual/Abt-Buy, loss: 0.0010312199592590332
step: 30, task: Textual/Abt-Buy, loss: 0.040621571242809296
step: 40, task: Textual/Abt-Buy, loss: 0.0016829892992973328
step: 50, task: Textual/Abt-Buy, loss: 0.03653648495674133
step: 60, task: Textual/Abt-Buy, loss: 0.04915817826986313
step: 70, task: Textual/Abt-Buy, loss: 0.22030453383922577
step: 80, task: Textual/Abt-Buy, loss: 0.2651878595352173
step: 90, task: Textual/Abt-Buy, loss: 0.14752638339996338
step: 100, task: Textual/Abt-Buy, loss: 0.02473554015159607
step: 110, task: Textual/Abt-Buy, loss: 0.0037177205085754395
step: 120, task: Textual/Abt-Buy, loss: 0.09256133437156677
step: 130, task: Textual/Abt-Buy, loss: 0.04096036031842232
step: 140, task: Textual/Abt-Buy, loss: 0.006739288568496704
step: 150, task: Textual/Abt-Buy, loss: 0.01808350533246994
step: 160, task: Textual/Abt-Buy, loss: 0.013507910072803497
step: 170, task: Textual/Abt-Buy, loss: 0.38974982500076294
step: 180, task: Textual/Abt-Buy, loss: 0.11827346682548523
step: 190, task: Textual/Abt-Buy, loss: 0.17795121669769287
step: 200, task: Textual/Abt-Buy, loss: 0.2520367503166199
step: 210, task: Textual/Abt-Buy, loss: 0.008211709558963776
step: 220, task: Textual/Abt-Buy, loss: 0.06901213526725769
step: 230, task: Textual/Abt-Buy, loss: 0.00651317834854126
step: 240, task: Textual/Abt-Buy, loss: 0.004595324397087097
step: 250, task: Textual/Abt-Buy, loss: 0.005092814564704895
step: 260, task: Textual/Abt-Buy, loss: 0.04474404454231262
step: 270, task: Textual/Abt-Buy, loss: 0.0009347349405288696
step: 280, task: Textual/Abt-Buy, loss: 0.04802785813808441
step: 290, task: Textual/Abt-Buy, loss: 0.22313626110553741
step: 300, task: Textual/Abt-Buy, loss: 0.07241673767566681
step: 310, task: Textual/Abt-Buy, loss: 0.07001613825559616
step: 320, task: Textual/Abt-Buy, loss: 0.04134785383939743
step: 330, task: Textual/Abt-Buy, loss: 0.043137289583683014
step: 340, task: Textual/Abt-Buy, loss: 0.15022198855876923
step: 350, task: Textual/Abt-Buy, loss: 0.009433917701244354
=========eval at epoch=3=========
Validation:
=============Textual/Abt-Buy==================
accuracy=0.937
precision=0.890
recall=0.471
f1=0.616
======================================
Test:
=============Textual/Abt-Buy==================
accuracy=0.941
precision=0.934
recall=0.481
f1=0.635
======================================
=====sanity check======
words: COL name VAL panasonic viera 50 ' plasma flat panel hdtv in black th50px80u COL description VAL panasonic viera 50 ' plasma flat panel hdtv in black th50px80u 720p display 1366 x 768 native resolution color purity optimizer surround sound anti-reflective filter viera link hdavi control built-in ntsc/atsc/qam tuners 3 hdmi inputs built-in galleryplayer capable sd card memory slot pedestal stand included black finish COL price VAL   [SEP] COL name VAL panasonic viera th-50pz80u 50 ' plasma tv COL description VAL 50 ' atsc , ntsc 16:9 1920 x 1080 surround hdtv COL price VAL 1364.96 
x: [    0 18047   766 27445  5730 38703   748 16432   654   128 29051  3269
  2798  1368   417 18724    11   909  3553  1096 38740  2940   257 14857
  8194 27445  5730 38703   748 16432   654   128 29051  3269  2798  1368
   417 18724    11   909  3553  1096 38740  2940   257 26180   642  2332
   508  4280  3023 43751  3763  3547  3195 32195 17775  6315 21104  2369
  1475    12 39878  2088 14929   748 16432  3104  1368   417 11132   797
  1490    12   179   295  1872   438    73  2923   438    73  1343   424
 27115   268   155  1368   417  5408 16584  1490    12   179  7294 23233
  4453 46409  1886  3783  8534 38238   337  1413  1165   909  2073 14857
   425 27445  1437  1437     2     2 18047   766 27445  5730 38703   748
 16432  3553    12  1096   642   329  2940   257   654   128 29051 30016
 14857  8194 27445   654   128    23  3866  2156   295  1872   438   545
    35   466 18283  3023 21083 21104  1368   417 18724 14857   425 27445
   508  4027     4  5607  1437     2]
tokens: ['<s>', 'COL', 'Ġname', 'ĠVAL', 'Ġpan', 'asonic', 'Ġv', 'iera', 'Ġ50', "Ġ'", 'Ġplasma', 'Ġflat', 'Ġpanel', 'Ġh', 'd', 'tv', 'Ġin', 'Ġblack', 'Ġth', '50', 'px', '80', 'u', 'ĠCOL', 'Ġdescription', 'ĠVAL', 'Ġpan', 'asonic', 'Ġv', 'iera', 'Ġ50', "Ġ'", 'Ġplasma', 'Ġflat', 'Ġpanel', 'Ġh', 'd', 'tv', 'Ġin', 'Ġblack', 'Ġth', '50', 'px', '80', 'u', 'Ġ720', 'p', 'Ġdisplay', 'Ġ13', '66', 'Ġx', 'Ġ768', 'Ġnative', 'Ġresolution', 'Ġcolor', 'Ġpurity', 'Ġoptim', 'izer', 'Ġsurround', 'Ġsound', 'Ġanti', '-', 'reflect', 'ive', 'Ġfilter', 'Ġv', 'iera', 'Ġlink', 'Ġh', 'd', 'avi', 'Ġcontrol', 'Ġbuilt', '-', 'in', 'Ġn', 'ts', 'c', '/', 'ats', 'c', '/', 'q', 'am', 'Ġtun', 'ers', 'Ġ3', 'Ġh', 'd', 'mi', 'Ġinputs', 'Ġbuilt', '-', 'in', 'Ġgallery', 'player', 'Ġcapable', 'Ġsd', 'Ġcard', 'Ġmemory', 'Ġslot', 'Ġpedest', 'al', 'Ġstand', 'Ġincluded', 'Ġblack', 'Ġfinish', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ', 'Ġ', '</s>', '</s>', 'COL', 'Ġname', 'ĠVAL', 'Ġpan', 'asonic', 'Ġv', 'iera', 'Ġth', '-', '50', 'p', 'z', '80', 'u', 'Ġ50', "Ġ'", 'Ġplasma', 'Ġtv', 'ĠCOL', 'Ġdescription', 'ĠVAL', 'Ġ50', "Ġ'", 'Ġat', 'sc', 'Ġ,', 'Ġn', 'ts', 'c', 'Ġ16', ':', '9', 'Ġ1920', 'Ġx', 'Ġ1080', 'Ġsurround', 'Ġh', 'd', 'tv', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ13', '64', '.', '96', 'Ġ', '</s>']
is_heads: [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
y: 0
tags: 0
mask: tensor([1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1])
seqlen: 162
task_name: Textual/Abt-Buy
=======================
step: 0, task: Textual/Abt-Buy, loss: 0.10563839226961136
step: 10, task: Textual/Abt-Buy, loss: 0.06442908197641373
step: 20, task: Textual/Abt-Buy, loss: 0.02258918434381485
step: 30, task: Textual/Abt-Buy, loss: 0.002941042184829712
step: 40, task: Textual/Abt-Buy, loss: 0.005600549280643463
step: 50, task: Textual/Abt-Buy, loss: 0.04738820716738701
step: 60, task: Textual/Abt-Buy, loss: 0.015422336757183075
step: 70, task: Textual/Abt-Buy, loss: 0.002620585262775421
step: 80, task: Textual/Abt-Buy, loss: 0.004912547767162323
step: 90, task: Textual/Abt-Buy, loss: 0.0024207085371017456
step: 100, task: Textual/Abt-Buy, loss: 0.010614976286888123
step: 110, task: Textual/Abt-Buy, loss: 0.24859675765037537
step: 120, task: Textual/Abt-Buy, loss: 0.03412725776433945
step: 130, task: Textual/Abt-Buy, loss: 0.054695069789886475
step: 140, task: Textual/Abt-Buy, loss: 0.038082294166088104
step: 150, task: Textual/Abt-Buy, loss: 0.01184074953198433
step: 160, task: Textual/Abt-Buy, loss: 0.0012748539447784424
step: 170, task: Textual/Abt-Buy, loss: 0.18016210198402405
step: 180, task: Textual/Abt-Buy, loss: 0.002551935613155365
step: 190, task: Textual/Abt-Buy, loss: 0.004735499620437622
step: 200, task: Textual/Abt-Buy, loss: 0.10273769497871399
step: 210, task: Textual/Abt-Buy, loss: 0.0013633370399475098
step: 220, task: Textual/Abt-Buy, loss: 0.0023994818329811096
step: 230, task: Textual/Abt-Buy, loss: 0.003656342625617981
step: 240, task: Textual/Abt-Buy, loss: 0.00045561790466308594
step: 250, task: Textual/Abt-Buy, loss: 0.00042828917503356934
step: 260, task: Textual/Abt-Buy, loss: 0.002950623631477356
step: 270, task: Textual/Abt-Buy, loss: 0.020472079515457153
step: 280, task: Textual/Abt-Buy, loss: 0.007142499089241028
step: 290, task: Textual/Abt-Buy, loss: 0.005556099116802216
step: 300, task: Textual/Abt-Buy, loss: 0.0014428794384002686
step: 310, task: Textual/Abt-Buy, loss: 0.03860771656036377
step: 320, task: Textual/Abt-Buy, loss: 0.11267781257629395
step: 330, task: Textual/Abt-Buy, loss: 0.00237157940864563
step: 340, task: Textual/Abt-Buy, loss: 0.028081364929676056
step: 350, task: Textual/Abt-Buy, loss: 0.0003475695848464966
=========eval at epoch=4=========
Validation:
=============Textual/Abt-Buy==================
accuracy=0.922
precision=0.901
recall=0.311
f1=0.462
======================================
Test:
=============Textual/Abt-Buy==================
accuracy=0.932
precision=0.987
recall=0.369
f1=0.537
======================================
=====sanity check======
words: COL name VAL panasonic viera 42 ' plasma flat panel 1080p hdtv in black th42pz85u COL description VAL panasonic viera 42 ' plasma flat panel 1080p hdtv in black th42pz85u 1080p display 1920 x 1080 native resolution color purity optimizer surround sound anti-reflective filter viera link hdavi control built-in ntsc/atsc/qam tuners pc input 3 hdmi inputs built-in galleryplayer capable sd card memory slot pedestal stand included black finish COL price VAL   [SEP] COL name VAL panasonic viera th-50pz800u 50 ' widescreen 1080p plasma hdtv 1,000,000:1 dynamic contrast ratio COL description VAL  COL price VAL 1711.19 
x: [    0 18047   766 27445  5730 38703   748 16432  3330   128 29051  3269
  2798 21083   642  1368   417 18724    11   909  3553  3714   642   329
  4531   257 14857  8194 27445  5730 38703   748 16432  3330   128 29051
  3269  2798 21083   642  1368   417 18724    11   909  3553  3714   642
   329  4531   257 21083   642  2332 18283  3023 21083  3763  3547  3195
 32195 17775  6315 21104  2369  1475    12 39878  2088 14929   748 16432
  3104  1368   417 11132   797  1490    12   179   295  1872   438    73
  2923   438    73  1343   424 27115   268 46213  8135   155  1368   417
  5408 16584  1490    12   179  7294 23233  4453 46409  1886  3783  8534
 38238   337  1413  1165   909  2073 14857   425 27445  1437  1437     2
     2 18047   766 27445  5730 38703   748 16432  3553    12  1096   642
   329  3913   257   654   128   885  4376 37346 21083   642 29051  1368
   417 18724   112     6   151     6   151    35   134  6878  5709  1750
 14857  8194 27445  1437 14857   425 27445   601  1225     4  1646  1437
     2]
tokens: ['<s>', 'COL', 'Ġname', 'ĠVAL', 'Ġpan', 'asonic', 'Ġv', 'iera', 'Ġ42', "Ġ'", 'Ġplasma', 'Ġflat', 'Ġpanel', 'Ġ1080', 'p', 'Ġh', 'd', 'tv', 'Ġin', 'Ġblack', 'Ġth', '42', 'p', 'z', '85', 'u', 'ĠCOL', 'Ġdescription', 'ĠVAL', 'Ġpan', 'asonic', 'Ġv', 'iera', 'Ġ42', "Ġ'", 'Ġplasma', 'Ġflat', 'Ġpanel', 'Ġ1080', 'p', 'Ġh', 'd', 'tv', 'Ġin', 'Ġblack', 'Ġth', '42', 'p', 'z', '85', 'u', 'Ġ1080', 'p', 'Ġdisplay', 'Ġ1920', 'Ġx', 'Ġ1080', 'Ġnative', 'Ġresolution', 'Ġcolor', 'Ġpurity', 'Ġoptim', 'izer', 'Ġsurround', 'Ġsound', 'Ġanti', '-', 'reflect', 'ive', 'Ġfilter', 'Ġv', 'iera', 'Ġlink', 'Ġh', 'd', 'avi', 'Ġcontrol', 'Ġbuilt', '-', 'in', 'Ġn', 'ts', 'c', '/', 'ats', 'c', '/', 'q', 'am', 'Ġtun', 'ers', 'Ġpc', 'Ġinput', 'Ġ3', 'Ġh', 'd', 'mi', 'Ġinputs', 'Ġbuilt', '-', 'in', 'Ġgallery', 'player', 'Ġcapable', 'Ġsd', 'Ġcard', 'Ġmemory', 'Ġslot', 'Ġpedest', 'al', 'Ġstand', 'Ġincluded', 'Ġblack', 'Ġfinish', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ', 'Ġ', '</s>', '</s>', 'COL', 'Ġname', 'ĠVAL', 'Ġpan', 'asonic', 'Ġv', 'iera', 'Ġth', '-', '50', 'p', 'z', '800', 'u', 'Ġ50', "Ġ'", 'Ġw', 'ides', 'creen', 'Ġ1080', 'p', 'Ġplasma', 'Ġh', 'd', 'tv', 'Ġ1', ',', '000', ',', '000', ':', '1', 'Ġdynamic', 'Ġcontrast', 'Ġratio', 'ĠCOL', 'Ġdescription', 'ĠVAL', 'Ġ', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ17', '11', '.', '19', 'Ġ', '</s>']
is_heads: [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
y: 0
tags: 0
mask: tensor([1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1])
seqlen: 169
task_name: Textual/Abt-Buy
=======================
step: 0, task: Textual/Abt-Buy, loss: 0.0011257827281951904
step: 10, task: Textual/Abt-Buy, loss: 0.002021484076976776
step: 20, task: Textual/Abt-Buy, loss: 0.00042131543159484863
step: 30, task: Textual/Abt-Buy, loss: 0.0015411078929901123
step: 40, task: Textual/Abt-Buy, loss: 0.00492309033870697
step: 50, task: Textual/Abt-Buy, loss: 0.00027076900005340576
step: 60, task: Textual/Abt-Buy, loss: 0.0005595237016677856
step: 70, task: Textual/Abt-Buy, loss: 0.0014313310384750366
step: 80, task: Textual/Abt-Buy, loss: 0.00021935999393463135
step: 90, task: Textual/Abt-Buy, loss: 0.0009898990392684937
step: 100, task: Textual/Abt-Buy, loss: 0.00011970102787017822
step: 110, task: Textual/Abt-Buy, loss: 0.0007592588663101196
step: 120, task: Textual/Abt-Buy, loss: 0.027966447174549103
step: 130, task: Textual/Abt-Buy, loss: 0.003630325198173523
step: 140, task: Textual/Abt-Buy, loss: 0.020062480121850967
step: 150, task: Textual/Abt-Buy, loss: 0.0007233619689941406
step: 160, task: Textual/Abt-Buy, loss: 0.007662475109100342
step: 170, task: Textual/Abt-Buy, loss: 0.005275122821331024
step: 180, task: Textual/Abt-Buy, loss: 0.05093948543071747
step: 190, task: Textual/Abt-Buy, loss: 0.07052122801542282
step: 200, task: Textual/Abt-Buy, loss: 0.020163260400295258
step: 210, task: Textual/Abt-Buy, loss: 0.1875135749578476
step: 220, task: Textual/Abt-Buy, loss: 0.018932655453681946
step: 230, task: Textual/Abt-Buy, loss: 0.02818652242422104
step: 240, task: Textual/Abt-Buy, loss: 0.0018863677978515625
step: 250, task: Textual/Abt-Buy, loss: 0.004563078284263611
step: 260, task: Textual/Abt-Buy, loss: 0.004338696599006653
step: 270, task: Textual/Abt-Buy, loss: 0.0030569806694984436
step: 280, task: Textual/Abt-Buy, loss: 0.003467269241809845
step: 290, task: Textual/Abt-Buy, loss: 0.08057470619678497
step: 300, task: Textual/Abt-Buy, loss: 0.001056179404258728
step: 310, task: Textual/Abt-Buy, loss: 0.0004359781742095947
step: 320, task: Textual/Abt-Buy, loss: 0.04353931546211243
step: 330, task: Textual/Abt-Buy, loss: 0.008093401789665222
step: 340, task: Textual/Abt-Buy, loss: 0.004108227789402008
step: 350, task: Textual/Abt-Buy, loss: 0.0002447962760925293
=========eval at epoch=5=========
Validation:
=============Textual/Abt-Buy==================
accuracy=0.936
precision=0.919
recall=0.442
f1=0.597
======================================
Test:
=============Textual/Abt-Buy==================
accuracy=0.945
precision=0.917
recall=0.534
f1=0.675
======================================
=====sanity check======
words: COL name VAL onkyo 6 disc cd player changer dxc390b COL description VAL onkyo 6 disc cd player changer - dxc390b multi single-bit dac 6 repeat modes 40 random track memory direct track access 96 db s/n ratio 5 hz-20 khz frequency response remote control included black finish COL price VAL   [SEP] COL name VAL onkyo 6-disc cd changer w/vlsc , black nic dx-c390 COL description VAL  COL price VAL 179.72 
x: [    0 18047   766 27445    15  4122   139   231  9553 45584   869 24622
   254   385 45421 27873   428 14857  8194 27445    15  4122   139   231
  9553 45584   869 24622   254   111   385 45421 27873   428  3228   881
    12  5881   385  1043   231  7230 19180   843  9624  1349  3783  2228
  1349   899  8971 45655   579    73   282  1750   195  1368   329    12
   844   449 39569 13135  1263  6063   797  1165   909  2073 14857   425
 27445  1437  1437     2     2 18047   766 27445    15  4122   139   231
    12 18909 45584 24622   254   885    73 41350  3866  2156   909 18657
 49386    12   438 27873 14857  8194 27445  1437 14857   425 27445 29189
     4  4956  1437     2]
tokens: ['<s>', 'COL', 'Ġname', 'ĠVAL', 'Ġon', 'ky', 'o', 'Ġ6', 'Ġdisc', 'Ġcd', 'Ġplayer', 'Ġchang', 'er', 'Ġd', 'xc', '390', 'b', 'ĠCOL', 'Ġdescription', 'ĠVAL', 'Ġon', 'ky', 'o', 'Ġ6', 'Ġdisc', 'Ġcd', 'Ġplayer', 'Ġchang', 'er', 'Ġ-', 'Ġd', 'xc', '390', 'b', 'Ġmulti', 'Ġsingle', '-', 'bit', 'Ġd', 'ac', 'Ġ6', 'Ġrepeat', 'Ġmodes', 'Ġ40', 'Ġrandom', 'Ġtrack', 'Ġmemory', 'Ġdirect', 'Ġtrack', 'Ġaccess', 'Ġ96', 'Ġdb', 'Ġs', '/', 'n', 'Ġratio', 'Ġ5', 'Ġh', 'z', '-', '20', 'Ġk', 'hz', 'Ġfrequency', 'Ġresponse', 'Ġremote', 'Ġcontrol', 'Ġincluded', 'Ġblack', 'Ġfinish', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ', 'Ġ', '</s>', '</s>', 'COL', 'Ġname', 'ĠVAL', 'Ġon', 'ky', 'o', 'Ġ6', '-', 'disc', 'Ġcd', 'Ġchang', 'er', 'Ġw', '/', 'vl', 'sc', 'Ġ,', 'Ġblack', 'Ġnic', 'Ġdx', '-', 'c', '390', 'ĠCOL', 'Ġdescription', 'ĠVAL', 'Ġ', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ179', '.', '72', 'Ġ', '</s>']
is_heads: [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
y: 1
tags: 1
mask: tensor([1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1])
seqlen: 112
task_name: Textual/Abt-Buy
=======================
step: 0, task: Textual/Abt-Buy, loss: 0.03617674857378006
step: 10, task: Textual/Abt-Buy, loss: 0.0004134923219680786
step: 20, task: Textual/Abt-Buy, loss: 0.0011475235223770142
step: 30, task: Textual/Abt-Buy, loss: 0.0025324299931526184
step: 40, task: Textual/Abt-Buy, loss: 0.0002859830856323242
step: 50, task: Textual/Abt-Buy, loss: 0.01401827484369278
step: 60, task: Textual/Abt-Buy, loss: 0.012279428541660309
step: 70, task: Textual/Abt-Buy, loss: 0.0012258291244506836
step: 80, task: Textual/Abt-Buy, loss: 0.011124588549137115
step: 90, task: Textual/Abt-Buy, loss: 0.0002910345792770386
step: 100, task: Textual/Abt-Buy, loss: 0.00022858381271362305
step: 110, task: Textual/Abt-Buy, loss: 0.0015233606100082397
step: 120, task: Textual/Abt-Buy, loss: 0.0005416423082351685
step: 130, task: Textual/Abt-Buy, loss: 0.0231277197599411
step: 140, task: Textual/Abt-Buy, loss: 0.002214305102825165
step: 150, task: Textual/Abt-Buy, loss: 0.0032121986150741577
step: 160, task: Textual/Abt-Buy, loss: 0.2720639109611511
step: 170, task: Textual/Abt-Buy, loss: 0.058712661266326904
step: 180, task: Textual/Abt-Buy, loss: 0.009756699204444885
step: 190, task: Textual/Abt-Buy, loss: 0.0063483864068984985
step: 200, task: Textual/Abt-Buy, loss: 0.00035293400287628174
step: 210, task: Textual/Abt-Buy, loss: 0.005977466702461243
step: 220, task: Textual/Abt-Buy, loss: 0.01765107363462448
step: 230, task: Textual/Abt-Buy, loss: 0.007599085569381714
step: 240, task: Textual/Abt-Buy, loss: 0.00018006563186645508
step: 250, task: Textual/Abt-Buy, loss: 0.0021797791123390198
step: 260, task: Textual/Abt-Buy, loss: 0.015026368200778961
step: 270, task: Textual/Abt-Buy, loss: 0.04321318864822388
step: 280, task: Textual/Abt-Buy, loss: 0.00045789778232574463
step: 290, task: Textual/Abt-Buy, loss: 0.029277589172124863
step: 300, task: Textual/Abt-Buy, loss: 0.1473190039396286
step: 310, task: Textual/Abt-Buy, loss: 7.148087024688721e-05
step: 320, task: Textual/Abt-Buy, loss: 0.0003456324338912964
step: 330, task: Textual/Abt-Buy, loss: 0.016756832599639893
step: 340, task: Textual/Abt-Buy, loss: 0.0004627406597137451
step: 350, task: Textual/Abt-Buy, loss: 0.0002864450216293335
=========eval at epoch=6=========
Validation:
=============Textual/Abt-Buy==================
accuracy=0.941
precision=0.912
recall=0.500
f1=0.646
======================================
Test:
=============Textual/Abt-Buy==================
accuracy=0.944
precision=0.915
recall=0.524
f1=0.667
======================================
=====sanity check======
words: COL name VAL sony silver cyber-shot digital camera dscw150 COL description VAL sony silver cyber-shot digital camera dscw150 8.1 megapixels 2.7 ' lcd display 15 mb internal memory carl zeiss 5x optical zoom lens 16:9 high-resolution mode 9-point auto focus automatic macro shooting high sensitivity mode burst mode face detection intelligent scene recognition mode in-camera retouching super steadyshot optical image stabilization with anti-blur solution music slideshow hdtv compatibility beginner-friendly function guide silver finish COL price VAL   [SEP] COL name VAL panasonic lumix dmc-fs3 digital camera silver COL description VAL panasonic dmc-fs3s 8 megapixel compact digital camera with 33mm lens , 3x optical zoom , intelligent auto mode and 2.5 ' diagonal intelligent lcd silver COL price VAL 137.33 
x: [    0 18047   766 27445   579  6119  4334  5381    12 10393  1778  2280
   385  3866   605  6115 14857  8194 27445   579  6119  4334  5381    12
 10393  1778  2280   385  3866   605  6115   290     4   134 10721  1115
 41699   132     4   406   128   784 28690  2332   379   475   428  3425
  3783   512   462 20025  3006   195  1178 17547 21762 10373   545    35
   466   239    12 29646  5745   361    12  2300  4485  1056  8408 12303
  1094   239 15608  5745 10084  5745   652 12673 12038  1310  4972  5745
    11    12 25092  5494 12746   154  2422 23789  2459 10120 17547  2274
 29632    19  1475    12  3662   710  2472   930 13150  1368   417 18724
 29988 37239    12  6928  5043  4704  4334  2073 14857   425 27445  1437
  1437     2     2 18047   766 27445  5730 38703 31962  3181   385 29297
    12 17884   246  1778  2280  4334 14857  8194 27445  5730 38703   385
 29297    12 17884   246    29   290 10721 21424 12549  1778  2280    19
  2357  5471 10373  2156   155  1178 17547 21762  2156 12038  4485  5745
     8   132     4   245   128 42539 12038   784 28690  4334 14857   425
 27445 22619     4  3103  1437     2]
tokens: ['<s>', 'COL', 'Ġname', 'ĠVAL', 'Ġs', 'ony', 'Ġsilver', 'Ġcyber', '-', 'shot', 'Ġdigital', 'Ġcamera', 'Ġd', 'sc', 'w', '150', 'ĠCOL', 'Ġdescription', 'ĠVAL', 'Ġs', 'ony', 'Ġsilver', 'Ġcyber', '-', 'shot', 'Ġdigital', 'Ġcamera', 'Ġd', 'sc', 'w', '150', 'Ġ8', '.', '1', 'Ġmeg', 'ap', 'ixels', 'Ġ2', '.', '7', "Ġ'", 'Ġl', 'cd', 'Ġdisplay', 'Ġ15', 'Ġm', 'b', 'Ġinternal', 'Ġmemory', 'Ġcar', 'l', 'Ġze', 'iss', 'Ġ5', 'x', 'Ġoptical', 'Ġzoom', 'Ġlens', 'Ġ16', ':', '9', 'Ġhigh', '-', 'resolution', 'Ġmode', 'Ġ9', '-', 'point', 'Ġauto', 'Ġfocus', 'Ġautomatic', 'Ġmacro', 'Ġshooting', 'Ġhigh', 'Ġsensitivity', 'Ġmode', 'Ġburst', 'Ġmode', 'Ġface', 'Ġdetection', 'Ġintelligent', 'Ġscene', 'Ġrecognition', 'Ġmode', 'Ġin', '-', 'camera', 'Ġret', 'ouch', 'ing', 'Ġsuper', 'Ġstead', 'ys', 'hot', 'Ġoptical', 'Ġimage', 'Ġstabilization', 'Ġwith', 'Ġanti', '-', 'bl', 'ur', 'Ġsolution', 'Ġmusic', 'Ġslideshow', 'Ġh', 'd', 'tv', 'Ġcompatibility', 'Ġbeginner', '-', 'friendly', 'Ġfunction', 'Ġguide', 'Ġsilver', 'Ġfinish', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ', 'Ġ', '</s>', '</s>', 'COL', 'Ġname', 'ĠVAL', 'Ġpan', 'asonic', 'Ġlum', 'ix', 'Ġd', 'mc', '-', 'fs', '3', 'Ġdigital', 'Ġcamera', 'Ġsilver', 'ĠCOL', 'Ġdescription', 'ĠVAL', 'Ġpan', 'asonic', 'Ġd', 'mc', '-', 'fs', '3', 's', 'Ġ8', 'Ġmeg', 'apixel', 'Ġcompact', 'Ġdigital', 'Ġcamera', 'Ġwith', 'Ġ33', 'mm', 'Ġlens', 'Ġ,', 'Ġ3', 'x', 'Ġoptical', 'Ġzoom', 'Ġ,', 'Ġintelligent', 'Ġauto', 'Ġmode', 'Ġand', 'Ġ2', '.', '5', "Ġ'", 'Ġdiagonal', 'Ġintelligent', 'Ġl', 'cd', 'Ġsilver', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ137', '.', '33', 'Ġ', '</s>']
is_heads: [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
y: 0
tags: 0
mask: tensor([1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1])
seqlen: 186
task_name: Textual/Abt-Buy
=======================
step: 0, task: Textual/Abt-Buy, loss: 0.0065471455454826355
step: 10, task: Textual/Abt-Buy, loss: 0.000210687518119812
step: 20, task: Textual/Abt-Buy, loss: 0.10453234612941742
step: 30, task: Textual/Abt-Buy, loss: 0.003939971327781677
step: 40, task: Textual/Abt-Buy, loss: 0.04264402389526367
step: 50, task: Textual/Abt-Buy, loss: 8.928775787353516e-05
step: 60, task: Textual/Abt-Buy, loss: 0.0010578632354736328
step: 70, task: Textual/Abt-Buy, loss: 8.074939250946045e-05
step: 80, task: Textual/Abt-Buy, loss: 0.007275432348251343
step: 90, task: Textual/Abt-Buy, loss: 0.000235825777053833
step: 100, task: Textual/Abt-Buy, loss: 0.0003068596124649048
step: 110, task: Textual/Abt-Buy, loss: 8.559226989746094e-05
step: 120, task: Textual/Abt-Buy, loss: 0.0001882314682006836
step: 130, task: Textual/Abt-Buy, loss: 0.00011646747589111328
step: 140, task: Textual/Abt-Buy, loss: 0.00013296306133270264
step: 150, task: Textual/Abt-Buy, loss: 0.07825540006160736
step: 160, task: Textual/Abt-Buy, loss: 0.09551826864480972
step: 170, task: Textual/Abt-Buy, loss: 8.635222911834717e-05
step: 180, task: Textual/Abt-Buy, loss: 0.00032426416873931885
step: 190, task: Textual/Abt-Buy, loss: 6.252527236938477e-05
step: 200, task: Textual/Abt-Buy, loss: 0.00021627545356750488
step: 210, task: Textual/Abt-Buy, loss: 0.007703229784965515
step: 220, task: Textual/Abt-Buy, loss: 0.00012958049774169922
step: 230, task: Textual/Abt-Buy, loss: 0.00943494588136673
step: 240, task: Textual/Abt-Buy, loss: 0.001785874366760254
step: 250, task: Textual/Abt-Buy, loss: 0.19087593257427216
step: 260, task: Textual/Abt-Buy, loss: 8.210539817810059e-05
step: 270, task: Textual/Abt-Buy, loss: 0.0014465302228927612
step: 280, task: Textual/Abt-Buy, loss: 0.0003253519535064697
step: 290, task: Textual/Abt-Buy, loss: 0.024228766560554504
step: 300, task: Textual/Abt-Buy, loss: 8.146464824676514e-05
step: 310, task: Textual/Abt-Buy, loss: 9.116530418395996e-05
step: 320, task: Textual/Abt-Buy, loss: 6.467103958129883e-05
step: 330, task: Textual/Abt-Buy, loss: 0.0001548975706100464
step: 340, task: Textual/Abt-Buy, loss: 0.03382881358265877
step: 350, task: Textual/Abt-Buy, loss: 0.010152287781238556
=========eval at epoch=7=========
Validation:
=============Textual/Abt-Buy==================
accuracy=0.934
precision=0.934
recall=0.413
f1=0.572
======================================
Test:
=============Textual/Abt-Buy==================
accuracy=0.944
precision=0.938
recall=0.515
f1=0.665
======================================
=====sanity check======
words: COL name VAL panasonic black dect 6.0 cordless telephone kxtg9333t COL description VAL panasonic black dect 6.0 cordless telephone kxtg9333t 1 base and 2 handsets extended talk time reduced interference all-digital answering system up to 17 hours of talk time expandable up to 6 handsets up to 3-way conference capability built-in clock with alarm digital speakerphone on handset black finish COL price VAL   [SEP] COL name VAL panasonic kx-tg4321b 5.8 ghz expandable digital cordless phone COL description VAL 1 x phone line ( s ) black COL price VAL  
x: [    0 18047   766 27445  5730 38703   909   263  3894   231     4   288
 13051  1672  7377   449 11483   571   466 25631    90 14857  8194 27445
  5730 38703   909   263  3894   231     4   288 13051  1672  7377   449
 11483   571   466 25631    90   112  1542     8   132  1420  2580  3112
  1067    86  2906  8149    70    12 29563 15635   467    62     7   601
   722     9  1067    86  3003   868    62     7   231  1420  2580    62
     7   155    12  1970  1019  9388  1490    12   179  6700    19  8054
  1778  5385 17283    15 17621   909  2073 14857   425 27445  1437  1437
     2     2 18047   766 27445  5730 38703   449  1178    12 42698  3897
  2146   428   195     4   398 34648   329  3003   868  1778 13051  1672
  1028 14857  8194 27445   112  3023  1028   516    36   579  4839   909
 14857   425 27445  1437  1437     2]
tokens: ['<s>', 'COL', 'Ġname', 'ĠVAL', 'Ġpan', 'asonic', 'Ġblack', 'Ġde', 'ct', 'Ġ6', '.', '0', 'Ġcord', 'less', 'Ġtelephone', 'Ġk', 'xt', 'g', '9', '333', 't', 'ĠCOL', 'Ġdescription', 'ĠVAL', 'Ġpan', 'asonic', 'Ġblack', 'Ġde', 'ct', 'Ġ6', '.', '0', 'Ġcord', 'less', 'Ġtelephone', 'Ġk', 'xt', 'g', '9', '333', 't', 'Ġ1', 'Ġbase', 'Ġand', 'Ġ2', 'Ġhands', 'ets', 'Ġextended', 'Ġtalk', 'Ġtime', 'Ġreduced', 'Ġinterference', 'Ġall', '-', 'digital', 'Ġanswering', 'Ġsystem', 'Ġup', 'Ġto', 'Ġ17', 'Ġhours', 'Ġof', 'Ġtalk', 'Ġtime', 'Ġexpand', 'able', 'Ġup', 'Ġto', 'Ġ6', 'Ġhands', 'ets', 'Ġup', 'Ġto', 'Ġ3', '-', 'way', 'Ġconference', 'Ġcapability', 'Ġbuilt', '-', 'in', 'Ġclock', 'Ġwith', 'Ġalarm', 'Ġdigital', 'Ġspeaker', 'phone', 'Ġon', 'Ġhandset', 'Ġblack', 'Ġfinish', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ', 'Ġ', '</s>', '</s>', 'COL', 'Ġname', 'ĠVAL', 'Ġpan', 'asonic', 'Ġk', 'x', '-', 'tg', '43', '21', 'b', 'Ġ5', '.', '8', 'Ġgh', 'z', 'Ġexpand', 'able', 'Ġdigital', 'Ġcord', 'less', 'Ġphone', 'ĠCOL', 'Ġdescription', 'ĠVAL', 'Ġ1', 'Ġx', 'Ġphone', 'Ġline', 'Ġ(', 'Ġs', 'Ġ)', 'Ġblack', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ', 'Ġ', '</s>']
is_heads: [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
y: 0
tags: 0
mask: tensor([1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1])
seqlen: 138
task_name: Textual/Abt-Buy
=======================
step: 0, task: Textual/Abt-Buy, loss: 0.021734479814767838
step: 10, task: Textual/Abt-Buy, loss: 0.000359952449798584
step: 20, task: Textual/Abt-Buy, loss: 0.00011005997657775879
step: 30, task: Textual/Abt-Buy, loss: 0.00862615555524826
step: 40, task: Textual/Abt-Buy, loss: 8.07344913482666e-05
step: 50, task: Textual/Abt-Buy, loss: 4.354119300842285e-05
step: 60, task: Textual/Abt-Buy, loss: 0.006385877728462219
step: 70, task: Textual/Abt-Buy, loss: 6.432831287384033e-05
step: 80, task: Textual/Abt-Buy, loss: 0.00816192477941513
step: 90, task: Textual/Abt-Buy, loss: 0.00015267729759216309
step: 100, task: Textual/Abt-Buy, loss: 4.795193672180176e-05
step: 110, task: Textual/Abt-Buy, loss: 3.775954246520996e-05
step: 120, task: Textual/Abt-Buy, loss: 5.373358726501465e-05
step: 130, task: Textual/Abt-Buy, loss: 7.684528827667236e-05
step: 140, task: Textual/Abt-Buy, loss: 0.004274383187294006
step: 150, task: Textual/Abt-Buy, loss: 9.059906005859375e-05
step: 160, task: Textual/Abt-Buy, loss: 0.00010511279106140137
step: 170, task: Textual/Abt-Buy, loss: 7.85142183303833e-05
step: 180, task: Textual/Abt-Buy, loss: 0.0009189695119857788
step: 190, task: Textual/Abt-Buy, loss: 0.00016355514526367188
step: 200, task: Textual/Abt-Buy, loss: 0.0011398941278457642
step: 210, task: Textual/Abt-Buy, loss: 5.257129669189453e-05
step: 220, task: Textual/Abt-Buy, loss: 0.0037493258714675903
step: 230, task: Textual/Abt-Buy, loss: 0.00011597573757171631
step: 240, task: Textual/Abt-Buy, loss: 0.00011089444160461426
step: 250, task: Textual/Abt-Buy, loss: 0.00027567148208618164
step: 260, task: Textual/Abt-Buy, loss: 4.240870475769043e-05
step: 270, task: Textual/Abt-Buy, loss: 0.002973422408103943
step: 280, task: Textual/Abt-Buy, loss: 0.005143985152244568
step: 290, task: Textual/Abt-Buy, loss: 0.00018471479415893555
step: 300, task: Textual/Abt-Buy, loss: 0.00022995471954345703
step: 310, task: Textual/Abt-Buy, loss: 0.00035534799098968506
step: 320, task: Textual/Abt-Buy, loss: 0.0004352480173110962
step: 330, task: Textual/Abt-Buy, loss: 0.0003159046173095703
step: 340, task: Textual/Abt-Buy, loss: 6.817281246185303e-05
step: 350, task: Textual/Abt-Buy, loss: 3.224611282348633e-05
=========eval at epoch=8=========
Validation:
=============Textual/Abt-Buy==================
accuracy=0.931
precision=0.951
recall=0.379
f1=0.542
======================================
Test:
=============Textual/Abt-Buy==================
accuracy=0.937
precision=0.957
recall=0.432
f1=0.595
======================================
Selected optimization level O2:  FP16 training with FP32 batchnorm and FP32 master weights.

Defaults for this optimization level are:
enabled                : True
opt_level              : O2
cast_model_type        : torch.float16
patch_torch_functions  : False
keep_batchnorm_fp32    : True
master_weights         : True
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O2
cast_model_type        : torch.float16
patch_torch_functions  : False
keep_batchnorm_fp32    : True
master_weights         : True
loss_scale             : dynamic
Warning:  multi_tensor_applier fused unscale kernel is unavailable, possibly because apex was installed without --cuda_ext --cpp_ext. Using Python fallback.  Original ImportError was: ModuleNotFoundError("No module named 'amp_C'")
Gradient overflow.  Skipping step, loss scaler 0 reducing loss scale to 32768.0
=====sanity check======
words: COL name VAL panasonic dect 6.0 black metallic expandable digital cordless phone system kxtg9332t COL description VAL panasonic dect 6.0 black metallic expandable digital cordless phone system kxtg9332t 2 handsets up to 6 multi-handset capability digital answering machine system ringer id call waiting caller id voicemail hold mute clock alarm led lighting night mode call block speakerphone 11 days standby 5 hours talk time black metallic finish COL price VAL   [SEP] COL name VAL panasonic kx-tg9348t expandable digital cordless phone COL description VAL 1 x phone line ( s ) metallic black COL price VAL  
x: [    0 18047   766 27445  5730 38703   263  3894   231     4   288   909
 24117  3003   868  1778 13051  1672  1028   467   449 11483   571   466
 33911    90 14857  8194 27445  5730 38703   263  3894   231     4   288
   909 24117  3003   868  1778 13051  1672  1028   467   449 11483   571
   466 33911    90   132  1420  2580    62     7   231  3228    12 34055
   594  9388  1778 15635  3563   467   910  6082 13561   486  2445 17017
 13561 30118 10555   946 33758  6700  8054   669  7526   363  5745   486
  1803  5385 17283   365   360 28611   195   722  1067    86   909 24117
  2073 14857   425 27445  1437  1437     2     2 18047   766 27445  5730
 38703   449  1178    12 42698   466 27765    90  3003   868  1778 13051
  1672  1028 14857  8194 27445   112  3023  1028   516    36   579  4839
 24117   909 14857   425 27445  1437  1437     2]
tokens: ['<s>', 'COL', 'Ġname', 'ĠVAL', 'Ġpan', 'asonic', 'Ġde', 'ct', 'Ġ6', '.', '0', 'Ġblack', 'Ġmetallic', 'Ġexpand', 'able', 'Ġdigital', 'Ġcord', 'less', 'Ġphone', 'Ġsystem', 'Ġk', 'xt', 'g', '9', '332', 't', 'ĠCOL', 'Ġdescription', 'ĠVAL', 'Ġpan', 'asonic', 'Ġde', 'ct', 'Ġ6', '.', '0', 'Ġblack', 'Ġmetallic', 'Ġexpand', 'able', 'Ġdigital', 'Ġcord', 'less', 'Ġphone', 'Ġsystem', 'Ġk', 'xt', 'g', '9', '332', 't', 'Ġ2', 'Ġhands', 'ets', 'Ġup', 'Ġto', 'Ġ6', 'Ġmulti', '-', 'hands', 'et', 'Ġcapability', 'Ġdigital', 'Ġanswering', 'Ġmachine', 'Ġsystem', 'Ġr', 'inger', 'Ġid', 'Ġcall', 'Ġwaiting', 'Ġcaller', 'Ġid', 'Ġvoic', 'email', 'Ġhold', 'Ġmute', 'Ġclock', 'Ġalarm', 'Ġled', 'Ġlighting', 'Ġnight', 'Ġmode', 'Ġcall', 'Ġblock', 'Ġspeaker', 'phone', 'Ġ11', 'Ġdays', 'Ġstandby', 'Ġ5', 'Ġhours', 'Ġtalk', 'Ġtime', 'Ġblack', 'Ġmetallic', 'Ġfinish', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ', 'Ġ', '</s>', '</s>', 'COL', 'Ġname', 'ĠVAL', 'Ġpan', 'asonic', 'Ġk', 'x', '-', 'tg', '9', '348', 't', 'Ġexpand', 'able', 'Ġdigital', 'Ġcord', 'less', 'Ġphone', 'ĠCOL', 'Ġdescription', 'ĠVAL', 'Ġ1', 'Ġx', 'Ġphone', 'Ġline', 'Ġ(', 'Ġs', 'Ġ)', 'Ġmetallic', 'Ġblack', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ', 'Ġ', '</s>']
is_heads: [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
y: 0
tags: 0
mask: tensor([1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1])
seqlen: 140
task_name: Textual/Abt-Buy
=======================
step: 0, task: Textual/Abt-Buy, loss: 1.0306388139724731
Gradient overflow.  Skipping step, loss scaler 0 reducing loss scale to 16384.0
Gradient overflow.  Skipping step, loss scaler 0 reducing loss scale to 8192.0
Gradient overflow.  Skipping step, loss scaler 0 reducing loss scale to 4096.0
step: 10, task: Textual/Abt-Buy, loss: 0.9002381563186646
step: 20, task: Textual/Abt-Buy, loss: 1.0936915874481201
step: 30, task: Textual/Abt-Buy, loss: 0.8709698915481567
step: 40, task: Textual/Abt-Buy, loss: 0.40183302760124207
step: 50, task: Textual/Abt-Buy, loss: 0.41446158289909363
step: 60, task: Textual/Abt-Buy, loss: 0.6705043315887451
step: 70, task: Textual/Abt-Buy, loss: 0.4774283766746521
step: 80, task: Textual/Abt-Buy, loss: 0.21472173929214478
step: 90, task: Textual/Abt-Buy, loss: 0.2601601481437683
step: 100, task: Textual/Abt-Buy, loss: 0.4228988289833069
step: 110, task: Textual/Abt-Buy, loss: 0.3402100205421448
step: 120, task: Textual/Abt-Buy, loss: 0.23765404522418976
step: 130, task: Textual/Abt-Buy, loss: 0.17711719870567322
step: 140, task: Textual/Abt-Buy, loss: 0.5571547150611877
step: 150, task: Textual/Abt-Buy, loss: 0.6058441996574402
step: 160, task: Textual/Abt-Buy, loss: 0.22405759990215302
step: 170, task: Textual/Abt-Buy, loss: 0.11100911349058151
step: 180, task: Textual/Abt-Buy, loss: 0.4433002173900604
step: 190, task: Textual/Abt-Buy, loss: 0.22038623690605164
step: 200, task: Textual/Abt-Buy, loss: 0.4066643714904785
step: 210, task: Textual/Abt-Buy, loss: 0.3628213405609131
step: 220, task: Textual/Abt-Buy, loss: 0.09144029021263123
step: 230, task: Textual/Abt-Buy, loss: 0.333097904920578
step: 240, task: Textual/Abt-Buy, loss: 0.33048877120018005
step: 250, task: Textual/Abt-Buy, loss: 0.2374628484249115
step: 260, task: Textual/Abt-Buy, loss: 0.39833012223243713
step: 270, task: Textual/Abt-Buy, loss: 0.6849160194396973
step: 280, task: Textual/Abt-Buy, loss: 0.950535237789154
step: 290, task: Textual/Abt-Buy, loss: 0.1770249605178833
step: 300, task: Textual/Abt-Buy, loss: 0.5301392078399658
step: 310, task: Textual/Abt-Buy, loss: 0.39350593090057373
step: 320, task: Textual/Abt-Buy, loss: 0.4952213764190674
step: 330, task: Textual/Abt-Buy, loss: 0.26888081431388855
step: 340, task: Textual/Abt-Buy, loss: 0.2105853259563446
step: 350, task: Textual/Abt-Buy, loss: 0.49667686223983765
=========eval at epoch=1=========
Validation:
=============Textual/Abt-Buy==================
accuracy=0.892
precision=0.000
recall=0.000
f1=0.000
======================================
Test:
=============Textual/Abt-Buy==================
accuracy=0.892
precision=0.000
recall=0.000
f1=0.000
======================================
/w/246/tianyu2020/miniconda2/envs/ditto/lib/python3.7/site-packages/apex/amp/_initialize.py:24: UserWarning: An input tensor was not cuda.
  warnings.warn("An input tensor was not cuda.")
/w/246/tianyu2020/miniconda2/envs/ditto/lib/python3.7/site-packages/torch/optim/lr_scheduler.py:122: UserWarning: Detected call of `lr_scheduler.step()` before `optimizer.step()`. In PyTorch 1.1.0 and later, you should call them in the opposite order: `optimizer.step()` before `lr_scheduler.step()`.  Failure to do this will result in PyTorch skipping the first value of the learning rate schedule. See more details at https://pytorch.org/docs/stable/optim.html#how-to-adjust-learning-rate
  "https://pytorch.org/docs/stable/optim.html#how-to-adjust-learning-rate", UserWarning)
/w/246/tianyu2020/miniconda2/envs/ditto/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1221: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
=====sanity check======
words: COL name VAL linksys wireless-g broadband router wrt54gl COL description VAL linksys wireless-g broadband router wrt54gl all-in-one internet-sharing router 4-port switch push button setup feature tkip and aes encryption wireless mac address filtering powerful spi firewall 54mbps wireless-g ( 802.11 g ) access point COL price VAL 79.0  [SEP] COL name VAL linksys g wireless-g wet54g wireless bridge COL description VAL 54mbps 1 x 10/100base-tx COL price VAL  
x: [    0 18047   766 27445  5678  2459  6955    12   571 11451 30577 14902
    90  4283  7210 14857  8194 27445  5678  2459  6955    12   571 11451
 30577 14902    90  4283  7210    70    12   179    12  1264  2888    12
 12828 30577   204    12  3427  5405  1920  6148 11808  1905   326   330
  1588     8    10   293 23061  6955 13418  1100 35060  2247  2292   118
 38956  4431  6648  3275  6955    12   571    36 31551     4  1225   821
  4839   899   477 14857   425 27445  7589     4   288  1437     2     2
 18047   766 27445  5678  2459   821  6955    12   571  7727  4283   571
  6955  4081 14857  8194 27445  4431  6648  3275   112  3023   158    73
  1866 11070    12 43820 14857   425 27445  1437  1437     2]
tokens: ['<s>', 'COL', 'Ġname', 'ĠVAL', 'Ġlinks', 'ys', 'Ġwireless', '-', 'g', 'Ġbroadband', 'Ġrouter', 'Ġwr', 't', '54', 'gl', 'ĠCOL', 'Ġdescription', 'ĠVAL', 'Ġlinks', 'ys', 'Ġwireless', '-', 'g', 'Ġbroadband', 'Ġrouter', 'Ġwr', 't', '54', 'gl', 'Ġall', '-', 'in', '-', 'one', 'Ġinternet', '-', 'sharing', 'Ġrouter', 'Ġ4', '-', 'port', 'Ġswitch', 'Ġpush', 'Ġbutton', 'Ġsetup', 'Ġfeature', 'Ġt', 'k', 'ip', 'Ġand', 'Ġa', 'es', 'Ġencryption', 'Ġwireless', 'Ġmac', 'Ġaddress', 'Ġfiltering', 'Ġpowerful', 'Ġsp', 'i', 'Ġfirewall', 'Ġ54', 'mb', 'ps', 'Ġwireless', '-', 'g', 'Ġ(', 'Ġ802', '.', '11', 'Ġg', 'Ġ)', 'Ġaccess', 'Ġpoint', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ79', '.', '0', 'Ġ', '</s>', '</s>', 'COL', 'Ġname', 'ĠVAL', 'Ġlinks', 'ys', 'Ġg', 'Ġwireless', '-', 'g', 'Ġwet', '54', 'g', 'Ġwireless', 'Ġbridge', 'ĠCOL', 'Ġdescription', 'ĠVAL', 'Ġ54', 'mb', 'ps', 'Ġ1', 'Ġx', 'Ġ10', '/', '100', 'base', '-', 'tx', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ', 'Ġ', '</s>']
is_heads: [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
y: 0
tags: 0
mask: tensor([1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1])
seqlen: 118
task_name: Textual/Abt-Buy
=======================
step: 0, task: Textual/Abt-Buy, loss: 0.25795140862464905
step: 10, task: Textual/Abt-Buy, loss: 0.663791835308075
step: 20, task: Textual/Abt-Buy, loss: 0.2789332866668701
step: 30, task: Textual/Abt-Buy, loss: 0.06447160989046097
step: 40, task: Textual/Abt-Buy, loss: 0.3776925504207611
step: 50, task: Textual/Abt-Buy, loss: 0.37140125036239624
step: 60, task: Textual/Abt-Buy, loss: 0.3715001940727234
step: 70, task: Textual/Abt-Buy, loss: 0.43009451031684875
step: 80, task: Textual/Abt-Buy, loss: 0.24571964144706726
step: 90, task: Textual/Abt-Buy, loss: 0.0500296875834465
step: 100, task: Textual/Abt-Buy, loss: 0.3277856111526489
step: 110, task: Textual/Abt-Buy, loss: 0.21495702862739563
step: 120, task: Textual/Abt-Buy, loss: 0.4190802574157715
step: 130, task: Textual/Abt-Buy, loss: 0.8586123585700989
step: 140, task: Textual/Abt-Buy, loss: 0.24591019749641418
step: 150, task: Textual/Abt-Buy, loss: 0.7966870069503784
step: 160, task: Textual/Abt-Buy, loss: 0.33543312549591064
step: 170, task: Textual/Abt-Buy, loss: 0.3227928876876831
step: 180, task: Textual/Abt-Buy, loss: 0.6850665807723999
step: 190, task: Textual/Abt-Buy, loss: 0.25004154443740845
step: 200, task: Textual/Abt-Buy, loss: 0.033921658992767334
step: 210, task: Textual/Abt-Buy, loss: 0.031993672251701355
step: 220, task: Textual/Abt-Buy, loss: 0.15249410271644592
step: 230, task: Textual/Abt-Buy, loss: 0.1932324916124344
step: 240, task: Textual/Abt-Buy, loss: 0.08407362550497055
step: 250, task: Textual/Abt-Buy, loss: 0.13540855050086975
step: 260, task: Textual/Abt-Buy, loss: 0.6252655386924744
step: 270, task: Textual/Abt-Buy, loss: 0.3105393052101135
step: 280, task: Textual/Abt-Buy, loss: 0.1476294994354248
step: 290, task: Textual/Abt-Buy, loss: 0.059473056346178055
step: 300, task: Textual/Abt-Buy, loss: 0.13906154036521912
step: 310, task: Textual/Abt-Buy, loss: 0.5197510719299316
step: 320, task: Textual/Abt-Buy, loss: 0.03034476935863495
step: 330, task: Textual/Abt-Buy, loss: 0.236955463886261
step: 340, task: Textual/Abt-Buy, loss: 0.18891116976737976
step: 350, task: Textual/Abt-Buy, loss: 0.050634585320949554
=========eval at epoch=1=========
Validation:
=============Textual/Abt-Buy==================
accuracy=0.910
precision=0.586
recall=0.563
f1=0.574
======================================
Test:
=============Textual/Abt-Buy==================
accuracy=0.933
precision=0.697
recall=0.660
f1=0.678
======================================
=====sanity check======
words: COL name VAL olympus ds40 digital voice recorder ds40r COL description VAL olympus ds40 digital voice recorder ds40r 136 hours 15 minutes recording time in lp mode high-sensitivity detachable stereo microphone voice guidance three modes of microphone sensitivity built-in variable control voice actuator ( vcva ) function up to 32 hours of continuous operation COL price VAL 149.0  [SEP] COL name VAL panasonic palmcorder sdr-h40 digital camcorder COL description VAL panasonic sdr-h40 40gb hard disk drive/sd hybrid camcorder with 42x optical zoom , optical image stabilization , one-touch dvd copy , and anti-shock shield COL price VAL 328.88 
x: [    0 18047   766 27445  1021 31434   687   385    29  1749  1778  2236
 32017   385    29  1749   338 14857  8194 27445  1021 31434   687   385
    29  1749  1778  2236 32017   385    29  1749   338 23272   722   379
   728  5492    86    11   784   642  5745   239    12    29 40275  6769
 32885 31436 18896  2236  3824   130 19180     9 18896 15608  1490    12
   179 15594   797  2236 31129  2630    36   748   438  3952  4839  5043
    62     7  2107   722     9 11152  2513 14857   425 27445 24621     4
   288  1437     2     2 18047   766 27445  5730 38703 14262   438 10337
   579 10232    12   298  1749  1778 11021   438 10337 14857  8194 27445
  5730 38703   579 10232    12   298  1749   843 19562   543 21675  1305
    73 28045  9284 11021   438 10337    19  3330  1178 17547 21762  2156
 17547  2274 29632  2156    65    12 26673   385 40311  5375  2156     8
  1475    12 37316 15978 14857   425 27445 37428     4  4652  1437     2]
tokens: ['<s>', 'COL', 'Ġname', 'ĠVAL', 'Ġo', 'lymp', 'us', 'Ġd', 's', '40', 'Ġdigital', 'Ġvoice', 'Ġrecorder', 'Ġd', 's', '40', 'r', 'ĠCOL', 'Ġdescription', 'ĠVAL', 'Ġo', 'lymp', 'us', 'Ġd', 's', '40', 'Ġdigital', 'Ġvoice', 'Ġrecorder', 'Ġd', 's', '40', 'r', 'Ġ136', 'Ġhours', 'Ġ15', 'Ġminutes', 'Ġrecording', 'Ġtime', 'Ġin', 'Ġl', 'p', 'Ġmode', 'Ġhigh', '-', 's', 'ensitivity', 'Ġdet', 'achable', 'Ġstereo', 'Ġmicrophone', 'Ġvoice', 'Ġguidance', 'Ġthree', 'Ġmodes', 'Ġof', 'Ġmicrophone', 'Ġsensitivity', 'Ġbuilt', '-', 'in', 'Ġvariable', 'Ġcontrol', 'Ġvoice', 'Ġactu', 'ator', 'Ġ(', 'Ġv', 'c', 'va', 'Ġ)', 'Ġfunction', 'Ġup', 'Ġto', 'Ġ32', 'Ġhours', 'Ġof', 'Ġcontinuous', 'Ġoperation', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ149', '.', '0', 'Ġ', '</s>', '</s>', 'COL', 'Ġname', 'ĠVAL', 'Ġpan', 'asonic', 'Ġpalm', 'c', 'order', 'Ġs', 'dr', '-', 'h', '40', 'Ġdigital', 'Ġcam', 'c', 'order', 'ĠCOL', 'Ġdescription', 'ĠVAL', 'Ġpan', 'asonic', 'Ġs', 'dr', '-', 'h', '40', 'Ġ40', 'gb', 'Ġhard', 'Ġdisk', 'Ġdrive', '/', 'sd', 'Ġhybrid', 'Ġcam', 'c', 'order', 'Ġwith', 'Ġ42', 'x', 'Ġoptical', 'Ġzoom', 'Ġ,', 'Ġoptical', 'Ġimage', 'Ġstabilization', 'Ġ,', 'Ġone', '-', 'touch', 'Ġd', 'vd', 'Ġcopy', 'Ġ,', 'Ġand', 'Ġanti', '-', 'shock', 'Ġshield', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ328', '.', '88', 'Ġ', '</s>']
is_heads: [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
y: 0
tags: 0
mask: tensor([1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1])
seqlen: 156
task_name: Textual/Abt-Buy
=======================
step: 0, task: Textual/Abt-Buy, loss: 0.09352196007966995
step: 10, task: Textual/Abt-Buy, loss: 0.2936142683029175
step: 20, task: Textual/Abt-Buy, loss: 0.014403872191905975
step: 30, task: Textual/Abt-Buy, loss: 0.02668435126543045
step: 40, task: Textual/Abt-Buy, loss: 0.03653616085648537
step: 50, task: Textual/Abt-Buy, loss: 0.4446340799331665
step: 60, task: Textual/Abt-Buy, loss: 0.07531604170799255
step: 70, task: Textual/Abt-Buy, loss: 0.19193649291992188
step: 80, task: Textual/Abt-Buy, loss: 0.03335432708263397
step: 90, task: Textual/Abt-Buy, loss: 0.33243703842163086
step: 100, task: Textual/Abt-Buy, loss: 0.2183481752872467
step: 110, task: Textual/Abt-Buy, loss: 0.10543227940797806
step: 120, task: Textual/Abt-Buy, loss: 0.013536281883716583
step: 130, task: Textual/Abt-Buy, loss: 0.18837876617908478
step: 140, task: Textual/Abt-Buy, loss: 0.016997352242469788
step: 150, task: Textual/Abt-Buy, loss: 0.15975618362426758
step: 160, task: Textual/Abt-Buy, loss: 0.0925116166472435
step: 170, task: Textual/Abt-Buy, loss: 0.09292225539684296
step: 180, task: Textual/Abt-Buy, loss: 0.006074361503124237
step: 190, task: Textual/Abt-Buy, loss: 0.04189663752913475
step: 200, task: Textual/Abt-Buy, loss: 0.16256242990493774
step: 210, task: Textual/Abt-Buy, loss: 0.09300186485052109
step: 220, task: Textual/Abt-Buy, loss: 0.13504216074943542
step: 230, task: Textual/Abt-Buy, loss: 0.03973320126533508
step: 240, task: Textual/Abt-Buy, loss: 0.02774488553404808
step: 250, task: Textual/Abt-Buy, loss: 0.3795672059059143
step: 260, task: Textual/Abt-Buy, loss: 0.1727525144815445
step: 270, task: Textual/Abt-Buy, loss: 0.07286590337753296
step: 280, task: Textual/Abt-Buy, loss: 0.004654303193092346
step: 290, task: Textual/Abt-Buy, loss: 0.08586999028921127
step: 300, task: Textual/Abt-Buy, loss: 0.10383061319589615
step: 310, task: Textual/Abt-Buy, loss: 0.02248232066631317
step: 320, task: Textual/Abt-Buy, loss: 0.09765021502971649
step: 330, task: Textual/Abt-Buy, loss: 0.5603184103965759
step: 340, task: Textual/Abt-Buy, loss: 0.07949981838464737
step: 350, task: Textual/Abt-Buy, loss: 0.07048952579498291
=========eval at epoch=2=========
Validation:
=============Textual/Abt-Buy==================
accuracy=0.932
precision=0.760
recall=0.539
f1=0.631
======================================
Test:
=============Textual/Abt-Buy==================
accuracy=0.929
precision=0.730
recall=0.539
f1=0.620
======================================
=====sanity check======
words: COL name VAL plantronics . audio 920 bluetooth headset audio920 COL description VAL plantronics . audio 920 bluetooth headset audio920 switch between mobile phone & pc multipoint technology skype ready noise canceling microphone wind screen 100 % plug & play dark grey finish COL price VAL   [SEP] COL name VAL plantronics . audio 920 wireless earset 78592-01 COL description VAL plantronics 920 . audio digital usb pc headset COL price VAL  
x: [    0 18047   766 27445  2195 23016   479  6086 37543 42034 44969 20084
  6086 29099 14857  8194 27445  2195 23016   479  6086 37543 42034 44969
 20084  6086 29099  5405   227  1830  1028   359 46213 35675 15494   806
  2972 37356  1227  6496 21338  1527 18896  2508  2441   727  7606 10242
   359   310  2933 10521  2073 14857   425 27445  1437  1437     2     2
 18047   766 27445  2195 23016   479  6086 37543  6955 12137   594  7004
 39642    12  2663 14857  8194 27445  2195 23016 37543   479  6086  1778
 49030 46213 20084 14857   425 27445  1437  1437     2]
tokens: ['<s>', 'COL', 'Ġname', 'ĠVAL', 'Ġplant', 'ronics', 'Ġ.', 'Ġaudio', 'Ġ920', 'Ġblu', 'etooth', 'Ġheadset', 'Ġaudio', '920', 'ĠCOL', 'Ġdescription', 'ĠVAL', 'Ġplant', 'ronics', 'Ġ.', 'Ġaudio', 'Ġ920', 'Ġblu', 'etooth', 'Ġheadset', 'Ġaudio', '920', 'Ġswitch', 'Ġbetween', 'Ġmobile', 'Ġphone', 'Ġ&', 'Ġpc', 'Ġmultip', 'oint', 'Ġtechnology', 'Ġsk', 'ype', 'Ġready', 'Ġnoise', 'Ġcance', 'ling', 'Ġmicrophone', 'Ġwind', 'Ġscreen', 'Ġ100', 'Ġ%', 'Ġplug', 'Ġ&', 'Ġplay', 'Ġdark', 'Ġgrey', 'Ġfinish', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ', 'Ġ', '</s>', '</s>', 'COL', 'Ġname', 'ĠVAL', 'Ġplant', 'ronics', 'Ġ.', 'Ġaudio', 'Ġ920', 'Ġwireless', 'Ġears', 'et', 'Ġ78', '592', '-', '01', 'ĠCOL', 'Ġdescription', 'ĠVAL', 'Ġplant', 'ronics', 'Ġ920', 'Ġ.', 'Ġaudio', 'Ġdigital', 'Ġusb', 'Ġpc', 'Ġheadset', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ', 'Ġ', '</s>']
is_heads: [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
y: 1
tags: 1
mask: tensor([1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1])
seqlen: 93
task_name: Textual/Abt-Buy
=======================
step: 0, task: Textual/Abt-Buy, loss: 0.02139115333557129
step: 10, task: Textual/Abt-Buy, loss: 0.12981955707073212
step: 20, task: Textual/Abt-Buy, loss: 0.0008322596549987793
step: 30, task: Textual/Abt-Buy, loss: 0.040986068546772
step: 40, task: Textual/Abt-Buy, loss: 0.02126409113407135
step: 50, task: Textual/Abt-Buy, loss: 0.001581817865371704
step: 60, task: Textual/Abt-Buy, loss: 0.006091028451919556
step: 70, task: Textual/Abt-Buy, loss: 0.0030974000692367554
step: 80, task: Textual/Abt-Buy, loss: 0.25391027331352234
step: 90, task: Textual/Abt-Buy, loss: 0.016636423766613007
step: 100, task: Textual/Abt-Buy, loss: 0.010013043880462646
step: 110, task: Textual/Abt-Buy, loss: 0.0022062361240386963
step: 120, task: Textual/Abt-Buy, loss: 0.013509407639503479
step: 130, task: Textual/Abt-Buy, loss: 0.0034172236919403076
step: 140, task: Textual/Abt-Buy, loss: 0.02786390483379364
step: 150, task: Textual/Abt-Buy, loss: 0.037582069635391235
step: 160, task: Textual/Abt-Buy, loss: 0.3664081394672394
step: 170, task: Textual/Abt-Buy, loss: 0.11852831393480301
step: 180, task: Textual/Abt-Buy, loss: 0.051522985100746155
step: 190, task: Textual/Abt-Buy, loss: 0.0029800310730934143
step: 200, task: Textual/Abt-Buy, loss: 0.13583220541477203
step: 210, task: Textual/Abt-Buy, loss: 0.004369601607322693
step: 220, task: Textual/Abt-Buy, loss: 0.0032939910888671875
step: 230, task: Textual/Abt-Buy, loss: 0.17413564026355743
step: 240, task: Textual/Abt-Buy, loss: 0.026943154633045197
step: 250, task: Textual/Abt-Buy, loss: 0.004814617335796356
step: 260, task: Textual/Abt-Buy, loss: 0.12007664144039154
step: 270, task: Textual/Abt-Buy, loss: 0.012110333889722824
step: 280, task: Textual/Abt-Buy, loss: 0.0016982853412628174
step: 290, task: Textual/Abt-Buy, loss: 0.12847022712230682
step: 300, task: Textual/Abt-Buy, loss: 0.007725872099399567
step: 310, task: Textual/Abt-Buy, loss: 0.021774321794509888
step: 320, task: Textual/Abt-Buy, loss: 0.18209795653820038
step: 330, task: Textual/Abt-Buy, loss: 0.021439656615257263
step: 340, task: Textual/Abt-Buy, loss: 0.15414731204509735
step: 350, task: Textual/Abt-Buy, loss: 0.0030369609594345093
=========eval at epoch=3=========
Validation:
=============Textual/Abt-Buy==================
accuracy=0.931
precision=0.910
recall=0.393
f1=0.549
======================================
Test:
=============Textual/Abt-Buy==================
accuracy=0.932
precision=0.941
recall=0.388
f1=0.550
======================================
=====sanity check======
words: COL name VAL sony weather shower cd clock radio icfcd73w COL description VAL sony weather shower cd clock radio icfcd73w am/fm/weather band splash resistant 5 direct access buttons shuttle dial operation lcd display digital clock hanging strap COL price VAL   [SEP] COL name VAL sony icf-s79w weather band digital shower radio icfs79w COL description VAL  COL price VAL 42.0 
x: [    0 18047   766 27445   579  6119  1650  9310 45584  6700  3188 41591
   506 28690  5352   605 14857  8194 27445   579  6119  1650  9310 45584
  6700  3188 41591   506 28690  5352   605   524    73 40523    73 21693
  1971 17158 19152   195  2228   899 14893 19463 11481  2513   784 28690
  2332  1778  6700  7209 26123 14857   425 27445  1437  1437     2     2
 18047   766 27445   579  6119 41591   506    12    29  5220   605  1650
  1971  1778  9310  3188 41591 17884  5220   605 14857  8194 27445  1437
 14857   425 27445  3330     4   288  1437     2]
tokens: ['<s>', 'COL', 'Ġname', 'ĠVAL', 'Ġs', 'ony', 'Ġweather', 'Ġshower', 'Ġcd', 'Ġclock', 'Ġradio', 'Ġic', 'f', 'cd', '73', 'w', 'ĠCOL', 'Ġdescription', 'ĠVAL', 'Ġs', 'ony', 'Ġweather', 'Ġshower', 'Ġcd', 'Ġclock', 'Ġradio', 'Ġic', 'f', 'cd', '73', 'w', 'Ġam', '/', 'fm', '/', 'weather', 'Ġband', 'Ġsplash', 'Ġresistant', 'Ġ5', 'Ġdirect', 'Ġaccess', 'Ġbuttons', 'Ġshuttle', 'Ġdial', 'Ġoperation', 'Ġl', 'cd', 'Ġdisplay', 'Ġdigital', 'Ġclock', 'Ġhanging', 'Ġstrap', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ', 'Ġ', '</s>', '</s>', 'COL', 'Ġname', 'ĠVAL', 'Ġs', 'ony', 'Ġic', 'f', '-', 's', '79', 'w', 'Ġweather', 'Ġband', 'Ġdigital', 'Ġshower', 'Ġradio', 'Ġic', 'fs', '79', 'w', 'ĠCOL', 'Ġdescription', 'ĠVAL', 'Ġ', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ42', '.', '0', 'Ġ', '</s>']
is_heads: [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
y: 0
tags: 0
mask: tensor([1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1])
seqlen: 92
task_name: Textual/Abt-Buy
=======================
step: 0, task: Textual/Abt-Buy, loss: 0.023085035383701324
step: 10, task: Textual/Abt-Buy, loss: 0.007569104433059692
step: 20, task: Textual/Abt-Buy, loss: 0.01656419038772583
step: 30, task: Textual/Abt-Buy, loss: 0.013689719140529633
step: 40, task: Textual/Abt-Buy, loss: 0.32154685258865356
step: 50, task: Textual/Abt-Buy, loss: 0.001986488699913025
step: 60, task: Textual/Abt-Buy, loss: 0.0019315928220748901
step: 70, task: Textual/Abt-Buy, loss: 0.18751010298728943
step: 80, task: Textual/Abt-Buy, loss: 0.12548016011714935
step: 90, task: Textual/Abt-Buy, loss: 0.014536090195178986
step: 100, task: Textual/Abt-Buy, loss: 0.03726685419678688
step: 110, task: Textual/Abt-Buy, loss: 0.0016259700059890747
step: 120, task: Textual/Abt-Buy, loss: 0.005797028541564941
step: 130, task: Textual/Abt-Buy, loss: 0.016631528735160828
step: 140, task: Textual/Abt-Buy, loss: 0.026547588407993317
step: 150, task: Textual/Abt-Buy, loss: 0.004144139587879181
step: 160, task: Textual/Abt-Buy, loss: 0.0006676316261291504
step: 170, task: Textual/Abt-Buy, loss: 0.01740717887878418
step: 180, task: Textual/Abt-Buy, loss: 0.007090993225574493
step: 190, task: Textual/Abt-Buy, loss: 0.0003537982702255249
step: 200, task: Textual/Abt-Buy, loss: 0.0010460913181304932
step: 210, task: Textual/Abt-Buy, loss: 0.005543939769268036
step: 220, task: Textual/Abt-Buy, loss: 0.2253790944814682
step: 230, task: Textual/Abt-Buy, loss: 0.0005068331956863403
step: 240, task: Textual/Abt-Buy, loss: 0.24696342647075653
step: 250, task: Textual/Abt-Buy, loss: 0.0269269198179245
step: 260, task: Textual/Abt-Buy, loss: 0.04565785452723503
step: 270, task: Textual/Abt-Buy, loss: 0.008514761924743652
step: 280, task: Textual/Abt-Buy, loss: 0.002072751522064209
step: 290, task: Textual/Abt-Buy, loss: 0.0022594183683395386
step: 300, task: Textual/Abt-Buy, loss: 0.0005389302968978882
step: 310, task: Textual/Abt-Buy, loss: 0.09281738102436066
step: 320, task: Textual/Abt-Buy, loss: 0.02187810093164444
step: 330, task: Textual/Abt-Buy, loss: 0.0004366189241409302
step: 340, task: Textual/Abt-Buy, loss: 0.04870007932186127
step: 350, task: Textual/Abt-Buy, loss: 0.0017137527465820312
=========eval at epoch=4=========
Validation:
=============Textual/Abt-Buy==================
accuracy=0.933
precision=0.835
recall=0.466
f1=0.598
======================================
Test:
=============Textual/Abt-Buy==================
accuracy=0.938
precision=0.922
recall=0.461
f1=0.615
======================================
=====sanity check======
words: COL name VAL panasonic kx-tga820b black dect 6.0 cordless handset kxtga820b COL description VAL panasonic kx-tga820b black dect 6.0 cordless handset kxtga820b compatible with dect kx-tg8231 / 8232 series phone systems dect 6.0 technology answering system with compatible base unit call waiting caller id join in/privacy full color backlit lcd display black finish COL price VAL   [SEP] COL name VAL panasonic kx-tg1032s dual handset digital cordless phone COL description VAL 1 x phone line ( s ) headset jack silver COL price VAL 61.14 
x: [    0 18047   766 27445  5730 38703   449  1178    12    90  2538 34212
   428   909   263  3894   231     4   288 13051  1672 17621   449 11483
  2538 34212   428 14857  8194 27445  5730 38703   449  1178    12    90
  2538 34212   428   909   263  3894   231     4   288 13051  1672 17621
   449 11483  2538 34212   428 16632    19   263  3894   449  1178    12
 42698   398 29949  1589   290 28503   651  1028  1743   263  3894   231
     4   288   806 15635   467    19 16632  1542  1933   486  2445 17017
 13561  1962    11    73 25943  5073   455  3195   124 13534   784 28690
  2332   909  2073 14857   425 27445  1437  1437     2     2 18047   766
 27445  5730 38703   449  1178    12 42698   698  2881    29  6594 17621
  1778 13051  1672  1028 14857  8194 27445   112  3023  1028   516    36
   579  4839 20084 10267  4334 14857   425 27445  5659     4  1570  1437
     2]
tokens: ['<s>', 'COL', 'Ġname', 'ĠVAL', 'Ġpan', 'asonic', 'Ġk', 'x', '-', 't', 'ga', '820', 'b', 'Ġblack', 'Ġde', 'ct', 'Ġ6', '.', '0', 'Ġcord', 'less', 'Ġhandset', 'Ġk', 'xt', 'ga', '820', 'b', 'ĠCOL', 'Ġdescription', 'ĠVAL', 'Ġpan', 'asonic', 'Ġk', 'x', '-', 't', 'ga', '820', 'b', 'Ġblack', 'Ġde', 'ct', 'Ġ6', '.', '0', 'Ġcord', 'less', 'Ġhandset', 'Ġk', 'xt', 'ga', '820', 'b', 'Ġcompatible', 'Ġwith', 'Ġde', 'ct', 'Ġk', 'x', '-', 'tg', '8', '231', 'Ġ/', 'Ġ8', '232', 'Ġseries', 'Ġphone', 'Ġsystems', 'Ġde', 'ct', 'Ġ6', '.', '0', 'Ġtechnology', 'Ġanswering', 'Ġsystem', 'Ġwith', 'Ġcompatible', 'Ġbase', 'Ġunit', 'Ġcall', 'Ġwaiting', 'Ġcaller', 'Ġid', 'Ġjoin', 'Ġin', '/', 'priv', 'acy', 'Ġfull', 'Ġcolor', 'Ġback', 'lit', 'Ġl', 'cd', 'Ġdisplay', 'Ġblack', 'Ġfinish', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ', 'Ġ', '</s>', '</s>', 'COL', 'Ġname', 'ĠVAL', 'Ġpan', 'asonic', 'Ġk', 'x', '-', 'tg', '10', '32', 's', 'Ġdual', 'Ġhandset', 'Ġdigital', 'Ġcord', 'less', 'Ġphone', 'ĠCOL', 'Ġdescription', 'ĠVAL', 'Ġ1', 'Ġx', 'Ġphone', 'Ġline', 'Ġ(', 'Ġs', 'Ġ)', 'Ġheadset', 'Ġjack', 'Ġsilver', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ61', '.', '14', 'Ġ', '</s>']
is_heads: [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
y: 0
tags: 0
mask: tensor([1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1])
seqlen: 145
task_name: Textual/Abt-Buy
=======================
step: 0, task: Textual/Abt-Buy, loss: 0.0012563914060592651
step: 10, task: Textual/Abt-Buy, loss: 0.0021095573902130127
step: 20, task: Textual/Abt-Buy, loss: 0.015969470143318176
step: 30, task: Textual/Abt-Buy, loss: 0.007114537060260773
step: 40, task: Textual/Abt-Buy, loss: 0.12232118844985962
step: 50, task: Textual/Abt-Buy, loss: 0.008717700839042664
step: 60, task: Textual/Abt-Buy, loss: 0.00040827691555023193
step: 70, task: Textual/Abt-Buy, loss: 0.0003136098384857178
step: 80, task: Textual/Abt-Buy, loss: 0.0004555433988571167
step: 90, task: Textual/Abt-Buy, loss: 0.09107863903045654
step: 100, task: Textual/Abt-Buy, loss: 0.000428810715675354
step: 110, task: Textual/Abt-Buy, loss: 0.00017462670803070068
step: 120, task: Textual/Abt-Buy, loss: 0.00074043869972229
step: 130, task: Textual/Abt-Buy, loss: 0.006796777248382568
step: 140, task: Textual/Abt-Buy, loss: 0.0012907534837722778
step: 150, task: Textual/Abt-Buy, loss: 0.10109002888202667
step: 160, task: Textual/Abt-Buy, loss: 0.00016412138938903809
step: 170, task: Textual/Abt-Buy, loss: 0.0022862255573272705
step: 180, task: Textual/Abt-Buy, loss: 0.00023160874843597412
step: 190, task: Textual/Abt-Buy, loss: 0.0021043866872787476
step: 200, task: Textual/Abt-Buy, loss: 0.05398895591497421
step: 210, task: Textual/Abt-Buy, loss: 0.00017745792865753174
step: 220, task: Textual/Abt-Buy, loss: 0.00032626092433929443
step: 230, task: Textual/Abt-Buy, loss: 0.0005609989166259766
step: 240, task: Textual/Abt-Buy, loss: 0.00035877525806427
step: 250, task: Textual/Abt-Buy, loss: 0.005761846899986267
step: 260, task: Textual/Abt-Buy, loss: 0.0002432316541671753
step: 270, task: Textual/Abt-Buy, loss: 0.0006888806819915771
step: 280, task: Textual/Abt-Buy, loss: 0.006621725857257843
step: 290, task: Textual/Abt-Buy, loss: 0.039622265845537186
step: 300, task: Textual/Abt-Buy, loss: 0.0013682842254638672
step: 310, task: Textual/Abt-Buy, loss: 0.00019124150276184082
step: 320, task: Textual/Abt-Buy, loss: 0.01550651341676712
step: 330, task: Textual/Abt-Buy, loss: 0.02105201780796051
step: 340, task: Textual/Abt-Buy, loss: 0.0001933276653289795
step: 350, task: Textual/Abt-Buy, loss: 0.0003624260425567627
=========eval at epoch=5=========
Validation:
=============Textual/Abt-Buy==================
accuracy=0.924
precision=0.800
recall=0.388
f1=0.523
======================================
Test:
=============Textual/Abt-Buy==================
accuracy=0.932
precision=0.826
recall=0.461
f1=0.592
======================================
=====sanity check======
words: COL name VAL sony 60gb high definition hard disk drive handycam camcorder hdrsr11 COL description VAL sony 60gb high definition hard disk drive handycam camcorder hdrsr11 1920x1080 recording face detection 5 megapixel clearvid cmos sensor bionz image processor exmor imaging sensor 12x optical/150x digital zoom 3.2 ' wide ( 16:9 ) hybrid touch panel clear photo lcd plus display dolby digital 5.1 ch recording dynamic range optimizer super nightshot infrared system x.v. color technology COL price VAL   [SEP] COL name VAL sony handycam hdr-sr12 high definition digital camcorder hdrsr12 COL description VAL 16:9 3.2 ' color lcd COL price VAL 869.0 
x: [    0 18047   766 27445   579  6119  1191 19562   239  8515   543 21675
  1305 14732 16767 11021   438 10337  1368   417  4926   338  1225 14857
  8194 27445   579  6119  1191 19562   239  8515   543 21675  1305 14732
 16767 11021   438 10337  1368   417  4926   338  1225 18283  1178 41305
  5492   652 12673   195 10721 21424   699 21157 25434   366  9626   741
  1499   329  2274 10655  1931 15188 16508  9626   316  1178 17547    73
  6115  1178  1778 21762   155     4   176   128  1810    36   545    35
   466  4839  9284  2842  2798   699  1345   784 28690  2704  2332   385
  1168  1409  1778   195     4   134  1855  5492  6878  1186 17775  6315
  2422   363 10393 30175   467  3023     4   705     4  3195   806 14857
   425 27445  1437  1437     2     2 18047   766 27445   579  6119 14732
 16767  1368 10232    12 37959  1092   239  8515  1778 11021   438 10337
  1368   417  4926   338  1092 14857  8194 27445   545    35   466   155
     4   176   128  3195   784 28690 14857   425 27445   290  4563     4
   288  1437     2]
tokens: ['<s>', 'COL', 'Ġname', 'ĠVAL', 'Ġs', 'ony', 'Ġ60', 'gb', 'Ġhigh', 'Ġdefinition', 'Ġhard', 'Ġdisk', 'Ġdrive', 'Ġhandy', 'cam', 'Ġcam', 'c', 'order', 'Ġh', 'd', 'rs', 'r', '11', 'ĠCOL', 'Ġdescription', 'ĠVAL', 'Ġs', 'ony', 'Ġ60', 'gb', 'Ġhigh', 'Ġdefinition', 'Ġhard', 'Ġdisk', 'Ġdrive', 'Ġhandy', 'cam', 'Ġcam', 'c', 'order', 'Ġh', 'd', 'rs', 'r', '11', 'Ġ1920', 'x', '1080', 'Ġrecording', 'Ġface', 'Ġdetection', 'Ġ5', 'Ġmeg', 'apixel', 'Ġclear', 'vid', 'Ġcm', 'os', 'Ġsensor', 'Ġb', 'ion', 'z', 'Ġimage', 'Ġprocessor', 'Ġex', 'mor', 'Ġimaging', 'Ġsensor', 'Ġ12', 'x', 'Ġoptical', '/', '150', 'x', 'Ġdigital', 'Ġzoom', 'Ġ3', '.', '2', "Ġ'", 'Ġwide', 'Ġ(', 'Ġ16', ':', '9', 'Ġ)', 'Ġhybrid', 'Ġtouch', 'Ġpanel', 'Ġclear', 'Ġphoto', 'Ġl', 'cd', 'Ġplus', 'Ġdisplay', 'Ġd', 'ol', 'by', 'Ġdigital', 'Ġ5', '.', '1', 'Ġch', 'Ġrecording', 'Ġdynamic', 'Ġrange', 'Ġoptim', 'izer', 'Ġsuper', 'Ġnight', 'shot', 'Ġinfrared', 'Ġsystem', 'Ġx', '.', 'v', '.', 'Ġcolor', 'Ġtechnology', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ', 'Ġ', '</s>', '</s>', 'COL', 'Ġname', 'ĠVAL', 'Ġs', 'ony', 'Ġhandy', 'cam', 'Ġh', 'dr', '-', 'sr', '12', 'Ġhigh', 'Ġdefinition', 'Ġdigital', 'Ġcam', 'c', 'order', 'Ġh', 'd', 'rs', 'r', '12', 'ĠCOL', 'Ġdescription', 'ĠVAL', 'Ġ16', ':', '9', 'Ġ3', '.', '2', "Ġ'", 'Ġcolor', 'Ġl', 'cd', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ8', '69', '.', '0', 'Ġ', '</s>']
is_heads: [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
y: 0
tags: 0
mask: tensor([1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1])
seqlen: 171
task_name: Textual/Abt-Buy
=======================
step: 0, task: Textual/Abt-Buy, loss: 0.0013439953327178955
step: 10, task: Textual/Abt-Buy, loss: 0.008897699415683746
step: 20, task: Textual/Abt-Buy, loss: 0.0011765658855438232
step: 30, task: Textual/Abt-Buy, loss: 0.0004391521215438843
step: 40, task: Textual/Abt-Buy, loss: 0.00021252036094665527
step: 50, task: Textual/Abt-Buy, loss: 0.10717272013425827
step: 60, task: Textual/Abt-Buy, loss: 0.0017260313034057617
step: 70, task: Textual/Abt-Buy, loss: 0.0172543004155159
step: 80, task: Textual/Abt-Buy, loss: 0.006415516138076782
step: 90, task: Textual/Abt-Buy, loss: 0.004219472408294678
step: 100, task: Textual/Abt-Buy, loss: 0.0006033331155776978
step: 110, task: Textual/Abt-Buy, loss: 0.0001932084560394287
step: 120, task: Textual/Abt-Buy, loss: 0.005770057439804077
step: 130, task: Textual/Abt-Buy, loss: 0.0003302246332168579
step: 140, task: Textual/Abt-Buy, loss: 0.000171661376953125
step: 150, task: Textual/Abt-Buy, loss: 0.003611236810684204
step: 160, task: Textual/Abt-Buy, loss: 0.00043676793575286865
step: 170, task: Textual/Abt-Buy, loss: 0.0003397315740585327
step: 180, task: Textual/Abt-Buy, loss: 0.004211857914924622
step: 190, task: Textual/Abt-Buy, loss: 0.0005437284708023071
step: 200, task: Textual/Abt-Buy, loss: 0.0006297677755355835
step: 210, task: Textual/Abt-Buy, loss: 0.00010943412780761719
step: 220, task: Textual/Abt-Buy, loss: 0.00674360990524292
step: 230, task: Textual/Abt-Buy, loss: 0.0022364258766174316
step: 240, task: Textual/Abt-Buy, loss: 0.07512509822845459
step: 250, task: Textual/Abt-Buy, loss: 0.0023926347494125366
step: 260, task: Textual/Abt-Buy, loss: 0.00012199580669403076
step: 270, task: Textual/Abt-Buy, loss: 0.0044503286480903625
step: 280, task: Textual/Abt-Buy, loss: 0.00018291175365447998
step: 290, task: Textual/Abt-Buy, loss: 0.0035140812397003174
step: 300, task: Textual/Abt-Buy, loss: 0.0009164512157440186
step: 310, task: Textual/Abt-Buy, loss: 0.023757480084896088
step: 320, task: Textual/Abt-Buy, loss: 0.0042337775230407715
step: 330, task: Textual/Abt-Buy, loss: 0.004398897290229797
step: 340, task: Textual/Abt-Buy, loss: 0.057591333985328674
step: 350, task: Textual/Abt-Buy, loss: 0.012281082570552826
=========eval at epoch=6=========
Validation:
=============Textual/Abt-Buy==================
accuracy=0.931
precision=0.735
recall=0.553
f1=0.632
======================================
Test:
=============Textual/Abt-Buy==================
accuracy=0.943
precision=0.784
recall=0.650
f1=0.711
======================================
=====sanity check======
words: COL name VAL sony 40gb high definition hard disk drive handycam camcorder hdrsr10 COL description VAL sony 40gb high definition hard disk drive handycam camcorder hdrsr10 1920 x 1080 recording face detection 2.3 megapixel clearvid cmos sensor bionz image processor exmor imaging sensor 15x optical/180x digital zoom 2.7 ' wide ( 16:9 ) hybrid touch panel clear photo lcd plus display dolby digital 5.1 ch recording dynamic range optimizer super nightshot infrared system x.v. color technology COL price VAL   [SEP] COL name VAL sony handycam dcr-sr45 digital camcorder dcrsr45 COL description VAL 16:9 2.7 ' hybrid lcd COL price VAL 304.99 
x: [    0 18047   766 27445   579  6119   843 19562   239  8515   543 21675
  1305 14732 16767 11021   438 10337  1368   417  4926   338   698 14857
  8194 27445   579  6119   843 19562   239  8515   543 21675  1305 14732
 16767 11021   438 10337  1368   417  4926   338   698 18283  3023 21083
  5492   652 12673   132     4   246 10721 21424   699 21157 25434   366
  9626   741  1499   329  2274 10655  1931 15188 16508  9626   379  1178
 17547    73 14515  1178  1778 21762   132     4   406   128  1810    36
   545    35   466  4839  9284  2842  2798   699  1345   784 28690  2704
  2332   385  1168  1409  1778   195     4   134  1855  5492  6878  1186
 17775  6315  2422   363 10393 30175   467  3023     4   705     4  3195
   806 14857   425 27445  1437  1437     2     2 18047   766 27445   579
  6119 14732 16767   385  8344    12 37959  1898  1778 11021   438 10337
 46773  4926   338  1898 14857  8194 27445   545    35   466   132     4
   406   128  9284   784 28690 14857   425 27445 33121     4  2831  1437
     2]
tokens: ['<s>', 'COL', 'Ġname', 'ĠVAL', 'Ġs', 'ony', 'Ġ40', 'gb', 'Ġhigh', 'Ġdefinition', 'Ġhard', 'Ġdisk', 'Ġdrive', 'Ġhandy', 'cam', 'Ġcam', 'c', 'order', 'Ġh', 'd', 'rs', 'r', '10', 'ĠCOL', 'Ġdescription', 'ĠVAL', 'Ġs', 'ony', 'Ġ40', 'gb', 'Ġhigh', 'Ġdefinition', 'Ġhard', 'Ġdisk', 'Ġdrive', 'Ġhandy', 'cam', 'Ġcam', 'c', 'order', 'Ġh', 'd', 'rs', 'r', '10', 'Ġ1920', 'Ġx', 'Ġ1080', 'Ġrecording', 'Ġface', 'Ġdetection', 'Ġ2', '.', '3', 'Ġmeg', 'apixel', 'Ġclear', 'vid', 'Ġcm', 'os', 'Ġsensor', 'Ġb', 'ion', 'z', 'Ġimage', 'Ġprocessor', 'Ġex', 'mor', 'Ġimaging', 'Ġsensor', 'Ġ15', 'x', 'Ġoptical', '/', '180', 'x', 'Ġdigital', 'Ġzoom', 'Ġ2', '.', '7', "Ġ'", 'Ġwide', 'Ġ(', 'Ġ16', ':', '9', 'Ġ)', 'Ġhybrid', 'Ġtouch', 'Ġpanel', 'Ġclear', 'Ġphoto', 'Ġl', 'cd', 'Ġplus', 'Ġdisplay', 'Ġd', 'ol', 'by', 'Ġdigital', 'Ġ5', '.', '1', 'Ġch', 'Ġrecording', 'Ġdynamic', 'Ġrange', 'Ġoptim', 'izer', 'Ġsuper', 'Ġnight', 'shot', 'Ġinfrared', 'Ġsystem', 'Ġx', '.', 'v', '.', 'Ġcolor', 'Ġtechnology', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ', 'Ġ', '</s>', '</s>', 'COL', 'Ġname', 'ĠVAL', 'Ġs', 'ony', 'Ġhandy', 'cam', 'Ġd', 'cr', '-', 'sr', '45', 'Ġdigital', 'Ġcam', 'c', 'order', 'Ġdc', 'rs', 'r', '45', 'ĠCOL', 'Ġdescription', 'ĠVAL', 'Ġ16', ':', '9', 'Ġ2', '.', '7', "Ġ'", 'Ġhybrid', 'Ġl', 'cd', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ304', '.', '99', 'Ġ', '</s>']
is_heads: [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
y: 0
tags: 0
mask: tensor([1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1])
seqlen: 169
task_name: Textual/Abt-Buy
=======================
step: 0, task: Textual/Abt-Buy, loss: 0.08450591564178467
step: 10, task: Textual/Abt-Buy, loss: 0.0006252527236938477
step: 20, task: Textual/Abt-Buy, loss: 0.00047466158866882324
step: 30, task: Textual/Abt-Buy, loss: 0.013578474521636963
step: 40, task: Textual/Abt-Buy, loss: 0.040786609053611755
step: 50, task: Textual/Abt-Buy, loss: 0.005941517651081085
step: 60, task: Textual/Abt-Buy, loss: 0.03348180279135704
step: 70, task: Textual/Abt-Buy, loss: 0.0005631893873214722
step: 80, task: Textual/Abt-Buy, loss: 0.00021833181381225586
step: 90, task: Textual/Abt-Buy, loss: 0.0001560598611831665
step: 100, task: Textual/Abt-Buy, loss: 0.0002906620502471924
Gradient overflow.  Skipping step, loss scaler 0 reducing loss scale to 4096.0
step: 110, task: Textual/Abt-Buy, loss: 0.002466157078742981
step: 120, task: Textual/Abt-Buy, loss: 0.00029212236404418945
step: 130, task: Textual/Abt-Buy, loss: 0.07645324617624283
step: 140, task: Textual/Abt-Buy, loss: 0.00015109777450561523
step: 150, task: Textual/Abt-Buy, loss: 0.01985396444797516
step: 160, task: Textual/Abt-Buy, loss: 0.0017823055386543274
step: 170, task: Textual/Abt-Buy, loss: 0.0020929276943206787
step: 180, task: Textual/Abt-Buy, loss: 0.0002743154764175415
step: 190, task: Textual/Abt-Buy, loss: 0.0001347959041595459
step: 200, task: Textual/Abt-Buy, loss: 0.03565773367881775
step: 210, task: Textual/Abt-Buy, loss: 0.01493401825428009
step: 220, task: Textual/Abt-Buy, loss: 0.00022430717945098877
step: 230, task: Textual/Abt-Buy, loss: 0.09632986783981323
step: 240, task: Textual/Abt-Buy, loss: 0.088568776845932
step: 250, task: Textual/Abt-Buy, loss: 0.000508725643157959
step: 260, task: Textual/Abt-Buy, loss: 0.0006982386112213135
step: 270, task: Textual/Abt-Buy, loss: 0.00016005337238311768
step: 280, task: Textual/Abt-Buy, loss: 0.00016614794731140137
step: 290, task: Textual/Abt-Buy, loss: 0.000333636999130249
step: 300, task: Textual/Abt-Buy, loss: 0.01916491985321045
step: 310, task: Textual/Abt-Buy, loss: 0.014674387872219086
step: 320, task: Textual/Abt-Buy, loss: 0.0002649277448654175
step: 330, task: Textual/Abt-Buy, loss: 0.0023361071944236755
step: 340, task: Textual/Abt-Buy, loss: 0.0007106661796569824
step: 350, task: Textual/Abt-Buy, loss: 0.0002368539571762085
=========eval at epoch=7=========
Validation:
=============Textual/Abt-Buy==================
accuracy=0.940
precision=0.858
recall=0.529
f1=0.655
======================================
Test:
=============Textual/Abt-Buy==================
accuracy=0.939
precision=0.836
recall=0.544
f1=0.659
======================================
=====sanity check======
words: COL name VAL cuisinart stainless steel 4-quart programmable slow cooker psc400 COL description VAL cuisinart stainless steel 4-quart programmable slow cooker psc400 24-hour programmable cook time digital countdown timer three cooking modes touchpad control panel with lcd timed display dishwasher-safe removable ceramic cooking pot nonslip rubber feet stainless steel finish COL price VAL   [SEP] COL name VAL cuisinart psc-400 cuisinart programmable slow cooker psc400 COL description VAL  COL price VAL 79.95 
x: [    0 18047   766 27445  3729 29761  2013 23486  3689   204    12 45252
   586 35128  2635 35572   181  3866  4017 14857  8194 27445  3729 29761
  2013 23486  3689   204    12 45252   586 35128  2635 35572   181  3866
  4017   706    12  4509   586 35128  7142    86  1778 28907 35809   130
  6836 19180  2842 19320   797  2798    19   784 28690 25335  2332  8847
 34475    12 22725 37680 28238  6836  4728 43423 33330 11283  1730 23486
  3689  2073 14857   425 27445  1437  1437     2     2 18047   766 27445
  3729 29761  2013   181  3866    12  4017  3729 29761  2013   586 35128
  2635 35572   181  3866  4017 14857  8194 27445  1437 14857   425 27445
  7589     4  4015  1437     2]
tokens: ['<s>', 'COL', 'Ġname', 'ĠVAL', 'Ġcu', 'isin', 'art', 'Ġstainless', 'Ġsteel', 'Ġ4', '-', 'quart', 'Ġprogram', 'mable', 'Ġslow', 'Ġcooker', 'Ġp', 'sc', '400', 'ĠCOL', 'Ġdescription', 'ĠVAL', 'Ġcu', 'isin', 'art', 'Ġstainless', 'Ġsteel', 'Ġ4', '-', 'quart', 'Ġprogram', 'mable', 'Ġslow', 'Ġcooker', 'Ġp', 'sc', '400', 'Ġ24', '-', 'hour', 'Ġprogram', 'mable', 'Ġcook', 'Ġtime', 'Ġdigital', 'Ġcountdown', 'Ġtimer', 'Ġthree', 'Ġcooking', 'Ġmodes', 'Ġtouch', 'pad', 'Ġcontrol', 'Ġpanel', 'Ġwith', 'Ġl', 'cd', 'Ġtimed', 'Ġdisplay', 'Ġdish', 'washer', '-', 'safe', 'Ġremovable', 'Ġceramic', 'Ġcooking', 'Ġpot', 'Ġnons', 'lip', 'Ġrubber', 'Ġfeet', 'Ġstainless', 'Ġsteel', 'Ġfinish', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ', 'Ġ', '</s>', '</s>', 'COL', 'Ġname', 'ĠVAL', 'Ġcu', 'isin', 'art', 'Ġp', 'sc', '-', '400', 'Ġcu', 'isin', 'art', 'Ġprogram', 'mable', 'Ġslow', 'Ġcooker', 'Ġp', 'sc', '400', 'ĠCOL', 'Ġdescription', 'ĠVAL', 'Ġ', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ79', '.', '95', 'Ġ', '</s>']
is_heads: [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
y: 1
tags: 1
mask: tensor([1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1])
seqlen: 113
task_name: Textual/Abt-Buy
=======================
step: 0, task: Textual/Abt-Buy, loss: 0.00036790966987609863
step: 10, task: Textual/Abt-Buy, loss: 0.00030750036239624023
step: 20, task: Textual/Abt-Buy, loss: 0.0001507401466369629
step: 30, task: Textual/Abt-Buy, loss: 0.0072620585560798645
step: 40, task: Textual/Abt-Buy, loss: 0.00018957257270812988
step: 50, task: Textual/Abt-Buy, loss: 0.021099001169204712
step: 60, task: Textual/Abt-Buy, loss: 0.049887657165527344
step: 70, task: Textual/Abt-Buy, loss: 0.005126088857650757
step: 80, task: Textual/Abt-Buy, loss: 0.00021761655807495117
step: 90, task: Textual/Abt-Buy, loss: 0.0011491179466247559
step: 100, task: Textual/Abt-Buy, loss: 0.0003146827220916748
step: 110, task: Textual/Abt-Buy, loss: 0.1644963175058365
step: 120, task: Textual/Abt-Buy, loss: 0.00013047456741333008
step: 130, task: Textual/Abt-Buy, loss: 0.0041832104325294495
step: 140, task: Textual/Abt-Buy, loss: 0.0037884339690208435
step: 150, task: Textual/Abt-Buy, loss: 0.00019466876983642578
step: 160, task: Textual/Abt-Buy, loss: 0.02579282969236374
step: 170, task: Textual/Abt-Buy, loss: 0.00013180077075958252
step: 180, task: Textual/Abt-Buy, loss: 0.0023733675479888916
step: 190, task: Textual/Abt-Buy, loss: 0.00010287761688232422
step: 200, task: Textual/Abt-Buy, loss: 0.0001722574234008789
step: 210, task: Textual/Abt-Buy, loss: 0.00020976364612579346
step: 220, task: Textual/Abt-Buy, loss: 0.007371440529823303
step: 230, task: Textual/Abt-Buy, loss: 0.00039623677730560303
step: 240, task: Textual/Abt-Buy, loss: 0.00020563602447509766
step: 250, task: Textual/Abt-Buy, loss: 0.0001681298017501831
step: 260, task: Textual/Abt-Buy, loss: 0.0010265558958053589
step: 270, task: Textual/Abt-Buy, loss: 0.011267684400081635
step: 280, task: Textual/Abt-Buy, loss: 0.00015322864055633545
step: 290, task: Textual/Abt-Buy, loss: 0.0006417930126190186
step: 300, task: Textual/Abt-Buy, loss: 0.00011512637138366699
step: 310, task: Textual/Abt-Buy, loss: 0.0002342015504837036
step: 320, task: Textual/Abt-Buy, loss: 0.01831965148448944
step: 330, task: Textual/Abt-Buy, loss: 0.00020803511142730713
step: 340, task: Textual/Abt-Buy, loss: 0.0007418245077133179
step: 350, task: Textual/Abt-Buy, loss: 0.00016395747661590576
=========eval at epoch=8=========
Validation:
=============Textual/Abt-Buy==================
accuracy=0.930
precision=0.800
recall=0.466
f1=0.589
======================================
Test:
=============Textual/Abt-Buy==================
accuracy=0.942
precision=0.836
recall=0.568
f1=0.676
======================================
Selected optimization level O2:  FP16 training with FP32 batchnorm and FP32 master weights.

Defaults for this optimization level are:
enabled                : True
opt_level              : O2
cast_model_type        : torch.float16
patch_torch_functions  : False
keep_batchnorm_fp32    : True
master_weights         : True
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O2
cast_model_type        : torch.float16
patch_torch_functions  : False
keep_batchnorm_fp32    : True
master_weights         : True
loss_scale             : dynamic
Warning:  multi_tensor_applier fused unscale kernel is unavailable, possibly because apex was installed without --cuda_ext --cpp_ext. Using Python fallback.  Original ImportError was: ModuleNotFoundError("No module named 'amp_C'")
Gradient overflow.  Skipping step, loss scaler 0 reducing loss scale to 32768.0
=====sanity check======
words: COL name VAL panasonic 5.8 ghz black expandable digital cordless phone system kxtg4324b COL description VAL panasonic 5.8 ghz black expandable digital cordless phone system kxtg4324b 4 handsets system digital answering machine ringer id call waiting caller id voicemail hold mute clock alarm led lighting night mode speakerphone intercom 11 days standby 5 hours talk time black finish COL price VAL   [SEP] COL name VAL panasonic kx-tga630s cordless handset COL description VAL silver pearl wall-mountable COL price VAL 28.34 
x: [    0 18047   766 27445  5730 38703   195     4   398 34648   329   909
  3003   868  1778 13051  1672  1028   467   449 11483   571  3897  1978
   428 14857  8194 27445  5730 38703   195     4   398 34648   329   909
  3003   868  1778 13051  1672  1028   467   449 11483   571  3897  1978
   428   204  1420  2580   467  1778 15635  3563   910  6082 13561   486
  2445 17017 13561 30118 10555   946 33758  6700  8054   669  7526   363
  5745  5385 17283  3222   175   365   360 28611   195   722  1067    86
   909  2073 14857   425 27445  1437  1437     2     2 18047   766 27445
  5730 38703   449  1178    12    90  2538 31181    29 13051  1672 17621
 14857  8194 27445  4334 36679  2204    12 17336   868 14857   425 27445
   971     4  3079  1437     2]
tokens: ['<s>', 'COL', 'Ġname', 'ĠVAL', 'Ġpan', 'asonic', 'Ġ5', '.', '8', 'Ġgh', 'z', 'Ġblack', 'Ġexpand', 'able', 'Ġdigital', 'Ġcord', 'less', 'Ġphone', 'Ġsystem', 'Ġk', 'xt', 'g', '43', '24', 'b', 'ĠCOL', 'Ġdescription', 'ĠVAL', 'Ġpan', 'asonic', 'Ġ5', '.', '8', 'Ġgh', 'z', 'Ġblack', 'Ġexpand', 'able', 'Ġdigital', 'Ġcord', 'less', 'Ġphone', 'Ġsystem', 'Ġk', 'xt', 'g', '43', '24', 'b', 'Ġ4', 'Ġhands', 'ets', 'Ġsystem', 'Ġdigital', 'Ġanswering', 'Ġmachine', 'Ġr', 'inger', 'Ġid', 'Ġcall', 'Ġwaiting', 'Ġcaller', 'Ġid', 'Ġvoic', 'email', 'Ġhold', 'Ġmute', 'Ġclock', 'Ġalarm', 'Ġled', 'Ġlighting', 'Ġnight', 'Ġmode', 'Ġspeaker', 'phone', 'Ġinter', 'com', 'Ġ11', 'Ġdays', 'Ġstandby', 'Ġ5', 'Ġhours', 'Ġtalk', 'Ġtime', 'Ġblack', 'Ġfinish', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ', 'Ġ', '</s>', '</s>', 'COL', 'Ġname', 'ĠVAL', 'Ġpan', 'asonic', 'Ġk', 'x', '-', 't', 'ga', '630', 's', 'Ġcord', 'less', 'Ġhandset', 'ĠCOL', 'Ġdescription', 'ĠVAL', 'Ġsilver', 'Ġpearl', 'Ġwall', '-', 'mount', 'able', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ28', '.', '34', 'Ġ', '</s>']
is_heads: [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
y: 0
tags: 0
mask: tensor([1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1])
seqlen: 125
task_name: Textual/Abt-Buy
=======================
step: 0, task: Textual/Abt-Buy, loss: 0.6934669613838196
Gradient overflow.  Skipping step, loss scaler 0 reducing loss scale to 16384.0
Gradient overflow.  Skipping step, loss scaler 0 reducing loss scale to 8192.0
step: 10, task: Textual/Abt-Buy, loss: 0.6799559593200684
step: 20, task: Textual/Abt-Buy, loss: 0.629260778427124
step: 30, task: Textual/Abt-Buy, loss: 0.5526345372200012
step: 40, task: Textual/Abt-Buy, loss: 0.22791747748851776
step: 50, task: Textual/Abt-Buy, loss: 0.6540402770042419
step: 60, task: Textual/Abt-Buy, loss: 0.3074057996273041
step: 70, task: Textual/Abt-Buy, loss: 0.4202519953250885
step: 80, task: Textual/Abt-Buy, loss: 0.12555301189422607
step: 90, task: Textual/Abt-Buy, loss: 0.21736666560173035
step: 100, task: Textual/Abt-Buy, loss: 0.4886762201786041
step: 110, task: Textual/Abt-Buy, loss: 0.27834492921829224
step: 120, task: Textual/Abt-Buy, loss: 0.4113031327724457
step: 130, task: Textual/Abt-Buy, loss: 0.641787052154541
step: 140, task: Textual/Abt-Buy, loss: 0.12222329527139664
step: 150, task: Textual/Abt-Buy, loss: 0.49892759323120117
step: 160, task: Textual/Abt-Buy, loss: 0.5985102653503418
step: 170, task: Textual/Abt-Buy, loss: 0.3266482353210449
step: 180, task: Textual/Abt-Buy, loss: 0.137766033411026
step: 190, task: Textual/Abt-Buy, loss: 0.48424476385116577
step: 200, task: Textual/Abt-Buy, loss: 0.6645947098731995
step: 210, task: Textual/Abt-Buy, loss: 0.26149752736091614
step: 220, task: Textual/Abt-Buy, loss: 0.23833811283111572
step: 230, task: Textual/Abt-Buy, loss: 0.613969087600708
step: 240, task: Textual/Abt-Buy, loss: 0.6350122690200806
step: 250, task: Textual/Abt-Buy, loss: 0.2304072380065918
step: 260, task: Textual/Abt-Buy, loss: 0.50199955701828
step: 270, task: Textual/Abt-Buy, loss: 0.24321123957633972
step: 280, task: Textual/Abt-Buy, loss: 0.05573950707912445
step: 290, task: Textual/Abt-Buy, loss: 0.14779168367385864
step: 300, task: Textual/Abt-Buy, loss: 0.23479348421096802
step: 310, task: Textual/Abt-Buy, loss: 0.46070238947868347
step: 320, task: Textual/Abt-Buy, loss: 0.06236482411623001
step: 330, task: Textual/Abt-Buy, loss: 0.6713241338729858
step: 340, task: Textual/Abt-Buy, loss: 0.5455727577209473
step: 350, task: Textual/Abt-Buy, loss: 0.06574572622776031
=========eval at epoch=1=========
Validation:
=============Textual/Abt-Buy==================
accuracy=0.892
precision=0.000
recall=0.000
f1=0.000
======================================
Test:
=============Textual/Abt-Buy==================
accuracy=0.892
precision=0.000
recall=0.000
f1=0.000
======================================
/w/246/tianyu2020/miniconda2/envs/ditto/lib/python3.7/site-packages/apex/amp/_initialize.py:24: UserWarning: An input tensor was not cuda.
  warnings.warn("An input tensor was not cuda.")
/w/246/tianyu2020/miniconda2/envs/ditto/lib/python3.7/site-packages/torch/optim/lr_scheduler.py:122: UserWarning: Detected call of `lr_scheduler.step()` before `optimizer.step()`. In PyTorch 1.1.0 and later, you should call them in the opposite order: `optimizer.step()` before `lr_scheduler.step()`.  Failure to do this will result in PyTorch skipping the first value of the learning rate schedule. See more details at https://pytorch.org/docs/stable/optim.html#how-to-adjust-learning-rate
  "https://pytorch.org/docs/stable/optim.html#how-to-adjust-learning-rate", UserWarning)
/w/246/tianyu2020/miniconda2/envs/ditto/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1221: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
=====sanity check======
words: COL name VAL sony silver cyber-shot digital camera dscw170 COL description VAL sony silver cyber-shot digital camera dscw170 10.1 megapixels 2.7 ' lcd display 15 mb internal memory carl zeiss 5x optical zoom lens bionz real imaging processor technology 16:9 high-resolution mode 9-point auto focus automatic macro shooting high sensitivity mode burst mode face detection intelligent scene recognition mode in-camera retouching super steadyshot optical image stabilization with anti-blur solution music slideshow hdtv compatibility beginner-friendly function guide silver finish COL price VAL   [SEP] COL name VAL samsung nv30 digital camera silver ec-nv30zsba / us COL description VAL samsung nv30 8 megapixel digital camera with schneider lens , dual image stabilization , smart touch , and face detection silver COL price VAL 139.0 
x: [    0 18047   766 27445   579  6119  4334  5381    12 10393  1778  2280
   385  3866   605 16218 14857  8194 27445   579  6119  4334  5381    12
 10393  1778  2280   385  3866   605 16218   158     4   134 10721  1115
 41699   132     4   406   128   784 28690  2332   379   475   428  3425
  3783   512   462 20025  3006   195  1178 17547 21762 10373   741  1499
   329   588 16508 10655   806   545    35   466   239    12 29646  5745
   361    12  2300  4485  1056  8408 12303  1094   239 15608  5745 10084
  5745   652 12673 12038  1310  4972  5745    11    12 25092  5494 12746
   154  2422 23789  2459 10120 17547  2274 29632    19  1475    12  3662
   710  2472   930 13150  1368   417 18724 29988 37239    12  6928  5043
  4704  4334  2073 14857   425 27445  1437  1437     2     2 18047   766
 27445   579 48545   295   705   541  1778  2280  4334 20508    12 37594
   541   329    29  3178  1589   201 14857  8194 27445   579 48545   295
   705   541   290 10721 21424  1778  2280    19  8447   858  5326 10373
  2156  6594  2274 29632  2156  2793  2842  2156     8   652 12673  4334
 14857   425 27445 24404     4   288  1437     2]
tokens: ['<s>', 'COL', 'Ġname', 'ĠVAL', 'Ġs', 'ony', 'Ġsilver', 'Ġcyber', '-', 'shot', 'Ġdigital', 'Ġcamera', 'Ġd', 'sc', 'w', '170', 'ĠCOL', 'Ġdescription', 'ĠVAL', 'Ġs', 'ony', 'Ġsilver', 'Ġcyber', '-', 'shot', 'Ġdigital', 'Ġcamera', 'Ġd', 'sc', 'w', '170', 'Ġ10', '.', '1', 'Ġmeg', 'ap', 'ixels', 'Ġ2', '.', '7', "Ġ'", 'Ġl', 'cd', 'Ġdisplay', 'Ġ15', 'Ġm', 'b', 'Ġinternal', 'Ġmemory', 'Ġcar', 'l', 'Ġze', 'iss', 'Ġ5', 'x', 'Ġoptical', 'Ġzoom', 'Ġlens', 'Ġb', 'ion', 'z', 'Ġreal', 'Ġimaging', 'Ġprocessor', 'Ġtechnology', 'Ġ16', ':', '9', 'Ġhigh', '-', 'resolution', 'Ġmode', 'Ġ9', '-', 'point', 'Ġauto', 'Ġfocus', 'Ġautomatic', 'Ġmacro', 'Ġshooting', 'Ġhigh', 'Ġsensitivity', 'Ġmode', 'Ġburst', 'Ġmode', 'Ġface', 'Ġdetection', 'Ġintelligent', 'Ġscene', 'Ġrecognition', 'Ġmode', 'Ġin', '-', 'camera', 'Ġret', 'ouch', 'ing', 'Ġsuper', 'Ġstead', 'ys', 'hot', 'Ġoptical', 'Ġimage', 'Ġstabilization', 'Ġwith', 'Ġanti', '-', 'bl', 'ur', 'Ġsolution', 'Ġmusic', 'Ġslideshow', 'Ġh', 'd', 'tv', 'Ġcompatibility', 'Ġbeginner', '-', 'friendly', 'Ġfunction', 'Ġguide', 'Ġsilver', 'Ġfinish', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ', 'Ġ', '</s>', '</s>', 'COL', 'Ġname', 'ĠVAL', 'Ġs', 'amsung', 'Ġn', 'v', '30', 'Ġdigital', 'Ġcamera', 'Ġsilver', 'Ġec', '-', 'nv', '30', 'z', 's', 'ba', 'Ġ/', 'Ġus', 'ĠCOL', 'Ġdescription', 'ĠVAL', 'Ġs', 'amsung', 'Ġn', 'v', '30', 'Ġ8', 'Ġmeg', 'apixel', 'Ġdigital', 'Ġcamera', 'Ġwith', 'Ġsch', 'ne', 'ider', 'Ġlens', 'Ġ,', 'Ġdual', 'Ġimage', 'Ġstabilization', 'Ġ,', 'Ġsmart', 'Ġtouch', 'Ġ,', 'Ġand', 'Ġface', 'Ġdetection', 'Ġsilver', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ139', '.', '0', 'Ġ', '</s>']
is_heads: [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
y: 0
tags: 0
mask: tensor([1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1])
seqlen: 188
task_name: Textual/Abt-Buy
=======================
step: 0, task: Textual/Abt-Buy, loss: 0.14166085422039032
step: 10, task: Textual/Abt-Buy, loss: 0.2630271911621094
step: 20, task: Textual/Abt-Buy, loss: 0.5367502570152283
step: 30, task: Textual/Abt-Buy, loss: 0.37090617418289185
step: 40, task: Textual/Abt-Buy, loss: 0.1580927073955536
step: 50, task: Textual/Abt-Buy, loss: 0.3018723726272583
step: 60, task: Textual/Abt-Buy, loss: 0.2521999478340149
step: 70, task: Textual/Abt-Buy, loss: 0.11499031633138657
step: 80, task: Textual/Abt-Buy, loss: 0.09183139353990555
step: 90, task: Textual/Abt-Buy, loss: 0.006315022706985474
step: 100, task: Textual/Abt-Buy, loss: 0.22550150752067566
step: 110, task: Textual/Abt-Buy, loss: 0.40516602993011475
step: 120, task: Textual/Abt-Buy, loss: 0.12274585664272308
step: 130, task: Textual/Abt-Buy, loss: 0.12631748616695404
step: 140, task: Textual/Abt-Buy, loss: 0.07606636732816696
step: 150, task: Textual/Abt-Buy, loss: 0.30866920948028564
step: 160, task: Textual/Abt-Buy, loss: 0.13314330577850342
step: 170, task: Textual/Abt-Buy, loss: 0.010105699300765991
step: 180, task: Textual/Abt-Buy, loss: 0.21526998281478882
step: 190, task: Textual/Abt-Buy, loss: 0.4058694839477539
step: 200, task: Textual/Abt-Buy, loss: 0.018921658396720886
step: 210, task: Textual/Abt-Buy, loss: 0.016593940556049347
step: 220, task: Textual/Abt-Buy, loss: 0.5830954909324646
step: 230, task: Textual/Abt-Buy, loss: 0.7795278429985046
step: 240, task: Textual/Abt-Buy, loss: 0.09850915521383286
step: 250, task: Textual/Abt-Buy, loss: 0.225150927901268
step: 260, task: Textual/Abt-Buy, loss: 0.05854561924934387
step: 270, task: Textual/Abt-Buy, loss: 0.16676545143127441
step: 280, task: Textual/Abt-Buy, loss: 0.07786941528320312
step: 290, task: Textual/Abt-Buy, loss: 0.1982821226119995
step: 300, task: Textual/Abt-Buy, loss: 0.004988387227058411
step: 310, task: Textual/Abt-Buy, loss: 0.3253246545791626
step: 320, task: Textual/Abt-Buy, loss: 0.02675403654575348
step: 330, task: Textual/Abt-Buy, loss: 0.08550986647605896
step: 340, task: Textual/Abt-Buy, loss: 0.1513424515724182
step: 350, task: Textual/Abt-Buy, loss: 0.29150426387786865
=========eval at epoch=1=========
Validation:
=============Textual/Abt-Buy==================
accuracy=0.921
precision=0.781
recall=0.364
f1=0.497
======================================
Test:
=============Textual/Abt-Buy==================
accuracy=0.930
precision=0.838
recall=0.427
f1=0.566
======================================
=====sanity check======
words: COL name VAL escort passport 9500ix radar detector 9500ix COL description VAL escort passport 9500ix radar detector 9500ix pre-loaded with thousands of saftey camera locations 360 degree radar & laser protection completely undetectable to all detector scanners variable-speed radar performance gps-powered truelock filter autolearn feature speed alert crystal-clear voice alerts 80 led matrix blue display 5 levels of brightness control black finish COL price VAL 503.95  [SEP] COL name VAL escort passport 9500ix radar/laser detector COL description VAL  COL price VAL 439.99 
x: [    0 18047   766 27445 24780 12373   361  1497  3181  9535 30956   361
  1497  3181 14857  8194 27445 24780 12373   361  1497  3181  9535 30956
   361  1497  3181  1198    12 24919    19  1583     9 25277   859   219
  2280  3237 10253  3093  9535   359 13443  2591  2198 35777  9041   868
     7    70 30956 35834 15594    12  8619  9535   819   821  3275    12
 10711  2664  8129  3343 14929  7241  4104  4422  1905  2078  5439 16155
    12 18763  2236  5431  1812   669 36173  2440  2332   195  1389     9
 27406   797   909  2073 14857   425 27445 34531     4  4015  1437     2
     2 18047   766 27445 24780 12373   361  1497  3181  9535    73   462
 12425 30956 14857  8194 27445  1437 14857   425 27445   204  3416     4
  2831  1437     2]
tokens: ['<s>', 'COL', 'Ġname', 'ĠVAL', 'Ġescort', 'Ġpassport', 'Ġ9', '500', 'ix', 'Ġradar', 'Ġdetector', 'Ġ9', '500', 'ix', 'ĠCOL', 'Ġdescription', 'ĠVAL', 'Ġescort', 'Ġpassport', 'Ġ9', '500', 'ix', 'Ġradar', 'Ġdetector', 'Ġ9', '500', 'ix', 'Ġpre', '-', 'loaded', 'Ġwith', 'Ġthousands', 'Ġof', 'Ġsaf', 'te', 'y', 'Ġcamera', 'Ġlocations', 'Ġ360', 'Ġdegree', 'Ġradar', 'Ġ&', 'Ġlaser', 'Ġprotection', 'Ġcompletely', 'Ġundet', 'ect', 'able', 'Ġto', 'Ġall', 'Ġdetector', 'Ġscanners', 'Ġvariable', '-', 'speed', 'Ġradar', 'Ġperformance', 'Ġg', 'ps', '-', 'powered', 'Ġtr', 'uel', 'ock', 'Ġfilter', 'Ġaut', 'ole', 'arn', 'Ġfeature', 'Ġspeed', 'Ġalert', 'Ġcrystal', '-', 'clear', 'Ġvoice', 'Ġalerts', 'Ġ80', 'Ġled', 'Ġmatrix', 'Ġblue', 'Ġdisplay', 'Ġ5', 'Ġlevels', 'Ġof', 'Ġbrightness', 'Ġcontrol', 'Ġblack', 'Ġfinish', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ503', '.', '95', 'Ġ', '</s>', '</s>', 'COL', 'Ġname', 'ĠVAL', 'Ġescort', 'Ġpassport', 'Ġ9', '500', 'ix', 'Ġradar', '/', 'l', 'aser', 'Ġdetector', 'ĠCOL', 'Ġdescription', 'ĠVAL', 'Ġ', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ4', '39', '.', '99', 'Ġ', '</s>']
is_heads: [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
y: 1
tags: 1
mask: tensor([1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1])
seqlen: 123
task_name: Textual/Abt-Buy
=======================
step: 0, task: Textual/Abt-Buy, loss: 0.11122773587703705
step: 10, task: Textual/Abt-Buy, loss: 0.009912267327308655
step: 20, task: Textual/Abt-Buy, loss: 0.22457759082317352
step: 30, task: Textual/Abt-Buy, loss: 0.03555241972208023
step: 40, task: Textual/Abt-Buy, loss: 0.03529468923807144
step: 50, task: Textual/Abt-Buy, loss: 0.02972126007080078
step: 60, task: Textual/Abt-Buy, loss: 0.4136148691177368
step: 70, task: Textual/Abt-Buy, loss: 0.08339535444974899
step: 80, task: Textual/Abt-Buy, loss: 0.03798788785934448
step: 90, task: Textual/Abt-Buy, loss: 0.008257448673248291
step: 100, task: Textual/Abt-Buy, loss: 0.27129387855529785
step: 110, task: Textual/Abt-Buy, loss: 0.025699086487293243
step: 120, task: Textual/Abt-Buy, loss: 0.010673843324184418
step: 130, task: Textual/Abt-Buy, loss: 0.06997857987880707
step: 140, task: Textual/Abt-Buy, loss: 0.0525372251868248
step: 150, task: Textual/Abt-Buy, loss: 0.030458852648735046
step: 160, task: Textual/Abt-Buy, loss: 0.10810760408639908
step: 170, task: Textual/Abt-Buy, loss: 0.10784651339054108
step: 180, task: Textual/Abt-Buy, loss: 0.13420608639717102
step: 190, task: Textual/Abt-Buy, loss: 0.004788786172866821
step: 200, task: Textual/Abt-Buy, loss: 0.00516422837972641
step: 210, task: Textual/Abt-Buy, loss: 0.003128059208393097
step: 220, task: Textual/Abt-Buy, loss: 0.022563695907592773
step: 230, task: Textual/Abt-Buy, loss: 0.034750282764434814
step: 240, task: Textual/Abt-Buy, loss: 0.05252115800976753
step: 250, task: Textual/Abt-Buy, loss: 0.17849946022033691
step: 260, task: Textual/Abt-Buy, loss: 0.004644580185413361
step: 270, task: Textual/Abt-Buy, loss: 0.34601858258247375
step: 280, task: Textual/Abt-Buy, loss: 0.0172627791762352
step: 290, task: Textual/Abt-Buy, loss: 0.011795014142990112
step: 300, task: Textual/Abt-Buy, loss: 0.033392634242773056
step: 310, task: Textual/Abt-Buy, loss: 0.2205018550157547
step: 320, task: Textual/Abt-Buy, loss: 0.003514319658279419
step: 330, task: Textual/Abt-Buy, loss: 0.01176375150680542
step: 340, task: Textual/Abt-Buy, loss: 0.303656667470932
step: 350, task: Textual/Abt-Buy, loss: 0.047147538512945175
=========eval at epoch=2=========
Validation:
=============Textual/Abt-Buy==================
accuracy=0.928
precision=0.723
recall=0.544
f1=0.620
======================================
Test:
=============Textual/Abt-Buy==================
accuracy=0.933
precision=0.708
recall=0.636
f1=0.670
======================================
=====sanity check======
words: COL name VAL toshiba 19 ' black lcd hdtv 19av500u COL description VAL toshiba 19 ' black lcd hdtv 19av500u 720p hd display dynalight back-light control theaterwide modes soundstrip speaker system hdmi digital input universal remote high-gloss bezel black finish COL price VAL   [SEP] COL name VAL toshiba 40rv525u 40 ' widescreen 1080p lcd hdtv w / cinespeed piano black COL description VAL  COL price VAL 710.42 
x: [    0 18047   766 27445     7  1193 15577   753   128   909   784 28690
  1368   417 18724   753  1469  1497   257 14857  8194 27445     7  1193
 15577   753   128   909   784 28690  1368   417 18724   753  1469  1497
   257 26180   642  1368   417  2332 38481   337  5971   124    12  6991
   797  7364  6445 19180  2369 34216  5385   467  1368   417  5408  1778
  8135 10547  6063   239    12  7210  5434    28 10101   909  2073 14857
   425 27445  1437  1437     2     2 18047   766 27445     7  1193 15577
   843   338   705 29451   257   843   128   885  4376 37346 21083   642
   784 28690  1368   417 18724   885  1589   740  3141 39640 13305   909
 14857  8194 27445  1437 14857   425 27445   262   698     4  3714  1437
     2]
tokens: ['<s>', 'COL', 'Ġname', 'ĠVAL', 'Ġto', 'sh', 'iba', 'Ġ19', "Ġ'", 'Ġblack', 'Ġl', 'cd', 'Ġh', 'd', 'tv', 'Ġ19', 'av', '500', 'u', 'ĠCOL', 'Ġdescription', 'ĠVAL', 'Ġto', 'sh', 'iba', 'Ġ19', "Ġ'", 'Ġblack', 'Ġl', 'cd', 'Ġh', 'd', 'tv', 'Ġ19', 'av', '500', 'u', 'Ġ720', 'p', 'Ġh', 'd', 'Ġdisplay', 'Ġdyn', 'al', 'ight', 'Ġback', '-', 'light', 'Ġcontrol', 'Ġtheater', 'wide', 'Ġmodes', 'Ġsound', 'strip', 'Ġspeaker', 'Ġsystem', 'Ġh', 'd', 'mi', 'Ġdigital', 'Ġinput', 'Ġuniversal', 'Ġremote', 'Ġhigh', '-', 'gl', 'oss', 'Ġbe', 'zel', 'Ġblack', 'Ġfinish', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ', 'Ġ', '</s>', '</s>', 'COL', 'Ġname', 'ĠVAL', 'Ġto', 'sh', 'iba', 'Ġ40', 'r', 'v', '525', 'u', 'Ġ40', "Ġ'", 'Ġw', 'ides', 'creen', 'Ġ1080', 'p', 'Ġl', 'cd', 'Ġh', 'd', 'tv', 'Ġw', 'Ġ/', 'Ġc', 'ines', 'peed', 'Ġpiano', 'Ġblack', 'ĠCOL', 'Ġdescription', 'ĠVAL', 'Ġ', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ7', '10', '.', '42', 'Ġ', '</s>']
is_heads: [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
y: 0
tags: 0
mask: tensor([1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1])
seqlen: 121
task_name: Textual/Abt-Buy
=======================
step: 0, task: Textual/Abt-Buy, loss: 0.02401714026927948
step: 10, task: Textual/Abt-Buy, loss: 0.038669049739837646
step: 20, task: Textual/Abt-Buy, loss: 0.015337236225605011
step: 30, task: Textual/Abt-Buy, loss: 0.005590967833995819
step: 40, task: Textual/Abt-Buy, loss: 0.32891666889190674
step: 50, task: Textual/Abt-Buy, loss: 0.0192110612988472
step: 60, task: Textual/Abt-Buy, loss: 0.1234239935874939
step: 70, task: Textual/Abt-Buy, loss: 0.03238483518362045
step: 80, task: Textual/Abt-Buy, loss: 0.018944934010505676
step: 90, task: Textual/Abt-Buy, loss: 0.002849176526069641
step: 100, task: Textual/Abt-Buy, loss: 0.010558314621448517
step: 110, task: Textual/Abt-Buy, loss: 0.3214932680130005
step: 120, task: Textual/Abt-Buy, loss: 0.05780860781669617
step: 130, task: Textual/Abt-Buy, loss: 0.16387370228767395
step: 140, task: Textual/Abt-Buy, loss: 0.01448153704404831
step: 150, task: Textual/Abt-Buy, loss: 0.004728130996227264
step: 160, task: Textual/Abt-Buy, loss: 0.00344027578830719
step: 170, task: Textual/Abt-Buy, loss: 0.04279780387878418
step: 180, task: Textual/Abt-Buy, loss: 0.007129356265068054
step: 190, task: Textual/Abt-Buy, loss: 0.014426745474338531
step: 200, task: Textual/Abt-Buy, loss: 0.02516905963420868
step: 210, task: Textual/Abt-Buy, loss: 0.00514926016330719
step: 220, task: Textual/Abt-Buy, loss: 0.005109287798404694
step: 230, task: Textual/Abt-Buy, loss: 0.1293240785598755
step: 240, task: Textual/Abt-Buy, loss: 0.01733773946762085
step: 250, task: Textual/Abt-Buy, loss: 0.07234874367713928
step: 260, task: Textual/Abt-Buy, loss: 0.06375210732221603
step: 270, task: Textual/Abt-Buy, loss: 0.032217707484960556
step: 280, task: Textual/Abt-Buy, loss: 0.005489856004714966
step: 290, task: Textual/Abt-Buy, loss: 0.0030768364667892456
step: 300, task: Textual/Abt-Buy, loss: 0.0831579864025116
step: 310, task: Textual/Abt-Buy, loss: 0.10119526833295822
step: 320, task: Textual/Abt-Buy, loss: 0.002162560820579529
step: 330, task: Textual/Abt-Buy, loss: 0.08172813802957535
step: 340, task: Textual/Abt-Buy, loss: 0.03403067588806152
step: 350, task: Textual/Abt-Buy, loss: 0.0461062490940094
=========eval at epoch=3=========
Validation:
=============Textual/Abt-Buy==================
accuracy=0.920
precision=0.908
recall=0.286
f1=0.435
======================================
Test:
=============Textual/Abt-Buy==================
accuracy=0.925
precision=0.970
recall=0.316
f1=0.476
======================================
=====sanity check======
words: COL name VAL canon cyan photo ink cartridge cyan cli8pc COL description VAL canon cyan photo ink cartridge cli8pc compatible with the pixma ip6600d printer COL price VAL 16.0  [SEP] COL name VAL canon pg-40 twin pack black ink cartridge 0615b013 COL description VAL black COL price VAL  
x: [    0 18047   766 27445 32839 39493  1345 16019 41785 39493  3741   118
   398 17426 14857  8194 27445 32839 39493  1345 16019 41785  3741   118
   398 17426 16632    19     5   181  3181  1916 36180  4280   612   417
 24079 14857   425 27445   545     4   288  1437     2     2 18047   766
 27445 32839 47194    12  1749  9544  6356   909 16019 41785 15007   996
   428 37129 14857  8194 27445   909 14857   425 27445  1437  1437     2]
tokens: ['<s>', 'COL', 'Ġname', 'ĠVAL', 'Ġcanon', 'Ġcyan', 'Ġphoto', 'Ġink', 'Ġcartridge', 'Ġcyan', 'Ġcl', 'i', '8', 'pc', 'ĠCOL', 'Ġdescription', 'ĠVAL', 'Ġcanon', 'Ġcyan', 'Ġphoto', 'Ġink', 'Ġcartridge', 'Ġcl', 'i', '8', 'pc', 'Ġcompatible', 'Ġwith', 'Ġthe', 'Ġp', 'ix', 'ma', 'Ġip', '66', '00', 'd', 'Ġprinter', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ16', '.', '0', 'Ġ', '</s>', '</s>', 'COL', 'Ġname', 'ĠVAL', 'Ġcanon', 'Ġpg', '-', '40', 'Ġtwin', 'Ġpack', 'Ġblack', 'Ġink', 'Ġcartridge', 'Ġ06', '15', 'b', '013', 'ĠCOL', 'Ġdescription', 'ĠVAL', 'Ġblack', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ', 'Ġ', '</s>']
is_heads: [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
y: 0
tags: 0
mask: tensor([1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1])
seqlen: 72
task_name: Textual/Abt-Buy
=======================
step: 0, task: Textual/Abt-Buy, loss: 0.016725264489650726
step: 10, task: Textual/Abt-Buy, loss: 0.012807011604309082
step: 20, task: Textual/Abt-Buy, loss: 0.0031145215034484863
step: 30, task: Textual/Abt-Buy, loss: 0.03602591156959534
step: 40, task: Textual/Abt-Buy, loss: 0.020604971796274185
step: 50, task: Textual/Abt-Buy, loss: 0.006938844919204712
step: 60, task: Textual/Abt-Buy, loss: 0.10402371734380722
step: 70, task: Textual/Abt-Buy, loss: 0.02434861660003662
step: 80, task: Textual/Abt-Buy, loss: 0.0815465897321701
step: 90, task: Textual/Abt-Buy, loss: 0.004987627267837524
step: 100, task: Textual/Abt-Buy, loss: 0.027139753103256226
step: 110, task: Textual/Abt-Buy, loss: 0.21159999072551727
step: 120, task: Textual/Abt-Buy, loss: 0.06433063745498657
step: 130, task: Textual/Abt-Buy, loss: 0.015083938837051392
step: 140, task: Textual/Abt-Buy, loss: 0.09913183003664017
step: 150, task: Textual/Abt-Buy, loss: 0.0006928890943527222
step: 160, task: Textual/Abt-Buy, loss: 0.020889312028884888
step: 170, task: Textual/Abt-Buy, loss: 0.017276041209697723
step: 180, task: Textual/Abt-Buy, loss: 0.0007048100233078003
step: 190, task: Textual/Abt-Buy, loss: 0.0004954636096954346
step: 200, task: Textual/Abt-Buy, loss: 0.13192294538021088
step: 210, task: Textual/Abt-Buy, loss: 0.030679576098918915
step: 220, task: Textual/Abt-Buy, loss: 0.005744114518165588
step: 230, task: Textual/Abt-Buy, loss: 0.03210664540529251
step: 240, task: Textual/Abt-Buy, loss: 0.024060167372226715
step: 250, task: Textual/Abt-Buy, loss: 0.0017176568508148193
step: 260, task: Textual/Abt-Buy, loss: 0.03978722169995308
step: 270, task: Textual/Abt-Buy, loss: 0.0018046647310256958
step: 280, task: Textual/Abt-Buy, loss: 0.0023410022258758545
step: 290, task: Textual/Abt-Buy, loss: 0.0021352022886276245
step: 300, task: Textual/Abt-Buy, loss: 0.10970832407474518
step: 310, task: Textual/Abt-Buy, loss: 0.004413597285747528
step: 320, task: Textual/Abt-Buy, loss: 0.004207119345664978
step: 330, task: Textual/Abt-Buy, loss: 0.1900893747806549
step: 340, task: Textual/Abt-Buy, loss: 0.0023831799626350403
step: 350, task: Textual/Abt-Buy, loss: 0.0033993571996688843
=========eval at epoch=4=========
Validation:
=============Textual/Abt-Buy==================
accuracy=0.937
precision=0.846
recall=0.505
f1=0.632
======================================
Test:
=============Textual/Abt-Buy==================
accuracy=0.940
precision=0.858
recall=0.529
f1=0.655
======================================
=====sanity check======
words: COL name VAL transcend 2gb micro sd memory card ts2gusd COL description VAL transcend 2gb micro sd secure digital memory card ts2gusd good with cell phones and mobile devices mechanical write protection switch uses microsd adapter compliant with secure digital music initiative COL price VAL   [SEP] COL name VAL transcend 2gb microsd card ts2gusd COL description VAL 2 gb COL price VAL 1.75 
x: [    0 18047   766 27445 32539   132 19562  5177 46409  3783  1886 42270
   176   571   687   417 14857  8194 27445 32539   132 19562  5177 46409
  2823  1778  3783  1886 42270   176   571   687   417   205    19  3551
  4247     8  1830  2110 12418  3116  2591  5405  2939  5177 28045 36007
 22624    19  2823  1778   930  3893 14857   425 27445  1437  1437     2
     2 18047   766 27445 32539   132 19562  5177 28045  1886 42270   176
   571   687   417 14857  8194 27445   132   821   428 14857   425 27445
   112     4  2545  1437     2]
tokens: ['<s>', 'COL', 'Ġname', 'ĠVAL', 'Ġtranscend', 'Ġ2', 'gb', 'Ġmicro', 'Ġsd', 'Ġmemory', 'Ġcard', 'Ġts', '2', 'g', 'us', 'd', 'ĠCOL', 'Ġdescription', 'ĠVAL', 'Ġtranscend', 'Ġ2', 'gb', 'Ġmicro', 'Ġsd', 'Ġsecure', 'Ġdigital', 'Ġmemory', 'Ġcard', 'Ġts', '2', 'g', 'us', 'd', 'Ġgood', 'Ġwith', 'Ġcell', 'Ġphones', 'Ġand', 'Ġmobile', 'Ġdevices', 'Ġmechanical', 'Ġwrite', 'Ġprotection', 'Ġswitch', 'Ġuses', 'Ġmicro', 'sd', 'Ġadapter', 'Ġcompliant', 'Ġwith', 'Ġsecure', 'Ġdigital', 'Ġmusic', 'Ġinitiative', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ', 'Ġ', '</s>', '</s>', 'COL', 'Ġname', 'ĠVAL', 'Ġtranscend', 'Ġ2', 'gb', 'Ġmicro', 'sd', 'Ġcard', 'Ġts', '2', 'g', 'us', 'd', 'ĠCOL', 'Ġdescription', 'ĠVAL', 'Ġ2', 'Ġg', 'b', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ1', '.', '75', 'Ġ', '</s>']
is_heads: [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
y: 1
tags: 1
mask: tensor([1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1])
seqlen: 89
task_name: Textual/Abt-Buy
=======================
step: 0, task: Textual/Abt-Buy, loss: 0.05671607702970505
step: 10, task: Textual/Abt-Buy, loss: 0.00804467499256134
step: 20, task: Textual/Abt-Buy, loss: 0.0170275941491127
step: 30, task: Textual/Abt-Buy, loss: 0.12659041583538055
step: 40, task: Textual/Abt-Buy, loss: 0.05176755413413048
step: 50, task: Textual/Abt-Buy, loss: 0.007715277373790741
step: 60, task: Textual/Abt-Buy, loss: 0.0024233534932136536
step: 70, task: Textual/Abt-Buy, loss: 0.003548175096511841
step: 80, task: Textual/Abt-Buy, loss: 0.03872586041688919
step: 90, task: Textual/Abt-Buy, loss: 0.0004584789276123047
step: 100, task: Textual/Abt-Buy, loss: 0.003524772822856903
step: 110, task: Textual/Abt-Buy, loss: 0.1159341111779213
step: 120, task: Textual/Abt-Buy, loss: 0.10144644230604172
step: 130, task: Textual/Abt-Buy, loss: 0.005749255418777466
step: 140, task: Textual/Abt-Buy, loss: 0.10949146747589111
step: 150, task: Textual/Abt-Buy, loss: 0.0004313737154006958
step: 160, task: Textual/Abt-Buy, loss: 0.06785374134778976
step: 170, task: Textual/Abt-Buy, loss: 0.00026109814643859863
step: 180, task: Textual/Abt-Buy, loss: 0.000528380274772644
step: 190, task: Textual/Abt-Buy, loss: 0.0736861452460289
step: 200, task: Textual/Abt-Buy, loss: 0.0976094901561737
step: 210, task: Textual/Abt-Buy, loss: 0.00019186735153198242
step: 220, task: Textual/Abt-Buy, loss: 0.005223043262958527
step: 230, task: Textual/Abt-Buy, loss: 0.040508680045604706
step: 240, task: Textual/Abt-Buy, loss: 0.0004087090492248535
step: 250, task: Textual/Abt-Buy, loss: 0.039701804518699646
step: 260, task: Textual/Abt-Buy, loss: 0.008222632110118866
Gradient overflow.  Skipping step, loss scaler 0 reducing loss scale to 8192.0
step: 270, task: Textual/Abt-Buy, loss: 0.030276775360107422
step: 280, task: Textual/Abt-Buy, loss: 0.001563429832458496
step: 290, task: Textual/Abt-Buy, loss: 0.000682443380355835
step: 300, task: Textual/Abt-Buy, loss: 0.004974357783794403
step: 310, task: Textual/Abt-Buy, loss: 0.012990906834602356
step: 320, task: Textual/Abt-Buy, loss: 0.20441901683807373
step: 330, task: Textual/Abt-Buy, loss: 0.0003300905227661133
step: 340, task: Textual/Abt-Buy, loss: 0.011787377297878265
step: 350, task: Textual/Abt-Buy, loss: 0.00027330219745635986
=========eval at epoch=5=========
Validation:
=============Textual/Abt-Buy==================
accuracy=0.924
precision=0.875
recall=0.340
f1=0.490
======================================
Test:
=============Textual/Abt-Buy==================
accuracy=0.930
precision=0.919
recall=0.383
f1=0.541
======================================
=====sanity check======
words: COL name VAL panasonic dect 6.0 black expandable digital cordless phone kxtg9361b COL description VAL panasonic dect 6.0 black expandable digital cordless phone kxtg9361b drop and splash resistant multi-handset capability ringer id call waiting caller id voicemail hold mute clock alarm led lighting night mode call block speakerphone 11 days standby 5 hours talk time black finish COL price VAL 48.0  [SEP] COL name VAL panasonic kx-tg1032s dual handset digital cordless phone COL description VAL 1 x phone line ( s ) headset jack silver COL price VAL 61.14 
x: [    0 18047   766 27445  5730 38703   263  3894   231     4   288   909
  3003   868  1778 13051  1672  1028   449 11483   571   466 33736   428
 14857  8194 27445  5730 38703   263  3894   231     4   288   909  3003
   868  1778 13051  1672  1028   449 11483   571   466 33736   428  1874
     8 17158 19152  3228    12 34055   594  9388   910  6082 13561   486
  2445 17017 13561 30118 10555   946 33758  6700  8054   669  7526   363
  5745   486  1803  5385 17283   365   360 28611   195   722  1067    86
   909  2073 14857   425 27445  2929     4   288  1437     2     2 18047
   766 27445  5730 38703   449  1178    12 42698   698  2881    29  6594
 17621  1778 13051  1672  1028 14857  8194 27445   112  3023  1028   516
    36   579  4839 20084 10267  4334 14857   425 27445  5659     4  1570
  1437     2]
tokens: ['<s>', 'COL', 'Ġname', 'ĠVAL', 'Ġpan', 'asonic', 'Ġde', 'ct', 'Ġ6', '.', '0', 'Ġblack', 'Ġexpand', 'able', 'Ġdigital', 'Ġcord', 'less', 'Ġphone', 'Ġk', 'xt', 'g', '9', '361', 'b', 'ĠCOL', 'Ġdescription', 'ĠVAL', 'Ġpan', 'asonic', 'Ġde', 'ct', 'Ġ6', '.', '0', 'Ġblack', 'Ġexpand', 'able', 'Ġdigital', 'Ġcord', 'less', 'Ġphone', 'Ġk', 'xt', 'g', '9', '361', 'b', 'Ġdrop', 'Ġand', 'Ġsplash', 'Ġresistant', 'Ġmulti', '-', 'hands', 'et', 'Ġcapability', 'Ġr', 'inger', 'Ġid', 'Ġcall', 'Ġwaiting', 'Ġcaller', 'Ġid', 'Ġvoic', 'email', 'Ġhold', 'Ġmute', 'Ġclock', 'Ġalarm', 'Ġled', 'Ġlighting', 'Ġnight', 'Ġmode', 'Ġcall', 'Ġblock', 'Ġspeaker', 'phone', 'Ġ11', 'Ġdays', 'Ġstandby', 'Ġ5', 'Ġhours', 'Ġtalk', 'Ġtime', 'Ġblack', 'Ġfinish', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ48', '.', '0', 'Ġ', '</s>', '</s>', 'COL', 'Ġname', 'ĠVAL', 'Ġpan', 'asonic', 'Ġk', 'x', '-', 'tg', '10', '32', 's', 'Ġdual', 'Ġhandset', 'Ġdigital', 'Ġcord', 'less', 'Ġphone', 'ĠCOL', 'Ġdescription', 'ĠVAL', 'Ġ1', 'Ġx', 'Ġphone', 'Ġline', 'Ġ(', 'Ġs', 'Ġ)', 'Ġheadset', 'Ġjack', 'Ġsilver', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ61', '.', '14', 'Ġ', '</s>']
is_heads: [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
y: 0
tags: 0
mask: tensor([1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1])
seqlen: 134
task_name: Textual/Abt-Buy
=======================
step: 0, task: Textual/Abt-Buy, loss: 0.000493854284286499
step: 10, task: Textual/Abt-Buy, loss: 0.01585107296705246
step: 20, task: Textual/Abt-Buy, loss: 0.0004400312900543213
step: 30, task: Textual/Abt-Buy, loss: 0.0019183307886123657
step: 40, task: Textual/Abt-Buy, loss: 0.02491295337677002
step: 50, task: Textual/Abt-Buy, loss: 0.004687659442424774
step: 60, task: Textual/Abt-Buy, loss: 0.037460990250110626
step: 70, task: Textual/Abt-Buy, loss: 0.0009037554264068604
step: 80, task: Textual/Abt-Buy, loss: 0.0006214380264282227
step: 90, task: Textual/Abt-Buy, loss: 0.0004973262548446655
step: 100, task: Textual/Abt-Buy, loss: 0.01849723607301712
step: 110, task: Textual/Abt-Buy, loss: 0.020387008786201477
step: 120, task: Textual/Abt-Buy, loss: 0.002177000045776367
step: 130, task: Textual/Abt-Buy, loss: 0.007431432604789734
step: 140, task: Textual/Abt-Buy, loss: 0.000352710485458374
step: 150, task: Textual/Abt-Buy, loss: 0.0013203024864196777
step: 160, task: Textual/Abt-Buy, loss: 0.00031119585037231445
step: 170, task: Textual/Abt-Buy, loss: 0.0006825178861618042
step: 180, task: Textual/Abt-Buy, loss: 0.0002656877040863037
step: 190, task: Textual/Abt-Buy, loss: 0.02875940501689911
step: 200, task: Textual/Abt-Buy, loss: 0.009030789136886597
step: 210, task: Textual/Abt-Buy, loss: 0.004501625895500183
step: 220, task: Textual/Abt-Buy, loss: 0.0005484819412231445
step: 230, task: Textual/Abt-Buy, loss: 0.00016316771507263184
step: 240, task: Textual/Abt-Buy, loss: 0.03139244019985199
step: 250, task: Textual/Abt-Buy, loss: 0.00016754865646362305
step: 260, task: Textual/Abt-Buy, loss: 0.05647730827331543
step: 270, task: Textual/Abt-Buy, loss: 0.00028207898139953613
step: 280, task: Textual/Abt-Buy, loss: 0.19554245471954346
step: 290, task: Textual/Abt-Buy, loss: 0.0001760721206665039
step: 300, task: Textual/Abt-Buy, loss: 0.0005032718181610107
step: 310, task: Textual/Abt-Buy, loss: 0.0009725391864776611
step: 320, task: Textual/Abt-Buy, loss: 0.0005475431680679321
step: 330, task: Textual/Abt-Buy, loss: 0.002029210329055786
step: 340, task: Textual/Abt-Buy, loss: 0.005973979830741882
step: 350, task: Textual/Abt-Buy, loss: 0.0013699829578399658
=========eval at epoch=6=========
Validation:
=============Textual/Abt-Buy==================
accuracy=0.928
precision=0.947
recall=0.350
f1=0.511
======================================
Test:
=============Textual/Abt-Buy==================
accuracy=0.930
precision=0.949
recall=0.364
f1=0.526
======================================
=====sanity check======
words: COL name VAL apple 32gb black 2nd generation ipod touch mb533lla COL description VAL apple 32gb black 2nd generation ipod touch mb533lla holds up to 7,000 songs in 128-kbps aac format , 25,000 ipod-viewable photos and 40 hours of video wi-fi ( 802.11 b/g ) nike + ipod support built-in maps location-based service 3.5 ' ( diagonal ) widescreen multi-touch display 480x320-pixel resolution 480p and 576p component tv out mac and windows compatible black finish COL price VAL 399.0  [SEP] COL name VAL apple 8gb ipod nano blue ( 4th generation ) mb732ll/a COL description VAL  COL price VAL 146.75 
x: [    0 18047   766 27445 15162  2107 19562   909   132  1187  2706 36180
  1630  2842   475   428 38037  5104 14857  8194 27445 15162  2107 19562
   909   132  1187  2706 36180  1630  2842   475   428 38037  5104  3106
    62     7   262     6   151  3686    11 13950    12   330 27072    10
  1043  7390  2156   564     6   151 36180  1630    12  5877   868  2356
     8   843   722     9   569 33755    12  9169    36 31551     4  1225
   741    73   571  4839   295  4348  2055 36180  1630   323  1490    12
   179 12879  2259    12   805   544   155     4   245   128    36 42539
  4839   885  4376 37346  3228    12 26673  2332 26754  1178 17655    12
 44546  3547 26754   642     8   195  5067   642  7681 30016    66 13418
     8  6410 16632   909  2073 14857   425 27445 41279     4   288  1437
     2     2 18047   766 27445 15162   290 19562 36180  1630 36924  2440
    36   204   212  2706  4839   475   428   406  2881   890    73   102
 14857  8194 27445  1437 14857   425 27445 24543     4  2545  1437     2]
tokens: ['<s>', 'COL', 'Ġname', 'ĠVAL', 'Ġapple', 'Ġ32', 'gb', 'Ġblack', 'Ġ2', 'nd', 'Ġgeneration', 'Ġip', 'od', 'Ġtouch', 'Ġm', 'b', '533', 'lla', 'ĠCOL', 'Ġdescription', 'ĠVAL', 'Ġapple', 'Ġ32', 'gb', 'Ġblack', 'Ġ2', 'nd', 'Ġgeneration', 'Ġip', 'od', 'Ġtouch', 'Ġm', 'b', '533', 'lla', 'Ġholds', 'Ġup', 'Ġto', 'Ġ7', ',', '000', 'Ġsongs', 'Ġin', 'Ġ128', '-', 'k', 'bps', 'Ġa', 'ac', 'Ġformat', 'Ġ,', 'Ġ25', ',', '000', 'Ġip', 'od', '-', 'view', 'able', 'Ġphotos', 'Ġand', 'Ġ40', 'Ġhours', 'Ġof', 'Ġvideo', 'Ġwi', '-', 'fi', 'Ġ(', 'Ġ802', '.', '11', 'Ġb', '/', 'g', 'Ġ)', 'Ġn', 'ike', 'Ġ+', 'Ġip', 'od', 'Ġsupport', 'Ġbuilt', '-', 'in', 'Ġmaps', 'Ġlocation', '-', 'based', 'Ġservice', 'Ġ3', '.', '5', "Ġ'", 'Ġ(', 'Ġdiagonal', 'Ġ)', 'Ġw', 'ides', 'creen', 'Ġmulti', '-', 'touch', 'Ġdisplay', 'Ġ480', 'x', '320', '-', 'pixel', 'Ġresolution', 'Ġ480', 'p', 'Ġand', 'Ġ5', '76', 'p', 'Ġcomponent', 'Ġtv', 'Ġout', 'Ġmac', 'Ġand', 'Ġwindows', 'Ġcompatible', 'Ġblack', 'Ġfinish', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ399', '.', '0', 'Ġ', '</s>', '</s>', 'COL', 'Ġname', 'ĠVAL', 'Ġapple', 'Ġ8', 'gb', 'Ġip', 'od', 'Ġnano', 'Ġblue', 'Ġ(', 'Ġ4', 'th', 'Ġgeneration', 'Ġ)', 'Ġm', 'b', '7', '32', 'll', '/', 'a', 'ĠCOL', 'Ġdescription', 'ĠVAL', 'Ġ', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ146', '.', '75', 'Ġ', '</s>']
is_heads: [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
y: 0
tags: 0
mask: tensor([1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1])
seqlen: 168
task_name: Textual/Abt-Buy
=======================
step: 0, task: Textual/Abt-Buy, loss: 0.0003199279308319092
step: 10, task: Textual/Abt-Buy, loss: 0.00024046003818511963
step: 20, task: Textual/Abt-Buy, loss: 0.017617516219615936
step: 30, task: Textual/Abt-Buy, loss: 0.0005110055208206177
Gradient overflow.  Skipping step, loss scaler 0 reducing loss scale to 4096.0
step: 40, task: Textual/Abt-Buy, loss: 0.00036288797855377197
step: 50, task: Textual/Abt-Buy, loss: 0.00036685168743133545
step: 60, task: Textual/Abt-Buy, loss: 0.024592440575361252
step: 70, task: Textual/Abt-Buy, loss: 0.00037322938442230225
step: 80, task: Textual/Abt-Buy, loss: 0.0016530007123947144
step: 90, task: Textual/Abt-Buy, loss: 0.00038436055183410645
step: 100, task: Textual/Abt-Buy, loss: 0.0004076957702636719
step: 110, task: Textual/Abt-Buy, loss: 0.009344331920146942
step: 120, task: Textual/Abt-Buy, loss: 0.0007785558700561523
step: 130, task: Textual/Abt-Buy, loss: 0.03226799517869949
step: 140, task: Textual/Abt-Buy, loss: 0.0007666051387786865
step: 150, task: Textual/Abt-Buy, loss: 0.0003402233123779297
step: 160, task: Textual/Abt-Buy, loss: 0.00044852495193481445
step: 170, task: Textual/Abt-Buy, loss: 0.00033524632453918457
step: 180, task: Textual/Abt-Buy, loss: 0.0002732276916503906
step: 190, task: Textual/Abt-Buy, loss: 0.0005295276641845703
step: 200, task: Textual/Abt-Buy, loss: 0.04800966754555702
step: 210, task: Textual/Abt-Buy, loss: 0.0017824620008468628
step: 220, task: Textual/Abt-Buy, loss: 0.0010698139667510986
step: 230, task: Textual/Abt-Buy, loss: 0.0040398165583610535
step: 240, task: Textual/Abt-Buy, loss: 0.000402107834815979
step: 250, task: Textual/Abt-Buy, loss: 0.010190024971961975
step: 260, task: Textual/Abt-Buy, loss: 0.017663881182670593
step: 270, task: Textual/Abt-Buy, loss: 0.03067111223936081
step: 280, task: Textual/Abt-Buy, loss: 0.07271070033311844
step: 290, task: Textual/Abt-Buy, loss: 0.01217401772737503
step: 300, task: Textual/Abt-Buy, loss: 0.00020618736743927002
step: 310, task: Textual/Abt-Buy, loss: 0.0004810541868209839
step: 320, task: Textual/Abt-Buy, loss: 0.0004709959030151367
step: 330, task: Textual/Abt-Buy, loss: 0.00023983418941497803
step: 340, task: Textual/Abt-Buy, loss: 0.038144551217556
step: 350, task: Textual/Abt-Buy, loss: 0.00033439695835113525
=========eval at epoch=7=========
Validation:
=============Textual/Abt-Buy==================
accuracy=0.926
precision=0.933
recall=0.340
f1=0.498
======================================
Test:
=============Textual/Abt-Buy==================
accuracy=0.924
precision=0.942
recall=0.316
f1=0.473
======================================
=====sanity check======
words: COL name VAL panasonic black lumix 10.1 megapixel digital camera dmcfz28k COL description VAL panasonic black lumix 10.1 megapixel digital camera dmcfz28k 10.1 megapixel 27 - 486mm f/2 .8 -4.4 leica dc lens 2.7 ' tft lcd display ( 230k dots ) 18x optical zoom intelligent auto mode burst mode auto angle detection 50mb built-in memory black finish COL price VAL   [SEP] COL name VAL samsung l200 digital camera black ec-l200zbba / us COL description VAL samsung l200 10 megapixel digital camera with 2.5 lcd , 3x optical zoom , digital image stabilization , face detection function black COL price VAL 119.0 
x: [    0 18047   766 27445  5730 38703   909 31962  3181   158     4   134
 10721 21424  1778  2280   385   119 19911   329  2517   330 14857  8194
 27445  5730 38703   909 31962  3181   158     4   134 10721 21424  1778
  2280   385   119 19911   329  2517   330   158     4   134 10721 21424
   974   111   204  5334  5471   856    73   176   479   398   111   306
     4   306  2084  2426 46773 10373   132     4   406   128   326  2543
   784 28690  2332    36 16242   330 26221  4839   504  1178 17547 21762
 12038  4485  5745 10084  5745  4485 11792 12673   654  6648  1490    12
   179  3783   909  2073 14857   425 27445  1437  1437     2     2 18047
   766 27445   579 48545   784  2619  1778  2280   909 20508    12   462
  2619 19831  3178  1589   201 14857  8194 27445   579 48545   784  2619
   158 10721 21424  1778  2280    19   132     4   245   784 28690  2156
   155  1178 17547 21762  2156  1778  2274 29632  2156   652 12673  5043
   909 14857   425 27445 16491     4   288  1437     2]
tokens: ['<s>', 'COL', 'Ġname', 'ĠVAL', 'Ġpan', 'asonic', 'Ġblack', 'Ġlum', 'ix', 'Ġ10', '.', '1', 'Ġmeg', 'apixel', 'Ġdigital', 'Ġcamera', 'Ġd', 'm', 'cf', 'z', '28', 'k', 'ĠCOL', 'Ġdescription', 'ĠVAL', 'Ġpan', 'asonic', 'Ġblack', 'Ġlum', 'ix', 'Ġ10', '.', '1', 'Ġmeg', 'apixel', 'Ġdigital', 'Ġcamera', 'Ġd', 'm', 'cf', 'z', '28', 'k', 'Ġ10', '.', '1', 'Ġmeg', 'apixel', 'Ġ27', 'Ġ-', 'Ġ4', '86', 'mm', 'Ġf', '/', '2', 'Ġ.', '8', 'Ġ-', '4', '.', '4', 'Ġle', 'ica', 'Ġdc', 'Ġlens', 'Ġ2', '.', '7', "Ġ'", 'Ġt', 'ft', 'Ġl', 'cd', 'Ġdisplay', 'Ġ(', 'Ġ230', 'k', 'Ġdots', 'Ġ)', 'Ġ18', 'x', 'Ġoptical', 'Ġzoom', 'Ġintelligent', 'Ġauto', 'Ġmode', 'Ġburst', 'Ġmode', 'Ġauto', 'Ġangle', 'Ġdetection', 'Ġ50', 'mb', 'Ġbuilt', '-', 'in', 'Ġmemory', 'Ġblack', 'Ġfinish', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ', 'Ġ', '</s>', '</s>', 'COL', 'Ġname', 'ĠVAL', 'Ġs', 'amsung', 'Ġl', '200', 'Ġdigital', 'Ġcamera', 'Ġblack', 'Ġec', '-', 'l', '200', 'zb', 'ba', 'Ġ/', 'Ġus', 'ĠCOL', 'Ġdescription', 'ĠVAL', 'Ġs', 'amsung', 'Ġl', '200', 'Ġ10', 'Ġmeg', 'apixel', 'Ġdigital', 'Ġcamera', 'Ġwith', 'Ġ2', '.', '5', 'Ġl', 'cd', 'Ġ,', 'Ġ3', 'x', 'Ġoptical', 'Ġzoom', 'Ġ,', 'Ġdigital', 'Ġimage', 'Ġstabilization', 'Ġ,', 'Ġface', 'Ġdetection', 'Ġfunction', 'Ġblack', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ119', '.', '0', 'Ġ', '</s>']
is_heads: [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
y: 0
tags: 0
mask: tensor([1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1])
seqlen: 165
task_name: Textual/Abt-Buy
=======================
step: 0, task: Textual/Abt-Buy, loss: 0.0002556443214416504
step: 10, task: Textual/Abt-Buy, loss: 0.00023163855075836182
step: 20, task: Textual/Abt-Buy, loss: 0.00022082030773162842
step: 30, task: Textual/Abt-Buy, loss: 0.006070517003536224
step: 40, task: Textual/Abt-Buy, loss: 0.0003221184015274048
step: 50, task: Textual/Abt-Buy, loss: 0.15983785688877106
step: 60, task: Textual/Abt-Buy, loss: 0.00032061338424682617
step: 70, task: Textual/Abt-Buy, loss: 0.0003134310245513916
step: 80, task: Textual/Abt-Buy, loss: 0.00031834840774536133
step: 90, task: Textual/Abt-Buy, loss: 0.0003324151039123535
step: 100, task: Textual/Abt-Buy, loss: 0.000353395938873291
step: 110, task: Textual/Abt-Buy, loss: 0.0006914287805557251
step: 120, task: Textual/Abt-Buy, loss: 0.00043398141860961914
step: 130, task: Textual/Abt-Buy, loss: 0.00024181604385375977
step: 140, task: Textual/Abt-Buy, loss: 0.0004969686269760132
step: 150, task: Textual/Abt-Buy, loss: 0.06374773383140564
step: 160, task: Textual/Abt-Buy, loss: 0.00024312734603881836
step: 170, task: Textual/Abt-Buy, loss: 0.00024615228176116943
step: 180, task: Textual/Abt-Buy, loss: 0.004368305206298828
step: 190, task: Textual/Abt-Buy, loss: 0.0004665553569793701
step: 200, task: Textual/Abt-Buy, loss: 0.0009693652391433716
step: 210, task: Textual/Abt-Buy, loss: 0.0003263801336288452
step: 220, task: Textual/Abt-Buy, loss: 0.00037826597690582275
step: 230, task: Textual/Abt-Buy, loss: 0.0002723187208175659
step: 240, task: Textual/Abt-Buy, loss: 0.0006220191717147827
step: 250, task: Textual/Abt-Buy, loss: 0.0002187192440032959
step: 260, task: Textual/Abt-Buy, loss: 0.00027157366275787354
step: 270, task: Textual/Abt-Buy, loss: 0.0003555864095687866
step: 280, task: Textual/Abt-Buy, loss: 0.013600215315818787
step: 290, task: Textual/Abt-Buy, loss: 0.00029243528842926025
step: 300, task: Textual/Abt-Buy, loss: 0.00030396878719329834
step: 310, task: Textual/Abt-Buy, loss: 0.00027199089527130127
step: 320, task: Textual/Abt-Buy, loss: 0.00025027990341186523
step: 330, task: Textual/Abt-Buy, loss: 0.0003582090139389038
step: 340, task: Textual/Abt-Buy, loss: 0.0012105554342269897
step: 350, task: Textual/Abt-Buy, loss: 0.00036853551864624023
=========eval at epoch=8=========
Validation:
=============Textual/Abt-Buy==================
accuracy=0.920
precision=0.921
recall=0.282
f1=0.431
======================================
Test:
=============Textual/Abt-Buy==================
accuracy=0.928
precision=0.936
recall=0.354
f1=0.514
======================================
Selected optimization level O2:  FP16 training with FP32 batchnorm and FP32 master weights.

Defaults for this optimization level are:
enabled                : True
opt_level              : O2
cast_model_type        : torch.float16
patch_torch_functions  : False
keep_batchnorm_fp32    : True
master_weights         : True
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O2
cast_model_type        : torch.float16
patch_torch_functions  : False
keep_batchnorm_fp32    : True
master_weights         : True
loss_scale             : dynamic
Warning:  multi_tensor_applier fused unscale kernel is unavailable, possibly because apex was installed without --cuda_ext --cpp_ext. Using Python fallback.  Original ImportError was: ModuleNotFoundError("No module named 'amp_C'")
Gradient overflow.  Skipping step, loss scaler 0 reducing loss scale to 32768.0
=====sanity check======
words: COL name VAL panasonic black expandable digital cordless dect 6.0 phone system kxtg8232b COL description VAL panasonic black expandable digital cordless dect 6.0 phone system kxtg8232b large 1.5 ' color lcd extended talk time reduced interference hearing aid compatibility all-digital answering system 2 handsets piano black finish COL price VAL   [SEP] COL name VAL panasonic kx-tga450b cordless handset COL description VAL panasonic kx-tga450b additional handset for pankxtg4500b COL price VAL  
x: [    0 18047   766 27445  5730 38703   909  3003   868  1778 13051  1672
   263  3894   231     4   288  1028   467   449 11483   571   398 28503
   428 14857  8194 27445  5730 38703   909  3003   868  1778 13051  1672
   263  3894   231     4   288  1028   467   449 11483   571   398 28503
   428   739   112     4   245   128  3195   784 28690  3112  1067    86
  2906  8149  1576  2887 29988    70    12 29563 15635   467   132  1420
  2580 13305   909  2073 14857   425 27445  1437  1437     2     2 18047
   766 27445  5730 38703   449  1178    12    90  2538 13872   428 13051
  1672 17621 14857  8194 27445  5730 38703   449  1178    12    90  2538
 13872   428   943 17621    13   181  3153 11483   571  1898   612   428
 14857   425 27445  1437  1437     2]
tokens: ['<s>', 'COL', 'Ġname', 'ĠVAL', 'Ġpan', 'asonic', 'Ġblack', 'Ġexpand', 'able', 'Ġdigital', 'Ġcord', 'less', 'Ġde', 'ct', 'Ġ6', '.', '0', 'Ġphone', 'Ġsystem', 'Ġk', 'xt', 'g', '8', '232', 'b', 'ĠCOL', 'Ġdescription', 'ĠVAL', 'Ġpan', 'asonic', 'Ġblack', 'Ġexpand', 'able', 'Ġdigital', 'Ġcord', 'less', 'Ġde', 'ct', 'Ġ6', '.', '0', 'Ġphone', 'Ġsystem', 'Ġk', 'xt', 'g', '8', '232', 'b', 'Ġlarge', 'Ġ1', '.', '5', "Ġ'", 'Ġcolor', 'Ġl', 'cd', 'Ġextended', 'Ġtalk', 'Ġtime', 'Ġreduced', 'Ġinterference', 'Ġhearing', 'Ġaid', 'Ġcompatibility', 'Ġall', '-', 'digital', 'Ġanswering', 'Ġsystem', 'Ġ2', 'Ġhands', 'ets', 'Ġpiano', 'Ġblack', 'Ġfinish', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ', 'Ġ', '</s>', '</s>', 'COL', 'Ġname', 'ĠVAL', 'Ġpan', 'asonic', 'Ġk', 'x', '-', 't', 'ga', '450', 'b', 'Ġcord', 'less', 'Ġhandset', 'ĠCOL', 'Ġdescription', 'ĠVAL', 'Ġpan', 'asonic', 'Ġk', 'x', '-', 't', 'ga', '450', 'b', 'Ġadditional', 'Ġhandset', 'Ġfor', 'Ġp', 'ank', 'xt', 'g', '45', '00', 'b', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ', 'Ġ', '</s>']
is_heads: [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
y: 0
tags: 0
mask: tensor([1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1])
seqlen: 126
task_name: Textual/Abt-Buy
=======================
step: 0, task: Textual/Abt-Buy, loss: 1.102712869644165
Gradient overflow.  Skipping step, loss scaler 0 reducing loss scale to 16384.0
Gradient overflow.  Skipping step, loss scaler 0 reducing loss scale to 8192.0
Gradient overflow.  Skipping step, loss scaler 0 reducing loss scale to 4096.0
step: 10, task: Textual/Abt-Buy, loss: 1.1077951192855835
step: 20, task: Textual/Abt-Buy, loss: 0.9979200959205627
step: 30, task: Textual/Abt-Buy, loss: 0.6381755471229553
step: 40, task: Textual/Abt-Buy, loss: 0.15389932692050934
step: 50, task: Textual/Abt-Buy, loss: 0.3732038736343384
step: 60, task: Textual/Abt-Buy, loss: 0.14745281636714935
step: 70, task: Textual/Abt-Buy, loss: 0.6395548582077026
step: 80, task: Textual/Abt-Buy, loss: 0.32550787925720215
step: 90, task: Textual/Abt-Buy, loss: 0.08113673329353333
step: 100, task: Textual/Abt-Buy, loss: 0.6900405883789062
step: 110, task: Textual/Abt-Buy, loss: 0.37055298686027527
step: 120, task: Textual/Abt-Buy, loss: 0.663243293762207
step: 130, task: Textual/Abt-Buy, loss: 0.5133062601089478
step: 140, task: Textual/Abt-Buy, loss: 0.26114967465400696
step: 150, task: Textual/Abt-Buy, loss: 0.2239542454481125
step: 160, task: Textual/Abt-Buy, loss: 0.639678955078125
step: 170, task: Textual/Abt-Buy, loss: 0.5565247535705566
step: 180, task: Textual/Abt-Buy, loss: 0.7285311222076416
step: 190, task: Textual/Abt-Buy, loss: 0.21374773979187012
step: 200, task: Textual/Abt-Buy, loss: 0.20713964104652405
step: 210, task: Textual/Abt-Buy, loss: 0.4319169223308563
step: 220, task: Textual/Abt-Buy, loss: 0.44412076473236084
step: 230, task: Textual/Abt-Buy, loss: 0.3600827753543854
step: 240, task: Textual/Abt-Buy, loss: 0.204938143491745
step: 250, task: Textual/Abt-Buy, loss: 0.06230096518993378
step: 260, task: Textual/Abt-Buy, loss: 0.16576272249221802
step: 270, task: Textual/Abt-Buy, loss: 0.20741067826747894
step: 280, task: Textual/Abt-Buy, loss: 0.7706506252288818
step: 290, task: Textual/Abt-Buy, loss: 0.17434018850326538
step: 300, task: Textual/Abt-Buy, loss: 1.0864399671554565
step: 310, task: Textual/Abt-Buy, loss: 0.08874940127134323
step: 320, task: Textual/Abt-Buy, loss: 0.11139550805091858
step: 330, task: Textual/Abt-Buy, loss: 0.3187969923019409
step: 340, task: Textual/Abt-Buy, loss: 0.09812768548727036
step: 350, task: Textual/Abt-Buy, loss: 0.2452928125858307
=========eval at epoch=1=========
Validation:
=============Textual/Abt-Buy==================
accuracy=0.901
precision=0.944
recall=0.083
f1=0.152
======================================
Test:
=============Textual/Abt-Buy==================
accuracy=0.895
precision=0.692
recall=0.044
f1=0.082
======================================
/w/246/tianyu2020/miniconda2/envs/ditto/lib/python3.7/site-packages/apex/amp/_initialize.py:24: UserWarning: An input tensor was not cuda.
  warnings.warn("An input tensor was not cuda.")
/w/246/tianyu2020/miniconda2/envs/ditto/lib/python3.7/site-packages/torch/optim/lr_scheduler.py:122: UserWarning: Detected call of `lr_scheduler.step()` before `optimizer.step()`. In PyTorch 1.1.0 and later, you should call them in the opposite order: `optimizer.step()` before `lr_scheduler.step()`.  Failure to do this will result in PyTorch skipping the first value of the learning rate schedule. See more details at https://pytorch.org/docs/stable/optim.html#how-to-adjust-learning-rate
  "https://pytorch.org/docs/stable/optim.html#how-to-adjust-learning-rate", UserWarning)
=====sanity check======
words: COL name VAL ge 24 ' gsd2400nww white built-in dishwasher gsd2400wh COL description VAL ge 24 ' gsd2400nww white built-in dishwasher gsd2400wh 4-level powerscrub wash system hotstart option piranha hard food disposer heated dry option self-cleaning filter system white finish COL price VAL 259.0  [SEP] COL name VAL ge gsd4000nww dishwasher with 5 wash cycles std tub estar ( white ) gsd4000nww COL description VAL  COL price VAL 313.29 
x: [    0 18047   766 27445  5473   706   128   821 28045  1978   612   282
 33130  1104  1490    12   179  8847 34475   821 28045  1978   612 11613
 14857  8194 27445  5473   706   128   821 28045  1978   612   282 33130
  1104  1490    12   179  8847 34475   821 28045  1978   612 11613   204
    12  4483  4361  8344  1792 10397   467  2131 13124  1973 36287   260
  1999   543   689 22031   254 10819  3841  1973  1403    12 16008 19266
 14929   467  1104  2073 14857   425 27445 37315     4   288  1437     2
     2 18047   766 27445  5473   821 28045 38161   282 33130  8847 34475
    19   195 10397 16726 49008 17465  3304   271    36  1104  4839   821
 28045 38161   282 33130 14857  8194 27445  1437 14857   425 27445 32706
     4  2890  1437     2]
tokens: ['<s>', 'COL', 'Ġname', 'ĠVAL', 'Ġge', 'Ġ24', "Ġ'", 'Ġg', 'sd', '24', '00', 'n', 'ww', 'Ġwhite', 'Ġbuilt', '-', 'in', 'Ġdish', 'washer', 'Ġg', 'sd', '24', '00', 'wh', 'ĠCOL', 'Ġdescription', 'ĠVAL', 'Ġge', 'Ġ24', "Ġ'", 'Ġg', 'sd', '24', '00', 'n', 'ww', 'Ġwhite', 'Ġbuilt', '-', 'in', 'Ġdish', 'washer', 'Ġg', 'sd', '24', '00', 'wh', 'Ġ4', '-', 'level', 'Ġpowers', 'cr', 'ub', 'Ġwash', 'Ġsystem', 'Ġhot', 'start', 'Ġoption', 'Ġpir', 'an', 'ha', 'Ġhard', 'Ġfood', 'Ġdispos', 'er', 'Ġheated', 'Ġdry', 'Ġoption', 'Ġself', '-', 'cle', 'aning', 'Ġfilter', 'Ġsystem', 'Ġwhite', 'Ġfinish', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ259', '.', '0', 'Ġ', '</s>', '</s>', 'COL', 'Ġname', 'ĠVAL', 'Ġge', 'Ġg', 'sd', '4000', 'n', 'ww', 'Ġdish', 'washer', 'Ġwith', 'Ġ5', 'Ġwash', 'Ġcycles', 'Ġstd', 'Ġtub', 'Ġest', 'ar', 'Ġ(', 'Ġwhite', 'Ġ)', 'Ġg', 'sd', '4000', 'n', 'ww', 'ĠCOL', 'Ġdescription', 'ĠVAL', 'Ġ', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ313', '.', '29', 'Ġ', '</s>']
is_heads: [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
y: 0
tags: 0
mask: tensor([1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1])
seqlen: 124
task_name: Textual/Abt-Buy
=======================
step: 0, task: Textual/Abt-Buy, loss: 0.3798820674419403
step: 10, task: Textual/Abt-Buy, loss: 0.09791852533817291
step: 20, task: Textual/Abt-Buy, loss: 0.08840303122997284
step: 30, task: Textual/Abt-Buy, loss: 0.2748132348060608
step: 40, task: Textual/Abt-Buy, loss: 0.2040785849094391
step: 50, task: Textual/Abt-Buy, loss: 0.3751448094844818
step: 60, task: Textual/Abt-Buy, loss: 0.041288744658231735
step: 70, task: Textual/Abt-Buy, loss: 0.05544865131378174
step: 80, task: Textual/Abt-Buy, loss: 0.0420508049428463
step: 90, task: Textual/Abt-Buy, loss: 0.042975228279829025
step: 100, task: Textual/Abt-Buy, loss: 0.4122118353843689
step: 110, task: Textual/Abt-Buy, loss: 0.1748361736536026
step: 120, task: Textual/Abt-Buy, loss: 0.3128489851951599
step: 130, task: Textual/Abt-Buy, loss: 0.1614675223827362
step: 140, task: Textual/Abt-Buy, loss: 0.10332794487476349
step: 150, task: Textual/Abt-Buy, loss: 0.013257935643196106
step: 160, task: Textual/Abt-Buy, loss: 0.06711003184318542
step: 170, task: Textual/Abt-Buy, loss: 0.10269094258546829
step: 180, task: Textual/Abt-Buy, loss: 0.4099300801753998
step: 190, task: Textual/Abt-Buy, loss: 0.1785387098789215
step: 200, task: Textual/Abt-Buy, loss: 0.09771814942359924
step: 210, task: Textual/Abt-Buy, loss: 0.14825113117694855
step: 220, task: Textual/Abt-Buy, loss: 0.04044549539685249
step: 230, task: Textual/Abt-Buy, loss: 0.007475145161151886
step: 240, task: Textual/Abt-Buy, loss: 0.09380129724740982
step: 250, task: Textual/Abt-Buy, loss: 0.012648135423660278
step: 260, task: Textual/Abt-Buy, loss: 0.13668957352638245
step: 270, task: Textual/Abt-Buy, loss: 0.04101914167404175
step: 280, task: Textual/Abt-Buy, loss: 0.005899541079998016
step: 290, task: Textual/Abt-Buy, loss: 0.11390607059001923
step: 300, task: Textual/Abt-Buy, loss: 0.2928246259689331
step: 310, task: Textual/Abt-Buy, loss: 0.06564578413963318
step: 320, task: Textual/Abt-Buy, loss: 0.03034181147813797
step: 330, task: Textual/Abt-Buy, loss: 0.0034848228096961975
step: 340, task: Textual/Abt-Buy, loss: 0.21486596763134003
step: 350, task: Textual/Abt-Buy, loss: 0.3331526517868042
=========eval at epoch=2=========
Validation:
=============Textual/Abt-Buy==================
accuracy=0.921
precision=0.784
recall=0.369
f1=0.502
======================================
Test:
=============Textual/Abt-Buy==================
accuracy=0.920
precision=0.757
recall=0.379
f1=0.505
======================================
=====sanity check======
words: COL name VAL sony weather shower cd clock radio icfcd73w COL description VAL sony weather shower cd clock radio icfcd73w am/fm/weather band splash resistant 5 direct access buttons shuttle dial operation lcd display digital clock hanging strap COL price VAL   [SEP] COL name VAL sony icf-cd73w am/fm/weather shower cd clock radio ( white ) COL description VAL  COL price VAL 68.96 
x: [    0 18047   766 27445   579  6119  1650  9310 45584  6700  3188 41591
   506 28690  5352   605 14857  8194 27445   579  6119  1650  9310 45584
  6700  3188 41591   506 28690  5352   605   524    73 40523    73 21693
  1971 17158 19152   195  2228   899 14893 19463 11481  2513   784 28690
  2332  1778  6700  7209 26123 14857   425 27445  1437  1437     2     2
 18047   766 27445   579  6119 41591   506    12 28690  5352   605   524
    73 40523    73 21693  9310 45584  6700  3188    36  1104  4839 14857
  8194 27445  1437 14857   425 27445  5595     4  5607  1437     2]
tokens: ['<s>', 'COL', 'Ġname', 'ĠVAL', 'Ġs', 'ony', 'Ġweather', 'Ġshower', 'Ġcd', 'Ġclock', 'Ġradio', 'Ġic', 'f', 'cd', '73', 'w', 'ĠCOL', 'Ġdescription', 'ĠVAL', 'Ġs', 'ony', 'Ġweather', 'Ġshower', 'Ġcd', 'Ġclock', 'Ġradio', 'Ġic', 'f', 'cd', '73', 'w', 'Ġam', '/', 'fm', '/', 'weather', 'Ġband', 'Ġsplash', 'Ġresistant', 'Ġ5', 'Ġdirect', 'Ġaccess', 'Ġbuttons', 'Ġshuttle', 'Ġdial', 'Ġoperation', 'Ġl', 'cd', 'Ġdisplay', 'Ġdigital', 'Ġclock', 'Ġhanging', 'Ġstrap', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ', 'Ġ', '</s>', '</s>', 'COL', 'Ġname', 'ĠVAL', 'Ġs', 'ony', 'Ġic', 'f', '-', 'cd', '73', 'w', 'Ġam', '/', 'fm', '/', 'weather', 'Ġshower', 'Ġcd', 'Ġclock', 'Ġradio', 'Ġ(', 'Ġwhite', 'Ġ)', 'ĠCOL', 'Ġdescription', 'ĠVAL', 'Ġ', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ68', '.', '96', 'Ġ', '</s>']
is_heads: [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
y: 1
tags: 1
mask: tensor([1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1])
seqlen: 95
task_name: Textual/Abt-Buy
=======================
step: 0, task: Textual/Abt-Buy, loss: 0.04313230887055397
step: 10, task: Textual/Abt-Buy, loss: 0.05073228478431702
step: 20, task: Textual/Abt-Buy, loss: 0.03478055074810982
step: 30, task: Textual/Abt-Buy, loss: 0.04354105144739151
step: 40, task: Textual/Abt-Buy, loss: 0.22708679735660553
step: 50, task: Textual/Abt-Buy, loss: 0.026906639337539673
step: 60, task: Textual/Abt-Buy, loss: 0.09998595714569092
step: 70, task: Textual/Abt-Buy, loss: 0.05973351374268532
step: 80, task: Textual/Abt-Buy, loss: 0.10021920502185822
step: 90, task: Textual/Abt-Buy, loss: 0.03672879561781883
step: 100, task: Textual/Abt-Buy, loss: 0.05054911971092224
step: 110, task: Textual/Abt-Buy, loss: 0.0012925416231155396
step: 120, task: Textual/Abt-Buy, loss: 0.00117415189743042
step: 130, task: Textual/Abt-Buy, loss: 0.14113813638687134
step: 140, task: Textual/Abt-Buy, loss: 0.008890688419342041
step: 150, task: Textual/Abt-Buy, loss: 0.008763961493968964
step: 160, task: Textual/Abt-Buy, loss: 0.0012155920267105103
step: 170, task: Textual/Abt-Buy, loss: 0.022403083741664886
step: 180, task: Textual/Abt-Buy, loss: 0.0956563800573349
step: 190, task: Textual/Abt-Buy, loss: 0.006277121603488922
step: 200, task: Textual/Abt-Buy, loss: 0.1949905902147293
step: 210, task: Textual/Abt-Buy, loss: 0.06767450273036957
step: 220, task: Textual/Abt-Buy, loss: 0.01504451408982277
step: 230, task: Textual/Abt-Buy, loss: 0.005595855414867401
step: 240, task: Textual/Abt-Buy, loss: 0.0004691481590270996
step: 250, task: Textual/Abt-Buy, loss: 0.1848631054162979
step: 260, task: Textual/Abt-Buy, loss: 0.0513743981719017
step: 270, task: Textual/Abt-Buy, loss: 0.03872602432966232
step: 280, task: Textual/Abt-Buy, loss: 0.08955374360084534
step: 290, task: Textual/Abt-Buy, loss: 0.032382674515247345
step: 300, task: Textual/Abt-Buy, loss: 0.016564179211854935
step: 310, task: Textual/Abt-Buy, loss: 0.016815461218357086
step: 320, task: Textual/Abt-Buy, loss: 0.021016761660575867
step: 330, task: Textual/Abt-Buy, loss: 0.07362533360719681
step: 340, task: Textual/Abt-Buy, loss: 0.09481590986251831
step: 350, task: Textual/Abt-Buy, loss: 0.09709154069423676
=========eval at epoch=3=========
Validation:
=============Textual/Abt-Buy==================
accuracy=0.933
precision=0.779
recall=0.529
f1=0.630
======================================
Test:
=============Textual/Abt-Buy==================
accuracy=0.934
precision=0.737
recall=0.597
f1=0.660
======================================
=====sanity check======
words: COL name VAL sharp over the counter white microwave oven r1211wh COL description VAL sharp over the counter white microwave oven r1211wh 1.5 cu . ft. capacity 1100 watts 19 automatic settings 2-color lighted lcd smart and easy sensor settings auto-touch control panel white finish COL price VAL 269.0  [SEP] COL name VAL sharp 1100 watt over the counter microwave COL description VAL  COL price VAL  
x: [    0 18047   766 27445  4406    81     5  3231  1104 28562 12941   910
  1092  1225 11613 14857  8194 27445  4406    81     5  3231  1104 28562
 12941   910  1092  1225 11613   112     4   245  3729   479 16935     4
  2148 28658 42574   753  8408  9629   132    12 21685  1109   196   784
 28690  2793     8  1365  9626  9629  4485    12 26673   797  2798  1104
  2073 14857   425 27445 36891     4   288  1437     2     2 18047   766
 27445  4406 28658 42738    81     5  3231 28562 14857  8194 27445  1437
 14857   425 27445  1437  1437     2]
tokens: ['<s>', 'COL', 'Ġname', 'ĠVAL', 'Ġsharp', 'Ġover', 'Ġthe', 'Ġcounter', 'Ġwhite', 'Ġmicrowave', 'Ġoven', 'Ġr', '12', '11', 'wh', 'ĠCOL', 'Ġdescription', 'ĠVAL', 'Ġsharp', 'Ġover', 'Ġthe', 'Ġcounter', 'Ġwhite', 'Ġmicrowave', 'Ġoven', 'Ġr', '12', '11', 'wh', 'Ġ1', '.', '5', 'Ġcu', 'Ġ.', 'Ġft', '.', 'Ġcapacity', 'Ġ1100', 'Ġwatts', 'Ġ19', 'Ġautomatic', 'Ġsettings', 'Ġ2', '-', 'color', 'Ġlight', 'ed', 'Ġl', 'cd', 'Ġsmart', 'Ġand', 'Ġeasy', 'Ġsensor', 'Ġsettings', 'Ġauto', '-', 'touch', 'Ġcontrol', 'Ġpanel', 'Ġwhite', 'Ġfinish', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ269', '.', '0', 'Ġ', '</s>', '</s>', 'COL', 'Ġname', 'ĠVAL', 'Ġsharp', 'Ġ1100', 'Ġwatt', 'Ġover', 'Ġthe', 'Ġcounter', 'Ġmicrowave', 'ĠCOL', 'Ġdescription', 'ĠVAL', 'Ġ', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ', 'Ġ', '</s>']
is_heads: [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
y: 1
tags: 1
mask: tensor([1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1])
seqlen: 90
task_name: Textual/Abt-Buy
=======================
step: 0, task: Textual/Abt-Buy, loss: 0.12106574326753616
step: 10, task: Textual/Abt-Buy, loss: 0.0014089196920394897
step: 20, task: Textual/Abt-Buy, loss: 0.39106273651123047
step: 30, task: Textual/Abt-Buy, loss: 0.03972475975751877
step: 40, task: Textual/Abt-Buy, loss: 0.00292842835187912
step: 50, task: Textual/Abt-Buy, loss: 0.002331554889678955
step: 60, task: Textual/Abt-Buy, loss: 0.014294236898422241
step: 70, task: Textual/Abt-Buy, loss: 0.07977522164583206
step: 80, task: Textual/Abt-Buy, loss: 0.21908241510391235
step: 90, task: Textual/Abt-Buy, loss: 0.04037441685795784
step: 100, task: Textual/Abt-Buy, loss: 0.02431110292673111
step: 110, task: Textual/Abt-Buy, loss: 0.015284374356269836
step: 120, task: Textual/Abt-Buy, loss: 0.030354995280504227
step: 130, task: Textual/Abt-Buy, loss: 0.06555883586406708
step: 140, task: Textual/Abt-Buy, loss: 0.07651546597480774
step: 150, task: Textual/Abt-Buy, loss: 0.00868554413318634
step: 160, task: Textual/Abt-Buy, loss: 0.0007245391607284546
step: 170, task: Textual/Abt-Buy, loss: 0.0019150227308273315
step: 180, task: Textual/Abt-Buy, loss: 0.0039797574281692505
step: 190, task: Textual/Abt-Buy, loss: 0.22909805178642273
step: 200, task: Textual/Abt-Buy, loss: 0.0029792189598083496
step: 210, task: Textual/Abt-Buy, loss: 0.0017554163932800293
step: 220, task: Textual/Abt-Buy, loss: 0.1486140638589859
step: 230, task: Textual/Abt-Buy, loss: 0.13879436254501343
step: 240, task: Textual/Abt-Buy, loss: 0.02238374948501587
step: 250, task: Textual/Abt-Buy, loss: 0.005760595202445984
step: 260, task: Textual/Abt-Buy, loss: 0.031852658838033676
step: 270, task: Textual/Abt-Buy, loss: 0.2774107754230499
step: 280, task: Textual/Abt-Buy, loss: 0.05757077783346176
step: 290, task: Textual/Abt-Buy, loss: 0.39213183522224426
step: 300, task: Textual/Abt-Buy, loss: 0.012271389365196228
step: 310, task: Textual/Abt-Buy, loss: 0.0008231699466705322
step: 320, task: Textual/Abt-Buy, loss: 0.010313928127288818
step: 330, task: Textual/Abt-Buy, loss: 0.010687403380870819
step: 340, task: Textual/Abt-Buy, loss: 0.000415802001953125
step: 350, task: Textual/Abt-Buy, loss: 0.0006958991289138794
=========eval at epoch=4=========
Validation:
=============Textual/Abt-Buy==================
accuracy=0.917
precision=0.912
recall=0.252
f1=0.395
======================================
Test:
=============Textual/Abt-Buy==================
accuracy=0.926
precision=0.932
recall=0.335
f1=0.493
======================================
=====sanity check======
words: COL name VAL polk audio sirius satellite radio home tuner srh1000 COL description VAL polk audio sirius satellite radio home tuner srh1000 6-line , front panel graphic display sirius replay tv screen graphical user interface rca stereo & optical digital outputs black finish COL price VAL   [SEP] COL name VAL directed electronics sportster 4 sirius satellite radio receiver sp4tk1 COL description VAL xs fm transmitter 6 lines lcd COL price VAL 169.99 
x: [    0 18047   766 27445  8385   330  6086 21958  6125  7595  3188   184
 27115   254   579 20378 20078 14857  8194 27445  8385   330  6086 21958
  6125  7595  3188   184 27115   254   579 20378 20078   231    12  1902
  2156   760  2798 11267  2332 21958  6125 16462 30016  2441 41806  3018
 12332   910  3245 31436   359 17547  1778 39512   909  2073 14857   425
 27445  1437  1437     2     2 18047   766 27445  3660  8917  2414  3121
   204 21958  6125  7595  3188  4797  2292   306 37001   134 14857  8194
 27445  3023    29   856   119 42055   231  2301   784 28690 14857   425
 27445 28222     4  2831  1437     2]
tokens: ['<s>', 'COL', 'Ġname', 'ĠVAL', 'Ġpol', 'k', 'Ġaudio', 'Ġsir', 'ius', 'Ġsatellite', 'Ġradio', 'Ġhome', 'Ġtun', 'er', 'Ġs', 'rh', '1000', 'ĠCOL', 'Ġdescription', 'ĠVAL', 'Ġpol', 'k', 'Ġaudio', 'Ġsir', 'ius', 'Ġsatellite', 'Ġradio', 'Ġhome', 'Ġtun', 'er', 'Ġs', 'rh', '1000', 'Ġ6', '-', 'line', 'Ġ,', 'Ġfront', 'Ġpanel', 'Ġgraphic', 'Ġdisplay', 'Ġsir', 'ius', 'Ġreplay', 'Ġtv', 'Ġscreen', 'Ġgraphical', 'Ġuser', 'Ġinterface', 'Ġr', 'ca', 'Ġstereo', 'Ġ&', 'Ġoptical', 'Ġdigital', 'Ġoutputs', 'Ġblack', 'Ġfinish', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ', 'Ġ', '</s>', '</s>', 'COL', 'Ġname', 'ĠVAL', 'Ġdirected', 'Ġelectronics', 'Ġsport', 'ster', 'Ġ4', 'Ġsir', 'ius', 'Ġsatellite', 'Ġradio', 'Ġreceiver', 'Ġsp', '4', 'tk', '1', 'ĠCOL', 'Ġdescription', 'ĠVAL', 'Ġx', 's', 'Ġf', 'm', 'Ġtransmitter', 'Ġ6', 'Ġlines', 'Ġl', 'cd', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ169', '.', '99', 'Ġ', '</s>']
is_heads: [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
y: 0
tags: 0
mask: tensor([1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1])
seqlen: 102
task_name: Textual/Abt-Buy
=======================
step: 0, task: Textual/Abt-Buy, loss: 0.0026633739471435547
step: 10, task: Textual/Abt-Buy, loss: 0.16378434002399445
step: 20, task: Textual/Abt-Buy, loss: 0.013201288878917694
step: 30, task: Textual/Abt-Buy, loss: 0.0036317259073257446
step: 40, task: Textual/Abt-Buy, loss: 0.012829780578613281
step: 50, task: Textual/Abt-Buy, loss: 0.0009090304374694824
step: 60, task: Textual/Abt-Buy, loss: 0.00018303096294403076
step: 70, task: Textual/Abt-Buy, loss: 0.00023540854454040527
step: 80, task: Textual/Abt-Buy, loss: 0.040478166192770004
step: 90, task: Textual/Abt-Buy, loss: 0.03212358057498932
step: 100, task: Textual/Abt-Buy, loss: 0.002405688166618347
step: 110, task: Textual/Abt-Buy, loss: 0.07975783199071884
step: 120, task: Textual/Abt-Buy, loss: 0.003596194088459015
step: 130, task: Textual/Abt-Buy, loss: 0.0014476627111434937
step: 140, task: Textual/Abt-Buy, loss: 0.000980675220489502
step: 150, task: Textual/Abt-Buy, loss: 0.000548630952835083
step: 160, task: Textual/Abt-Buy, loss: 0.00788029283285141
step: 170, task: Textual/Abt-Buy, loss: 0.0004162043333053589
step: 180, task: Textual/Abt-Buy, loss: 0.07104495167732239
step: 190, task: Textual/Abt-Buy, loss: 0.004830092191696167
step: 200, task: Textual/Abt-Buy, loss: 0.062157437205314636
step: 210, task: Textual/Abt-Buy, loss: 0.01941770687699318
step: 220, task: Textual/Abt-Buy, loss: 0.001265116035938263
step: 230, task: Textual/Abt-Buy, loss: 0.32950276136398315
step: 240, task: Textual/Abt-Buy, loss: 0.024132609367370605
step: 250, task: Textual/Abt-Buy, loss: 0.008992180228233337
step: 260, task: Textual/Abt-Buy, loss: 0.0028443634510040283
step: 270, task: Textual/Abt-Buy, loss: 0.003367304801940918
step: 280, task: Textual/Abt-Buy, loss: 0.05630742385983467
step: 290, task: Textual/Abt-Buy, loss: 0.0004829317331314087
step: 300, task: Textual/Abt-Buy, loss: 0.0011550933122634888
step: 310, task: Textual/Abt-Buy, loss: 0.012902684509754181
step: 320, task: Textual/Abt-Buy, loss: 0.0009513199329376221
step: 330, task: Textual/Abt-Buy, loss: 0.0002170652151107788
step: 340, task: Textual/Abt-Buy, loss: 0.010992731899023056
step: 350, task: Textual/Abt-Buy, loss: 0.0001678764820098877
=========eval at epoch=5=========
Validation:
=============Textual/Abt-Buy==================
accuracy=0.926
precision=0.901
recall=0.354
f1=0.509
======================================
Test:
=============Textual/Abt-Buy==================
accuracy=0.931
precision=0.884
recall=0.408
f1=0.558
======================================
=====sanity check======
words: COL name VAL canon printer black ink cartridge cli221blk COL description VAL canon printer black ink cartridge cli221blk fine technology for exceptional sharpness and detail compatible with pixma ip3600 , pixma ip4600 , pixma mp620 and pixma mp980 COL price VAL   [SEP] COL name VAL canon cli-8y ink cartridge 0623b002 COL description VAL yellow COL price VAL 13.99 
x: [    0 18047   766 27445 32839 24079   909 16019 41785  3741   118 28730
  3662   330 14857  8194 27445 32839 24079   909 16019 41785  3741   118
 28730  3662   330  2051   806    13  9297  4406  1825     8  4617 16632
    19   181  3181  1916 36180  3367   612  2156   181  3181  1916 36180
  3761   612  2156   181  3181  1916 44857 32994     8   181  3181  1916
 44857 36824 14857   425 27445  1437  1437     2     2 18047   766 27445
 32839  3741   118    12   398   219 16019 41785 15007  1922   428 19130
 14857  8194 27445  5718 14857   425 27445   508     4  2831  1437     2]
tokens: ['<s>', 'COL', 'Ġname', 'ĠVAL', 'Ġcanon', 'Ġprinter', 'Ġblack', 'Ġink', 'Ġcartridge', 'Ġcl', 'i', '221', 'bl', 'k', 'ĠCOL', 'Ġdescription', 'ĠVAL', 'Ġcanon', 'Ġprinter', 'Ġblack', 'Ġink', 'Ġcartridge', 'Ġcl', 'i', '221', 'bl', 'k', 'Ġfine', 'Ġtechnology', 'Ġfor', 'Ġexceptional', 'Ġsharp', 'ness', 'Ġand', 'Ġdetail', 'Ġcompatible', 'Ġwith', 'Ġp', 'ix', 'ma', 'Ġip', '36', '00', 'Ġ,', 'Ġp', 'ix', 'ma', 'Ġip', '46', '00', 'Ġ,', 'Ġp', 'ix', 'ma', 'Ġmp', '620', 'Ġand', 'Ġp', 'ix', 'ma', 'Ġmp', '980', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ', 'Ġ', '</s>', '</s>', 'COL', 'Ġname', 'ĠVAL', 'Ġcanon', 'Ġcl', 'i', '-', '8', 'y', 'Ġink', 'Ġcartridge', 'Ġ06', '23', 'b', '002', 'ĠCOL', 'Ġdescription', 'ĠVAL', 'Ġyellow', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ13', '.', '99', 'Ġ', '</s>']
is_heads: [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
y: 0
tags: 0
mask: tensor([1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1])
seqlen: 96
task_name: Textual/Abt-Buy
=======================
step: 0, task: Textual/Abt-Buy, loss: 0.04565873369574547
step: 10, task: Textual/Abt-Buy, loss: 0.04936593770980835
step: 20, task: Textual/Abt-Buy, loss: 0.0001431107521057129
step: 30, task: Textual/Abt-Buy, loss: 0.028444964438676834
step: 40, task: Textual/Abt-Buy, loss: 0.00024981796741485596
step: 50, task: Textual/Abt-Buy, loss: 0.00021973252296447754
step: 60, task: Textual/Abt-Buy, loss: 0.1345355063676834
step: 70, task: Textual/Abt-Buy, loss: 0.014319147914648056
step: 80, task: Textual/Abt-Buy, loss: 0.002273261547088623
step: 90, task: Textual/Abt-Buy, loss: 0.015699900686740875
step: 100, task: Textual/Abt-Buy, loss: 0.00017111003398895264
step: 110, task: Textual/Abt-Buy, loss: 0.0015056878328323364
step: 120, task: Textual/Abt-Buy, loss: 0.00014793872833251953
step: 130, task: Textual/Abt-Buy, loss: 0.00021943449974060059
step: 140, task: Textual/Abt-Buy, loss: 0.004727080464363098
step: 150, task: Textual/Abt-Buy, loss: 0.0003784596920013428
step: 160, task: Textual/Abt-Buy, loss: 0.00011084973812103271
step: 170, task: Textual/Abt-Buy, loss: 0.0001688748598098755
step: 180, task: Textual/Abt-Buy, loss: 0.021694079041481018
step: 190, task: Textual/Abt-Buy, loss: 8.61436128616333e-05
step: 200, task: Textual/Abt-Buy, loss: 0.0003137737512588501
step: 210, task: Textual/Abt-Buy, loss: 0.001631319522857666
step: 220, task: Textual/Abt-Buy, loss: 0.07357295602560043
step: 230, task: Textual/Abt-Buy, loss: 0.010398335754871368
step: 240, task: Textual/Abt-Buy, loss: 0.0013816356658935547
step: 250, task: Textual/Abt-Buy, loss: 0.0021639540791511536
step: 260, task: Textual/Abt-Buy, loss: 0.03375515341758728
step: 270, task: Textual/Abt-Buy, loss: 0.016012996435165405
step: 280, task: Textual/Abt-Buy, loss: 0.00038670003414154053
step: 290, task: Textual/Abt-Buy, loss: 8.913874626159668e-05
step: 300, task: Textual/Abt-Buy, loss: 7.374584674835205e-05
step: 310, task: Textual/Abt-Buy, loss: 0.0069131553173065186
step: 320, task: Textual/Abt-Buy, loss: 0.024463199079036713
step: 330, task: Textual/Abt-Buy, loss: 0.014817800372838974
step: 340, task: Textual/Abt-Buy, loss: 0.05488116666674614
step: 350, task: Textual/Abt-Buy, loss: 0.00039096176624298096
=========eval at epoch=6=========
Validation:
=============Textual/Abt-Buy==================
accuracy=0.934
precision=0.899
recall=0.432
f1=0.584
======================================
Test:
=============Textual/Abt-Buy==================
accuracy=0.937
precision=0.898
recall=0.471
f1=0.618
======================================
=====sanity check======
words: COL name VAL nikon d700 digital slr digital camera d700body COL description VAL nikon d700 digital slr digital camera d700body 12.1 megapixels fx-format cmos sensor continuous shooting up to 5 frames per second 3 ' super-density 920,000-dot vga color monitor two live view shooting modes rugged magnesium-alloy construction 51-point af with 3d focus tracking dynamic integrated dust reduction system 1,005-pixel 3d color matrix metering ii scene recognition system black finish body only COL price VAL   [SEP] COL name VAL nikon coolpix s610 digital camera midnight black 26125 COL description VAL 10 megapixel 16:9 4x optical zoom 4x digital zoom 3 ' active matrix tft color lcd COL price VAL  
x: [    0 18047   766 27445   295   967   261   385  5987  1778  3369   338
  1778  2280   385  5987  9773 14857  8194 27445   295   967   261   385
  5987  1778  3369   338  1778  2280   385  5987  9773   316     4   134
 10721  1115 41699   856  1178    12 34609 25434   366  9626 11152  1094
    62     7   195 16420   228   200   155   128  2422    12 37373 37543
     6   151    12 33369   748  2538  3195  5271    80   697  1217  1094
 19180 21937 36165    12  1250  2160  1663  4074    12  2300  9724    19
   155   417  1056  6779  6878  6818  8402  4878   467   112     6 31866
    12 44546   155   417  3195 36173  1145  2961 42661  1310  4972   467
   909  2073   809   129 14857   425 27445  1437  1437     2     2 18047
   766 27445   295   967   261  3035   642  3181   579 33375  1778  2280
  5832   909   973 11338 14857  8194 27445   158 10721 21424   545    35
   466   204  1178 17547 21762   204  1178  1778 21762   155   128  2171
 36173   326  2543  3195   784 28690 14857   425 27445  1437  1437     2]
tokens: ['<s>', 'COL', 'Ġname', 'ĠVAL', 'Ġn', 'ik', 'on', 'Ġd', '700', 'Ġdigital', 'Ġsl', 'r', 'Ġdigital', 'Ġcamera', 'Ġd', '700', 'body', 'ĠCOL', 'Ġdescription', 'ĠVAL', 'Ġn', 'ik', 'on', 'Ġd', '700', 'Ġdigital', 'Ġsl', 'r', 'Ġdigital', 'Ġcamera', 'Ġd', '700', 'body', 'Ġ12', '.', '1', 'Ġmeg', 'ap', 'ixels', 'Ġf', 'x', '-', 'format', 'Ġcm', 'os', 'Ġsensor', 'Ġcontinuous', 'Ġshooting', 'Ġup', 'Ġto', 'Ġ5', 'Ġframes', 'Ġper', 'Ġsecond', 'Ġ3', "Ġ'", 'Ġsuper', '-', 'density', 'Ġ920', ',', '000', '-', 'dot', 'Ġv', 'ga', 'Ġcolor', 'Ġmonitor', 'Ġtwo', 'Ġlive', 'Ġview', 'Ġshooting', 'Ġmodes', 'Ġrugged', 'Ġmagnesium', '-', 'all', 'oy', 'Ġconstruction', 'Ġ51', '-', 'point', 'Ġaf', 'Ġwith', 'Ġ3', 'd', 'Ġfocus', 'Ġtracking', 'Ġdynamic', 'Ġintegrated', 'Ġdust', 'Ġreduction', 'Ġsystem', 'Ġ1', ',', '005', '-', 'pixel', 'Ġ3', 'd', 'Ġcolor', 'Ġmatrix', 'Ġmet', 'ering', 'Ġii', 'Ġscene', 'Ġrecognition', 'Ġsystem', 'Ġblack', 'Ġfinish', 'Ġbody', 'Ġonly', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ', 'Ġ', '</s>', '</s>', 'COL', 'Ġname', 'ĠVAL', 'Ġn', 'ik', 'on', 'Ġcool', 'p', 'ix', 'Ġs', '610', 'Ġdigital', 'Ġcamera', 'Ġmidnight', 'Ġblack', 'Ġ26', '125', 'ĠCOL', 'Ġdescription', 'ĠVAL', 'Ġ10', 'Ġmeg', 'apixel', 'Ġ16', ':', '9', 'Ġ4', 'x', 'Ġoptical', 'Ġzoom', 'Ġ4', 'x', 'Ġdigital', 'Ġzoom', 'Ġ3', "Ġ'", 'Ġactive', 'Ġmatrix', 'Ġt', 'ft', 'Ġcolor', 'Ġl', 'cd', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ', 'Ġ', '</s>']
is_heads: [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
y: 0
tags: 0
mask: tensor([1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1])
seqlen: 168
task_name: Textual/Abt-Buy
=======================
step: 0, task: Textual/Abt-Buy, loss: 0.00020806491374969482
step: 10, task: Textual/Abt-Buy, loss: 0.010957576334476471
step: 20, task: Textual/Abt-Buy, loss: 0.01933184266090393
step: 30, task: Textual/Abt-Buy, loss: 0.19919848442077637
step: 40, task: Textual/Abt-Buy, loss: 0.00120466947555542
step: 50, task: Textual/Abt-Buy, loss: 0.0028268471360206604
step: 60, task: Textual/Abt-Buy, loss: 0.0355723537504673
step: 70, task: Textual/Abt-Buy, loss: 0.006579697132110596
step: 80, task: Textual/Abt-Buy, loss: 0.00012770295143127441
step: 90, task: Textual/Abt-Buy, loss: 7.520616054534912e-05
step: 100, task: Textual/Abt-Buy, loss: 8.578598499298096e-05
step: 110, task: Textual/Abt-Buy, loss: 0.004131771624088287
step: 120, task: Textual/Abt-Buy, loss: 9.563565254211426e-05
step: 130, task: Textual/Abt-Buy, loss: 0.000255778431892395
step: 140, task: Textual/Abt-Buy, loss: 0.0002323240041732788
step: 150, task: Textual/Abt-Buy, loss: 0.0001532435417175293
step: 160, task: Textual/Abt-Buy, loss: 0.004591323435306549
step: 170, task: Textual/Abt-Buy, loss: 0.001045525074005127
step: 180, task: Textual/Abt-Buy, loss: 6.884336471557617e-05
step: 190, task: Textual/Abt-Buy, loss: 0.01087973266839981
step: 200, task: Textual/Abt-Buy, loss: 5.981326103210449e-05
step: 210, task: Textual/Abt-Buy, loss: 0.00020171701908111572
step: 220, task: Textual/Abt-Buy, loss: 0.018831364810466766
step: 230, task: Textual/Abt-Buy, loss: 0.02108166366815567
step: 240, task: Textual/Abt-Buy, loss: 0.05090536177158356
step: 250, task: Textual/Abt-Buy, loss: 8.909404277801514e-05
step: 260, task: Textual/Abt-Buy, loss: 8.177757263183594e-05
step: 270, task: Textual/Abt-Buy, loss: 9.746849536895752e-05
step: 280, task: Textual/Abt-Buy, loss: 9.359419345855713e-05
step: 290, task: Textual/Abt-Buy, loss: 0.00013710558414459229
step: 300, task: Textual/Abt-Buy, loss: 0.002810262143611908
step: 310, task: Textual/Abt-Buy, loss: 0.0004749894142150879
step: 320, task: Textual/Abt-Buy, loss: 7.624924182891846e-05
step: 330, task: Textual/Abt-Buy, loss: 9.56803560256958e-05
step: 340, task: Textual/Abt-Buy, loss: 8.048117160797119e-05
step: 350, task: Textual/Abt-Buy, loss: 0.00022815167903900146
=========eval at epoch=7=========
Validation:
=============Textual/Abt-Buy==================
accuracy=0.924
precision=0.942
recall=0.316
f1=0.473
======================================
Test:
=============Textual/Abt-Buy==================
accuracy=0.926
precision=0.944
recall=0.330
f1=0.489
======================================
=====sanity check======
words: COL name VAL sirius stiletto 2 portable satellite radio sl2pk1 COL description VAL sirius stiletto 2 portable satellite radio sl2pk1 sirius replay controls record up to 100 hours stores up to 10 hours of individual songs 2gb internal memory personalized sports ticker srs trubass and 3d focus technologies wifi black finish COL price VAL   [SEP] COL name VAL audiovox satellite radio tuner COL description VAL terk xmrvrfm002 commandermt universal in-car xm receiver COL price VAL  
x: [    0 18047   766 27445 21958  6125  1690  1848 26187   132 15295  7595
  3188  3369   176   642   330   134 14857  8194 27445 21958  6125  1690
  1848 26187   132 15295  7595  3188  3369   176   642   330   134 21958
  6125 16462  5656   638    62     7   727   722  2326    62     7   158
   722     9  1736  3686   132 19562  3425  3783 17159  1612 10457   254
   579  4926  2664  1792  2401     8   155   417  1056  4233 42387   909
  2073 14857   425 27445  1437  1437     2     2 18047   766 27445  9818
 32822  4325  7595  3188 27115   254 14857  8194 27445  8470   330  3023
 35685 37032 40523 19130  5936  8362    90 10547    11    12  5901  3023
   119  4797 14857   425 27445  1437  1437     2]
tokens: ['<s>', 'COL', 'Ġname', 'ĠVAL', 'Ġsir', 'ius', 'Ġst', 'ile', 'tto', 'Ġ2', 'Ġportable', 'Ġsatellite', 'Ġradio', 'Ġsl', '2', 'p', 'k', '1', 'ĠCOL', 'Ġdescription', 'ĠVAL', 'Ġsir', 'ius', 'Ġst', 'ile', 'tto', 'Ġ2', 'Ġportable', 'Ġsatellite', 'Ġradio', 'Ġsl', '2', 'p', 'k', '1', 'Ġsir', 'ius', 'Ġreplay', 'Ġcontrols', 'Ġrecord', 'Ġup', 'Ġto', 'Ġ100', 'Ġhours', 'Ġstores', 'Ġup', 'Ġto', 'Ġ10', 'Ġhours', 'Ġof', 'Ġindividual', 'Ġsongs', 'Ġ2', 'gb', 'Ġinternal', 'Ġmemory', 'Ġpersonalized', 'Ġsports', 'Ġtick', 'er', 'Ġs', 'rs', 'Ġtr', 'ub', 'ass', 'Ġand', 'Ġ3', 'd', 'Ġfocus', 'Ġtechnologies', 'Ġwifi', 'Ġblack', 'Ġfinish', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ', 'Ġ', '</s>', '</s>', 'COL', 'Ġname', 'ĠVAL', 'Ġaud', 'iov', 'ox', 'Ġsatellite', 'Ġradio', 'Ġtun', 'er', 'ĠCOL', 'Ġdescription', 'ĠVAL', 'Ġter', 'k', 'Ġx', 'mr', 'vr', 'fm', '002', 'Ġcommand', 'erm', 't', 'Ġuniversal', 'Ġin', '-', 'car', 'Ġx', 'm', 'Ġreceiver', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ', 'Ġ', '</s>']
is_heads: [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
y: 0
tags: 0
mask: tensor([1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1])
seqlen: 116
task_name: Textual/Abt-Buy
=======================
step: 0, task: Textual/Abt-Buy, loss: 7.084012031555176e-05
step: 10, task: Textual/Abt-Buy, loss: 5.015730857849121e-05
step: 20, task: Textual/Abt-Buy, loss: 5.4895877838134766e-05
step: 30, task: Textual/Abt-Buy, loss: 0.00013208389282226562
step: 40, task: Textual/Abt-Buy, loss: 4.544854164123535e-05
step: 50, task: Textual/Abt-Buy, loss: 0.00019931793212890625
step: 60, task: Textual/Abt-Buy, loss: 0.020485997200012207
step: 70, task: Textual/Abt-Buy, loss: 0.13875241577625275
step: 80, task: Textual/Abt-Buy, loss: 0.00020679831504821777
step: 90, task: Textual/Abt-Buy, loss: 7.18832015991211e-05
step: 100, task: Textual/Abt-Buy, loss: 0.022331420332193375
step: 110, task: Textual/Abt-Buy, loss: 4.285573959350586e-05
step: 120, task: Textual/Abt-Buy, loss: 0.007712431252002716
step: 130, task: Textual/Abt-Buy, loss: 7.568299770355225e-05
step: 140, task: Textual/Abt-Buy, loss: 7.53551721572876e-05
step: 150, task: Textual/Abt-Buy, loss: 0.00041472911834716797
step: 160, task: Textual/Abt-Buy, loss: 0.02227967232465744
step: 170, task: Textual/Abt-Buy, loss: 6.538629531860352e-05
step: 180, task: Textual/Abt-Buy, loss: 0.2851704955101013
step: 190, task: Textual/Abt-Buy, loss: 0.00010810792446136475
step: 200, task: Textual/Abt-Buy, loss: 6.16908073425293e-05
step: 210, task: Textual/Abt-Buy, loss: 0.00026538968086242676
step: 220, task: Textual/Abt-Buy, loss: 0.0004558265209197998
step: 230, task: Textual/Abt-Buy, loss: 7.171928882598877e-05
step: 240, task: Textual/Abt-Buy, loss: 8.821487426757812e-05
step: 250, task: Textual/Abt-Buy, loss: 0.020260725170373917
step: 260, task: Textual/Abt-Buy, loss: 0.00010973215103149414
step: 270, task: Textual/Abt-Buy, loss: 0.013127177953720093
step: 280, task: Textual/Abt-Buy, loss: 0.0005636662244796753
step: 290, task: Textual/Abt-Buy, loss: 0.0013332962989807129
step: 300, task: Textual/Abt-Buy, loss: 9.22083854675293e-05
step: 310, task: Textual/Abt-Buy, loss: 0.020390693098306656
step: 320, task: Textual/Abt-Buy, loss: 5.0067901611328125e-05
step: 330, task: Textual/Abt-Buy, loss: 0.00021067261695861816
step: 340, task: Textual/Abt-Buy, loss: 0.0014228969812393188
step: 350, task: Textual/Abt-Buy, loss: 0.022001996636390686
=========eval at epoch=8=========
Validation:
=============Textual/Abt-Buy==================
accuracy=0.934
precision=0.944
recall=0.408
f1=0.569
======================================
Test:
=============Textual/Abt-Buy==================
accuracy=0.933
precision=0.964
recall=0.393
f1=0.559
======================================
Selected optimization level O2:  FP16 training with FP32 batchnorm and FP32 master weights.

Defaults for this optimization level are:
enabled                : True
opt_level              : O2
cast_model_type        : torch.float16
patch_torch_functions  : False
keep_batchnorm_fp32    : True
master_weights         : True
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O2
cast_model_type        : torch.float16
patch_torch_functions  : False
keep_batchnorm_fp32    : True
master_weights         : True
loss_scale             : dynamic
Warning:  multi_tensor_applier fused unscale kernel is unavailable, possibly because apex was installed without --cuda_ext --cpp_ext. Using Python fallback.  Original ImportError was: ModuleNotFoundError("No module named 'amp_C'")
Gradient overflow.  Skipping step, loss scaler 0 reducing loss scale to 32768.0
=====sanity check======
words: COL name VAL sony black 5.1 channel home theater system htddwg700 COL description VAL sony black 5.1 channel home theater system htddwg700 5.1 channel 900 watts power portable audio enhancer with front audio input ipod cradle digital cinema auto calibration bravia sync digital media port black finish COL price VAL 199.0  [SEP] COL name VAL panasonic sc-bt100 home theater system sc-bt100p-k COL description VAL bd player , 5.1 speakers 1 disc ( s ) progressive scan 1250w rms dolby digital , dolby truehd , dolby digital plus , dts-hd , dts COL price VAL  
x: [    0 18047   766 27445   579  6119   909   195     4   134  4238   184
  7364   467  1368    90 16134   605   571  5987 14857  8194 27445   579
  6119   909   195     4   134  4238   184  7364   467  1368    90 16134
   605   571  5987   195     4   134  4238 10742 42574   476 15295  6086
 45378 20126    19   760  6086  8135 36180  1630 39111  1778 11605  4485
 42269 35977   493 22785  1778   433  4103   909  2073 14857   425 27445
 29272     4   288  1437     2     2 18047   766 27445  5730 38703  2850
    12 25933  1866   184  7364   467  2850    12 25933  1866   642    12
   330 14857  8194 27445   741   417   869  2156   195     4   134  6864
   112  9553    36   579  4839  8212 14194   316  1096   605   910  4339
   385  1168  1409  1778  2156   385  1168  1409  1528 35905  2156   385
  1168  1409  1778  2704  2156   385  1872    12 35905  2156   385  1872
 14857   425 27445  1437  1437     2]
tokens: ['<s>', 'COL', 'Ġname', 'ĠVAL', 'Ġs', 'ony', 'Ġblack', 'Ġ5', '.', '1', 'Ġchannel', 'Ġhome', 'Ġtheater', 'Ġsystem', 'Ġh', 't', 'dd', 'w', 'g', '700', 'ĠCOL', 'Ġdescription', 'ĠVAL', 'Ġs', 'ony', 'Ġblack', 'Ġ5', '.', '1', 'Ġchannel', 'Ġhome', 'Ġtheater', 'Ġsystem', 'Ġh', 't', 'dd', 'w', 'g', '700', 'Ġ5', '.', '1', 'Ġchannel', 'Ġ900', 'Ġwatts', 'Ġpower', 'Ġportable', 'Ġaudio', 'Ġenh', 'ancer', 'Ġwith', 'Ġfront', 'Ġaudio', 'Ġinput', 'Ġip', 'od', 'Ġcradle', 'Ġdigital', 'Ġcinema', 'Ġauto', 'Ġcalibration', 'Ġbrav', 'ia', 'Ġsync', 'Ġdigital', 'Ġmedia', 'Ġport', 'Ġblack', 'Ġfinish', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ199', '.', '0', 'Ġ', '</s>', '</s>', 'COL', 'Ġname', 'ĠVAL', 'Ġpan', 'asonic', 'Ġsc', '-', 'bt', '100', 'Ġhome', 'Ġtheater', 'Ġsystem', 'Ġsc', '-', 'bt', '100', 'p', '-', 'k', 'ĠCOL', 'Ġdescription', 'ĠVAL', 'Ġb', 'd', 'Ġplayer', 'Ġ,', 'Ġ5', '.', '1', 'Ġspeakers', 'Ġ1', 'Ġdisc', 'Ġ(', 'Ġs', 'Ġ)', 'Ġprogressive', 'Ġscan', 'Ġ12', '50', 'w', 'Ġr', 'ms', 'Ġd', 'ol', 'by', 'Ġdigital', 'Ġ,', 'Ġd', 'ol', 'by', 'Ġtrue', 'hd', 'Ġ,', 'Ġd', 'ol', 'by', 'Ġdigital', 'Ġplus', 'Ġ,', 'Ġd', 'ts', '-', 'hd', 'Ġ,', 'Ġd', 'ts', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ', 'Ġ', '</s>']
is_heads: [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
y: 0
tags: 0
mask: tensor([1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1])
seqlen: 150
task_name: Textual/Abt-Buy
=======================
step: 0, task: Textual/Abt-Buy, loss: 0.46487703919410706
Gradient overflow.  Skipping step, loss scaler 0 reducing loss scale to 16384.0
Gradient overflow.  Skipping step, loss scaler 0 reducing loss scale to 8192.0
step: 10, task: Textual/Abt-Buy, loss: 0.5007184743881226
step: 20, task: Textual/Abt-Buy, loss: 0.473117470741272
step: 30, task: Textual/Abt-Buy, loss: 0.5414697527885437
step: 40, task: Textual/Abt-Buy, loss: 0.5489161610603333
step: 50, task: Textual/Abt-Buy, loss: 0.29116374254226685
step: 60, task: Textual/Abt-Buy, loss: 0.13338196277618408
step: 70, task: Textual/Abt-Buy, loss: 0.3427595794200897
step: 80, task: Textual/Abt-Buy, loss: 0.22686219215393066
step: 90, task: Textual/Abt-Buy, loss: 0.41748571395874023
step: 100, task: Textual/Abt-Buy, loss: 0.588812530040741
step: 110, task: Textual/Abt-Buy, loss: 0.22774773836135864
step: 120, task: Textual/Abt-Buy, loss: 0.5696081519126892
step: 130, task: Textual/Abt-Buy, loss: 0.7964662909507751
step: 140, task: Textual/Abt-Buy, loss: 0.26755771040916443
step: 150, task: Textual/Abt-Buy, loss: 0.4516935348510742
step: 160, task: Textual/Abt-Buy, loss: 0.17610891163349152
step: 170, task: Textual/Abt-Buy, loss: 0.5167520642280579
step: 180, task: Textual/Abt-Buy, loss: 0.2118385136127472
step: 190, task: Textual/Abt-Buy, loss: 0.5618472695350647
step: 200, task: Textual/Abt-Buy, loss: 0.2737848460674286
step: 210, task: Textual/Abt-Buy, loss: 0.23791062831878662
step: 220, task: Textual/Abt-Buy, loss: 0.48351210355758667
step: 230, task: Textual/Abt-Buy, loss: 0.6121423244476318
step: 240, task: Textual/Abt-Buy, loss: 0.2501910924911499
step: 250, task: Textual/Abt-Buy, loss: 0.6569461822509766
step: 260, task: Textual/Abt-Buy, loss: 0.3343437612056732
step: 270, task: Textual/Abt-Buy, loss: 0.2713257074356079
step: 280, task: Textual/Abt-Buy, loss: 0.3294769525527954
step: 290, task: Textual/Abt-Buy, loss: 0.3898743689060211
step: 300, task: Textual/Abt-Buy, loss: 0.2807956635951996
step: 310, task: Textual/Abt-Buy, loss: 0.28800472617149353
step: 320, task: Textual/Abt-Buy, loss: 0.675555944442749
step: 330, task: Textual/Abt-Buy, loss: 0.16631825268268585
step: 340, task: Textual/Abt-Buy, loss: 0.17374306917190552
step: 350, task: Textual/Abt-Buy, loss: 0.2618885934352875
=========eval at epoch=1=========
Validation:
=============Textual/Abt-Buy==================
accuracy=0.892
precision=0.000
recall=0.000
f1=0.000
======================================
Test:
=============Textual/Abt-Buy==================
accuracy=0.892
precision=0.000
recall=0.000
f1=0.000
======================================
/w/246/tianyu2020/miniconda2/envs/ditto/lib/python3.7/site-packages/apex/amp/_initialize.py:24: UserWarning: An input tensor was not cuda.
  warnings.warn("An input tensor was not cuda.")
/w/246/tianyu2020/miniconda2/envs/ditto/lib/python3.7/site-packages/torch/optim/lr_scheduler.py:122: UserWarning: Detected call of `lr_scheduler.step()` before `optimizer.step()`. In PyTorch 1.1.0 and later, you should call them in the opposite order: `optimizer.step()` before `lr_scheduler.step()`.  Failure to do this will result in PyTorch skipping the first value of the learning rate schedule. See more details at https://pytorch.org/docs/stable/optim.html#how-to-adjust-learning-rate
  "https://pytorch.org/docs/stable/optim.html#how-to-adjust-learning-rate", UserWarning)
/w/246/tianyu2020/miniconda2/envs/ditto/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1221: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
=====sanity check======
words: COL name VAL apple 32gb black 2nd generation ipod touch mb533lla COL description VAL apple 32gb black 2nd generation ipod touch mb533lla holds up to 7,000 songs in 128-kbps aac format , 25,000 ipod-viewable photos and 40 hours of video wi-fi ( 802.11 b/g ) nike + ipod support built-in maps location-based service 3.5 ' ( diagonal ) widescreen multi-touch display 480x320-pixel resolution 480p and 576p component tv out mac and windows compatible black finish COL price VAL 399.0  [SEP] COL name VAL apple ipod touch 16gb flash portable media player mb531lla COL description VAL audio player , video player , photo viewer 3.5 ' color lcd 16gb flash memory COL price VAL 309.99 
x: [    0 18047   766 27445 15162  2107 19562   909   132  1187  2706 36180
  1630  2842   475   428 38037  5104 14857  8194 27445 15162  2107 19562
   909   132  1187  2706 36180  1630  2842   475   428 38037  5104  3106
    62     7   262     6   151  3686    11 13950    12   330 27072    10
  1043  7390  2156   564     6   151 36180  1630    12  5877   868  2356
     8   843   722     9   569 33755    12  9169    36 31551     4  1225
   741    73   571  4839   295  4348  2055 36180  1630   323  1490    12
   179 12879  2259    12   805   544   155     4   245   128    36 42539
  4839   885  4376 37346  3228    12 26673  2332 26754  1178 17655    12
 44546  3547 26754   642     8   195  5067   642  7681 30016    66 13418
     8  6410 16632   909  2073 14857   425 27445 41279     4   288  1437
     2     2 18047   766 27445 15162 36180  1630  2842   545 19562  7462
 15295   433   869   475   428   245  2983  5104 14857  8194 27445  6086
   869  2156   569   869  2156  1345 18754   155     4   245   128  3195
   784 28690   545 19562  7462  3783 14857   425 27445 36402     4  2831
  1437     2]
tokens: ['<s>', 'COL', 'Ġname', 'ĠVAL', 'Ġapple', 'Ġ32', 'gb', 'Ġblack', 'Ġ2', 'nd', 'Ġgeneration', 'Ġip', 'od', 'Ġtouch', 'Ġm', 'b', '533', 'lla', 'ĠCOL', 'Ġdescription', 'ĠVAL', 'Ġapple', 'Ġ32', 'gb', 'Ġblack', 'Ġ2', 'nd', 'Ġgeneration', 'Ġip', 'od', 'Ġtouch', 'Ġm', 'b', '533', 'lla', 'Ġholds', 'Ġup', 'Ġto', 'Ġ7', ',', '000', 'Ġsongs', 'Ġin', 'Ġ128', '-', 'k', 'bps', 'Ġa', 'ac', 'Ġformat', 'Ġ,', 'Ġ25', ',', '000', 'Ġip', 'od', '-', 'view', 'able', 'Ġphotos', 'Ġand', 'Ġ40', 'Ġhours', 'Ġof', 'Ġvideo', 'Ġwi', '-', 'fi', 'Ġ(', 'Ġ802', '.', '11', 'Ġb', '/', 'g', 'Ġ)', 'Ġn', 'ike', 'Ġ+', 'Ġip', 'od', 'Ġsupport', 'Ġbuilt', '-', 'in', 'Ġmaps', 'Ġlocation', '-', 'based', 'Ġservice', 'Ġ3', '.', '5', "Ġ'", 'Ġ(', 'Ġdiagonal', 'Ġ)', 'Ġw', 'ides', 'creen', 'Ġmulti', '-', 'touch', 'Ġdisplay', 'Ġ480', 'x', '320', '-', 'pixel', 'Ġresolution', 'Ġ480', 'p', 'Ġand', 'Ġ5', '76', 'p', 'Ġcomponent', 'Ġtv', 'Ġout', 'Ġmac', 'Ġand', 'Ġwindows', 'Ġcompatible', 'Ġblack', 'Ġfinish', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ399', '.', '0', 'Ġ', '</s>', '</s>', 'COL', 'Ġname', 'ĠVAL', 'Ġapple', 'Ġip', 'od', 'Ġtouch', 'Ġ16', 'gb', 'Ġflash', 'Ġportable', 'Ġmedia', 'Ġplayer', 'Ġm', 'b', '5', '31', 'lla', 'ĠCOL', 'Ġdescription', 'ĠVAL', 'Ġaudio', 'Ġplayer', 'Ġ,', 'Ġvideo', 'Ġplayer', 'Ġ,', 'Ġphoto', 'Ġviewer', 'Ġ3', '.', '5', "Ġ'", 'Ġcolor', 'Ġl', 'cd', 'Ġ16', 'gb', 'Ġflash', 'Ġmemory', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ309', '.', '99', 'Ġ', '</s>']
is_heads: [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
y: 0
tags: 0
mask: tensor([1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1])
seqlen: 182
task_name: Textual/Abt-Buy
=======================
step: 0, task: Textual/Abt-Buy, loss: 0.462484210729599
step: 10, task: Textual/Abt-Buy, loss: 0.47130149602890015
step: 20, task: Textual/Abt-Buy, loss: 0.2262476682662964
step: 30, task: Textual/Abt-Buy, loss: 0.26977163553237915
step: 40, task: Textual/Abt-Buy, loss: 0.4125204086303711
step: 50, task: Textual/Abt-Buy, loss: 0.2902395725250244
step: 60, task: Textual/Abt-Buy, loss: 0.2608804702758789
step: 70, task: Textual/Abt-Buy, loss: 0.5911399722099304
step: 80, task: Textual/Abt-Buy, loss: 0.3909757733345032
step: 90, task: Textual/Abt-Buy, loss: 0.010536178946495056
step: 100, task: Textual/Abt-Buy, loss: 0.3155517578125
step: 110, task: Textual/Abt-Buy, loss: 0.05852896347641945
step: 120, task: Textual/Abt-Buy, loss: 0.22856369614601135
step: 130, task: Textual/Abt-Buy, loss: 0.38693973422050476
step: 140, task: Textual/Abt-Buy, loss: 0.3613872230052948
step: 150, task: Textual/Abt-Buy, loss: 0.18907156586647034
step: 160, task: Textual/Abt-Buy, loss: 0.08708415180444717
step: 170, task: Textual/Abt-Buy, loss: 0.0495929941534996
step: 180, task: Textual/Abt-Buy, loss: 0.09404421597719193
step: 190, task: Textual/Abt-Buy, loss: 0.5505138635635376
step: 200, task: Textual/Abt-Buy, loss: 0.16852854192256927
step: 210, task: Textual/Abt-Buy, loss: 0.21817824244499207
step: 220, task: Textual/Abt-Buy, loss: 0.07747842371463776
step: 230, task: Textual/Abt-Buy, loss: 0.02332780510187149
step: 240, task: Textual/Abt-Buy, loss: 0.03473267704248428
step: 250, task: Textual/Abt-Buy, loss: 0.10492435097694397
step: 260, task: Textual/Abt-Buy, loss: 0.04763663187623024
step: 270, task: Textual/Abt-Buy, loss: 0.13382276892662048
step: 280, task: Textual/Abt-Buy, loss: 0.03241325169801712
step: 290, task: Textual/Abt-Buy, loss: 0.05667344853281975
step: 300, task: Textual/Abt-Buy, loss: 0.03360545635223389
step: 310, task: Textual/Abt-Buy, loss: 0.08381065726280212
step: 320, task: Textual/Abt-Buy, loss: 0.11517160385847092
step: 330, task: Textual/Abt-Buy, loss: 0.03125288337469101
step: 340, task: Textual/Abt-Buy, loss: 0.023297637701034546
step: 350, task: Textual/Abt-Buy, loss: 0.3222775459289551
=========eval at epoch=1=========
Validation:
=============Textual/Abt-Buy==================
accuracy=0.922
precision=0.828
recall=0.350
f1=0.491
======================================
Test:
=============Textual/Abt-Buy==================
accuracy=0.932
precision=0.845
recall=0.451
f1=0.589
======================================
=====sanity check======
words: COL name VAL sanus 15 ' to 40 ' flat panel black tv wall mount ml22b1 COL description VAL sanus 15 ' to 40 ' flat panel black tv wall mount ml22b1 solid heavy-gauge steel construction durable powder-coated finish fits most medium flat panel lcd tvs up to 100 lbs black finish COL price VAL   [SEP] COL name VAL sanus visionmount flat panel tv wall mount vmpl3b COL description VAL steel 280 lb COL price VAL 144.05 
x: [    0 18047   766 27445 15610   687   379   128     7   843   128  3269
  2798   909 30016  2204 14206 36769  2036   428   134 14857  8194 27445
 15610   687   379   128     7   843   128  3269  2798   909 30016  2204
 14206 36769  2036   428   134  2705  2016    12   571  1180  1899  3689
  1663 18300 10477    12   876  1070  2073 10698   144  4761  3269  2798
   784 28690   326 15597    62     7   727 23246   909  2073 14857   425
 27445  1437  1437     2     2 18047   766 27445 15610   687  3360 17336
  3269  2798 30016  2204 14206 48643  2911   246   428 14857  8194 27445
  3689 20688 19821 14857   425 27445 19641     4  2546  1437     2]
tokens: ['<s>', 'COL', 'Ġname', 'ĠVAL', 'Ġsan', 'us', 'Ġ15', "Ġ'", 'Ġto', 'Ġ40', "Ġ'", 'Ġflat', 'Ġpanel', 'Ġblack', 'Ġtv', 'Ġwall', 'Ġmount', 'Ġml', '22', 'b', '1', 'ĠCOL', 'Ġdescription', 'ĠVAL', 'Ġsan', 'us', 'Ġ15', "Ġ'", 'Ġto', 'Ġ40', "Ġ'", 'Ġflat', 'Ġpanel', 'Ġblack', 'Ġtv', 'Ġwall', 'Ġmount', 'Ġml', '22', 'b', '1', 'Ġsolid', 'Ġheavy', '-', 'g', 'au', 'ge', 'Ġsteel', 'Ġconstruction', 'Ġdurable', 'Ġpowder', '-', 'co', 'ated', 'Ġfinish', 'Ġfits', 'Ġmost', 'Ġmedium', 'Ġflat', 'Ġpanel', 'Ġl', 'cd', 'Ġt', 'vs', 'Ġup', 'Ġto', 'Ġ100', 'Ġlbs', 'Ġblack', 'Ġfinish', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ', 'Ġ', '</s>', '</s>', 'COL', 'Ġname', 'ĠVAL', 'Ġsan', 'us', 'Ġvision', 'mount', 'Ġflat', 'Ġpanel', 'Ġtv', 'Ġwall', 'Ġmount', 'Ġvm', 'pl', '3', 'b', 'ĠCOL', 'Ġdescription', 'ĠVAL', 'Ġsteel', 'Ġ280', 'Ġlb', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ144', '.', '05', 'Ġ', '</s>']
is_heads: [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
y: 0
tags: 0
mask: tensor([1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1])
seqlen: 107
task_name: Textual/Abt-Buy
=======================
step: 0, task: Textual/Abt-Buy, loss: 0.05077723413705826
step: 10, task: Textual/Abt-Buy, loss: 0.10995858907699585
step: 20, task: Textual/Abt-Buy, loss: 0.16400903463363647
step: 30, task: Textual/Abt-Buy, loss: 0.04426213353872299
step: 40, task: Textual/Abt-Buy, loss: 0.1679759919643402
step: 50, task: Textual/Abt-Buy, loss: 0.008499190211296082
step: 60, task: Textual/Abt-Buy, loss: 0.05808280408382416
step: 70, task: Textual/Abt-Buy, loss: 0.10829775035381317
step: 80, task: Textual/Abt-Buy, loss: 0.2735666036605835
step: 90, task: Textual/Abt-Buy, loss: 0.07931390404701233
step: 100, task: Textual/Abt-Buy, loss: 0.0717088133096695
step: 110, task: Textual/Abt-Buy, loss: 0.11794102191925049
step: 120, task: Textual/Abt-Buy, loss: 0.11121506989002228
step: 130, task: Textual/Abt-Buy, loss: 0.013946115970611572
step: 140, task: Textual/Abt-Buy, loss: 0.02757393568754196
step: 150, task: Textual/Abt-Buy, loss: 0.09987116605043411
step: 160, task: Textual/Abt-Buy, loss: 0.11350774765014648
step: 170, task: Textual/Abt-Buy, loss: 0.12362109869718552
step: 180, task: Textual/Abt-Buy, loss: 0.008875027298927307
step: 190, task: Textual/Abt-Buy, loss: 0.032854221761226654
step: 200, task: Textual/Abt-Buy, loss: 0.01689463108778
step: 210, task: Textual/Abt-Buy, loss: 0.16118264198303223
step: 220, task: Textual/Abt-Buy, loss: 0.07210016250610352
step: 230, task: Textual/Abt-Buy, loss: 0.12852682173252106
step: 240, task: Textual/Abt-Buy, loss: 0.0569644533097744
step: 250, task: Textual/Abt-Buy, loss: 0.024259410798549652
step: 260, task: Textual/Abt-Buy, loss: 0.009266689419746399
step: 270, task: Textual/Abt-Buy, loss: 0.0024666935205459595
step: 280, task: Textual/Abt-Buy, loss: 0.03858577832579613
step: 290, task: Textual/Abt-Buy, loss: 0.051905058324337006
step: 300, task: Textual/Abt-Buy, loss: 0.04617359861731529
step: 310, task: Textual/Abt-Buy, loss: 0.06521625816822052
step: 320, task: Textual/Abt-Buy, loss: 0.15366141498088837
step: 330, task: Textual/Abt-Buy, loss: 0.028946615755558014
step: 340, task: Textual/Abt-Buy, loss: 0.021278880536556244
step: 350, task: Textual/Abt-Buy, loss: 0.006621256470680237
=========eval at epoch=2=========
Validation:
=============Textual/Abt-Buy==================
accuracy=0.928
precision=0.959
recall=0.345
f1=0.507
======================================
Test:
=============Textual/Abt-Buy==================
accuracy=0.927
precision=0.875
recall=0.374
f1=0.524
======================================
=====sanity check======
words: COL name VAL panasonic lithium ion rechargeable battery black finish cgrs006a1b COL description VAL panasonic lithium ion rechargeable battery cgrs006a1b compatible with dmcfz7 and dmcfz30 digital cameras COL price VAL   [SEP] COL name VAL panasonic lithium ion digital camera battery cgr-s006a / 1b COL description VAL lithium ion ( li-ion ) photo battery COL price VAL 49.99 
x: [    0 18047   766 27445  5730 38703 16904 31973 25850   868  3822   909
  2073   740  6504    29 38049   102   134   428 14857  8194 27445  5730
 38703 16904 31973 25850   868  3822   740  6504    29 38049   102   134
   428 16632    19   385   119 19911   329   406     8   385   119 19911
   329   541  1778  4387 14857   425 27445  1437  1437     2     2 18047
   766 27445  5730 38703 16904 31973  1778  2280  3822   740  6504    12
    29 38049   102  1589   112   428 14857  8194 27445 16904 31973    36
 16787    12  1499  4839  1345  3822 14857   425 27445  2766     4  2831
  1437     2]
tokens: ['<s>', 'COL', 'Ġname', 'ĠVAL', 'Ġpan', 'asonic', 'Ġlithium', 'Ġion', 'Ġrecharge', 'able', 'Ġbattery', 'Ġblack', 'Ġfinish', 'Ġc', 'gr', 's', '006', 'a', '1', 'b', 'ĠCOL', 'Ġdescription', 'ĠVAL', 'Ġpan', 'asonic', 'Ġlithium', 'Ġion', 'Ġrecharge', 'able', 'Ġbattery', 'Ġc', 'gr', 's', '006', 'a', '1', 'b', 'Ġcompatible', 'Ġwith', 'Ġd', 'm', 'cf', 'z', '7', 'Ġand', 'Ġd', 'm', 'cf', 'z', '30', 'Ġdigital', 'Ġcameras', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ', 'Ġ', '</s>', '</s>', 'COL', 'Ġname', 'ĠVAL', 'Ġpan', 'asonic', 'Ġlithium', 'Ġion', 'Ġdigital', 'Ġcamera', 'Ġbattery', 'Ġc', 'gr', '-', 's', '006', 'a', 'Ġ/', 'Ġ1', 'b', 'ĠCOL', 'Ġdescription', 'ĠVAL', 'Ġlithium', 'Ġion', 'Ġ(', 'Ġli', '-', 'ion', 'Ġ)', 'Ġphoto', 'Ġbattery', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ49', '.', '99', 'Ġ', '</s>']
is_heads: [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
y: 1
tags: 1
mask: tensor([1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1])
seqlen: 98
task_name: Textual/Abt-Buy
=======================
step: 0, task: Textual/Abt-Buy, loss: 0.10628823190927505
step: 10, task: Textual/Abt-Buy, loss: 0.013646453619003296
step: 20, task: Textual/Abt-Buy, loss: 0.006269291043281555
step: 30, task: Textual/Abt-Buy, loss: 0.031196676194667816
step: 40, task: Textual/Abt-Buy, loss: 0.013963870704174042
step: 50, task: Textual/Abt-Buy, loss: 0.0030814409255981445
step: 60, task: Textual/Abt-Buy, loss: 0.025346748530864716
step: 70, task: Textual/Abt-Buy, loss: 0.019144520163536072
step: 80, task: Textual/Abt-Buy, loss: 0.10501166433095932
step: 90, task: Textual/Abt-Buy, loss: 0.19020970165729523
step: 100, task: Textual/Abt-Buy, loss: 0.0018169432878494263
Gradient overflow.  Skipping step, loss scaler 0 reducing loss scale to 4096.0
step: 110, task: Textual/Abt-Buy, loss: 0.027917422354221344
step: 120, task: Textual/Abt-Buy, loss: 0.04337688907980919
step: 130, task: Textual/Abt-Buy, loss: 0.245929554104805
step: 140, task: Textual/Abt-Buy, loss: 0.04230634495615959
step: 150, task: Textual/Abt-Buy, loss: 0.04029764235019684
step: 160, task: Textual/Abt-Buy, loss: 0.009303964674472809
step: 170, task: Textual/Abt-Buy, loss: 0.0007382184267044067
step: 180, task: Textual/Abt-Buy, loss: 0.40990594029426575
step: 190, task: Textual/Abt-Buy, loss: 0.03448392450809479
step: 200, task: Textual/Abt-Buy, loss: 0.013007432222366333
step: 210, task: Textual/Abt-Buy, loss: 0.020645983517169952
step: 220, task: Textual/Abt-Buy, loss: 0.002330079674720764
step: 230, task: Textual/Abt-Buy, loss: 0.0015897005796432495
step: 240, task: Textual/Abt-Buy, loss: 0.0007390379905700684
step: 250, task: Textual/Abt-Buy, loss: 0.04499609395861626
step: 260, task: Textual/Abt-Buy, loss: 0.4168611764907837
step: 270, task: Textual/Abt-Buy, loss: 0.026393763720989227
step: 280, task: Textual/Abt-Buy, loss: 0.0033491849899291992
step: 290, task: Textual/Abt-Buy, loss: 0.028832674026489258
step: 300, task: Textual/Abt-Buy, loss: 0.009177103638648987
step: 310, task: Textual/Abt-Buy, loss: 0.09005891531705856
step: 320, task: Textual/Abt-Buy, loss: 0.017192117869853973
step: 330, task: Textual/Abt-Buy, loss: 0.28211888670921326
step: 340, task: Textual/Abt-Buy, loss: 0.003040790557861328
step: 350, task: Textual/Abt-Buy, loss: 0.021192938089370728
=========eval at epoch=3=========
Validation:
=============Textual/Abt-Buy==================
accuracy=0.924
precision=0.905
recall=0.325
f1=0.479
======================================
Test:
=============Textual/Abt-Buy==================
accuracy=0.934
precision=0.926
recall=0.422
f1=0.580
======================================
=====sanity check======
words: COL name VAL samsung black 8.1 megapixel digital camera ecnv30zbba COL description VAL samsung nv30 black 8.1 megapixel digital camera ecnv30zbba 3x optical zoom lens 2.5 ' lcd display high resolution ccd sensor 20mb internal memory dual image stabilization face detection auto focus sd memory card slot black finish COL price VAL   [SEP] COL name VAL samsung nv30 digital camera silver ec-nv30zsba / us COL description VAL samsung nv30 8 megapixel digital camera with schneider lens , dual image stabilization , smart touch , and face detection silver COL price VAL 139.0 
x: [    0 18047   766 27445   579 48545   909   290     4   134 10721 21424
  1778  2280 20508 37594   541 19831  3178 14857  8194 27445   579 48545
   295   705   541   909   290     4   134 10721 21424  1778  2280 20508
 37594   541 19831  3178   155  1178 17547 21762 10373   132     4   245
   128   784 28690  2332   239  3547   740 28690  9626   291  6648  3425
  3783  6594  2274 29632   652 12673  4485  1056 46409  3783  1886  8534
   909  2073 14857   425 27445  1437  1437     2     2 18047   766 27445
   579 48545   295   705   541  1778  2280  4334 20508    12 37594   541
   329    29  3178  1589   201 14857  8194 27445   579 48545   295   705
   541   290 10721 21424  1778  2280    19  8447   858  5326 10373  2156
  6594  2274 29632  2156  2793  2842  2156     8   652 12673  4334 14857
   425 27445 24404     4   288  1437     2]
tokens: ['<s>', 'COL', 'Ġname', 'ĠVAL', 'Ġs', 'amsung', 'Ġblack', 'Ġ8', '.', '1', 'Ġmeg', 'apixel', 'Ġdigital', 'Ġcamera', 'Ġec', 'nv', '30', 'zb', 'ba', 'ĠCOL', 'Ġdescription', 'ĠVAL', 'Ġs', 'amsung', 'Ġn', 'v', '30', 'Ġblack', 'Ġ8', '.', '1', 'Ġmeg', 'apixel', 'Ġdigital', 'Ġcamera', 'Ġec', 'nv', '30', 'zb', 'ba', 'Ġ3', 'x', 'Ġoptical', 'Ġzoom', 'Ġlens', 'Ġ2', '.', '5', "Ġ'", 'Ġl', 'cd', 'Ġdisplay', 'Ġhigh', 'Ġresolution', 'Ġc', 'cd', 'Ġsensor', 'Ġ20', 'mb', 'Ġinternal', 'Ġmemory', 'Ġdual', 'Ġimage', 'Ġstabilization', 'Ġface', 'Ġdetection', 'Ġauto', 'Ġfocus', 'Ġsd', 'Ġmemory', 'Ġcard', 'Ġslot', 'Ġblack', 'Ġfinish', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ', 'Ġ', '</s>', '</s>', 'COL', 'Ġname', 'ĠVAL', 'Ġs', 'amsung', 'Ġn', 'v', '30', 'Ġdigital', 'Ġcamera', 'Ġsilver', 'Ġec', '-', 'nv', '30', 'z', 's', 'ba', 'Ġ/', 'Ġus', 'ĠCOL', 'Ġdescription', 'ĠVAL', 'Ġs', 'amsung', 'Ġn', 'v', '30', 'Ġ8', 'Ġmeg', 'apixel', 'Ġdigital', 'Ġcamera', 'Ġwith', 'Ġsch', 'ne', 'ider', 'Ġlens', 'Ġ,', 'Ġdual', 'Ġimage', 'Ġstabilization', 'Ġ,', 'Ġsmart', 'Ġtouch', 'Ġ,', 'Ġand', 'Ġface', 'Ġdetection', 'Ġsilver', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ139', '.', '0', 'Ġ', '</s>']
is_heads: [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
y: 1
tags: 1
mask: tensor([1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1])
seqlen: 139
task_name: Textual/Abt-Buy
=======================
step: 0, task: Textual/Abt-Buy, loss: 0.02562878280878067
step: 10, task: Textual/Abt-Buy, loss: 0.005430527031421661
step: 20, task: Textual/Abt-Buy, loss: 0.004182919859886169
step: 30, task: Textual/Abt-Buy, loss: 0.004119656980037689
step: 40, task: Textual/Abt-Buy, loss: 0.0676116868853569
step: 50, task: Textual/Abt-Buy, loss: 0.017306983470916748
step: 60, task: Textual/Abt-Buy, loss: 0.0019527524709701538
step: 70, task: Textual/Abt-Buy, loss: 0.002540111541748047
step: 80, task: Textual/Abt-Buy, loss: 0.0020599663257598877
step: 90, task: Textual/Abt-Buy, loss: 0.002197280526161194
step: 100, task: Textual/Abt-Buy, loss: 0.0024649426341056824
step: 110, task: Textual/Abt-Buy, loss: 0.002919316291809082
step: 120, task: Textual/Abt-Buy, loss: 0.03342818468809128
step: 130, task: Textual/Abt-Buy, loss: 0.04817182198166847
step: 140, task: Textual/Abt-Buy, loss: 0.004838697612285614
step: 150, task: Textual/Abt-Buy, loss: 0.0033056512475013733
step: 160, task: Textual/Abt-Buy, loss: 0.009007759392261505
step: 170, task: Textual/Abt-Buy, loss: 0.007608093321323395
step: 180, task: Textual/Abt-Buy, loss: 0.030022092163562775
step: 190, task: Textual/Abt-Buy, loss: 0.03567637503147125
step: 200, task: Textual/Abt-Buy, loss: 0.00022627413272857666
step: 210, task: Textual/Abt-Buy, loss: 0.0002149045467376709
step: 220, task: Textual/Abt-Buy, loss: 0.008892938494682312
step: 230, task: Textual/Abt-Buy, loss: 0.0013917386531829834
step: 240, task: Textual/Abt-Buy, loss: 0.0006673932075500488
step: 250, task: Textual/Abt-Buy, loss: 0.0028864145278930664
step: 260, task: Textual/Abt-Buy, loss: 0.004146113991737366
step: 270, task: Textual/Abt-Buy, loss: 0.00032113492488861084
step: 280, task: Textual/Abt-Buy, loss: 0.013767808675765991
step: 290, task: Textual/Abt-Buy, loss: 0.0008504986763000488
step: 300, task: Textual/Abt-Buy, loss: 0.2526243031024933
step: 310, task: Textual/Abt-Buy, loss: 0.43435630202293396
step: 320, task: Textual/Abt-Buy, loss: 0.028655454516410828
step: 330, task: Textual/Abt-Buy, loss: 0.5824506282806396
step: 340, task: Textual/Abt-Buy, loss: 0.01403520256280899
step: 350, task: Textual/Abt-Buy, loss: 0.0009649842977523804
=========eval at epoch=4=========
Validation:
=============Textual/Abt-Buy==================
accuracy=0.914
precision=0.977
recall=0.209
f1=0.344
======================================
Test:
=============Textual/Abt-Buy==================
accuracy=0.913
precision=0.953
recall=0.199
f1=0.329
======================================
=====sanity check======
words: COL name VAL panasonic stainless steel countertop microwave oven nnsd377ss COL description VAL panasonic nnsd377s stainless steel countertop microwave oven nnsd377ss 0.8 cu . ft. capacity 800 watts cooking power 6 levels power settings 5 multi-stage cooking quick minute feature 4 digit display panel popcorn key revolving removable turntable stainless steel finish COL price VAL   [SEP] COL name VAL panasonic nn-sd377s 0.8 cu.ft . 800 watt microwave oven COL description VAL  COL price VAL  
x: [    0 18047   766 27445  5730 38703 23486  3689  3231  8766 28562 12941
   295  6852   417 33588  7485 14857  8194 27445  5730 38703   295  6852
   417 33588    29 23486  3689  3231  8766 28562 12941   295  6852   417
 33588  7485   321     4   398  3729   479 16935     4  2148  5735 42574
  6836   476   231  1389   476  9629   195  3228    12 10850  6836  2119
  2289  1905   204 16808  2332  2798 26639   762 24826 37680 11342  3999
   868 23486  3689  2073 14857   425 27445  1437  1437     2     2 18047
   766 27445  5730 38703   295   282    12 28045 33588    29   321     4
   398  3729     4  2543   479  5735 42738 28562 12941 14857  8194 27445
  1437 14857   425 27445  1437  1437     2]
tokens: ['<s>', 'COL', 'Ġname', 'ĠVAL', 'Ġpan', 'asonic', 'Ġstainless', 'Ġsteel', 'Ġcounter', 'top', 'Ġmicrowave', 'Ġoven', 'Ġn', 'ns', 'd', '377', 'ss', 'ĠCOL', 'Ġdescription', 'ĠVAL', 'Ġpan', 'asonic', 'Ġn', 'ns', 'd', '377', 's', 'Ġstainless', 'Ġsteel', 'Ġcounter', 'top', 'Ġmicrowave', 'Ġoven', 'Ġn', 'ns', 'd', '377', 'ss', 'Ġ0', '.', '8', 'Ġcu', 'Ġ.', 'Ġft', '.', 'Ġcapacity', 'Ġ800', 'Ġwatts', 'Ġcooking', 'Ġpower', 'Ġ6', 'Ġlevels', 'Ġpower', 'Ġsettings', 'Ġ5', 'Ġmulti', '-', 'stage', 'Ġcooking', 'Ġquick', 'Ġminute', 'Ġfeature', 'Ġ4', 'Ġdigit', 'Ġdisplay', 'Ġpanel', 'Ġpopcorn', 'Ġkey', 'Ġrevolving', 'Ġremovable', 'Ġtur', 'nt', 'able', 'Ġstainless', 'Ġsteel', 'Ġfinish', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ', 'Ġ', '</s>', '</s>', 'COL', 'Ġname', 'ĠVAL', 'Ġpan', 'asonic', 'Ġn', 'n', '-', 'sd', '377', 's', 'Ġ0', '.', '8', 'Ġcu', '.', 'ft', 'Ġ.', 'Ġ800', 'Ġwatt', 'Ġmicrowave', 'Ġoven', 'ĠCOL', 'Ġdescription', 'ĠVAL', 'Ġ', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ', 'Ġ', '</s>']
is_heads: [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
y: 1
tags: 1
mask: tensor([1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1])
seqlen: 115
task_name: Textual/Abt-Buy
=======================
step: 0, task: Textual/Abt-Buy, loss: 0.0013375282287597656
step: 10, task: Textual/Abt-Buy, loss: 0.0011070668697357178
step: 20, task: Textual/Abt-Buy, loss: 0.000748559832572937
step: 30, task: Textual/Abt-Buy, loss: 0.0007884055376052856
step: 40, task: Textual/Abt-Buy, loss: 0.014337792992591858
step: 50, task: Textual/Abt-Buy, loss: 0.0007457733154296875
step: 60, task: Textual/Abt-Buy, loss: 0.0005246102809906006
step: 70, task: Textual/Abt-Buy, loss: 0.0019037723541259766
step: 80, task: Textual/Abt-Buy, loss: 0.0235249325633049
step: 90, task: Textual/Abt-Buy, loss: 0.00040602684020996094
step: 100, task: Textual/Abt-Buy, loss: 0.002215638756752014
step: 110, task: Textual/Abt-Buy, loss: 0.0007925629615783691
step: 120, task: Textual/Abt-Buy, loss: 0.0005567818880081177
step: 130, task: Textual/Abt-Buy, loss: 0.0013210326433181763
step: 140, task: Textual/Abt-Buy, loss: 0.0015300363302230835
step: 150, task: Textual/Abt-Buy, loss: 0.026875056326389313
step: 160, task: Textual/Abt-Buy, loss: 0.0018540620803833008
step: 170, task: Textual/Abt-Buy, loss: 0.003619872033596039
step: 180, task: Textual/Abt-Buy, loss: 0.07384710013866425
step: 190, task: Textual/Abt-Buy, loss: 0.0010984092950820923
step: 200, task: Textual/Abt-Buy, loss: 0.02459678053855896
step: 210, task: Textual/Abt-Buy, loss: 0.005894467234611511
step: 220, task: Textual/Abt-Buy, loss: 0.017096348106861115
step: 230, task: Textual/Abt-Buy, loss: 0.01106783002614975
step: 240, task: Textual/Abt-Buy, loss: 0.0007510185241699219
step: 250, task: Textual/Abt-Buy, loss: 0.0015959963202476501
step: 260, task: Textual/Abt-Buy, loss: 0.0012812614440917969
step: 270, task: Textual/Abt-Buy, loss: 0.0005522966384887695
step: 280, task: Textual/Abt-Buy, loss: 0.00040215253829956055
step: 290, task: Textual/Abt-Buy, loss: 0.2924365997314453
step: 300, task: Textual/Abt-Buy, loss: 0.0016792267560958862
step: 310, task: Textual/Abt-Buy, loss: 0.0044487714767456055
step: 320, task: Textual/Abt-Buy, loss: 0.0401785746216774
step: 330, task: Textual/Abt-Buy, loss: 0.0007045120000839233
step: 340, task: Textual/Abt-Buy, loss: 0.0011122822761535645
step: 350, task: Textual/Abt-Buy, loss: 0.0005813241004943848
=========eval at epoch=5=========
Validation:
=============Textual/Abt-Buy==================
accuracy=0.918
precision=0.930
recall=0.257
f1=0.403
======================================
Test:
=============Textual/Abt-Buy==================
accuracy=0.920
precision=0.965
recall=0.267
f1=0.418
======================================
=====sanity check======
words: COL name VAL canon deluxe soft black camera case 0716b001 COL description VAL canon deluxe soft black camera case 0716b001 compatible with canon powershot s2 is black finish COL price VAL   [SEP] COL name VAL canon cli-221 black ink cartridge 2946b001 COL description VAL black COL price VAL 11.99 
x: [    0 18047   766 27445 32839  2424 39210  3793   909  2280   403 13470
  1549   428 19089 14857  8194 27445 32839  2424 39210  3793   909  2280
   403 13470  1549   428 19089 16632    19 32839  4361 10120   579   176
    16   909  2073 14857   425 27445  1437  1437     2     2 18047   766
 27445 32839  3741   118    12 28730   909 16019 41785  1132  3761   428
 19089 14857  8194 27445   909 14857   425 27445   365     4  2831  1437
     2]
tokens: ['<s>', 'COL', 'Ġname', 'ĠVAL', 'Ġcanon', 'Ġdel', 'uxe', 'Ġsoft', 'Ġblack', 'Ġcamera', 'Ġcase', 'Ġ07', '16', 'b', '001', 'ĠCOL', 'Ġdescription', 'ĠVAL', 'Ġcanon', 'Ġdel', 'uxe', 'Ġsoft', 'Ġblack', 'Ġcamera', 'Ġcase', 'Ġ07', '16', 'b', '001', 'Ġcompatible', 'Ġwith', 'Ġcanon', 'Ġpowers', 'hot', 'Ġs', '2', 'Ġis', 'Ġblack', 'Ġfinish', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ', 'Ġ', '</s>', '</s>', 'COL', 'Ġname', 'ĠVAL', 'Ġcanon', 'Ġcl', 'i', '-', '221', 'Ġblack', 'Ġink', 'Ġcartridge', 'Ġ29', '46', 'b', '001', 'ĠCOL', 'Ġdescription', 'ĠVAL', 'Ġblack', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ11', '.', '99', 'Ġ', '</s>']
is_heads: [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
y: 0
tags: 0
mask: tensor([1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1])
seqlen: 73
task_name: Textual/Abt-Buy
=======================
step: 0, task: Textual/Abt-Buy, loss: 0.0006157010793685913
step: 10, task: Textual/Abt-Buy, loss: 0.0006742626428604126
step: 20, task: Textual/Abt-Buy, loss: 0.0008971244096755981
step: 30, task: Textual/Abt-Buy, loss: 0.0006323009729385376
step: 40, task: Textual/Abt-Buy, loss: 0.03239423781633377
step: 50, task: Textual/Abt-Buy, loss: 0.0006190240383148193
step: 60, task: Textual/Abt-Buy, loss: 0.02295258641242981
step: 70, task: Textual/Abt-Buy, loss: 0.0006000101566314697
step: 80, task: Textual/Abt-Buy, loss: 0.012635603547096252
step: 90, task: Textual/Abt-Buy, loss: 0.05200926586985588
step: 100, task: Textual/Abt-Buy, loss: 0.0004030466079711914
step: 110, task: Textual/Abt-Buy, loss: 0.00039947032928466797
step: 120, task: Textual/Abt-Buy, loss: 0.0003301352262496948
step: 130, task: Textual/Abt-Buy, loss: 0.0002947896718978882
step: 140, task: Textual/Abt-Buy, loss: 0.00026129186153411865
step: 150, task: Textual/Abt-Buy, loss: 0.00036056339740753174
step: 160, task: Textual/Abt-Buy, loss: 0.039937179535627365
step: 170, task: Textual/Abt-Buy, loss: 0.0012774616479873657
step: 180, task: Textual/Abt-Buy, loss: 0.00039105117321014404
step: 190, task: Textual/Abt-Buy, loss: 0.002126269042491913
step: 200, task: Textual/Abt-Buy, loss: 0.000615924596786499
step: 210, task: Textual/Abt-Buy, loss: 0.0007788687944412231
step: 220, task: Textual/Abt-Buy, loss: 0.000942528247833252
step: 230, task: Textual/Abt-Buy, loss: 0.15795467793941498
step: 240, task: Textual/Abt-Buy, loss: 0.025026265531778336
step: 250, task: Textual/Abt-Buy, loss: 0.015979692339897156
step: 260, task: Textual/Abt-Buy, loss: 0.002952873706817627
step: 270, task: Textual/Abt-Buy, loss: 0.0012484043836593628
step: 280, task: Textual/Abt-Buy, loss: 0.018471263349056244
step: 290, task: Textual/Abt-Buy, loss: 0.0008863955736160278
step: 300, task: Textual/Abt-Buy, loss: 0.0028763562440872192
step: 310, task: Textual/Abt-Buy, loss: 0.148160919547081
step: 320, task: Textual/Abt-Buy, loss: 0.000879824161529541
step: 330, task: Textual/Abt-Buy, loss: 0.004071146249771118
step: 340, task: Textual/Abt-Buy, loss: 0.001253172755241394
step: 350, task: Textual/Abt-Buy, loss: 0.059991154819726944
=========eval at epoch=6=========
Validation:
=============Textual/Abt-Buy==================
accuracy=0.924
precision=0.969
recall=0.301
f1=0.459
======================================
Test:
=============Textual/Abt-Buy==================
accuracy=0.923
precision=0.939
recall=0.301
f1=0.456
======================================
=====sanity check======
words: COL name VAL speck seethru red hard shell case for 13 ' macbook mb13redseev2 COL description VAL speck seethru red hard shell case for 13 ' macbook mb13redseev2 translucent hard plastic shell gives great protection full access to all controls rubber feet for added support red finish COL price VAL   [SEP] COL name VAL speck products seethru case for apple 13 ' macbook mb13-grn-see-v2 COL description VAL plastic green COL price VAL  
x: [    0 18047   766 27445 25227  2420   842  4774  2070  1275   543 10785
   403    13   508   128 13418  6298   475   428  1558  2050  1090  3623
   176 14857  8194 27445 25227  2420   842  4774  2070  1275   543 10785
   403    13   508   128 13418  6298   475   428  1558  2050  1090  3623
   176 42026   543  4136 10785  2029   372  2591   455   899     7    70
  5656 11283  1730    13   355   323  1275  2073 14857   425 27445  1437
  1437     2     2 18047   766 27445 25227  2420   785   842  4774  2070
   403    13 15162   508   128 13418  6298   475   428  1558    12  6504
   282    12  7048    12   705   176 14857  8194 27445  4136  2272 14857
   425 27445  1437  1437     2]
tokens: ['<s>', 'COL', 'Ġname', 'ĠVAL', 'Ġspe', 'ck', 'Ġse', 'eth', 'ru', 'Ġred', 'Ġhard', 'Ġshell', 'Ġcase', 'Ġfor', 'Ġ13', "Ġ'", 'Ġmac', 'book', 'Ġm', 'b', '13', 'red', 'se', 'ev', '2', 'ĠCOL', 'Ġdescription', 'ĠVAL', 'Ġspe', 'ck', 'Ġse', 'eth', 'ru', 'Ġred', 'Ġhard', 'Ġshell', 'Ġcase', 'Ġfor', 'Ġ13', "Ġ'", 'Ġmac', 'book', 'Ġm', 'b', '13', 'red', 'se', 'ev', '2', 'Ġtranslucent', 'Ġhard', 'Ġplastic', 'Ġshell', 'Ġgives', 'Ġgreat', 'Ġprotection', 'Ġfull', 'Ġaccess', 'Ġto', 'Ġall', 'Ġcontrols', 'Ġrubber', 'Ġfeet', 'Ġfor', 'Ġadded', 'Ġsupport', 'Ġred', 'Ġfinish', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ', 'Ġ', '</s>', '</s>', 'COL', 'Ġname', 'ĠVAL', 'Ġspe', 'ck', 'Ġproducts', 'Ġse', 'eth', 'ru', 'Ġcase', 'Ġfor', 'Ġapple', 'Ġ13', "Ġ'", 'Ġmac', 'book', 'Ġm', 'b', '13', '-', 'gr', 'n', '-', 'see', '-', 'v', '2', 'ĠCOL', 'Ġdescription', 'ĠVAL', 'Ġplastic', 'Ġgreen', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ', 'Ġ', '</s>']
is_heads: [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
y: 0
tags: 0
mask: tensor([1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1])
seqlen: 113
task_name: Textual/Abt-Buy
=======================
step: 0, task: Textual/Abt-Buy, loss: 0.04161063954234123
step: 10, task: Textual/Abt-Buy, loss: 0.0010455846786499023
step: 20, task: Textual/Abt-Buy, loss: 0.014589861035346985
step: 30, task: Textual/Abt-Buy, loss: 0.0023882240056991577
step: 40, task: Textual/Abt-Buy, loss: 0.000388413667678833
step: 50, task: Textual/Abt-Buy, loss: 0.0003749430179595947
step: 60, task: Textual/Abt-Buy, loss: 0.09548486024141312
step: 70, task: Textual/Abt-Buy, loss: 0.0017695352435112
step: 80, task: Textual/Abt-Buy, loss: 0.0004986077547073364
step: 90, task: Textual/Abt-Buy, loss: 0.0003616064786911011
step: 100, task: Textual/Abt-Buy, loss: 0.0017255693674087524
step: 110, task: Textual/Abt-Buy, loss: 0.0008883774280548096
step: 120, task: Textual/Abt-Buy, loss: 0.0034416615962982178
step: 130, task: Textual/Abt-Buy, loss: 0.0010736733675003052
step: 140, task: Textual/Abt-Buy, loss: 0.08478425443172455
step: 150, task: Textual/Abt-Buy, loss: 0.005082756280899048
step: 160, task: Textual/Abt-Buy, loss: 0.0006330311298370361
step: 170, task: Textual/Abt-Buy, loss: 0.000202864408493042
step: 180, task: Textual/Abt-Buy, loss: 0.0002933889627456665
step: 190, task: Textual/Abt-Buy, loss: 0.0003730505704879761
step: 200, task: Textual/Abt-Buy, loss: 0.000330507755279541
step: 210, task: Textual/Abt-Buy, loss: 0.00031688809394836426
step: 220, task: Textual/Abt-Buy, loss: 0.0011782348155975342
step: 230, task: Textual/Abt-Buy, loss: 0.04863692447543144
step: 240, task: Textual/Abt-Buy, loss: 0.0002801269292831421
step: 250, task: Textual/Abt-Buy, loss: 0.0006381422281265259
step: 260, task: Textual/Abt-Buy, loss: 0.0003638416528701782
step: 270, task: Textual/Abt-Buy, loss: 0.0002896934747695923
step: 280, task: Textual/Abt-Buy, loss: 0.00033514201641082764
step: 290, task: Textual/Abt-Buy, loss: 0.0011489242315292358
step: 300, task: Textual/Abt-Buy, loss: 0.00030259788036346436
step: 310, task: Textual/Abt-Buy, loss: 0.00037132203578948975
step: 320, task: Textual/Abt-Buy, loss: 0.0003169327974319458
step: 330, task: Textual/Abt-Buy, loss: 0.0003099590539932251
step: 340, task: Textual/Abt-Buy, loss: 0.21902914345264435
step: 350, task: Textual/Abt-Buy, loss: 0.018928363919258118
=========eval at epoch=7=========
Validation:
=============Textual/Abt-Buy==================
accuracy=0.919
precision=0.981
recall=0.252
f1=0.402
======================================
Test:
=============Textual/Abt-Buy==================
accuracy=0.921
precision=0.950
recall=0.277
f1=0.429
======================================
=====sanity check======
words: COL name VAL logitech black v220 cordless optical mouse for notebooks 910000153 COL description VAL logitech black v220 cordless optical mouse for notebooks 910000153 ergonomic design with soft rubber grips extended battery life mini-receiver snaps onto mouse turning it off high-definition optical technology side-to-side plus zoom black finish COL price VAL 29.0  [SEP] COL name VAL logitech cordless desktop mx 5500 revolution keyboard and mouse 920-000383 COL description VAL logitech cordless desktop mx 5500 revolution COL price VAL  
x: [    0 18047   766 27445  7425 30051   909   748 16846 13051  1672 17547
 18292    13 36459  8301 14200 27982 14857  8194 27445  7425 30051   909
   748 16846 13051  1672 17547 18292    13 36459  8301 14200 27982 35389
 42141  1521    19  3793 11283 29706  3112  3822   301  7983    12   241
 44168 11803  2500 18292  3408    24   160   239    12 38835 17547   806
   526    12   560    12  3730  2704 21762   909  2073 14857   425 27445
  1132     4   288  1437     2     2 18047   766 27445  7425 30051 13051
  1672 14050   475  1178   195  1497  7977 12722     8 18292 37543    12
   151 29980 14857  8194 27445  7425 30051 13051  1672 14050   475  1178
   195  1497  7977 14857   425 27445  1437  1437     2]
tokens: ['<s>', 'COL', 'Ġname', 'ĠVAL', 'Ġlog', 'itech', 'Ġblack', 'Ġv', '220', 'Ġcord', 'less', 'Ġoptical', 'Ġmouse', 'Ġfor', 'Ġnotebooks', 'Ġ91', '0000', '153', 'ĠCOL', 'Ġdescription', 'ĠVAL', 'Ġlog', 'itech', 'Ġblack', 'Ġv', '220', 'Ġcord', 'less', 'Ġoptical', 'Ġmouse', 'Ġfor', 'Ġnotebooks', 'Ġ91', '0000', '153', 'Ġerg', 'onomic', 'Ġdesign', 'Ġwith', 'Ġsoft', 'Ġrubber', 'Ġgrips', 'Ġextended', 'Ġbattery', 'Ġlife', 'Ġmini', '-', 're', 'ceiver', 'Ġsnaps', 'Ġonto', 'Ġmouse', 'Ġturning', 'Ġit', 'Ġoff', 'Ġhigh', '-', 'definition', 'Ġoptical', 'Ġtechnology', 'Ġside', '-', 'to', '-', 'side', 'Ġplus', 'Ġzoom', 'Ġblack', 'Ġfinish', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ29', '.', '0', 'Ġ', '</s>', '</s>', 'COL', 'Ġname', 'ĠVAL', 'Ġlog', 'itech', 'Ġcord', 'less', 'Ġdesktop', 'Ġm', 'x', 'Ġ5', '500', 'Ġrevolution', 'Ġkeyboard', 'Ġand', 'Ġmouse', 'Ġ920', '-', '000', '383', 'ĠCOL', 'Ġdescription', 'ĠVAL', 'Ġlog', 'itech', 'Ġcord', 'less', 'Ġdesktop', 'Ġm', 'x', 'Ġ5', '500', 'Ġrevolution', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ', 'Ġ', '</s>']
is_heads: [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
y: 0
tags: 0
mask: tensor([1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1])
seqlen: 117
task_name: Textual/Abt-Buy
=======================
step: 0, task: Textual/Abt-Buy, loss: 0.0005147010087966919
step: 10, task: Textual/Abt-Buy, loss: 0.0002936124801635742
step: 20, task: Textual/Abt-Buy, loss: 0.0003358423709869385
step: 30, task: Textual/Abt-Buy, loss: 0.00102272629737854
step: 40, task: Textual/Abt-Buy, loss: 0.0002956986427307129
step: 50, task: Textual/Abt-Buy, loss: 0.0003605186939239502
step: 60, task: Textual/Abt-Buy, loss: 0.0004900246858596802
step: 70, task: Textual/Abt-Buy, loss: 0.0006037354469299316
step: 80, task: Textual/Abt-Buy, loss: 0.22624361515045166
step: 90, task: Textual/Abt-Buy, loss: 0.00041240453720092773
step: 100, task: Textual/Abt-Buy, loss: 0.0004442930221557617
step: 110, task: Textual/Abt-Buy, loss: 0.0004611760377883911
step: 120, task: Textual/Abt-Buy, loss: 0.012378804385662079
step: 130, task: Textual/Abt-Buy, loss: 0.00036773085594177246
step: 140, task: Textual/Abt-Buy, loss: 0.014260709285736084
step: 150, task: Textual/Abt-Buy, loss: 0.0005221962928771973
step: 160, task: Textual/Abt-Buy, loss: 0.014238335192203522
step: 170, task: Textual/Abt-Buy, loss: 0.0004387497901916504
step: 180, task: Textual/Abt-Buy, loss: 0.014315478503704071
step: 190, task: Textual/Abt-Buy, loss: 0.00033152103424072266
step: 200, task: Textual/Abt-Buy, loss: 0.0002983659505844116
step: 210, task: Textual/Abt-Buy, loss: 0.00036084651947021484
step: 220, task: Textual/Abt-Buy, loss: 0.0002878457307815552
step: 230, task: Textual/Abt-Buy, loss: 0.0004909485578536987
step: 240, task: Textual/Abt-Buy, loss: 0.0003647059202194214
step: 250, task: Textual/Abt-Buy, loss: 0.002482593059539795
step: 260, task: Textual/Abt-Buy, loss: 0.0006080865859985352
step: 270, task: Textual/Abt-Buy, loss: 0.00024697184562683105
step: 280, task: Textual/Abt-Buy, loss: 0.005260109901428223
step: 290, task: Textual/Abt-Buy, loss: 0.04129834473133087
step: 300, task: Textual/Abt-Buy, loss: 0.00030624866485595703
step: 310, task: Textual/Abt-Buy, loss: 0.0009138435125350952
step: 320, task: Textual/Abt-Buy, loss: 0.0010153502225875854
step: 330, task: Textual/Abt-Buy, loss: 0.026835571974515915
step: 340, task: Textual/Abt-Buy, loss: 0.0002566725015640259
step: 350, task: Textual/Abt-Buy, loss: 0.0003032684326171875
=========eval at epoch=8=========
Validation:
=============Textual/Abt-Buy==================
accuracy=0.921
precision=0.950
recall=0.277
f1=0.429
======================================
Test:
=============Textual/Abt-Buy==================
accuracy=0.923
precision=0.926
recall=0.306
f1=0.460
======================================
Selected optimization level O2:  FP16 training with FP32 batchnorm and FP32 master weights.

Defaults for this optimization level are:
enabled                : True
opt_level              : O2
cast_model_type        : torch.float16
patch_torch_functions  : False
keep_batchnorm_fp32    : True
master_weights         : True
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O2
cast_model_type        : torch.float16
patch_torch_functions  : False
keep_batchnorm_fp32    : True
master_weights         : True
loss_scale             : dynamic
Warning:  multi_tensor_applier fused unscale kernel is unavailable, possibly because apex was installed without --cuda_ext --cpp_ext. Using Python fallback.  Original ImportError was: ModuleNotFoundError("No module named 'amp_C'")
Gradient overflow.  Skipping step, loss scaler 0 reducing loss scale to 32768.0
=====sanity check======
words: COL name VAL nikon d90 black digital slr camera with nikkor 18-105mm lens d90outfit COL description VAL nikon d90 black digital slr camera with nikkor 18-105mm lens d90outfit 12.3 megapixel 3 ' tft lcd display d-movie shooting function expeed image processing scene recognition system in-camera retouch menu low-noise performance active d-lighting viewfinder compatible with hdmi output included af-s dx nikkor 18-105mm vr lens black finish COL price VAL   [SEP] COL name VAL nikon coolpix s550 digital camera graphite black 26108 COL description VAL 10 megapixel 16:9 4x digital zoom 2.5 ' active matrix tft color lcd COL price VAL 168.72 
x: [    0 18047   766 27445   295   967   261   385  3248   909  1778  3369
   338  2280    19   295 21609   368   504    12 15274  5471 10373   385
  3248   995 14307 14857  8194 27445   295   967   261   385  3248   909
  1778  3369   338  2280    19   295 21609   368   504    12 15274  5471
 10373   385  3248   995 14307   316     4   246 10721 21424   155   128
   326  2543   784 28690  2332   385    12 38428  1094  5043  1931 39640
  2274  5774  1310  4972   467    11    12 25092  5494 12746  5765   614
    12  2362  1496   819  2171   385    12 30181  1217 38116 16632    19
  1368   417  5408  4195  1165  9724    12    29 49386   295 21609   368
   504    12 15274  5471   748   338 10373   909  2073 14857   425 27445
  1437  1437     2     2 18047   766 27445   295   967   261  3035   642
  3181   579 17953  1778  2280 20992  1459   909   973 18844 14857  8194
 27445   158 10721 21424   545    35   466   204  1178  1778 21762   132
     4   245   128  2171 36173   326  2543  3195   784 28690 14857   425
 27445 26372     4  4956  1437     2]
tokens: ['<s>', 'COL', 'Ġname', 'ĠVAL', 'Ġn', 'ik', 'on', 'Ġd', '90', 'Ġblack', 'Ġdigital', 'Ġsl', 'r', 'Ġcamera', 'Ġwith', 'Ġn', 'ikk', 'or', 'Ġ18', '-', '105', 'mm', 'Ġlens', 'Ġd', '90', 'out', 'fit', 'ĠCOL', 'Ġdescription', 'ĠVAL', 'Ġn', 'ik', 'on', 'Ġd', '90', 'Ġblack', 'Ġdigital', 'Ġsl', 'r', 'Ġcamera', 'Ġwith', 'Ġn', 'ikk', 'or', 'Ġ18', '-', '105', 'mm', 'Ġlens', 'Ġd', '90', 'out', 'fit', 'Ġ12', '.', '3', 'Ġmeg', 'apixel', 'Ġ3', "Ġ'", 'Ġt', 'ft', 'Ġl', 'cd', 'Ġdisplay', 'Ġd', '-', 'movie', 'Ġshooting', 'Ġfunction', 'Ġex', 'peed', 'Ġimage', 'Ġprocessing', 'Ġscene', 'Ġrecognition', 'Ġsystem', 'Ġin', '-', 'camera', 'Ġret', 'ouch', 'Ġmenu', 'Ġlow', '-', 'no', 'ise', 'Ġperformance', 'Ġactive', 'Ġd', '-', 'lighting', 'Ġview', 'finder', 'Ġcompatible', 'Ġwith', 'Ġh', 'd', 'mi', 'Ġoutput', 'Ġincluded', 'Ġaf', '-', 's', 'Ġdx', 'Ġn', 'ikk', 'or', 'Ġ18', '-', '105', 'mm', 'Ġv', 'r', 'Ġlens', 'Ġblack', 'Ġfinish', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ', 'Ġ', '</s>', '</s>', 'COL', 'Ġname', 'ĠVAL', 'Ġn', 'ik', 'on', 'Ġcool', 'p', 'ix', 'Ġs', '550', 'Ġdigital', 'Ġcamera', 'Ġgraph', 'ite', 'Ġblack', 'Ġ26', '108', 'ĠCOL', 'Ġdescription', 'ĠVAL', 'Ġ10', 'Ġmeg', 'apixel', 'Ġ16', ':', '9', 'Ġ4', 'x', 'Ġdigital', 'Ġzoom', 'Ġ2', '.', '5', "Ġ'", 'Ġactive', 'Ġmatrix', 'Ġt', 'ft', 'Ġcolor', 'Ġl', 'cd', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ168', '.', '72', 'Ġ', '</s>']
is_heads: [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
y: 0
tags: 0
mask: tensor([1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1])
seqlen: 174
task_name: Textual/Abt-Buy
=======================
step: 0, task: Textual/Abt-Buy, loss: 0.7155978679656982
Gradient overflow.  Skipping step, loss scaler 0 reducing loss scale to 16384.0
Gradient overflow.  Skipping step, loss scaler 0 reducing loss scale to 8192.0
step: 10, task: Textual/Abt-Buy, loss: 0.6989644765853882
step: 20, task: Textual/Abt-Buy, loss: 0.63669353723526
step: 30, task: Textual/Abt-Buy, loss: 0.5538969039916992
step: 40, task: Textual/Abt-Buy, loss: 0.41239163279533386
step: 50, task: Textual/Abt-Buy, loss: 0.23382747173309326
step: 60, task: Textual/Abt-Buy, loss: 0.10354989022016525
step: 70, task: Textual/Abt-Buy, loss: 0.12161644548177719
step: 80, task: Textual/Abt-Buy, loss: 0.24437028169631958
step: 90, task: Textual/Abt-Buy, loss: 0.08847606927156448
step: 100, task: Textual/Abt-Buy, loss: 0.22550652921199799
step: 110, task: Textual/Abt-Buy, loss: 0.4964979887008667
step: 120, task: Textual/Abt-Buy, loss: 0.5758634805679321
step: 130, task: Textual/Abt-Buy, loss: 0.40572288632392883
step: 140, task: Textual/Abt-Buy, loss: 0.4425271153450012
step: 150, task: Textual/Abt-Buy, loss: 0.446630597114563
step: 160, task: Textual/Abt-Buy, loss: 0.32535573840141296
step: 170, task: Textual/Abt-Buy, loss: 0.5501556992530823
step: 180, task: Textual/Abt-Buy, loss: 0.4509594738483429
step: 190, task: Textual/Abt-Buy, loss: 0.20716452598571777
step: 200, task: Textual/Abt-Buy, loss: 0.3660963475704193
step: 210, task: Textual/Abt-Buy, loss: 0.4037848711013794
step: 220, task: Textual/Abt-Buy, loss: 0.4452322721481323
step: 230, task: Textual/Abt-Buy, loss: 0.2509465217590332
step: 240, task: Textual/Abt-Buy, loss: 0.3900468051433563
step: 250, task: Textual/Abt-Buy, loss: 0.3617469072341919
step: 260, task: Textual/Abt-Buy, loss: 0.28314000368118286
step: 270, task: Textual/Abt-Buy, loss: 0.29230642318725586
step: 280, task: Textual/Abt-Buy, loss: 0.40102076530456543
step: 290, task: Textual/Abt-Buy, loss: 0.4835105240345001
step: 300, task: Textual/Abt-Buy, loss: 0.5433436036109924
step: 310, task: Textual/Abt-Buy, loss: 0.4338587820529938
step: 320, task: Textual/Abt-Buy, loss: 0.3563902974128723
step: 330, task: Textual/Abt-Buy, loss: 0.09425122290849686
step: 340, task: Textual/Abt-Buy, loss: 0.3964393734931946
step: 350, task: Textual/Abt-Buy, loss: 0.25212129950523376
=========eval at epoch=1=========
Validation:
=============Textual/Abt-Buy==================
accuracy=0.892
precision=0.000
recall=0.000
f1=0.000
======================================
Test:
=============Textual/Abt-Buy==================
accuracy=0.892
precision=0.000
recall=0.000
f1=0.000
======================================
/w/246/tianyu2020/miniconda2/envs/ditto/lib/python3.7/site-packages/apex/amp/_initialize.py:24: UserWarning: An input tensor was not cuda.
  warnings.warn("An input tensor was not cuda.")
/w/246/tianyu2020/miniconda2/envs/ditto/lib/python3.7/site-packages/torch/optim/lr_scheduler.py:122: UserWarning: Detected call of `lr_scheduler.step()` before `optimizer.step()`. In PyTorch 1.1.0 and later, you should call them in the opposite order: `optimizer.step()` before `lr_scheduler.step()`.  Failure to do this will result in PyTorch skipping the first value of the learning rate schedule. See more details at https://pytorch.org/docs/stable/optim.html#how-to-adjust-learning-rate
  "https://pytorch.org/docs/stable/optim.html#how-to-adjust-learning-rate", UserWarning)
/w/246/tianyu2020/miniconda2/envs/ditto/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1221: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
=====sanity check======
words: COL name VAL canon red photo ink cartridge cli8r COL description VAL canon red photo ink cartridge cli8r fine technology for exceptional sharpness & detail compatible with canon pixma pro9000 COL price VAL 16.0  [SEP] COL name VAL canon bci-6 color ink cartridges 4705a018 COL description VAL black , cyan , magenta , yellow , light cyan , light magenta COL price VAL 59.99 
x: [    0 18047   766 27445 32839  1275  1345 16019 41785  3741   118   398
   338 14857  8194 27445 32839  1275  1345 16019 41785  3741   118   398
   338  2051   806    13  9297  4406  1825   359  4617 16632    19 32839
   181  3181  1916  1759   466   151 14857   425 27445   545     4   288
  1437     2     2 18047   766 27445 32839   741  2520    12   401  3195
 16019 38661   204 35278   102 33352 14857  8194 27445   909  2156 39493
  2156  9931 16586  2156  5718  2156  1109 39493  2156  1109  9931 16586
 14857   425 27445  5169     4  2831  1437     2]
tokens: ['<s>', 'COL', 'Ġname', 'ĠVAL', 'Ġcanon', 'Ġred', 'Ġphoto', 'Ġink', 'Ġcartridge', 'Ġcl', 'i', '8', 'r', 'ĠCOL', 'Ġdescription', 'ĠVAL', 'Ġcanon', 'Ġred', 'Ġphoto', 'Ġink', 'Ġcartridge', 'Ġcl', 'i', '8', 'r', 'Ġfine', 'Ġtechnology', 'Ġfor', 'Ġexceptional', 'Ġsharp', 'ness', 'Ġ&', 'Ġdetail', 'Ġcompatible', 'Ġwith', 'Ġcanon', 'Ġp', 'ix', 'ma', 'Ġpro', '9', '000', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ16', '.', '0', 'Ġ', '</s>', '</s>', 'COL', 'Ġname', 'ĠVAL', 'Ġcanon', 'Ġb', 'ci', '-', '6', 'Ġcolor', 'Ġink', 'Ġcartridges', 'Ġ4', '705', 'a', '018', 'ĠCOL', 'Ġdescription', 'ĠVAL', 'Ġblack', 'Ġ,', 'Ġcyan', 'Ġ,', 'Ġmag', 'enta', 'Ġ,', 'Ġyellow', 'Ġ,', 'Ġlight', 'Ġcyan', 'Ġ,', 'Ġlight', 'Ġmag', 'enta', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ59', '.', '99', 'Ġ', '</s>']
is_heads: [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
y: 0
tags: 0
mask: tensor([1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1])
seqlen: 92
task_name: Textual/Abt-Buy
=======================
step: 0, task: Textual/Abt-Buy, loss: 0.36796367168426514
step: 10, task: Textual/Abt-Buy, loss: 0.35723182559013367
step: 20, task: Textual/Abt-Buy, loss: 0.367418110370636
step: 30, task: Textual/Abt-Buy, loss: 0.08673235028982162
step: 40, task: Textual/Abt-Buy, loss: 0.2189469337463379
step: 50, task: Textual/Abt-Buy, loss: 0.3964425325393677
step: 60, task: Textual/Abt-Buy, loss: 0.5386152863502502
step: 70, task: Textual/Abt-Buy, loss: 0.3820192515850067
step: 80, task: Textual/Abt-Buy, loss: 0.5125201344490051
step: 90, task: Textual/Abt-Buy, loss: 0.3664608597755432
step: 100, task: Textual/Abt-Buy, loss: 0.48575299978256226
step: 110, task: Textual/Abt-Buy, loss: 0.26472780108451843
step: 120, task: Textual/Abt-Buy, loss: 0.2606162428855896
step: 130, task: Textual/Abt-Buy, loss: 0.13357365131378174
step: 140, task: Textual/Abt-Buy, loss: 0.258716881275177
step: 150, task: Textual/Abt-Buy, loss: 0.06620350480079651
step: 160, task: Textual/Abt-Buy, loss: 0.2942587733268738
step: 170, task: Textual/Abt-Buy, loss: 0.2521984279155731
step: 180, task: Textual/Abt-Buy, loss: 0.6128167510032654
step: 190, task: Textual/Abt-Buy, loss: 0.08765573054552078
step: 200, task: Textual/Abt-Buy, loss: 0.2759832739830017
step: 210, task: Textual/Abt-Buy, loss: 0.4077918231487274
step: 220, task: Textual/Abt-Buy, loss: 0.3979610800743103
step: 230, task: Textual/Abt-Buy, loss: 0.4038773775100708
step: 240, task: Textual/Abt-Buy, loss: 0.5439196825027466
step: 250, task: Textual/Abt-Buy, loss: 0.39320695400238037
step: 260, task: Textual/Abt-Buy, loss: 0.22903582453727722
step: 270, task: Textual/Abt-Buy, loss: 0.8470968008041382
step: 280, task: Textual/Abt-Buy, loss: 0.24960047006607056
step: 290, task: Textual/Abt-Buy, loss: 0.4820094704627991
step: 300, task: Textual/Abt-Buy, loss: 0.26016923785209656
step: 310, task: Textual/Abt-Buy, loss: 0.2318044900894165
step: 320, task: Textual/Abt-Buy, loss: 0.12036990374326706
step: 330, task: Textual/Abt-Buy, loss: 0.3761717975139618
step: 340, task: Textual/Abt-Buy, loss: 0.2340134084224701
step: 350, task: Textual/Abt-Buy, loss: 0.21488310396671295
=========eval at epoch=1=========
Validation:
=============Textual/Abt-Buy==================
accuracy=0.892
precision=0.000
recall=0.000
f1=0.000
======================================
Test:
=============Textual/Abt-Buy==================
accuracy=0.892
precision=0.000
recall=0.000
f1=0.000
======================================
=====sanity check======
words: COL name VAL apple 120gb black 7th generation ipod classic mb565lla COL description VAL apple 120gb black 7th generation ipod classic mb565lla holds up to 30,000 songs in 128-kbps aac format , 25,000 ipod-viewable photos and 150 hours of video 2.5 ' ( diagonal ) color lcd with led backlight 320-by-240-pixel resolution mac and windows compatible black finish COL price VAL   [SEP] COL name VAL apple 8gb ipod nano green ( 4th generation ) mb745ll/a COL description VAL  COL price VAL 139.88 
x: [    0 18047   766 27445 15162  5962 19562   909   262   212  2706 36180
  1630  4187   475   428 37402  5104 14857  8194 27445 15162  5962 19562
   909   262   212  2706 36180  1630  4187   475   428 37402  5104  3106
    62     7   389     6   151  3686    11 13950    12   330 27072    10
  1043  7390  2156   564     6   151 36180  1630    12  5877   868  2356
     8  3982   722     9   569   132     4   245   128    36 42539  4839
  3195   784 28690    19   669   124  6991 21947    12  1409    12 18847
    12 44546  3547 13418     8  6410 16632   909  2073 14857   425 27445
  1437  1437     2     2 18047   766 27445 15162   290 19562 36180  1630
 36924  2272    36   204   212  2706  4839   475   428 35868   890    73
   102 14857  8194 27445  1437 14857   425 27445 24404     4  4652  1437
     2]
tokens: ['<s>', 'COL', 'Ġname', 'ĠVAL', 'Ġapple', 'Ġ120', 'gb', 'Ġblack', 'Ġ7', 'th', 'Ġgeneration', 'Ġip', 'od', 'Ġclassic', 'Ġm', 'b', '565', 'lla', 'ĠCOL', 'Ġdescription', 'ĠVAL', 'Ġapple', 'Ġ120', 'gb', 'Ġblack', 'Ġ7', 'th', 'Ġgeneration', 'Ġip', 'od', 'Ġclassic', 'Ġm', 'b', '565', 'lla', 'Ġholds', 'Ġup', 'Ġto', 'Ġ30', ',', '000', 'Ġsongs', 'Ġin', 'Ġ128', '-', 'k', 'bps', 'Ġa', 'ac', 'Ġformat', 'Ġ,', 'Ġ25', ',', '000', 'Ġip', 'od', '-', 'view', 'able', 'Ġphotos', 'Ġand', 'Ġ150', 'Ġhours', 'Ġof', 'Ġvideo', 'Ġ2', '.', '5', "Ġ'", 'Ġ(', 'Ġdiagonal', 'Ġ)', 'Ġcolor', 'Ġl', 'cd', 'Ġwith', 'Ġled', 'Ġback', 'light', 'Ġ320', '-', 'by', '-', '240', '-', 'pixel', 'Ġresolution', 'Ġmac', 'Ġand', 'Ġwindows', 'Ġcompatible', 'Ġblack', 'Ġfinish', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ', 'Ġ', '</s>', '</s>', 'COL', 'Ġname', 'ĠVAL', 'Ġapple', 'Ġ8', 'gb', 'Ġip', 'od', 'Ġnano', 'Ġgreen', 'Ġ(', 'Ġ4', 'th', 'Ġgeneration', 'Ġ)', 'Ġm', 'b', '745', 'll', '/', 'a', 'ĠCOL', 'Ġdescription', 'ĠVAL', 'Ġ', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ139', '.', '88', 'Ġ', '</s>']
is_heads: [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
y: 0
tags: 0
mask: tensor([1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1])
seqlen: 133
task_name: Textual/Abt-Buy
=======================
step: 0, task: Textual/Abt-Buy, loss: 0.22895079851150513
step: 10, task: Textual/Abt-Buy, loss: 0.39709997177124023
step: 20, task: Textual/Abt-Buy, loss: 0.7738878130912781
step: 30, task: Textual/Abt-Buy, loss: 0.2564639747142792
step: 40, task: Textual/Abt-Buy, loss: 0.08980204910039902
step: 50, task: Textual/Abt-Buy, loss: 0.4558592438697815
step: 60, task: Textual/Abt-Buy, loss: 0.12794087827205658
step: 70, task: Textual/Abt-Buy, loss: 0.21961592137813568
step: 80, task: Textual/Abt-Buy, loss: 0.4105825126171112
step: 90, task: Textual/Abt-Buy, loss: 0.1552126705646515
step: 100, task: Textual/Abt-Buy, loss: 0.22824063897132874
step: 110, task: Textual/Abt-Buy, loss: 0.41028010845184326
step: 120, task: Textual/Abt-Buy, loss: 0.2396223396062851
step: 130, task: Textual/Abt-Buy, loss: 0.3797737956047058
step: 140, task: Textual/Abt-Buy, loss: 0.2599024474620819
step: 150, task: Textual/Abt-Buy, loss: 0.12341886758804321
step: 160, task: Textual/Abt-Buy, loss: 0.5481099486351013
step: 170, task: Textual/Abt-Buy, loss: 0.24975109100341797
step: 180, task: Textual/Abt-Buy, loss: 0.489976167678833
step: 190, task: Textual/Abt-Buy, loss: 0.09634634852409363
step: 200, task: Textual/Abt-Buy, loss: 0.36395400762557983
step: 210, task: Textual/Abt-Buy, loss: 0.10865727812051773
step: 220, task: Textual/Abt-Buy, loss: 0.099179707467556
step: 230, task: Textual/Abt-Buy, loss: 0.5062136054039001
step: 240, task: Textual/Abt-Buy, loss: 0.3974027633666992
step: 250, task: Textual/Abt-Buy, loss: 0.6549400091171265
step: 260, task: Textual/Abt-Buy, loss: 0.27568337321281433
step: 270, task: Textual/Abt-Buy, loss: 0.09273569285869598
step: 280, task: Textual/Abt-Buy, loss: 0.5977245569229126
step: 290, task: Textual/Abt-Buy, loss: 0.4932810068130493
step: 300, task: Textual/Abt-Buy, loss: 0.2865624725818634
step: 310, task: Textual/Abt-Buy, loss: 0.3622613251209259
step: 320, task: Textual/Abt-Buy, loss: 0.4225952923297882
step: 330, task: Textual/Abt-Buy, loss: 0.22901494801044464
step: 340, task: Textual/Abt-Buy, loss: 0.4888049364089966
step: 350, task: Textual/Abt-Buy, loss: 0.26868540048599243
=========eval at epoch=1=========
Validation:
=============Textual/Abt-Buy==================
accuracy=0.892
precision=0.000
recall=0.000
f1=0.000
======================================
Test:
=============Textual/Abt-Buy==================
accuracy=0.892
precision=0.000
recall=0.000
f1=0.000
======================================
=====sanity check======
words: COL name VAL universal rf series mastercontrol remote control rf20 COL description VAL universal rf series mastercontrol remote control ? rf20 control up to 10 components 432 macropower buttons customizable lcd screen pre-programmed codes learning capable simplesound fully backlit keypad dvd guide COL price VAL 79.99  [SEP] COL name VAL universal remote control mrf-350 addressable narrow band rf base station with rfx-250 antenna COL description VAL  COL price VAL 174.72 
x: [    0 18047   766 27445 10547   910   506   651  4710 17665  6063   797
   910   506   844 14857  8194 27445 10547   910   506   651  4710 17665
  6063   797 17487   910   506   844   797    62     7   158  6411 40870
 13418  6884  8285 14893 36036   784 28690  2441  1198    12 28644  4567
 14284  2239  4453 16207 12349  9834  1950   124 13534   762 19320   385
 40311  4704 14857   425 27445  7589     4  2831  1437     2     2 18047
   766 27445 10547  6063   797   475 29898    12 10056  1100   868  6787
  1971   910   506  1542  1992    19   910 44830    12  5714 29236 14857
  8194 27445  1437 14857   425 27445 28816     4  4956  1437     2]
tokens: ['<s>', 'COL', 'Ġname', 'ĠVAL', 'Ġuniversal', 'Ġr', 'f', 'Ġseries', 'Ġmaster', 'control', 'Ġremote', 'Ġcontrol', 'Ġr', 'f', '20', 'ĠCOL', 'Ġdescription', 'ĠVAL', 'Ġuniversal', 'Ġr', 'f', 'Ġseries', 'Ġmaster', 'control', 'Ġremote', 'Ġcontrol', 'Ġ?', 'Ġr', 'f', '20', 'Ġcontrol', 'Ġup', 'Ġto', 'Ġ10', 'Ġcomponents', 'Ġ432', 'Ġmac', 'rop', 'ower', 'Ġbuttons', 'Ġcustomizable', 'Ġl', 'cd', 'Ġscreen', 'Ġpre', '-', 'program', 'med', 'Ġcodes', 'Ġlearning', 'Ġcapable', 'Ġsim', 'ples', 'ound', 'Ġfully', 'Ġback', 'lit', 'Ġkey', 'pad', 'Ġd', 'vd', 'Ġguide', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ79', '.', '99', 'Ġ', '</s>', '</s>', 'COL', 'Ġname', 'ĠVAL', 'Ġuniversal', 'Ġremote', 'Ġcontrol', 'Ġm', 'rf', '-', '350', 'Ġaddress', 'able', 'Ġnarrow', 'Ġband', 'Ġr', 'f', 'Ġbase', 'Ġstation', 'Ġwith', 'Ġr', 'fx', '-', '250', 'Ġantenna', 'ĠCOL', 'Ġdescription', 'ĠVAL', 'Ġ', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ174', '.', '72', 'Ġ', '</s>']
is_heads: [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
y: 0
tags: 0
mask: tensor([1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1])
seqlen: 107
task_name: Textual/Abt-Buy
=======================
step: 0, task: Textual/Abt-Buy, loss: 0.49419647455215454
step: 10, task: Textual/Abt-Buy, loss: 0.2646249234676361
step: 20, task: Textual/Abt-Buy, loss: 0.09149008244276047
step: 30, task: Textual/Abt-Buy, loss: 0.3815959692001343
step: 40, task: Textual/Abt-Buy, loss: 0.24076396226882935
step: 50, task: Textual/Abt-Buy, loss: 0.12793001532554626
step: 60, task: Textual/Abt-Buy, loss: 0.23634514212608337
step: 70, task: Textual/Abt-Buy, loss: 0.6616583466529846
step: 80, task: Textual/Abt-Buy, loss: 0.4020112156867981
step: 90, task: Textual/Abt-Buy, loss: 0.47019654512405396
step: 100, task: Textual/Abt-Buy, loss: 0.23503930866718292
step: 110, task: Textual/Abt-Buy, loss: 0.11278809607028961
step: 120, task: Textual/Abt-Buy, loss: 0.588961124420166
step: 130, task: Textual/Abt-Buy, loss: 0.3408015966415405
step: 140, task: Textual/Abt-Buy, loss: 0.3534141182899475
step: 150, task: Textual/Abt-Buy, loss: 0.4535200297832489
step: 160, task: Textual/Abt-Buy, loss: 0.3620818853378296
step: 170, task: Textual/Abt-Buy, loss: 0.24007698893547058
step: 180, task: Textual/Abt-Buy, loss: 0.4986236095428467
step: 190, task: Textual/Abt-Buy, loss: 0.48712974786758423
step: 200, task: Textual/Abt-Buy, loss: 0.12860631942749023
step: 210, task: Textual/Abt-Buy, loss: 0.5310108065605164
step: 220, task: Textual/Abt-Buy, loss: 0.5443377494812012
step: 230, task: Textual/Abt-Buy, loss: 0.6560325026512146
step: 240, task: Textual/Abt-Buy, loss: 0.13557565212249756
step: 250, task: Textual/Abt-Buy, loss: 0.41617846488952637
step: 260, task: Textual/Abt-Buy, loss: 0.11517753452062607
step: 270, task: Textual/Abt-Buy, loss: 0.2348325550556183
step: 280, task: Textual/Abt-Buy, loss: 0.23023301362991333
step: 290, task: Textual/Abt-Buy, loss: 0.552178680896759
step: 300, task: Textual/Abt-Buy, loss: 0.21413207054138184
step: 310, task: Textual/Abt-Buy, loss: 0.26479530334472656
step: 320, task: Textual/Abt-Buy, loss: 0.36205750703811646
step: 330, task: Textual/Abt-Buy, loss: 0.3976345658302307
step: 340, task: Textual/Abt-Buy, loss: 0.19811637699604034
step: 350, task: Textual/Abt-Buy, loss: 0.10143385827541351
=========eval at epoch=1=========
Validation:
=============Textual/Abt-Buy==================
accuracy=0.892
precision=0.000
recall=0.000
f1=0.000
======================================
Test:
=============Textual/Abt-Buy==================
accuracy=0.892
precision=0.000
recall=0.000
f1=0.000
======================================
=====sanity check======
words: COL name VAL panasonic viera 42 ' plasma flat panel hdtv in black th42px80u COL description VAL panasonic viera 42 ' plasma flat panel hdtv in black th42px80u 720p display 1024 x 768 native resolution color purity optimizer surround sound anti-reflective filter viera link hdavi control built-in ntsc/atsc/qam tuners 3 hdmi inputs built-in galleryplayer capable sd card memory slot pedestal stand included black finish COL price VAL   [SEP] COL name VAL panasonic viera th-50pz850u 50 ' plasma tv COL description VAL 50 ' atsc , ntsc 16:9 1920 x 1080 hdtv COL price VAL 2096.99 
x: [    0 18047   766 27445  5730 38703   748 16432  3330   128 29051  3269
  2798  1368   417 18724    11   909  3553  3714 38740  2940   257 14857
  8194 27445  5730 38703   748 16432  3330   128 29051  3269  2798  1368
   417 18724    11   909  3553  3714 38740  2940   257 26180   642  2332
 46959  3023 43751  3763  3547  3195 32195 17775  6315 21104  2369  1475
    12 39878  2088 14929   748 16432  3104  1368   417 11132   797  1490
    12   179   295  1872   438    73  2923   438    73  1343   424 27115
   268   155  1368   417  5408 16584  1490    12   179  7294 23233  4453
 46409  1886  3783  8534 38238   337  1413  1165   909  2073 14857   425
 27445  1437  1437     2     2 18047   766 27445  5730 38703   748 16432
  3553    12  1096   642   329 19270   257   654   128 29051 30016 14857
  8194 27445   654   128    23  3866  2156   295  1872   438   545    35
   466 18283  3023 21083  1368   417 18724 14857   425 27445   291  5607
     4  2831  1437     2]
tokens: ['<s>', 'COL', 'Ġname', 'ĠVAL', 'Ġpan', 'asonic', 'Ġv', 'iera', 'Ġ42', "Ġ'", 'Ġplasma', 'Ġflat', 'Ġpanel', 'Ġh', 'd', 'tv', 'Ġin', 'Ġblack', 'Ġth', '42', 'px', '80', 'u', 'ĠCOL', 'Ġdescription', 'ĠVAL', 'Ġpan', 'asonic', 'Ġv', 'iera', 'Ġ42', "Ġ'", 'Ġplasma', 'Ġflat', 'Ġpanel', 'Ġh', 'd', 'tv', 'Ġin', 'Ġblack', 'Ġth', '42', 'px', '80', 'u', 'Ġ720', 'p', 'Ġdisplay', 'Ġ1024', 'Ġx', 'Ġ768', 'Ġnative', 'Ġresolution', 'Ġcolor', 'Ġpurity', 'Ġoptim', 'izer', 'Ġsurround', 'Ġsound', 'Ġanti', '-', 'reflect', 'ive', 'Ġfilter', 'Ġv', 'iera', 'Ġlink', 'Ġh', 'd', 'avi', 'Ġcontrol', 'Ġbuilt', '-', 'in', 'Ġn', 'ts', 'c', '/', 'ats', 'c', '/', 'q', 'am', 'Ġtun', 'ers', 'Ġ3', 'Ġh', 'd', 'mi', 'Ġinputs', 'Ġbuilt', '-', 'in', 'Ġgallery', 'player', 'Ġcapable', 'Ġsd', 'Ġcard', 'Ġmemory', 'Ġslot', 'Ġpedest', 'al', 'Ġstand', 'Ġincluded', 'Ġblack', 'Ġfinish', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ', 'Ġ', '</s>', '</s>', 'COL', 'Ġname', 'ĠVAL', 'Ġpan', 'asonic', 'Ġv', 'iera', 'Ġth', '-', '50', 'p', 'z', '850', 'u', 'Ġ50', "Ġ'", 'Ġplasma', 'Ġtv', 'ĠCOL', 'Ġdescription', 'ĠVAL', 'Ġ50', "Ġ'", 'Ġat', 'sc', 'Ġ,', 'Ġn', 'ts', 'c', 'Ġ16', ':', '9', 'Ġ1920', 'Ġx', 'Ġ1080', 'Ġh', 'd', 'tv', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ20', '96', '.', '99', 'Ġ', '</s>']
is_heads: [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
y: 0
tags: 0
mask: tensor([1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1])
seqlen: 160
task_name: Textual/Abt-Buy
=======================
step: 0, task: Textual/Abt-Buy, loss: 0.17336329817771912
step: 10, task: Textual/Abt-Buy, loss: 0.5866562128067017
step: 20, task: Textual/Abt-Buy, loss: 0.8631718158721924
step: 30, task: Textual/Abt-Buy, loss: 0.6039447784423828
step: 40, task: Textual/Abt-Buy, loss: 0.8795191645622253
step: 50, task: Textual/Abt-Buy, loss: 0.3619454503059387
step: 60, task: Textual/Abt-Buy, loss: 0.376389741897583
step: 70, task: Textual/Abt-Buy, loss: 0.2581784725189209
step: 80, task: Textual/Abt-Buy, loss: 0.23512016236782074
step: 90, task: Textual/Abt-Buy, loss: 0.2563355565071106
step: 100, task: Textual/Abt-Buy, loss: 0.2592740058898926
step: 110, task: Textual/Abt-Buy, loss: 0.08555058389902115
step: 120, task: Textual/Abt-Buy, loss: 0.29589056968688965
step: 130, task: Textual/Abt-Buy, loss: 0.24897703528404236
step: 140, task: Textual/Abt-Buy, loss: 0.45491600036621094
step: 150, task: Textual/Abt-Buy, loss: 0.24972006678581238
step: 160, task: Textual/Abt-Buy, loss: 0.24520179629325867
step: 170, task: Textual/Abt-Buy, loss: 0.25722748041152954
step: 180, task: Textual/Abt-Buy, loss: 0.8216515779495239
step: 190, task: Textual/Abt-Buy, loss: 0.3977401852607727
step: 200, task: Textual/Abt-Buy, loss: 0.4951215982437134
step: 210, task: Textual/Abt-Buy, loss: 0.41594424843788147
step: 220, task: Textual/Abt-Buy, loss: 0.4965522885322571
step: 230, task: Textual/Abt-Buy, loss: 0.49618881940841675
step: 240, task: Textual/Abt-Buy, loss: 0.14332124590873718
step: 250, task: Textual/Abt-Buy, loss: 0.0860113874077797
step: 260, task: Textual/Abt-Buy, loss: 0.2032012790441513
step: 270, task: Textual/Abt-Buy, loss: 0.35856571793556213
step: 280, task: Textual/Abt-Buy, loss: 0.2627977728843689
step: 290, task: Textual/Abt-Buy, loss: 0.2611689269542694
step: 300, task: Textual/Abt-Buy, loss: 0.4425734281539917
step: 310, task: Textual/Abt-Buy, loss: 0.2193630039691925
step: 320, task: Textual/Abt-Buy, loss: 0.41104650497436523
step: 330, task: Textual/Abt-Buy, loss: 0.4821641147136688
step: 340, task: Textual/Abt-Buy, loss: 0.2353469431400299
step: 350, task: Textual/Abt-Buy, loss: 0.22055783867835999
=========eval at epoch=1=========
Validation:
=============Textual/Abt-Buy==================
accuracy=0.892
precision=0.000
recall=0.000
f1=0.000
======================================
Test:
=============Textual/Abt-Buy==================
accuracy=0.892
precision=0.000
recall=0.000
f1=0.000
======================================
=====sanity check======
words: COL name VAL sony blu-ray disc player bdps550 COL description VAL sony blu-ray disc player bdps550 decode dolby truehd and dts hd internally full hd 1080 video output 24p true cinema dvd upscaling to 1080p via hdmi bravia theatre sync ( hdmi-cec ) bd/dvd/cd playback and avchd with x.v. color output dolby digital plus decoding backlit remote glass front finish COL price VAL   [SEP] COL name VAL denon dvd-3800bdci blu-ray disc player dvd3800bdci COL description VAL bd-r , dvd-rw , cd-rw , secure digital ( sd ) dvd video , cd-da , mp3 , wma , jpeg , divx 6 , pcm playback progressive scan COL price VAL  
x: [    0 18047   766 27445   579  6119 42034    12  5022  9553   869   741
   417  3275 17953 14857  8194 27445   579  6119 42034    12  5022  9553
   869   741   417  3275 17953 45182   385  1168  1409  1528 35905     8
   385  1872  1368   417 16985   455  1368   417 21083   569  4195   706
   642  1528 11605   385 40311    62  3866  8279     7 21083   642  1241
  1368   417  5408 35977   493  8870 22785    36  1368   417  5408    12
  1755   438  4839   741   417    73   417 40311    73 28690 20083     8
  6402   611   417    19  3023     4   705     4  3195  4195   385  1168
  1409  1778  2704 46133   124 13534  6063  4049   760  2073 14857   425
 27445  1437  1437     2     2 18047   766 27445  3069   261   385 40311
    12  3170   612 35470  2520 42034    12  5022  9553   869   385 40311
  3170   612 35470  2520 14857  8194 27445   741   417    12   338  2156
   385 40311    12 43926  2156 45584    12 43926  2156  2823  1778    36
 46409  4839   385 40311   569  2156 45584    12  6106  2156 44857   246
  2156   885  1916  2156  1236 41191  2156 14445  1178   231  2156   181
 13753 20083  8212 14194 14857   425 27445  1437  1437     2]
tokens: ['<s>', 'COL', 'Ġname', 'ĠVAL', 'Ġs', 'ony', 'Ġblu', '-', 'ray', 'Ġdisc', 'Ġplayer', 'Ġb', 'd', 'ps', '550', 'ĠCOL', 'Ġdescription', 'ĠVAL', 'Ġs', 'ony', 'Ġblu', '-', 'ray', 'Ġdisc', 'Ġplayer', 'Ġb', 'd', 'ps', '550', 'Ġdecode', 'Ġd', 'ol', 'by', 'Ġtrue', 'hd', 'Ġand', 'Ġd', 'ts', 'Ġh', 'd', 'Ġinternally', 'Ġfull', 'Ġh', 'd', 'Ġ1080', 'Ġvideo', 'Ġoutput', 'Ġ24', 'p', 'Ġtrue', 'Ġcinema', 'Ġd', 'vd', 'Ġup', 'sc', 'aling', 'Ġto', 'Ġ1080', 'p', 'Ġvia', 'Ġh', 'd', 'mi', 'Ġbrav', 'ia', 'Ġtheatre', 'Ġsync', 'Ġ(', 'Ġh', 'd', 'mi', '-', 'ce', 'c', 'Ġ)', 'Ġb', 'd', '/', 'd', 'vd', '/', 'cd', 'Ġplayback', 'Ġand', 'Ġav', 'ch', 'd', 'Ġwith', 'Ġx', '.', 'v', '.', 'Ġcolor', 'Ġoutput', 'Ġd', 'ol', 'by', 'Ġdigital', 'Ġplus', 'Ġdecoding', 'Ġback', 'lit', 'Ġremote', 'Ġglass', 'Ġfront', 'Ġfinish', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ', 'Ġ', '</s>', '</s>', 'COL', 'Ġname', 'ĠVAL', 'Ġden', 'on', 'Ġd', 'vd', '-', '38', '00', 'bd', 'ci', 'Ġblu', '-', 'ray', 'Ġdisc', 'Ġplayer', 'Ġd', 'vd', '38', '00', 'bd', 'ci', 'ĠCOL', 'Ġdescription', 'ĠVAL', 'Ġb', 'd', '-', 'r', 'Ġ,', 'Ġd', 'vd', '-', 'rw', 'Ġ,', 'Ġcd', '-', 'rw', 'Ġ,', 'Ġsecure', 'Ġdigital', 'Ġ(', 'Ġsd', 'Ġ)', 'Ġd', 'vd', 'Ġvideo', 'Ġ,', 'Ġcd', '-', 'da', 'Ġ,', 'Ġmp', '3', 'Ġ,', 'Ġw', 'ma', 'Ġ,', 'Ġj', 'peg', 'Ġ,', 'Ġdiv', 'x', 'Ġ6', 'Ġ,', 'Ġp', 'cm', 'Ġplayback', 'Ġprogressive', 'Ġscan', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ', 'Ġ', '</s>']
is_heads: [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
y: 0
tags: 0
mask: tensor([1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1])
seqlen: 190
task_name: Textual/Abt-Buy
=======================
step: 0, task: Textual/Abt-Buy, loss: 0.38124653697013855
step: 10, task: Textual/Abt-Buy, loss: 0.03894386813044548
step: 20, task: Textual/Abt-Buy, loss: 0.07808874547481537
step: 30, task: Textual/Abt-Buy, loss: 0.21247386932373047
step: 40, task: Textual/Abt-Buy, loss: 0.21220681071281433
step: 50, task: Textual/Abt-Buy, loss: 0.20542410016059875
step: 60, task: Textual/Abt-Buy, loss: 0.17847603559494019
step: 70, task: Textual/Abt-Buy, loss: 0.17306427657604218
step: 80, task: Textual/Abt-Buy, loss: 0.16831260919570923
step: 90, task: Textual/Abt-Buy, loss: 0.030212849378585815
step: 100, task: Textual/Abt-Buy, loss: 0.03155091777443886
step: 110, task: Textual/Abt-Buy, loss: 0.2969730496406555
step: 120, task: Textual/Abt-Buy, loss: 0.22029931843280792
step: 130, task: Textual/Abt-Buy, loss: 0.17143256962299347
step: 140, task: Textual/Abt-Buy, loss: 0.0723658874630928
step: 150, task: Textual/Abt-Buy, loss: 0.5413773059844971
step: 160, task: Textual/Abt-Buy, loss: 0.22936463356018066
step: 170, task: Textual/Abt-Buy, loss: 0.06203574314713478
step: 180, task: Textual/Abt-Buy, loss: 0.1708381623029709
step: 190, task: Textual/Abt-Buy, loss: 0.28097182512283325
step: 200, task: Textual/Abt-Buy, loss: 0.04522409290075302
step: 210, task: Textual/Abt-Buy, loss: 0.0640588253736496
step: 220, task: Textual/Abt-Buy, loss: 0.11670625954866409
step: 230, task: Textual/Abt-Buy, loss: 0.16724653542041779
step: 240, task: Textual/Abt-Buy, loss: 0.0764501616358757
step: 250, task: Textual/Abt-Buy, loss: 0.1184186115860939
step: 260, task: Textual/Abt-Buy, loss: 0.023786991834640503
step: 270, task: Textual/Abt-Buy, loss: 0.15249153971672058
step: 280, task: Textual/Abt-Buy, loss: 0.015040375292301178
step: 290, task: Textual/Abt-Buy, loss: 0.17855893075466156
step: 300, task: Textual/Abt-Buy, loss: 0.11653673648834229
step: 310, task: Textual/Abt-Buy, loss: 0.033821262419223785
step: 320, task: Textual/Abt-Buy, loss: 0.014711610972881317
step: 330, task: Textual/Abt-Buy, loss: 0.2349165380001068
step: 340, task: Textual/Abt-Buy, loss: 0.07445070892572403
step: 350, task: Textual/Abt-Buy, loss: 0.03742005676031113
=========eval at epoch=1=========
Validation:
=============Textual/Abt-Buy==================
accuracy=0.896
precision=0.684
recall=0.063
f1=0.116
======================================
Test:
=============Textual/Abt-Buy==================
accuracy=0.893
precision=0.545
recall=0.029
f1=0.055
======================================
=====sanity check======
words: COL name VAL whirlpool cabrio wtw6400sw top loading white washer wtw6400swh COL description VAL whirlpool cabrio wtw6400sw top loading white washer wtw6400swh 4.5 cu . ft. capacity direct inject wash system 6th sense technology care control temperature management ultra quiet wash noise reduction stainless steel wash drum 10 automatic cycles woolmark certified wool cycle automatic water level settings white finish COL price VAL   [SEP] COL name VAL whirlpool wfw8300sw 27 ' front-load washer w/3 .4 cu . ft. capacity ( white ) COL description VAL  COL price VAL 668.75 
x: [    0 18047   766 27445  8401 12862 10416 11148 12834   885 17137  4027
   612  4184   299 16761  1104    21  1843   885 17137  4027   612    29
 11613 14857  8194 27445  8401 12862 10416 11148 12834   885 17137  4027
   612  4184   299 16761  1104    21  1843   885 17137  4027   612    29
 11613   204     4   245  3729   479 16935     4  2148  2228 17951 10397
   467   231   212  1472   806   575   797  5181  1052  9620  5128 10397
  6496  4878 23486  3689 10397 12638   158  8408 16726 24787  6920  9785
 24787  4943  8408   514   672  9629  1104  2073 14857   425 27445  1437
  1437     2     2 18047   766 27445  8401 12862 10416   885 44860  6361
   612  4184   974   128   760    12 16204    21  1843   885    73   246
   479   306  3729   479 16935     4  2148    36  1104  4839 14857  8194
 27445  1437 14857   425 27445   231  4671     4  2545  1437     2]
tokens: ['<s>', 'COL', 'Ġname', 'ĠVAL', 'Ġwh', 'irl', 'pool', 'Ġcab', 'rio', 'Ġw', 'tw', '64', '00', 'sw', 'Ġtop', 'Ġloading', 'Ġwhite', 'Ġwas', 'her', 'Ġw', 'tw', '64', '00', 's', 'wh', 'ĠCOL', 'Ġdescription', 'ĠVAL', 'Ġwh', 'irl', 'pool', 'Ġcab', 'rio', 'Ġw', 'tw', '64', '00', 'sw', 'Ġtop', 'Ġloading', 'Ġwhite', 'Ġwas', 'her', 'Ġw', 'tw', '64', '00', 's', 'wh', 'Ġ4', '.', '5', 'Ġcu', 'Ġ.', 'Ġft', '.', 'Ġcapacity', 'Ġdirect', 'Ġinject', 'Ġwash', 'Ġsystem', 'Ġ6', 'th', 'Ġsense', 'Ġtechnology', 'Ġcare', 'Ġcontrol', 'Ġtemperature', 'Ġmanagement', 'Ġultra', 'Ġquiet', 'Ġwash', 'Ġnoise', 'Ġreduction', 'Ġstainless', 'Ġsteel', 'Ġwash', 'Ġdrum', 'Ġ10', 'Ġautomatic', 'Ġcycles', 'Ġwool', 'mark', 'Ġcertified', 'Ġwool', 'Ġcycle', 'Ġautomatic', 'Ġwater', 'Ġlevel', 'Ġsettings', 'Ġwhite', 'Ġfinish', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ', 'Ġ', '</s>', '</s>', 'COL', 'Ġname', 'ĠVAL', 'Ġwh', 'irl', 'pool', 'Ġw', 'fw', '83', '00', 'sw', 'Ġ27', "Ġ'", 'Ġfront', '-', 'load', 'Ġwas', 'her', 'Ġw', '/', '3', 'Ġ.', '4', 'Ġcu', 'Ġ.', 'Ġft', '.', 'Ġcapacity', 'Ġ(', 'Ġwhite', 'Ġ)', 'ĠCOL', 'Ġdescription', 'ĠVAL', 'Ġ', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ6', '68', '.', '75', 'Ġ', '</s>']
is_heads: [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
y: 0
tags: 0
mask: tensor([1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1])
seqlen: 143
task_name: Textual/Abt-Buy
=======================
step: 0, task: Textual/Abt-Buy, loss: 0.03331609442830086
step: 10, task: Textual/Abt-Buy, loss: 0.03940422087907791
step: 20, task: Textual/Abt-Buy, loss: 0.03546031191945076
step: 30, task: Textual/Abt-Buy, loss: 0.2213042676448822
step: 40, task: Textual/Abt-Buy, loss: 0.009860329329967499
step: 50, task: Textual/Abt-Buy, loss: 0.03211768716573715
step: 60, task: Textual/Abt-Buy, loss: 0.16727633774280548
Gradient overflow.  Skipping step, loss scaler 0 reducing loss scale to 8192.0
step: 70, task: Textual/Abt-Buy, loss: 0.06294561922550201
step: 80, task: Textual/Abt-Buy, loss: 0.17309746146202087
step: 90, task: Textual/Abt-Buy, loss: 0.013254702091217041
step: 100, task: Textual/Abt-Buy, loss: 0.17067576944828033
step: 110, task: Textual/Abt-Buy, loss: 0.048471011221408844
step: 120, task: Textual/Abt-Buy, loss: 0.19798798859119415
step: 130, task: Textual/Abt-Buy, loss: 0.10508894920349121
step: 140, task: Textual/Abt-Buy, loss: 0.002643406391143799
step: 150, task: Textual/Abt-Buy, loss: 0.2800271511077881
step: 160, task: Textual/Abt-Buy, loss: 0.04233628511428833
step: 170, task: Textual/Abt-Buy, loss: 0.0168001726269722
step: 180, task: Textual/Abt-Buy, loss: 0.2927069067955017
step: 190, task: Textual/Abt-Buy, loss: 0.06579560041427612
step: 200, task: Textual/Abt-Buy, loss: 0.10962677001953125
step: 210, task: Textual/Abt-Buy, loss: 0.029598504304885864
step: 220, task: Textual/Abt-Buy, loss: 0.2995222210884094
step: 230, task: Textual/Abt-Buy, loss: 0.024811215698719025
step: 240, task: Textual/Abt-Buy, loss: 0.053962938487529755
step: 250, task: Textual/Abt-Buy, loss: 0.0119321309030056
step: 260, task: Textual/Abt-Buy, loss: 0.17197425663471222
step: 270, task: Textual/Abt-Buy, loss: 0.45518216490745544
step: 280, task: Textual/Abt-Buy, loss: 0.04600280895829201
step: 290, task: Textual/Abt-Buy, loss: 0.17720846831798553
step: 300, task: Textual/Abt-Buy, loss: 0.07380087673664093
step: 310, task: Textual/Abt-Buy, loss: 0.26547932624816895
step: 320, task: Textual/Abt-Buy, loss: 0.02847680076956749
step: 330, task: Textual/Abt-Buy, loss: 0.09267792105674744
step: 340, task: Textual/Abt-Buy, loss: 0.04955994337797165
step: 350, task: Textual/Abt-Buy, loss: 0.0888536348938942
=========eval at epoch=2=========
Validation:
=============Textual/Abt-Buy==================
accuracy=0.900
precision=0.792
recall=0.092
f1=0.165
======================================
Test:
=============Textual/Abt-Buy==================
accuracy=0.904
precision=0.789
recall=0.146
f1=0.246
======================================
=====sanity check======
words: COL name VAL sony silver cyber-shot digital camera dscs750 COL description VAL sony silver cyber-shot digital camera dscs750 7.2 megapixel super had ccd 2.5 ' lcd display 3x optical zoom high sensitivity mode auto focus 22 mb internal memory face detection burst mode convenient photo modes beginner-friendly function guide silver finish COL price VAL   [SEP] COL name VAL sony handycam dcr-sr45 digital camcorder dcrsr45 COL description VAL 16:9 2.7 ' hybrid lcd COL price VAL 304.99 
x: [    0 18047   766 27445   579  6119  4334  5381    12 10393  1778  2280
   385  3866    29 10569 14857  8194 27445   579  6119  4334  5381    12
 10393  1778  2280   385  3866    29 10569   262     4   176 10721 21424
  2422    56   740 28690   132     4   245   128   784 28690  2332   155
  1178 17547 21762   239 15608  5745  4485  1056   820   475   428  3425
  3783   652 12673 10084  5745 12148  1345 19180 37239    12  6928  5043
  4704  4334  2073 14857   425 27445  1437  1437     2     2 18047   766
 27445   579  6119 14732 16767   385  8344    12 37959  1898  1778 11021
   438 10337 46773  4926   338  1898 14857  8194 27445   545    35   466
   132     4   406   128  9284   784 28690 14857   425 27445 33121     4
  2831  1437     2]
tokens: ['<s>', 'COL', 'Ġname', 'ĠVAL', 'Ġs', 'ony', 'Ġsilver', 'Ġcyber', '-', 'shot', 'Ġdigital', 'Ġcamera', 'Ġd', 'sc', 's', '750', 'ĠCOL', 'Ġdescription', 'ĠVAL', 'Ġs', 'ony', 'Ġsilver', 'Ġcyber', '-', 'shot', 'Ġdigital', 'Ġcamera', 'Ġd', 'sc', 's', '750', 'Ġ7', '.', '2', 'Ġmeg', 'apixel', 'Ġsuper', 'Ġhad', 'Ġc', 'cd', 'Ġ2', '.', '5', "Ġ'", 'Ġl', 'cd', 'Ġdisplay', 'Ġ3', 'x', 'Ġoptical', 'Ġzoom', 'Ġhigh', 'Ġsensitivity', 'Ġmode', 'Ġauto', 'Ġfocus', 'Ġ22', 'Ġm', 'b', 'Ġinternal', 'Ġmemory', 'Ġface', 'Ġdetection', 'Ġburst', 'Ġmode', 'Ġconvenient', 'Ġphoto', 'Ġmodes', 'Ġbeginner', '-', 'friendly', 'Ġfunction', 'Ġguide', 'Ġsilver', 'Ġfinish', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ', 'Ġ', '</s>', '</s>', 'COL', 'Ġname', 'ĠVAL', 'Ġs', 'ony', 'Ġhandy', 'cam', 'Ġd', 'cr', '-', 'sr', '45', 'Ġdigital', 'Ġcam', 'c', 'order', 'Ġdc', 'rs', 'r', '45', 'ĠCOL', 'Ġdescription', 'ĠVAL', 'Ġ16', ':', '9', 'Ġ2', '.', '7', "Ġ'", 'Ġhybrid', 'Ġl', 'cd', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ304', '.', '99', 'Ġ', '</s>']
is_heads: [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
y: 0
tags: 0
mask: tensor([1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1])
seqlen: 123
task_name: Textual/Abt-Buy
=======================
step: 0, task: Textual/Abt-Buy, loss: 0.008665710687637329
step: 10, task: Textual/Abt-Buy, loss: 0.05928834527730942
step: 20, task: Textual/Abt-Buy, loss: 0.0791051983833313
step: 30, task: Textual/Abt-Buy, loss: 0.017608609050512314
step: 40, task: Textual/Abt-Buy, loss: 0.17650873959064484
step: 50, task: Textual/Abt-Buy, loss: 0.23913779854774475
step: 60, task: Textual/Abt-Buy, loss: 0.0335402674973011
step: 70, task: Textual/Abt-Buy, loss: 0.11853018403053284
step: 80, task: Textual/Abt-Buy, loss: 0.006976805627346039
step: 90, task: Textual/Abt-Buy, loss: 0.4303157329559326
step: 100, task: Textual/Abt-Buy, loss: 0.019130170345306396
step: 110, task: Textual/Abt-Buy, loss: 0.02534373849630356
step: 120, task: Textual/Abt-Buy, loss: 0.4735468029975891
step: 130, task: Textual/Abt-Buy, loss: 0.19227422773838043
step: 140, task: Textual/Abt-Buy, loss: 0.18149572610855103
step: 150, task: Textual/Abt-Buy, loss: 0.016959838569164276
step: 160, task: Textual/Abt-Buy, loss: 0.003566429018974304
step: 170, task: Textual/Abt-Buy, loss: 0.00670401006937027
step: 180, task: Textual/Abt-Buy, loss: 0.2089006006717682
step: 190, task: Textual/Abt-Buy, loss: 0.06932814419269562
step: 200, task: Textual/Abt-Buy, loss: 0.06269806623458862
step: 210, task: Textual/Abt-Buy, loss: 0.029739558696746826
step: 220, task: Textual/Abt-Buy, loss: 0.0046880170702934265
step: 230, task: Textual/Abt-Buy, loss: 0.004233110696077347
step: 240, task: Textual/Abt-Buy, loss: 0.044878847897052765
step: 250, task: Textual/Abt-Buy, loss: 0.0035418421030044556
step: 260, task: Textual/Abt-Buy, loss: 0.4432812035083771
step: 270, task: Textual/Abt-Buy, loss: 0.15759015083312988
step: 280, task: Textual/Abt-Buy, loss: 0.032454781234264374
step: 290, task: Textual/Abt-Buy, loss: 0.05751985311508179
step: 300, task: Textual/Abt-Buy, loss: 0.18468740582466125
step: 310, task: Textual/Abt-Buy, loss: 0.002261713147163391
step: 320, task: Textual/Abt-Buy, loss: 0.007046975195407867
step: 330, task: Textual/Abt-Buy, loss: 0.4320228099822998
step: 340, task: Textual/Abt-Buy, loss: 0.09580806642770767
step: 350, task: Textual/Abt-Buy, loss: 0.09400156140327454
=========eval at epoch=3=========
Validation:
=============Textual/Abt-Buy==================
accuracy=0.902
precision=0.952
recall=0.097
f1=0.176
======================================
Test:
=============Textual/Abt-Buy==================
accuracy=0.902
precision=0.909
recall=0.097
f1=0.175
======================================
=====sanity check======
words: COL name VAL logitech quickcam communicate stx 961464 COL description VAL logitech quickcam communicate stx 961464 640 x 480 video capture 1.3 megapixel still image capture built-in microphone with rightsound technology 30 frames per second adjustable base fits any monitor or notebook usb 2.0 certified COL price VAL 49.0  [SEP] COL name VAL logitech quickcam pro 9000 webcam 960-000048 COL description VAL logitech quickcam pro 9000 COL price VAL  
x: [    0 18047   766 27445  7425 30051  2119 16767  8469  1690  1178  8971
  1570  4027 14857  8194 27445  7425 30051  2119 16767  8469  1690  1178
  8971  1570  4027 37101  3023 26754   569  5604   112     4   246 10721
 21424   202  2274  5604  1490    12   179 18896    19   659  9834   806
   389 16420   228   200 29861  1542 10698   143  5271    50 27276 49030
   132     4   288  9785 14857   425 27445  2766     4   288  1437     2
     2 18047   766 27445  7425 30051  2119 16767  1759 43420 41348 39811
    12 14200  3818 14857  8194 27445  7425 30051  2119 16767  1759 43420
 14857   425 27445  1437  1437     2]
tokens: ['<s>', 'COL', 'Ġname', 'ĠVAL', 'Ġlog', 'itech', 'Ġquick', 'cam', 'Ġcommunicate', 'Ġst', 'x', 'Ġ96', '14', '64', 'ĠCOL', 'Ġdescription', 'ĠVAL', 'Ġlog', 'itech', 'Ġquick', 'cam', 'Ġcommunicate', 'Ġst', 'x', 'Ġ96', '14', '64', 'Ġ640', 'Ġx', 'Ġ480', 'Ġvideo', 'Ġcapture', 'Ġ1', '.', '3', 'Ġmeg', 'apixel', 'Ġstill', 'Ġimage', 'Ġcapture', 'Ġbuilt', '-', 'in', 'Ġmicrophone', 'Ġwith', 'Ġrights', 'ound', 'Ġtechnology', 'Ġ30', 'Ġframes', 'Ġper', 'Ġsecond', 'Ġadjustable', 'Ġbase', 'Ġfits', 'Ġany', 'Ġmonitor', 'Ġor', 'Ġnotebook', 'Ġusb', 'Ġ2', '.', '0', 'Ġcertified', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ49', '.', '0', 'Ġ', '</s>', '</s>', 'COL', 'Ġname', 'ĠVAL', 'Ġlog', 'itech', 'Ġquick', 'cam', 'Ġpro', 'Ġ9000', 'Ġwebcam', 'Ġ960', '-', '0000', '48', 'ĠCOL', 'Ġdescription', 'ĠVAL', 'Ġlog', 'itech', 'Ġquick', 'cam', 'Ġpro', 'Ġ9000', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ', 'Ġ', '</s>']
is_heads: [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
y: 0
tags: 0
mask: tensor([1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1])
seqlen: 102
task_name: Textual/Abt-Buy
=======================
step: 0, task: Textual/Abt-Buy, loss: 0.005771718919277191
step: 10, task: Textual/Abt-Buy, loss: 0.0026219338178634644
step: 20, task: Textual/Abt-Buy, loss: 0.16882140934467316
step: 30, task: Textual/Abt-Buy, loss: 0.022543665021657944
step: 40, task: Textual/Abt-Buy, loss: 0.021380819380283356
step: 50, task: Textual/Abt-Buy, loss: 0.2183191180229187
step: 60, task: Textual/Abt-Buy, loss: 0.11749918013811111
step: 70, task: Textual/Abt-Buy, loss: 0.006182081997394562
step: 80, task: Textual/Abt-Buy, loss: 0.022336885333061218
step: 90, task: Textual/Abt-Buy, loss: 0.013780754059553146
step: 100, task: Textual/Abt-Buy, loss: 0.008074827492237091
step: 110, task: Textual/Abt-Buy, loss: 0.004932031035423279
step: 120, task: Textual/Abt-Buy, loss: 0.04961515590548515
step: 130, task: Textual/Abt-Buy, loss: 0.13206592202186584
step: 140, task: Textual/Abt-Buy, loss: 0.002819761633872986
step: 150, task: Textual/Abt-Buy, loss: 0.003925777971744537
step: 160, task: Textual/Abt-Buy, loss: 0.005007699131965637
step: 170, task: Textual/Abt-Buy, loss: 0.07922028005123138
step: 180, task: Textual/Abt-Buy, loss: 0.0641060620546341
step: 190, task: Textual/Abt-Buy, loss: 0.016007423400878906
step: 200, task: Textual/Abt-Buy, loss: 0.01695207506418228
step: 210, task: Textual/Abt-Buy, loss: 0.0685221254825592
step: 220, task: Textual/Abt-Buy, loss: 0.00694979727268219
step: 230, task: Textual/Abt-Buy, loss: 0.007890965789556503
step: 240, task: Textual/Abt-Buy, loss: 0.005384407937526703
step: 250, task: Textual/Abt-Buy, loss: 0.0054378509521484375
step: 260, task: Textual/Abt-Buy, loss: 0.011700630187988281
step: 270, task: Textual/Abt-Buy, loss: 0.01768377423286438
step: 280, task: Textual/Abt-Buy, loss: 0.0030628666281700134
step: 290, task: Textual/Abt-Buy, loss: 0.04554414749145508
step: 300, task: Textual/Abt-Buy, loss: 0.11132364720106125
step: 310, task: Textual/Abt-Buy, loss: 0.0017146319150924683
step: 320, task: Textual/Abt-Buy, loss: 0.006322793662548065
step: 330, task: Textual/Abt-Buy, loss: 0.004732392728328705
step: 340, task: Textual/Abt-Buy, loss: 0.009331531822681427
step: 350, task: Textual/Abt-Buy, loss: 0.3180919289588928
=========eval at epoch=4=========
Validation:
=============Textual/Abt-Buy==================
accuracy=0.906
precision=0.906
recall=0.141
f1=0.244
======================================
Test:
=============Textual/Abt-Buy==================
accuracy=0.904
precision=0.867
recall=0.126
f1=0.220
======================================
=====sanity check======
words: COL name VAL nikon d90 black digital slr camera with nikkor 18-105mm lens d90outfit COL description VAL nikon d90 black digital slr camera with nikkor 18-105mm lens d90outfit 12.3 megapixel 3 ' tft lcd display d-movie shooting function expeed image processing scene recognition system in-camera retouch menu low-noise performance active d-lighting viewfinder compatible with hdmi output included af-s dx nikkor 18-105mm vr lens black finish COL price VAL   [SEP] COL name VAL sony alpha dslr-a200 digital slr camera with dual lens kit dslra200w COL description VAL 10.2 megapixel 2.7 ' active matrix tft color lcd COL price VAL 699.0 
x: [    0 18047   766 27445   295   967   261   385  3248   909  1778  3369
   338  2280    19   295 21609   368   504    12 15274  5471 10373   385
  3248   995 14307 14857  8194 27445   295   967   261   385  3248   909
  1778  3369   338  2280    19   295 21609   368   504    12 15274  5471
 10373   385  3248   995 14307   316     4   246 10721 21424   155   128
   326  2543   784 28690  2332   385    12 38428  1094  5043  1931 39640
  2274  5774  1310  4972   467    11    12 25092  5494 12746  5765   614
    12  2362  1496   819  2171   385    12 30181  1217 38116 16632    19
  1368   417  5408  4195  1165  9724    12    29 49386   295 21609   368
   504    12 15274  5471   748   338 10373   909  2073 14857   425 27445
  1437  1437     2     2 18047   766 27445   579  6119 32756   385  9996
   338    12   102  2619  1778  3369   338  2280    19  6594 10373 10549
   385  9996   763  2619   605 14857  8194 27445   158     4   176 10721
 21424   132     4   406   128  2171 36173   326  2543  3195   784 28690
 14857   425 27445   231  2831     4   288  1437     2]
tokens: ['<s>', 'COL', 'Ġname', 'ĠVAL', 'Ġn', 'ik', 'on', 'Ġd', '90', 'Ġblack', 'Ġdigital', 'Ġsl', 'r', 'Ġcamera', 'Ġwith', 'Ġn', 'ikk', 'or', 'Ġ18', '-', '105', 'mm', 'Ġlens', 'Ġd', '90', 'out', 'fit', 'ĠCOL', 'Ġdescription', 'ĠVAL', 'Ġn', 'ik', 'on', 'Ġd', '90', 'Ġblack', 'Ġdigital', 'Ġsl', 'r', 'Ġcamera', 'Ġwith', 'Ġn', 'ikk', 'or', 'Ġ18', '-', '105', 'mm', 'Ġlens', 'Ġd', '90', 'out', 'fit', 'Ġ12', '.', '3', 'Ġmeg', 'apixel', 'Ġ3', "Ġ'", 'Ġt', 'ft', 'Ġl', 'cd', 'Ġdisplay', 'Ġd', '-', 'movie', 'Ġshooting', 'Ġfunction', 'Ġex', 'peed', 'Ġimage', 'Ġprocessing', 'Ġscene', 'Ġrecognition', 'Ġsystem', 'Ġin', '-', 'camera', 'Ġret', 'ouch', 'Ġmenu', 'Ġlow', '-', 'no', 'ise', 'Ġperformance', 'Ġactive', 'Ġd', '-', 'lighting', 'Ġview', 'finder', 'Ġcompatible', 'Ġwith', 'Ġh', 'd', 'mi', 'Ġoutput', 'Ġincluded', 'Ġaf', '-', 's', 'Ġdx', 'Ġn', 'ikk', 'or', 'Ġ18', '-', '105', 'mm', 'Ġv', 'r', 'Ġlens', 'Ġblack', 'Ġfinish', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ', 'Ġ', '</s>', '</s>', 'COL', 'Ġname', 'ĠVAL', 'Ġs', 'ony', 'Ġalpha', 'Ġd', 'sl', 'r', '-', 'a', '200', 'Ġdigital', 'Ġsl', 'r', 'Ġcamera', 'Ġwith', 'Ġdual', 'Ġlens', 'Ġkit', 'Ġd', 'sl', 'ra', '200', 'w', 'ĠCOL', 'Ġdescription', 'ĠVAL', 'Ġ10', '.', '2', 'Ġmeg', 'apixel', 'Ġ2', '.', '7', "Ġ'", 'Ġactive', 'Ġmatrix', 'Ġt', 'ft', 'Ġcolor', 'Ġl', 'cd', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ6', '99', '.', '0', 'Ġ', '</s>']
is_heads: [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
y: 0
tags: 0
mask: tensor([1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1])
seqlen: 177
task_name: Textual/Abt-Buy
=======================
step: 0, task: Textual/Abt-Buy, loss: 0.06058716028928757
step: 10, task: Textual/Abt-Buy, loss: 0.16351211071014404
step: 20, task: Textual/Abt-Buy, loss: 0.03223544359207153
step: 30, task: Textual/Abt-Buy, loss: 0.012965630739927292
step: 40, task: Textual/Abt-Buy, loss: 0.010754868388175964
step: 50, task: Textual/Abt-Buy, loss: 0.022052373737096786
step: 60, task: Textual/Abt-Buy, loss: 0.09498908370733261
step: 70, task: Textual/Abt-Buy, loss: 0.007087938487529755
step: 80, task: Textual/Abt-Buy, loss: 0.17033976316452026
step: 90, task: Textual/Abt-Buy, loss: 0.029161974787712097
step: 100, task: Textual/Abt-Buy, loss: 0.031291037797927856
step: 110, task: Textual/Abt-Buy, loss: 0.042890843003988266
step: 120, task: Textual/Abt-Buy, loss: 0.010646350681781769
step: 130, task: Textual/Abt-Buy, loss: 0.025264844298362732
step: 140, task: Textual/Abt-Buy, loss: 0.02625304087996483
step: 150, task: Textual/Abt-Buy, loss: 0.02302536368370056
step: 160, task: Textual/Abt-Buy, loss: 0.32872557640075684
step: 170, task: Textual/Abt-Buy, loss: 0.052388161420822144
step: 180, task: Textual/Abt-Buy, loss: 0.03611059859395027
step: 190, task: Textual/Abt-Buy, loss: 0.014034535735845566
step: 200, task: Textual/Abt-Buy, loss: 0.011181984096765518
step: 210, task: Textual/Abt-Buy, loss: 0.07597965747117996
step: 220, task: Textual/Abt-Buy, loss: 0.003248944878578186
step: 230, task: Textual/Abt-Buy, loss: 0.0018723756074905396
step: 240, task: Textual/Abt-Buy, loss: 0.18167436122894287
step: 250, task: Textual/Abt-Buy, loss: 0.03276977315545082
step: 260, task: Textual/Abt-Buy, loss: 0.20559047162532806
step: 270, task: Textual/Abt-Buy, loss: 0.12126868963241577
step: 280, task: Textual/Abt-Buy, loss: 0.02303367853164673
step: 290, task: Textual/Abt-Buy, loss: 0.024091394618153572
step: 300, task: Textual/Abt-Buy, loss: 0.003053605556488037
step: 310, task: Textual/Abt-Buy, loss: 0.02842390164732933
step: 320, task: Textual/Abt-Buy, loss: 0.04096713289618492
step: 330, task: Textual/Abt-Buy, loss: 0.11852440237998962
step: 340, task: Textual/Abt-Buy, loss: 0.04449431598186493
step: 350, task: Textual/Abt-Buy, loss: 0.005320779979228973
=========eval at epoch=5=========
Validation:
=============Textual/Abt-Buy==================
accuracy=0.905
precision=0.875
recall=0.136
f1=0.235
======================================
Test:
=============Textual/Abt-Buy==================
accuracy=0.902
precision=0.880
recall=0.107
f1=0.190
======================================
=====sanity check======
words: COL name VAL denon blu-ray disc dvd/cd digital player/transport dvd2500btci COL description VAL denon blu-ray disc dvd/cd digital player/transport dvd2500btci hdmi 1.3 a with high definition output up to 1080p full 10-bit processing for i/p and scaling circuit up to 36-bit deep color support via hdmi multi-layered construction with dual-layered top shields and triple-layered bottom shields complete digital-only transport to eliminate interference black finish COL price VAL   [SEP] COL name VAL denon dvd-3800bdci blu-ray disc player dvd3800bdci COL description VAL bd-r , dvd-rw , cd-rw , secure digital ( sd ) dvd video , cd-da , mp3 , wma , jpeg , divx 6 , pcm playback progressive scan COL price VAL  
x: [    0 18047   766 27445  3069   261 42034    12  5022  9553   385 40311
    73 28690  1778   869    73  9981  3427   385 40311 41374 25933  2520
 14857  8194 27445  3069   261 42034    12  5022  9553   385 40311    73
 28690  1778   869    73  9981  3427   385 40311 41374 25933  2520  1368
   417  5408   112     4   246    10    19   239  8515  4195    62     7
 21083   642   455   158    12  5881  5774    13   939    73   642     8
 22187  9326    62     7  2491    12  5881  1844  3195   323  1241  1368
   417  5408  3228    12  8433  3215  1663    19  6594    12  8433  3215
   299 31768     8  6436    12  8433  3215  2576 31768  1498  1778    12
  8338  4240     7  7677  8149   909  2073 14857   425 27445  1437  1437
     2     2 18047   766 27445  3069   261   385 40311    12  3170   612
 35470  2520 42034    12  5022  9553   869   385 40311  3170   612 35470
  2520 14857  8194 27445   741   417    12   338  2156   385 40311    12
 43926  2156 45584    12 43926  2156  2823  1778    36 46409  4839   385
 40311   569  2156 45584    12  6106  2156 44857   246  2156   885  1916
  2156  1236 41191  2156 14445  1178   231  2156   181 13753 20083  8212
 14194 14857   425 27445  1437  1437     2]
tokens: ['<s>', 'COL', 'Ġname', 'ĠVAL', 'Ġden', 'on', 'Ġblu', '-', 'ray', 'Ġdisc', 'Ġd', 'vd', '/', 'cd', 'Ġdigital', 'Ġplayer', '/', 'trans', 'port', 'Ġd', 'vd', '2500', 'bt', 'ci', 'ĠCOL', 'Ġdescription', 'ĠVAL', 'Ġden', 'on', 'Ġblu', '-', 'ray', 'Ġdisc', 'Ġd', 'vd', '/', 'cd', 'Ġdigital', 'Ġplayer', '/', 'trans', 'port', 'Ġd', 'vd', '2500', 'bt', 'ci', 'Ġh', 'd', 'mi', 'Ġ1', '.', '3', 'Ġa', 'Ġwith', 'Ġhigh', 'Ġdefinition', 'Ġoutput', 'Ġup', 'Ġto', 'Ġ1080', 'p', 'Ġfull', 'Ġ10', '-', 'bit', 'Ġprocessing', 'Ġfor', 'Ġi', '/', 'p', 'Ġand', 'Ġscaling', 'Ġcircuit', 'Ġup', 'Ġto', 'Ġ36', '-', 'bit', 'Ġdeep', 'Ġcolor', 'Ġsupport', 'Ġvia', 'Ġh', 'd', 'mi', 'Ġmulti', '-', 'lay', 'ered', 'Ġconstruction', 'Ġwith', 'Ġdual', '-', 'lay', 'ered', 'Ġtop', 'Ġshields', 'Ġand', 'Ġtriple', '-', 'lay', 'ered', 'Ġbottom', 'Ġshields', 'Ġcomplete', 'Ġdigital', '-', 'only', 'Ġtransport', 'Ġto', 'Ġeliminate', 'Ġinterference', 'Ġblack', 'Ġfinish', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ', 'Ġ', '</s>', '</s>', 'COL', 'Ġname', 'ĠVAL', 'Ġden', 'on', 'Ġd', 'vd', '-', '38', '00', 'bd', 'ci', 'Ġblu', '-', 'ray', 'Ġdisc', 'Ġplayer', 'Ġd', 'vd', '38', '00', 'bd', 'ci', 'ĠCOL', 'Ġdescription', 'ĠVAL', 'Ġb', 'd', '-', 'r', 'Ġ,', 'Ġd', 'vd', '-', 'rw', 'Ġ,', 'Ġcd', '-', 'rw', 'Ġ,', 'Ġsecure', 'Ġdigital', 'Ġ(', 'Ġsd', 'Ġ)', 'Ġd', 'vd', 'Ġvideo', 'Ġ,', 'Ġcd', '-', 'da', 'Ġ,', 'Ġmp', '3', 'Ġ,', 'Ġw', 'ma', 'Ġ,', 'Ġj', 'peg', 'Ġ,', 'Ġdiv', 'x', 'Ġ6', 'Ġ,', 'Ġp', 'cm', 'Ġplayback', 'Ġprogressive', 'Ġscan', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ', 'Ġ', '</s>']
is_heads: [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
y: 0
tags: 0
mask: tensor([1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1])
seqlen: 199
task_name: Textual/Abt-Buy
=======================
step: 0, task: Textual/Abt-Buy, loss: 0.00209634006023407
step: 10, task: Textual/Abt-Buy, loss: 0.002819754183292389
step: 20, task: Textual/Abt-Buy, loss: 0.25343042612075806
step: 30, task: Textual/Abt-Buy, loss: 0.012367025017738342
step: 40, task: Textual/Abt-Buy, loss: 0.05025012791156769
step: 50, task: Textual/Abt-Buy, loss: 0.004555597901344299
step: 60, task: Textual/Abt-Buy, loss: 0.19444896280765533
step: 70, task: Textual/Abt-Buy, loss: 0.09905131161212921
step: 80, task: Textual/Abt-Buy, loss: 0.005110941827297211
step: 90, task: Textual/Abt-Buy, loss: 0.01180974394083023
step: 100, task: Textual/Abt-Buy, loss: 0.00280732661485672
step: 110, task: Textual/Abt-Buy, loss: 0.006912343204021454
step: 120, task: Textual/Abt-Buy, loss: 0.018850989639759064
step: 130, task: Textual/Abt-Buy, loss: 0.001843094825744629
step: 140, task: Textual/Abt-Buy, loss: 0.008865267038345337
step: 150, task: Textual/Abt-Buy, loss: 0.21994361281394958
step: 160, task: Textual/Abt-Buy, loss: 0.00795937329530716
step: 170, task: Textual/Abt-Buy, loss: 0.05848030000925064
step: 180, task: Textual/Abt-Buy, loss: 0.015195421874523163
step: 190, task: Textual/Abt-Buy, loss: 0.02210821956396103
step: 200, task: Textual/Abt-Buy, loss: 0.010940894484519958
step: 210, task: Textual/Abt-Buy, loss: 0.011572279036045074
step: 220, task: Textual/Abt-Buy, loss: 0.0637400820851326
step: 230, task: Textual/Abt-Buy, loss: 0.0019453167915344238
step: 240, task: Textual/Abt-Buy, loss: 0.0019659623503684998
step: 250, task: Textual/Abt-Buy, loss: 0.01503627747297287
step: 260, task: Textual/Abt-Buy, loss: 0.011304154992103577
step: 270, task: Textual/Abt-Buy, loss: 0.03411201760172844
step: 280, task: Textual/Abt-Buy, loss: 0.07205561548471451
step: 290, task: Textual/Abt-Buy, loss: 0.0011406689882278442
step: 300, task: Textual/Abt-Buy, loss: 0.0360126830637455
step: 310, task: Textual/Abt-Buy, loss: 0.008970286697149277
step: 320, task: Textual/Abt-Buy, loss: 0.03257722035050392
step: 330, task: Textual/Abt-Buy, loss: 0.1025584489107132
step: 340, task: Textual/Abt-Buy, loss: 0.007540509104728699
step: 350, task: Textual/Abt-Buy, loss: 0.031525589525699615
=========eval at epoch=6=========
Validation:
=============Textual/Abt-Buy==================
accuracy=0.904
precision=0.867
recall=0.126
f1=0.220
======================================
Test:
=============Textual/Abt-Buy==================
accuracy=0.903
precision=0.857
recall=0.117
f1=0.205
======================================
=====sanity check======
words: COL name VAL sony 7.1 channel black a/v receiver strdg820 COL description VAL sony 7.1 channel black a/v receiver strdg820 770 watts total power ( 110w x 7 ) accepting resolutions up to 1080p via hdmi digital cinema auto calibration bravia sync digital cinema sound dolby digital , dolby digital ex , dolby pro logic ii , dolby pro logic iix , dts , dts-es , dts 96/24 , dts neo :6 decoding black finish COL price VAL 399.0  [SEP] COL name VAL sony str-dg720 a/v receiver strdg720 COL description VAL dolby digital , dolby pro logic ii , dts 96/24 , dts neo :6 , dolby digital ex , dolby pro logic iix , dolby pro logic , dts-es , digital cinema sound , dts COL price VAL 224.79 
x: [    0 18047   766 27445   579  6119   262     4   134  4238   909    10
    73   705  4797  7031   417   571 34212 14857  8194 27445   579  6119
   262     4   134  4238   909    10    73   705  4797  7031   417   571
 34212 39570 42574   746   476    36  8017   605  3023   262  4839  8394
 13781    62     7 21083   642  1241  1368   417  5408  1778 11605  4485
 42269 35977   493 22785  1778 11605  2369   385  1168  1409  1778  2156
   385  1168  1409  1778  1931  2156   385  1168  1409  1759 14578 42661
  2156   385  1168  1409  1759 14578   939  3181  2156   385  1872  2156
   385  1872    12   293  2156   385  1872  8971    73  1978  2156   385
  1872 17863  4832   401 46133   909  2073 14857   425 27445 41279     4
   288  1437     2     2 18047   766 27445   579  6119  7031    12   417
   571 29721    10    73   705  4797  7031   417   571 29721 14857  8194
 27445   385  1168  1409  1778  2156   385  1168  1409  1759 14578 42661
  2156   385  1872  8971    73  1978  2156   385  1872 17863  4832   401
  2156   385  1168  1409  1778  1931  2156   385  1168  1409  1759 14578
   939  3181  2156   385  1168  1409  1759 14578  2156   385  1872    12
   293  2156  1778 11605  2369  2156   385  1872 14857   425 27445 27546
     4  5220  1437     2]
tokens: ['<s>', 'COL', 'Ġname', 'ĠVAL', 'Ġs', 'ony', 'Ġ7', '.', '1', 'Ġchannel', 'Ġblack', 'Ġa', '/', 'v', 'Ġreceiver', 'Ġstr', 'd', 'g', '820', 'ĠCOL', 'Ġdescription', 'ĠVAL', 'Ġs', 'ony', 'Ġ7', '.', '1', 'Ġchannel', 'Ġblack', 'Ġa', '/', 'v', 'Ġreceiver', 'Ġstr', 'd', 'g', '820', 'Ġ770', 'Ġwatts', 'Ġtotal', 'Ġpower', 'Ġ(', 'Ġ110', 'w', 'Ġx', 'Ġ7', 'Ġ)', 'Ġaccepting', 'Ġresolutions', 'Ġup', 'Ġto', 'Ġ1080', 'p', 'Ġvia', 'Ġh', 'd', 'mi', 'Ġdigital', 'Ġcinema', 'Ġauto', 'Ġcalibration', 'Ġbrav', 'ia', 'Ġsync', 'Ġdigital', 'Ġcinema', 'Ġsound', 'Ġd', 'ol', 'by', 'Ġdigital', 'Ġ,', 'Ġd', 'ol', 'by', 'Ġdigital', 'Ġex', 'Ġ,', 'Ġd', 'ol', 'by', 'Ġpro', 'Ġlogic', 'Ġii', 'Ġ,', 'Ġd', 'ol', 'by', 'Ġpro', 'Ġlogic', 'Ġi', 'ix', 'Ġ,', 'Ġd', 'ts', 'Ġ,', 'Ġd', 'ts', '-', 'es', 'Ġ,', 'Ġd', 'ts', 'Ġ96', '/', '24', 'Ġ,', 'Ġd', 'ts', 'Ġneo', 'Ġ:', '6', 'Ġdecoding', 'Ġblack', 'Ġfinish', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ399', '.', '0', 'Ġ', '</s>', '</s>', 'COL', 'Ġname', 'ĠVAL', 'Ġs', 'ony', 'Ġstr', '-', 'd', 'g', '720', 'Ġa', '/', 'v', 'Ġreceiver', 'Ġstr', 'd', 'g', '720', 'ĠCOL', 'Ġdescription', 'ĠVAL', 'Ġd', 'ol', 'by', 'Ġdigital', 'Ġ,', 'Ġd', 'ol', 'by', 'Ġpro', 'Ġlogic', 'Ġii', 'Ġ,', 'Ġd', 'ts', 'Ġ96', '/', '24', 'Ġ,', 'Ġd', 'ts', 'Ġneo', 'Ġ:', '6', 'Ġ,', 'Ġd', 'ol', 'by', 'Ġdigital', 'Ġex', 'Ġ,', 'Ġd', 'ol', 'by', 'Ġpro', 'Ġlogic', 'Ġi', 'ix', 'Ġ,', 'Ġd', 'ol', 'by', 'Ġpro', 'Ġlogic', 'Ġ,', 'Ġd', 'ts', '-', 'es', 'Ġ,', 'Ġdigital', 'Ġcinema', 'Ġsound', 'Ġ,', 'Ġd', 'ts', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ224', '.', '79', 'Ġ', '</s>']
is_heads: [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
y: 0
tags: 0
mask: tensor([1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1])
seqlen: 208
task_name: Textual/Abt-Buy
=======================
step: 0, task: Textual/Abt-Buy, loss: 0.008053086698055267
step: 10, task: Textual/Abt-Buy, loss: 0.005069993436336517
step: 20, task: Textual/Abt-Buy, loss: 0.003226138651371002
step: 30, task: Textual/Abt-Buy, loss: 0.0018228590488433838
step: 40, task: Textual/Abt-Buy, loss: 0.004275627434253693
step: 50, task: Textual/Abt-Buy, loss: 0.05190262198448181
step: 60, task: Textual/Abt-Buy, loss: 0.02014712616801262
step: 70, task: Textual/Abt-Buy, loss: 0.0017930418252944946
step: 80, task: Textual/Abt-Buy, loss: 0.1174437552690506
step: 90, task: Textual/Abt-Buy, loss: 0.0060349032282829285
step: 100, task: Textual/Abt-Buy, loss: 0.029738444834947586
step: 110, task: Textual/Abt-Buy, loss: 0.004536822438240051
step: 120, task: Textual/Abt-Buy, loss: 0.011551938951015472
step: 130, task: Textual/Abt-Buy, loss: 0.007230974733829498
step: 140, task: Textual/Abt-Buy, loss: 0.43781644105911255
step: 150, task: Textual/Abt-Buy, loss: 0.05502757430076599
step: 160, task: Textual/Abt-Buy, loss: 0.26502591371536255
step: 170, task: Textual/Abt-Buy, loss: 0.009925760328769684
step: 180, task: Textual/Abt-Buy, loss: 0.05323919281363487
step: 190, task: Textual/Abt-Buy, loss: 0.043781861662864685
step: 200, task: Textual/Abt-Buy, loss: 0.006183631718158722
step: 210, task: Textual/Abt-Buy, loss: 0.022780435159802437
step: 220, task: Textual/Abt-Buy, loss: 0.002737797796726227
step: 230, task: Textual/Abt-Buy, loss: 0.0021784603595733643
step: 240, task: Textual/Abt-Buy, loss: 0.009038060903549194
step: 250, task: Textual/Abt-Buy, loss: 0.04553277790546417
step: 260, task: Textual/Abt-Buy, loss: 0.0667763352394104
step: 270, task: Textual/Abt-Buy, loss: 0.015058137476444244
step: 280, task: Textual/Abt-Buy, loss: 0.03173190727829933
step: 290, task: Textual/Abt-Buy, loss: 0.01810968667268753
step: 300, task: Textual/Abt-Buy, loss: 0.008894190192222595
step: 310, task: Textual/Abt-Buy, loss: 0.27255910634994507
step: 320, task: Textual/Abt-Buy, loss: 0.06171059235930443
step: 330, task: Textual/Abt-Buy, loss: 0.18074671924114227
step: 340, task: Textual/Abt-Buy, loss: 0.14706534147262573
step: 350, task: Textual/Abt-Buy, loss: 0.009265515953302383
=========eval at epoch=7=========
Validation:
=============Textual/Abt-Buy==================
accuracy=0.905
precision=0.929
recall=0.126
f1=0.222
======================================
Test:
=============Textual/Abt-Buy==================
accuracy=0.900
precision=0.800
recall=0.097
f1=0.173
======================================
=====sanity check======
words: COL name VAL panasonic 2-line integrated telephone system kxts208w COL description VAL panasonic 2-line integrated telephone system kxts208w 3-way conference one-touch/speed dialer speakerphone white finish COL price VAL   [SEP] COL name VAL panasonic kx-tsc14b corded telephone COL description VAL 2 x phone line ( s ) headset black COL price VAL  
x: [    0 18047   766 27445  5730 38703   132    12  1902  6818  7377   467
   449 11483    29 26919   605 14857  8194 27445  5730 38703   132    12
  1902  6818  7377   467   449 11483    29 26919   605   155    12  1970
  1019    65    12 26673    73  8619 11481   254  5385 17283  1104  2073
 14857   425 27445  1437  1437     2     2 18047   766 27445  5730 38703
   449  1178    12  1872   438  1570   428 13051   196  7377 14857  8194
 27445   132  3023  1028   516    36   579  4839 20084   909 14857   425
 27445  1437  1437     2]
tokens: ['<s>', 'COL', 'Ġname', 'ĠVAL', 'Ġpan', 'asonic', 'Ġ2', '-', 'line', 'Ġintegrated', 'Ġtelephone', 'Ġsystem', 'Ġk', 'xt', 's', '208', 'w', 'ĠCOL', 'Ġdescription', 'ĠVAL', 'Ġpan', 'asonic', 'Ġ2', '-', 'line', 'Ġintegrated', 'Ġtelephone', 'Ġsystem', 'Ġk', 'xt', 's', '208', 'w', 'Ġ3', '-', 'way', 'Ġconference', 'Ġone', '-', 'touch', '/', 'speed', 'Ġdial', 'er', 'Ġspeaker', 'phone', 'Ġwhite', 'Ġfinish', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ', 'Ġ', '</s>', '</s>', 'COL', 'Ġname', 'ĠVAL', 'Ġpan', 'asonic', 'Ġk', 'x', '-', 'ts', 'c', '14', 'b', 'Ġcord', 'ed', 'Ġtelephone', 'ĠCOL', 'Ġdescription', 'ĠVAL', 'Ġ2', 'Ġx', 'Ġphone', 'Ġline', 'Ġ(', 'Ġs', 'Ġ)', 'Ġheadset', 'Ġblack', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ', 'Ġ', '</s>']
is_heads: [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
y: 0
tags: 0
mask: tensor([1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1])
seqlen: 88
task_name: Textual/Abt-Buy
=======================
step: 0, task: Textual/Abt-Buy, loss: 0.02185995876789093
step: 10, task: Textual/Abt-Buy, loss: 0.02262387052178383
step: 20, task: Textual/Abt-Buy, loss: 0.40938976407051086
step: 30, task: Textual/Abt-Buy, loss: 0.06272341310977936
step: 40, task: Textual/Abt-Buy, loss: 0.06284285336732864
step: 50, task: Textual/Abt-Buy, loss: 0.009089954197406769
step: 60, task: Textual/Abt-Buy, loss: 0.008207157254219055
step: 70, task: Textual/Abt-Buy, loss: 0.473812460899353
step: 80, task: Textual/Abt-Buy, loss: 0.00336495041847229
step: 90, task: Textual/Abt-Buy, loss: 0.1415480375289917
step: 100, task: Textual/Abt-Buy, loss: 0.0014776885509490967
step: 110, task: Textual/Abt-Buy, loss: 0.017051391303539276
step: 120, task: Textual/Abt-Buy, loss: 0.007874548435211182
step: 130, task: Textual/Abt-Buy, loss: 0.04328678175806999
step: 140, task: Textual/Abt-Buy, loss: 0.050925832241773605
step: 150, task: Textual/Abt-Buy, loss: 0.0038088038563728333
step: 160, task: Textual/Abt-Buy, loss: 0.003641471266746521
step: 170, task: Textual/Abt-Buy, loss: 0.028636105358600616
step: 180, task: Textual/Abt-Buy, loss: 0.006273612380027771
step: 190, task: Textual/Abt-Buy, loss: 0.0850808173418045
step: 200, task: Textual/Abt-Buy, loss: 0.007225215435028076
step: 210, task: Textual/Abt-Buy, loss: 0.0028141438961029053
step: 220, task: Textual/Abt-Buy, loss: 0.30970457196235657
step: 230, task: Textual/Abt-Buy, loss: 0.16891053318977356
step: 240, task: Textual/Abt-Buy, loss: 0.025304578244686127
step: 250, task: Textual/Abt-Buy, loss: 0.016154736280441284
step: 260, task: Textual/Abt-Buy, loss: 0.03933672979474068
Gradient overflow.  Skipping step, loss scaler 0 reducing loss scale to 8192.0
step: 270, task: Textual/Abt-Buy, loss: 0.008905559778213501
step: 280, task: Textual/Abt-Buy, loss: 0.009304285049438477
step: 290, task: Textual/Abt-Buy, loss: 0.014620795845985413
step: 300, task: Textual/Abt-Buy, loss: 0.003654010593891144
step: 310, task: Textual/Abt-Buy, loss: 0.03988176956772804
step: 320, task: Textual/Abt-Buy, loss: 0.02070574462413788
step: 330, task: Textual/Abt-Buy, loss: 0.0028329119086265564
step: 340, task: Textual/Abt-Buy, loss: 0.0965084508061409
step: 350, task: Textual/Abt-Buy, loss: 0.14097163081169128
=========eval at epoch=8=========
Validation:
=============Textual/Abt-Buy==================
accuracy=0.907
precision=0.935
recall=0.141
f1=0.245
======================================
Test:
=============Textual/Abt-Buy==================
accuracy=0.906
precision=0.906
recall=0.141
f1=0.244
======================================
Selected optimization level O2:  FP16 training with FP32 batchnorm and FP32 master weights.

Defaults for this optimization level are:
enabled                : True
opt_level              : O2
cast_model_type        : torch.float16
patch_torch_functions  : False
keep_batchnorm_fp32    : True
master_weights         : True
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O2
cast_model_type        : torch.float16
patch_torch_functions  : False
keep_batchnorm_fp32    : True
master_weights         : True
loss_scale             : dynamic
Warning:  multi_tensor_applier fused unscale kernel is unavailable, possibly because apex was installed without --cuda_ext --cpp_ext. Using Python fallback.  Original ImportError was: ModuleNotFoundError("No module named 'amp_C'")
Gradient overflow.  Skipping step, loss scaler 0 reducing loss scale to 32768.0
=====sanity check======
words: COL name VAL sony 7.1 channel black av receiver strdg920 COL description VAL sony 7.1 channel black av home theater receiver strdg920 770 watts total power ( 110w x 7 ) accepting resolutions up to 1080p via hdmi digital cinema auto calibration bravia sync digital cinema sound x.v.color , deep color and 1080/24p signal capability dolby digital , dolby digital ex , dolby pro logic ii , dolby pro logic iix , dts , dts-es , dts 96/24 , dts neo :6 decoding black finish COL price VAL   [SEP] COL name VAL sony str-dg820 a/v receiver strdg820 COL description VAL dolby digital , dolby pro logic ii , dts 96/24 , dts neo :6 , dolby digital ex , dolby pro logic iix , dolby pro logic , dts-es , digital cinema sound , dts COL price VAL 318.72 
x: [    0 18047   766 27445   579  6119   262     4   134  4238   909  6402
  4797  7031   417   571 29099 14857  8194 27445   579  6119   262     4
   134  4238   909  6402   184  7364  4797  7031   417   571 29099 39570
 42574   746   476    36  8017   605  3023   262  4839  8394 13781    62
     7 21083   642  1241  1368   417  5408  1778 11605  4485 42269 35977
   493 22785  1778 11605  2369  3023     4   705     4 21685  2156  1844
  3195     8 21083    73  1978   642  6029  9388   385  1168  1409  1778
  2156   385  1168  1409  1778  1931  2156   385  1168  1409  1759 14578
 42661  2156   385  1168  1409  1759 14578   939  3181  2156   385  1872
  2156   385  1872    12   293  2156   385  1872  8971    73  1978  2156
   385  1872 17863  4832   401 46133   909  2073 14857   425 27445  1437
  1437     2     2 18047   766 27445   579  6119  7031    12   417   571
 34212    10    73   705  4797  7031   417   571 34212 14857  8194 27445
   385  1168  1409  1778  2156   385  1168  1409  1759 14578 42661  2156
   385  1872  8971    73  1978  2156   385  1872 17863  4832   401  2156
   385  1168  1409  1778  1931  2156   385  1168  1409  1759 14578   939
  3181  2156   385  1168  1409  1759 14578  2156   385  1872    12   293
  2156  1778 11605  2369  2156   385  1872 14857   425 27445 37207     4
  4956  1437     2]
tokens: ['<s>', 'COL', 'Ġname', 'ĠVAL', 'Ġs', 'ony', 'Ġ7', '.', '1', 'Ġchannel', 'Ġblack', 'Ġav', 'Ġreceiver', 'Ġstr', 'd', 'g', '920', 'ĠCOL', 'Ġdescription', 'ĠVAL', 'Ġs', 'ony', 'Ġ7', '.', '1', 'Ġchannel', 'Ġblack', 'Ġav', 'Ġhome', 'Ġtheater', 'Ġreceiver', 'Ġstr', 'd', 'g', '920', 'Ġ770', 'Ġwatts', 'Ġtotal', 'Ġpower', 'Ġ(', 'Ġ110', 'w', 'Ġx', 'Ġ7', 'Ġ)', 'Ġaccepting', 'Ġresolutions', 'Ġup', 'Ġto', 'Ġ1080', 'p', 'Ġvia', 'Ġh', 'd', 'mi', 'Ġdigital', 'Ġcinema', 'Ġauto', 'Ġcalibration', 'Ġbrav', 'ia', 'Ġsync', 'Ġdigital', 'Ġcinema', 'Ġsound', 'Ġx', '.', 'v', '.', 'color', 'Ġ,', 'Ġdeep', 'Ġcolor', 'Ġand', 'Ġ1080', '/', '24', 'p', 'Ġsignal', 'Ġcapability', 'Ġd', 'ol', 'by', 'Ġdigital', 'Ġ,', 'Ġd', 'ol', 'by', 'Ġdigital', 'Ġex', 'Ġ,', 'Ġd', 'ol', 'by', 'Ġpro', 'Ġlogic', 'Ġii', 'Ġ,', 'Ġd', 'ol', 'by', 'Ġpro', 'Ġlogic', 'Ġi', 'ix', 'Ġ,', 'Ġd', 'ts', 'Ġ,', 'Ġd', 'ts', '-', 'es', 'Ġ,', 'Ġd', 'ts', 'Ġ96', '/', '24', 'Ġ,', 'Ġd', 'ts', 'Ġneo', 'Ġ:', '6', 'Ġdecoding', 'Ġblack', 'Ġfinish', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ', 'Ġ', '</s>', '</s>', 'COL', 'Ġname', 'ĠVAL', 'Ġs', 'ony', 'Ġstr', '-', 'd', 'g', '820', 'Ġa', '/', 'v', 'Ġreceiver', 'Ġstr', 'd', 'g', '820', 'ĠCOL', 'Ġdescription', 'ĠVAL', 'Ġd', 'ol', 'by', 'Ġdigital', 'Ġ,', 'Ġd', 'ol', 'by', 'Ġpro', 'Ġlogic', 'Ġii', 'Ġ,', 'Ġd', 'ts', 'Ġ96', '/', '24', 'Ġ,', 'Ġd', 'ts', 'Ġneo', 'Ġ:', '6', 'Ġ,', 'Ġd', 'ol', 'by', 'Ġdigital', 'Ġex', 'Ġ,', 'Ġd', 'ol', 'by', 'Ġpro', 'Ġlogic', 'Ġi', 'ix', 'Ġ,', 'Ġd', 'ol', 'by', 'Ġpro', 'Ġlogic', 'Ġ,', 'Ġd', 'ts', '-', 'es', 'Ġ,', 'Ġdigital', 'Ġcinema', 'Ġsound', 'Ġ,', 'Ġd', 'ts', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ318', '.', '72', 'Ġ', '</s>']
is_heads: [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
y: 0
tags: 0
mask: tensor([1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1])
seqlen: 219
task_name: Textual/Abt-Buy
=======================
step: 0, task: Textual/Abt-Buy, loss: 0.5647040605545044
Gradient overflow.  Skipping step, loss scaler 0 reducing loss scale to 16384.0
Gradient overflow.  Skipping step, loss scaler 0 reducing loss scale to 8192.0
step: 10, task: Textual/Abt-Buy, loss: 0.6286706924438477
step: 20, task: Textual/Abt-Buy, loss: 0.6015149354934692
step: 30, task: Textual/Abt-Buy, loss: 0.5375797748565674
step: 40, task: Textual/Abt-Buy, loss: 0.25935083627700806
step: 50, task: Textual/Abt-Buy, loss: 0.06703947484493256
step: 60, task: Textual/Abt-Buy, loss: 0.11498527973890305
step: 70, task: Textual/Abt-Buy, loss: 0.4583272337913513
step: 80, task: Textual/Abt-Buy, loss: 0.5491908192634583
step: 90, task: Textual/Abt-Buy, loss: 0.10522599518299103
step: 100, task: Textual/Abt-Buy, loss: 0.5545452237129211
step: 110, task: Textual/Abt-Buy, loss: 0.5849257111549377
step: 120, task: Textual/Abt-Buy, loss: 0.12449747323989868
step: 130, task: Textual/Abt-Buy, loss: 0.4040631651878357
step: 140, task: Textual/Abt-Buy, loss: 0.24030134081840515
step: 150, task: Textual/Abt-Buy, loss: 0.20557716488838196
step: 160, task: Textual/Abt-Buy, loss: 0.42808446288108826
step: 170, task: Textual/Abt-Buy, loss: 0.1273210197687149
step: 180, task: Textual/Abt-Buy, loss: 0.37113720178604126
step: 190, task: Textual/Abt-Buy, loss: 0.21614161133766174
step: 200, task: Textual/Abt-Buy, loss: 0.25536173582077026
step: 210, task: Textual/Abt-Buy, loss: 0.2688029408454895
step: 220, task: Textual/Abt-Buy, loss: 0.15651269257068634
step: 230, task: Textual/Abt-Buy, loss: 0.26361560821533203
step: 240, task: Textual/Abt-Buy, loss: 0.37128597497940063
step: 250, task: Textual/Abt-Buy, loss: 0.20324134826660156
step: 260, task: Textual/Abt-Buy, loss: 0.22486190497875214
step: 270, task: Textual/Abt-Buy, loss: 0.22319340705871582
step: 280, task: Textual/Abt-Buy, loss: 0.3590826094150543
step: 290, task: Textual/Abt-Buy, loss: 0.34089744091033936
step: 300, task: Textual/Abt-Buy, loss: 0.2239868938922882
step: 310, task: Textual/Abt-Buy, loss: 0.25764429569244385
step: 320, task: Textual/Abt-Buy, loss: 0.4964035153388977
step: 330, task: Textual/Abt-Buy, loss: 0.4048185646533966
step: 340, task: Textual/Abt-Buy, loss: 0.09038993716239929
step: 350, task: Textual/Abt-Buy, loss: 0.22539658844470978
=========eval at epoch=1=========
Validation:
=============Textual/Abt-Buy==================
accuracy=0.892
precision=0.000
recall=0.000
f1=0.000
======================================
Test:
=============Textual/Abt-Buy==================
accuracy=0.892
precision=0.000
recall=0.000
f1=0.000
======================================
/w/246/tianyu2020/miniconda2/envs/ditto/lib/python3.7/site-packages/apex/amp/_initialize.py:24: UserWarning: An input tensor was not cuda.
  warnings.warn("An input tensor was not cuda.")
/w/246/tianyu2020/miniconda2/envs/ditto/lib/python3.7/site-packages/torch/optim/lr_scheduler.py:122: UserWarning: Detected call of `lr_scheduler.step()` before `optimizer.step()`. In PyTorch 1.1.0 and later, you should call them in the opposite order: `optimizer.step()` before `lr_scheduler.step()`.  Failure to do this will result in PyTorch skipping the first value of the learning rate schedule. See more details at https://pytorch.org/docs/stable/optim.html#how-to-adjust-learning-rate
  "https://pytorch.org/docs/stable/optim.html#how-to-adjust-learning-rate", UserWarning)
/w/246/tianyu2020/miniconda2/envs/ditto/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1221: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
=====sanity check======
words: COL name VAL panasonic 2 line integrated corded phone system kxtsc14b COL description VAL panasonic 2 line integrated corded phone system kxtsc14b 3-line lcd display automatic line selection call waiting caller id 3-way conferencing speakerphone navigator key black finish COL price VAL 74.0  [SEP] COL name VAL panasonic kx-ts208w corded phone COL description VAL 2 x phone line ( s ) headset white COL price VAL  
x: [    0 18047   766 27445  5730 38703   132   516  6818 13051   196  1028
   467   449 11483  3866  1570   428 14857  8194 27445  5730 38703   132
   516  6818 13051   196  1028   467   449 11483  3866  1570   428   155
    12  1902   784 28690  2332  8408   516  4230   486  2445 17017 13561
   155    12  1970  7856  8663 11162  5385 17283 24708  2630   762   909
  2073 14857   425 27445  6657     4   288  1437     2     2 18047   766
 27445  5730 38703   449  1178    12  1872 26919   605 13051   196  1028
 14857  8194 27445   132  3023  1028   516    36   579  4839 20084  1104
 14857   425 27445  1437  1437     2]
tokens: ['<s>', 'COL', 'Ġname', 'ĠVAL', 'Ġpan', 'asonic', 'Ġ2', 'Ġline', 'Ġintegrated', 'Ġcord', 'ed', 'Ġphone', 'Ġsystem', 'Ġk', 'xt', 'sc', '14', 'b', 'ĠCOL', 'Ġdescription', 'ĠVAL', 'Ġpan', 'asonic', 'Ġ2', 'Ġline', 'Ġintegrated', 'Ġcord', 'ed', 'Ġphone', 'Ġsystem', 'Ġk', 'xt', 'sc', '14', 'b', 'Ġ3', '-', 'line', 'Ġl', 'cd', 'Ġdisplay', 'Ġautomatic', 'Ġline', 'Ġselection', 'Ġcall', 'Ġwaiting', 'Ġcaller', 'Ġid', 'Ġ3', '-', 'way', 'Ġconf', 'eren', 'cing', 'Ġspeaker', 'phone', 'Ġnavig', 'ator', 'Ġkey', 'Ġblack', 'Ġfinish', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ74', '.', '0', 'Ġ', '</s>', '</s>', 'COL', 'Ġname', 'ĠVAL', 'Ġpan', 'asonic', 'Ġk', 'x', '-', 'ts', '208', 'w', 'Ġcord', 'ed', 'Ġphone', 'ĠCOL', 'Ġdescription', 'ĠVAL', 'Ġ2', 'Ġx', 'Ġphone', 'Ġline', 'Ġ(', 'Ġs', 'Ġ)', 'Ġheadset', 'Ġwhite', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ', 'Ġ', '</s>']
is_heads: [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
y: 0
tags: 0
mask: tensor([1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1])
seqlen: 102
task_name: Textual/Abt-Buy
=======================
step: 0, task: Textual/Abt-Buy, loss: 0.39497411251068115
step: 10, task: Textual/Abt-Buy, loss: 0.49787038564682007
step: 20, task: Textual/Abt-Buy, loss: 0.07093968987464905
step: 30, task: Textual/Abt-Buy, loss: 1.042389154434204
step: 40, task: Textual/Abt-Buy, loss: 0.39602047204971313
step: 50, task: Textual/Abt-Buy, loss: 0.21860641241073608
step: 60, task: Textual/Abt-Buy, loss: 0.23776528239250183
step: 70, task: Textual/Abt-Buy, loss: 0.21432803571224213
step: 80, task: Textual/Abt-Buy, loss: 0.4901835024356842
step: 90, task: Textual/Abt-Buy, loss: 0.21406881511211395
step: 100, task: Textual/Abt-Buy, loss: 0.3549346625804901
step: 110, task: Textual/Abt-Buy, loss: 0.14614853262901306
step: 120, task: Textual/Abt-Buy, loss: 0.8164084553718567
step: 130, task: Textual/Abt-Buy, loss: 0.8678187727928162
step: 140, task: Textual/Abt-Buy, loss: 0.3456021547317505
step: 150, task: Textual/Abt-Buy, loss: 0.083213210105896
step: 160, task: Textual/Abt-Buy, loss: 0.3753325939178467
step: 170, task: Textual/Abt-Buy, loss: 0.1101541817188263
step: 180, task: Textual/Abt-Buy, loss: 0.5643674731254578
step: 190, task: Textual/Abt-Buy, loss: 0.3378446400165558
step: 200, task: Textual/Abt-Buy, loss: 0.2948348820209503
step: 210, task: Textual/Abt-Buy, loss: 0.42730462551116943
step: 220, task: Textual/Abt-Buy, loss: 0.2836855351924896
step: 230, task: Textual/Abt-Buy, loss: 0.40732449293136597
step: 240, task: Textual/Abt-Buy, loss: 0.3245425820350647
step: 250, task: Textual/Abt-Buy, loss: 0.2930589020252228
step: 260, task: Textual/Abt-Buy, loss: 0.15500415861606598
step: 270, task: Textual/Abt-Buy, loss: 0.21701785922050476
step: 280, task: Textual/Abt-Buy, loss: 0.1537715196609497
step: 290, task: Textual/Abt-Buy, loss: 0.47389084100723267
step: 300, task: Textual/Abt-Buy, loss: 0.02662453055381775
step: 310, task: Textual/Abt-Buy, loss: 0.622795581817627
step: 320, task: Textual/Abt-Buy, loss: 0.18602266907691956
step: 330, task: Textual/Abt-Buy, loss: 0.3850345313549042
step: 340, task: Textual/Abt-Buy, loss: 0.22924357652664185
step: 350, task: Textual/Abt-Buy, loss: 0.10293599963188171
=========eval at epoch=1=========
Validation:
=============Textual/Abt-Buy==================
accuracy=0.893
precision=0.504
recall=0.340
f1=0.406
======================================
Test:
=============Textual/Abt-Buy==================
accuracy=0.890
precision=0.483
recall=0.350
f1=0.406
======================================
=====sanity check======
words: COL name VAL apple ipod nano gray armband mb769ga COL description VAL apple ipod nano gray armband mb769ga compatible with 4th generation ipod nano has space for the nike + ipod sport kit receiver gray finish COL price VAL 29.0  [SEP] COL name VAL apple 8gb ipod nano blue ( 4th generation ) mb732ll/a COL description VAL  COL price VAL 146.75 
x: [    0 18047   766 27445 15162 36180  1630 36924 12339  4709  6648   463
   475   428   406  4563  2538 14857  8194 27445 15162 36180  1630 36924
 12339  4709  6648   463   475   428   406  4563  2538 16632    19   204
   212  2706 36180  1630 36924    34   980    13     5   295  4348  2055
 36180  1630  2414 10549  4797 12339  2073 14857   425 27445  1132     4
   288  1437     2     2 18047   766 27445 15162   290 19562 36180  1630
 36924  2440    36   204   212  2706  4839   475   428   406  2881   890
    73   102 14857  8194 27445  1437 14857   425 27445 24543     4  2545
  1437     2]
tokens: ['<s>', 'COL', 'Ġname', 'ĠVAL', 'Ġapple', 'Ġip', 'od', 'Ġnano', 'Ġgray', 'Ġar', 'mb', 'and', 'Ġm', 'b', '7', '69', 'ga', 'ĠCOL', 'Ġdescription', 'ĠVAL', 'Ġapple', 'Ġip', 'od', 'Ġnano', 'Ġgray', 'Ġar', 'mb', 'and', 'Ġm', 'b', '7', '69', 'ga', 'Ġcompatible', 'Ġwith', 'Ġ4', 'th', 'Ġgeneration', 'Ġip', 'od', 'Ġnano', 'Ġhas', 'Ġspace', 'Ġfor', 'Ġthe', 'Ġn', 'ike', 'Ġ+', 'Ġip', 'od', 'Ġsport', 'Ġkit', 'Ġreceiver', 'Ġgray', 'Ġfinish', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ29', '.', '0', 'Ġ', '</s>', '</s>', 'COL', 'Ġname', 'ĠVAL', 'Ġapple', 'Ġ8', 'gb', 'Ġip', 'od', 'Ġnano', 'Ġblue', 'Ġ(', 'Ġ4', 'th', 'Ġgeneration', 'Ġ)', 'Ġm', 'b', '7', '32', 'll', '/', 'a', 'ĠCOL', 'Ġdescription', 'ĠVAL', 'Ġ', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ146', '.', '75', 'Ġ', '</s>']
is_heads: [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
y: 0
tags: 0
mask: tensor([1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1])
seqlen: 98
task_name: Textual/Abt-Buy
=======================
step: 0, task: Textual/Abt-Buy, loss: 0.13188931345939636
step: 10, task: Textual/Abt-Buy, loss: 0.2287919521331787
step: 20, task: Textual/Abt-Buy, loss: 0.09359856694936752
step: 30, task: Textual/Abt-Buy, loss: 0.2607036828994751
step: 40, task: Textual/Abt-Buy, loss: 0.22115260362625122
step: 50, task: Textual/Abt-Buy, loss: 0.4037955403327942
step: 60, task: Textual/Abt-Buy, loss: 0.22050464153289795
step: 70, task: Textual/Abt-Buy, loss: 0.28214144706726074
step: 80, task: Textual/Abt-Buy, loss: 0.23401853442192078
step: 90, task: Textual/Abt-Buy, loss: 0.11224126070737839
step: 100, task: Textual/Abt-Buy, loss: 0.09196440875530243
step: 110, task: Textual/Abt-Buy, loss: 0.08062021434307098
step: 120, task: Textual/Abt-Buy, loss: 0.10189077258110046
step: 130, task: Textual/Abt-Buy, loss: 0.41676121950149536
step: 140, task: Textual/Abt-Buy, loss: 0.1248408630490303
step: 150, task: Textual/Abt-Buy, loss: 0.2165175974369049
step: 160, task: Textual/Abt-Buy, loss: 0.10889527946710587
step: 170, task: Textual/Abt-Buy, loss: 0.10646633058786392
step: 180, task: Textual/Abt-Buy, loss: 0.19685280323028564
step: 190, task: Textual/Abt-Buy, loss: 0.06823377311229706
step: 200, task: Textual/Abt-Buy, loss: 0.0028495341539382935
step: 210, task: Textual/Abt-Buy, loss: 0.3480958640575409
step: 220, task: Textual/Abt-Buy, loss: 0.28610554337501526
step: 230, task: Textual/Abt-Buy, loss: 0.057982832193374634
step: 240, task: Textual/Abt-Buy, loss: 0.030640020966529846
step: 250, task: Textual/Abt-Buy, loss: 0.16277359426021576
step: 260, task: Textual/Abt-Buy, loss: 0.0603300966322422
step: 270, task: Textual/Abt-Buy, loss: 0.4300110936164856
step: 280, task: Textual/Abt-Buy, loss: 0.12583699822425842
step: 290, task: Textual/Abt-Buy, loss: 0.043457869440317154
step: 300, task: Textual/Abt-Buy, loss: 0.028060220181941986
step: 310, task: Textual/Abt-Buy, loss: 0.03188757970929146
step: 320, task: Textual/Abt-Buy, loss: 0.1969429850578308
step: 330, task: Textual/Abt-Buy, loss: 0.07259416580200195
step: 340, task: Textual/Abt-Buy, loss: 0.10898436605930328
step: 350, task: Textual/Abt-Buy, loss: 0.045849937945604324
=========eval at epoch=2=========
Validation:
=============Textual/Abt-Buy==================
accuracy=0.895
precision=1.000
recall=0.024
f1=0.047
======================================
Test:
=============Textual/Abt-Buy==================
accuracy=0.896
precision=0.714
recall=0.049
f1=0.091
======================================
=====sanity check======
words: COL name VAL sanus 15 ' 37 ' visionmount full-motion flat panel tv black wall mount mf215b1 COL description VAL sanus 15 ' 37 ' visionmount full-motion flat panel tv black wall mount mf215b1 easily conceal hardware easy to install includes two vesa-compatible tv brackets virtual axis 3d black finish COL price VAL   [SEP] COL name VAL sanus flat panel tv wall mount vm400s COL description VAL steel , aluminum 80 lb COL price VAL  
x: [    0 18047   766 27445 15610   687   379   128  2908   128  3360 17336
   455    12 35474  3269  2798 30016   909  2204 14206   475   506 24355
   428   134 14857  8194 27445 15610   687   379   128  2908   128  3360
 17336   455    12 35474  3269  2798 30016   909  2204 14206   475   506
 24355   428   134  2773 21415  6554  1365     7  8486  1171    80   748
 18382    12 41799 30016 29617  6229 31799   155   417   909  2073 14857
   425 27445  1437  1437     2     2 18047   766 27445 15610   687  3269
  2798 30016  2204 14206 48643  4017    29 14857  8194 27445  3689  2156
  9757  1812 19821 14857   425 27445  1437  1437     2]
tokens: ['<s>', 'COL', 'Ġname', 'ĠVAL', 'Ġsan', 'us', 'Ġ15', "Ġ'", 'Ġ37', "Ġ'", 'Ġvision', 'mount', 'Ġfull', '-', 'motion', 'Ġflat', 'Ġpanel', 'Ġtv', 'Ġblack', 'Ġwall', 'Ġmount', 'Ġm', 'f', '215', 'b', '1', 'ĠCOL', 'Ġdescription', 'ĠVAL', 'Ġsan', 'us', 'Ġ15', "Ġ'", 'Ġ37', "Ġ'", 'Ġvision', 'mount', 'Ġfull', '-', 'motion', 'Ġflat', 'Ġpanel', 'Ġtv', 'Ġblack', 'Ġwall', 'Ġmount', 'Ġm', 'f', '215', 'b', '1', 'Ġeasily', 'Ġconceal', 'Ġhardware', 'Ġeasy', 'Ġto', 'Ġinstall', 'Ġincludes', 'Ġtwo', 'Ġv', 'esa', '-', 'compatible', 'Ġtv', 'Ġbrackets', 'Ġvirtual', 'Ġaxis', 'Ġ3', 'd', 'Ġblack', 'Ġfinish', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ', 'Ġ', '</s>', '</s>', 'COL', 'Ġname', 'ĠVAL', 'Ġsan', 'us', 'Ġflat', 'Ġpanel', 'Ġtv', 'Ġwall', 'Ġmount', 'Ġvm', '400', 's', 'ĠCOL', 'Ġdescription', 'ĠVAL', 'Ġsteel', 'Ġ,', 'Ġaluminum', 'Ġ80', 'Ġlb', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ', 'Ġ', '</s>']
is_heads: [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
y: 0
tags: 0
mask: tensor([1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1])
seqlen: 105
task_name: Textual/Abt-Buy
=======================
step: 0, task: Textual/Abt-Buy, loss: 0.4279152452945709
step: 10, task: Textual/Abt-Buy, loss: 0.09710681438446045
step: 20, task: Textual/Abt-Buy, loss: 0.23741663992404938
step: 30, task: Textual/Abt-Buy, loss: 0.08013275265693665
step: 40, task: Textual/Abt-Buy, loss: 0.017892953008413315
step: 50, task: Textual/Abt-Buy, loss: 0.028220348060131073
step: 60, task: Textual/Abt-Buy, loss: 0.13229988515377045
step: 70, task: Textual/Abt-Buy, loss: 0.2205607295036316
step: 80, task: Textual/Abt-Buy, loss: 0.017682954668998718
step: 90, task: Textual/Abt-Buy, loss: 0.1847074031829834
step: 100, task: Textual/Abt-Buy, loss: 0.00944942981004715
step: 110, task: Textual/Abt-Buy, loss: 0.022077523171901703
step: 120, task: Textual/Abt-Buy, loss: 0.16899950802326202
step: 130, task: Textual/Abt-Buy, loss: 0.1210002601146698
step: 140, task: Textual/Abt-Buy, loss: 0.0907672792673111
step: 150, task: Textual/Abt-Buy, loss: 0.03528977930545807
step: 160, task: Textual/Abt-Buy, loss: 0.21361732482910156
step: 170, task: Textual/Abt-Buy, loss: 0.13181014358997345
step: 180, task: Textual/Abt-Buy, loss: 0.0456724539399147
step: 190, task: Textual/Abt-Buy, loss: 0.09705371409654617
step: 200, task: Textual/Abt-Buy, loss: 0.01638467237353325
step: 210, task: Textual/Abt-Buy, loss: 0.09100094437599182
step: 220, task: Textual/Abt-Buy, loss: 0.17623218894004822
step: 230, task: Textual/Abt-Buy, loss: 0.027176380157470703
step: 240, task: Textual/Abt-Buy, loss: 0.03852056339383125
step: 250, task: Textual/Abt-Buy, loss: 0.07867786288261414
step: 260, task: Textual/Abt-Buy, loss: 0.024096570909023285
step: 270, task: Textual/Abt-Buy, loss: 0.559714674949646
step: 280, task: Textual/Abt-Buy, loss: 0.019907526671886444
step: 290, task: Textual/Abt-Buy, loss: 0.03582733869552612
step: 300, task: Textual/Abt-Buy, loss: 0.04880411550402641
step: 310, task: Textual/Abt-Buy, loss: 0.11371865123510361
step: 320, task: Textual/Abt-Buy, loss: 0.059803251177072525
step: 330, task: Textual/Abt-Buy, loss: 0.018735848367214203
step: 340, task: Textual/Abt-Buy, loss: 0.007288143038749695
step: 350, task: Textual/Abt-Buy, loss: 0.15724186599254608
=========eval at epoch=3=========
Validation:
=============Textual/Abt-Buy==================
accuracy=0.895
precision=0.750
recall=0.029
f1=0.056
======================================
Test:
=============Textual/Abt-Buy==================
accuracy=0.897
precision=0.833
recall=0.049
f1=0.092
======================================
=====sanity check======
words: COL name VAL sony 52 ' bravia w-series black lcd flat panel hdtv kdl52w4100 COL description VAL sony 52 ' bravia w-series black lcd flat panel hdtv kdl52w4100 1920 x 1080 full hd resolution dmex motionflow 120hz technology advanced contrast enhancer ( ace ) bravia sync technology 24p true cinema 30,000:1 dynamic contrast ratio 3d comb filter cinemotion reverse 3:2 pulldown technology black finish COL price VAL   [SEP] COL name VAL sony bravia m series kdl-19m4000 19 ' lcd tv kdl19m4000s COL description VAL 19 ' atsc , ntsc 16:9 1440 x 900 dolby hdtv 1080i , 1080p COL price VAL 379.72 
x: [    0 18047   766 27445   579  6119  3135   128 35977   493   885    12
 22760   909   784 28690  3269  2798  1368   417 18724   449 30469  4429
   605   306  1866 14857  8194 27445   579  6119  3135   128 35977   493
   885    12 22760   909   784 28690  3269  2798  1368   417 18724   449
 30469  4429   605   306  1866 18283  3023 21083   455  1368   417  3547
   385   119  3463  4298 19322  5962 39569   806  3319  5709 45378 20126
    36  9837  4839 35977   493 22785   806   706   642  1528 11605   389
     6   151    35   134  6878  5709  1750   155   417 14960 14929 18535
 19187  7213   155    35   176  2999  3955   806   909  2073 14857   425
 27445  1437  1437     2     2 18047   766 27445   579  6119 35977   493
   475   651   449 30469    12  1646   119 38161   753   128   784 28690
 30016   449 30469  1646   119 38161    29 14857  8194 27445   753   128
    23  3866  2156   295  1872   438   545    35   466 41383  3023 10742
   385  1168  1409  1368   417 18724 21083   118  2156 21083   642 14857
   425 27445 41946     4  4956  1437     2]
tokens: ['<s>', 'COL', 'Ġname', 'ĠVAL', 'Ġs', 'ony', 'Ġ52', "Ġ'", 'Ġbrav', 'ia', 'Ġw', '-', 'series', 'Ġblack', 'Ġl', 'cd', 'Ġflat', 'Ġpanel', 'Ġh', 'd', 'tv', 'Ġk', 'dl', '52', 'w', '4', '100', 'ĠCOL', 'Ġdescription', 'ĠVAL', 'Ġs', 'ony', 'Ġ52', "Ġ'", 'Ġbrav', 'ia', 'Ġw', '-', 'series', 'Ġblack', 'Ġl', 'cd', 'Ġflat', 'Ġpanel', 'Ġh', 'd', 'tv', 'Ġk', 'dl', '52', 'w', '4', '100', 'Ġ1920', 'Ġx', 'Ġ1080', 'Ġfull', 'Ġh', 'd', 'Ġresolution', 'Ġd', 'm', 'ex', 'Ġmotion', 'flow', 'Ġ120', 'hz', 'Ġtechnology', 'Ġadvanced', 'Ġcontrast', 'Ġenh', 'ancer', 'Ġ(', 'Ġace', 'Ġ)', 'Ġbrav', 'ia', 'Ġsync', 'Ġtechnology', 'Ġ24', 'p', 'Ġtrue', 'Ġcinema', 'Ġ30', ',', '000', ':', '1', 'Ġdynamic', 'Ġcontrast', 'Ġratio', 'Ġ3', 'd', 'Ġcomb', 'Ġfilter', 'Ġcinem', 'otion', 'Ġreverse', 'Ġ3', ':', '2', 'Ġpull', 'down', 'Ġtechnology', 'Ġblack', 'Ġfinish', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ', 'Ġ', '</s>', '</s>', 'COL', 'Ġname', 'ĠVAL', 'Ġs', 'ony', 'Ġbrav', 'ia', 'Ġm', 'Ġseries', 'Ġk', 'dl', '-', '19', 'm', '4000', 'Ġ19', "Ġ'", 'Ġl', 'cd', 'Ġtv', 'Ġk', 'dl', '19', 'm', '4000', 's', 'ĠCOL', 'Ġdescription', 'ĠVAL', 'Ġ19', "Ġ'", 'Ġat', 'sc', 'Ġ,', 'Ġn', 'ts', 'c', 'Ġ16', ':', '9', 'Ġ1440', 'Ġx', 'Ġ900', 'Ġd', 'ol', 'by', 'Ġh', 'd', 'tv', 'Ġ1080', 'i', 'Ġ,', 'Ġ1080', 'p', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ379', '.', '72', 'Ġ', '</s>']
is_heads: [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
y: 0
tags: 0
mask: tensor([1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1])
seqlen: 175
task_name: Textual/Abt-Buy
=======================
step: 0, task: Textual/Abt-Buy, loss: 0.16702604293823242
step: 10, task: Textual/Abt-Buy, loss: 0.2545643150806427
step: 20, task: Textual/Abt-Buy, loss: 0.012134239077568054
step: 30, task: Textual/Abt-Buy, loss: 0.5917540788650513
step: 40, task: Textual/Abt-Buy, loss: 0.009139299392700195
step: 50, task: Textual/Abt-Buy, loss: 0.00568796694278717
step: 60, task: Textual/Abt-Buy, loss: 0.013734720647335052
step: 70, task: Textual/Abt-Buy, loss: 0.027521314099431038
step: 80, task: Textual/Abt-Buy, loss: 0.0010093897581100464
step: 90, task: Textual/Abt-Buy, loss: 0.11740026623010635
step: 100, task: Textual/Abt-Buy, loss: 0.14289304614067078
step: 110, task: Textual/Abt-Buy, loss: 0.01927698403596878
step: 120, task: Textual/Abt-Buy, loss: 0.01918836683034897
step: 130, task: Textual/Abt-Buy, loss: 0.002319440245628357
step: 140, task: Textual/Abt-Buy, loss: 0.03869497403502464
step: 150, task: Textual/Abt-Buy, loss: 0.21531637012958527
step: 160, task: Textual/Abt-Buy, loss: 0.1902426779270172
step: 170, task: Textual/Abt-Buy, loss: 0.015219219028949738
step: 180, task: Textual/Abt-Buy, loss: 0.22038544714450836
step: 190, task: Textual/Abt-Buy, loss: 0.013277880847454071
step: 200, task: Textual/Abt-Buy, loss: 0.0043190717697143555
step: 210, task: Textual/Abt-Buy, loss: 0.16920660436153412
step: 220, task: Textual/Abt-Buy, loss: 0.019527383148670197
step: 230, task: Textual/Abt-Buy, loss: 0.0059017762541770935
step: 240, task: Textual/Abt-Buy, loss: 0.006237931549549103
step: 250, task: Textual/Abt-Buy, loss: 0.0024277642369270325
step: 260, task: Textual/Abt-Buy, loss: 0.0005799680948257446
step: 270, task: Textual/Abt-Buy, loss: 0.0012788400053977966
step: 280, task: Textual/Abt-Buy, loss: 0.008121319115161896
step: 290, task: Textual/Abt-Buy, loss: 0.0006522089242935181
step: 300, task: Textual/Abt-Buy, loss: 0.039797343313694
step: 310, task: Textual/Abt-Buy, loss: 0.017837561666965485
step: 320, task: Textual/Abt-Buy, loss: 0.007962904870510101
step: 330, task: Textual/Abt-Buy, loss: 0.007388044148683548
step: 340, task: Textual/Abt-Buy, loss: 0.20851632952690125
step: 350, task: Textual/Abt-Buy, loss: 0.20327764749526978
=========eval at epoch=4=========
Validation:
=============Textual/Abt-Buy==================
accuracy=0.908
precision=1.000
recall=0.141
f1=0.247
======================================
Test:
=============Textual/Abt-Buy==================
accuracy=0.904
precision=0.893
recall=0.121
f1=0.214
======================================
=====sanity check======
words: COL name VAL sony cyber-shot black digital camera dsch10b COL description VAL sony dsch10 cyber-shot black digital camera dsch10b 8.1 megapixels 3.0 ' lcd display carl zeiss 10x optical zoom lens 31 mb internal memory versatile flash advanced sports mode 9-point auto focus high sensitivity mode burst mode face detection in-camera retouching super steadyshot optical image stabilization with anti-blur solution music slideshow hdtv compatibility stamina battery power beginner-friendly function guide black finish COL price VAL   [SEP] COL name VAL sony cyber-shot dsc-w150 digital camera red dscw150r COL description VAL 8.1 megapixel 16:9 2x digital zoom 2.7 ' active matrix tft color lcd COL price VAL 139.94 
x: [    0 18047   766 27445   579  6119  5381    12 10393   909  1778  2280
   385 12265   698   428 14857  8194 27445   579  6119   385 12265   698
  5381    12 10393   909  1778  2280   385 12265   698   428   290     4
   134 10721  1115 41699   155     4   288   128   784 28690  2332   512
   462 20025  3006   158  1178 17547 21762 10373  1105   475   428  3425
  3783 16106  7462  3319  1612  5745   361    12  2300  4485  1056   239
 15608  5745 10084  5745   652 12673    11    12 25092  5494 12746   154
  2422 23789  2459 10120 17547  2274 29632    19  1475    12  3662   710
  2472   930 13150  1368   417 18724 29988 34745  3822   476 37239    12
  6928  5043  4704   909  2073 14857   425 27445  1437  1437     2     2
 18047   766 27445   579  6119  5381    12 10393   385  3866    12   605
  6115  1778  2280  1275   385  3866   605  6115   338 14857  8194 27445
   290     4   134 10721 21424   545    35   466   132  1178  1778 21762
   132     4   406   128  2171 36173   326  2543  3195   784 28690 14857
   425 27445 24404     4  6405  1437     2]
tokens: ['<s>', 'COL', 'Ġname', 'ĠVAL', 'Ġs', 'ony', 'Ġcyber', '-', 'shot', 'Ġblack', 'Ġdigital', 'Ġcamera', 'Ġd', 'sch', '10', 'b', 'ĠCOL', 'Ġdescription', 'ĠVAL', 'Ġs', 'ony', 'Ġd', 'sch', '10', 'Ġcyber', '-', 'shot', 'Ġblack', 'Ġdigital', 'Ġcamera', 'Ġd', 'sch', '10', 'b', 'Ġ8', '.', '1', 'Ġmeg', 'ap', 'ixels', 'Ġ3', '.', '0', "Ġ'", 'Ġl', 'cd', 'Ġdisplay', 'Ġcar', 'l', 'Ġze', 'iss', 'Ġ10', 'x', 'Ġoptical', 'Ġzoom', 'Ġlens', 'Ġ31', 'Ġm', 'b', 'Ġinternal', 'Ġmemory', 'Ġversatile', 'Ġflash', 'Ġadvanced', 'Ġsports', 'Ġmode', 'Ġ9', '-', 'point', 'Ġauto', 'Ġfocus', 'Ġhigh', 'Ġsensitivity', 'Ġmode', 'Ġburst', 'Ġmode', 'Ġface', 'Ġdetection', 'Ġin', '-', 'camera', 'Ġret', 'ouch', 'ing', 'Ġsuper', 'Ġstead', 'ys', 'hot', 'Ġoptical', 'Ġimage', 'Ġstabilization', 'Ġwith', 'Ġanti', '-', 'bl', 'ur', 'Ġsolution', 'Ġmusic', 'Ġslideshow', 'Ġh', 'd', 'tv', 'Ġcompatibility', 'Ġstamina', 'Ġbattery', 'Ġpower', 'Ġbeginner', '-', 'friendly', 'Ġfunction', 'Ġguide', 'Ġblack', 'Ġfinish', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ', 'Ġ', '</s>', '</s>', 'COL', 'Ġname', 'ĠVAL', 'Ġs', 'ony', 'Ġcyber', '-', 'shot', 'Ġd', 'sc', '-', 'w', '150', 'Ġdigital', 'Ġcamera', 'Ġred', 'Ġd', 'sc', 'w', '150', 'r', 'ĠCOL', 'Ġdescription', 'ĠVAL', 'Ġ8', '.', '1', 'Ġmeg', 'apixel', 'Ġ16', ':', '9', 'Ġ2', 'x', 'Ġdigital', 'Ġzoom', 'Ġ2', '.', '7', "Ġ'", 'Ġactive', 'Ġmatrix', 'Ġt', 'ft', 'Ġcolor', 'Ġl', 'cd', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ139', '.', '94', 'Ġ', '</s>']
is_heads: [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
y: 0
tags: 0
mask: tensor([1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1])
seqlen: 175
task_name: Textual/Abt-Buy
=======================
step: 0, task: Textual/Abt-Buy, loss: 0.003939434885978699
step: 10, task: Textual/Abt-Buy, loss: 0.002254486083984375
step: 20, task: Textual/Abt-Buy, loss: 0.01232261210680008
step: 30, task: Textual/Abt-Buy, loss: 0.20735138654708862
step: 40, task: Textual/Abt-Buy, loss: 0.02659430354833603
step: 50, task: Textual/Abt-Buy, loss: 0.008122682571411133
step: 60, task: Textual/Abt-Buy, loss: 0.0342005155980587
step: 70, task: Textual/Abt-Buy, loss: 0.05706069618463516
step: 80, task: Textual/Abt-Buy, loss: 0.006445504724979401
step: 90, task: Textual/Abt-Buy, loss: 0.0033153966069221497
step: 100, task: Textual/Abt-Buy, loss: 0.0011196136474609375
step: 110, task: Textual/Abt-Buy, loss: 0.002485819160938263
step: 120, task: Textual/Abt-Buy, loss: 0.0039388686418533325
step: 130, task: Textual/Abt-Buy, loss: 0.001031532883644104
step: 140, task: Textual/Abt-Buy, loss: 0.17643630504608154
step: 150, task: Textual/Abt-Buy, loss: 0.0008984506130218506
step: 160, task: Textual/Abt-Buy, loss: 0.001421228051185608
step: 170, task: Textual/Abt-Buy, loss: 0.006125573068857193
step: 180, task: Textual/Abt-Buy, loss: 0.013618312776088715
step: 190, task: Textual/Abt-Buy, loss: 0.005685560405254364
step: 200, task: Textual/Abt-Buy, loss: 0.015129964798688889
step: 210, task: Textual/Abt-Buy, loss: 0.019708462059497833
step: 220, task: Textual/Abt-Buy, loss: 0.49727869033813477
step: 230, task: Textual/Abt-Buy, loss: 0.007139764726161957
step: 240, task: Textual/Abt-Buy, loss: 0.014315962791442871
step: 250, task: Textual/Abt-Buy, loss: 0.021777264773845673
step: 260, task: Textual/Abt-Buy, loss: 0.007882632315158844
step: 270, task: Textual/Abt-Buy, loss: 0.05749491602182388
step: 280, task: Textual/Abt-Buy, loss: 0.027582243084907532
step: 290, task: Textual/Abt-Buy, loss: 0.0005928128957748413
step: 300, task: Textual/Abt-Buy, loss: 0.03650957718491554
step: 310, task: Textual/Abt-Buy, loss: 0.0006080269813537598
step: 320, task: Textual/Abt-Buy, loss: 0.012439660727977753
step: 330, task: Textual/Abt-Buy, loss: 0.17649295926094055
step: 340, task: Textual/Abt-Buy, loss: 0.1334703415632248
step: 350, task: Textual/Abt-Buy, loss: 0.03138022869825363
=========eval at epoch=5=========
Validation:
=============Textual/Abt-Buy==================
accuracy=0.902
precision=0.950
recall=0.092
f1=0.168
======================================
Test:
=============Textual/Abt-Buy==================
accuracy=0.902
precision=1.000
recall=0.092
f1=0.169
======================================
=====sanity check======
words: COL name VAL sony black hd radio with dock for ipod and iphone xdrs10hdip COL description VAL sony black hd radio with dock for ipod and iphone xdrs10hdip ipod and iphone dock clear static-free hd digital radio reception fm multicasting no monthly subscription fees backlit lcd display digital tuning clock with alarm time setting wireless remote control stereo speakers with bass reflex sound system black finish COL price VAL   [SEP] COL name VAL sony ipod/phone dock clock radio black nic icfc1ipmk2blk COL description VAL  COL price VAL 80.25 
x: [    0 18047   766 27445   579  6119   909  1368   417  3188    19 15261
    13 36180  1630     8  1437 28778  1264  3023   417  4926   698 35905
  1588 14857  8194 27445   579  6119   909  1368   417  3188    19 15261
    13 36180  1630     8  1437 28778  1264  3023   417  4926   698 35905
  1588 36180  1630     8  1437 28778  1264 15261   699 25156    12  3743
  1368   417  1778  3188  7362   856   119 43630 15374   117  3708  6656
  3154   124 13534   784 28690  2332  1778 28927  6700    19  8054    86
  2749  6955  6063   797 31436  6864    19  9590 32229  2369   467   909
  2073 14857   425 27445  1437  1437     2     2 18047   766 27445   579
  6119 36180  1630    73 17283 15261  6700  3188   909 18657 41591 25484
   134  1588 43503   176  3662   330 14857  8194 27445  1437 14857   425
 27445  1812     4  1244  1437     2]
tokens: ['<s>', 'COL', 'Ġname', 'ĠVAL', 'Ġs', 'ony', 'Ġblack', 'Ġh', 'd', 'Ġradio', 'Ġwith', 'Ġdock', 'Ġfor', 'Ġip', 'od', 'Ġand', 'Ġ', 'iph', 'one', 'Ġx', 'd', 'rs', '10', 'hd', 'ip', 'ĠCOL', 'Ġdescription', 'ĠVAL', 'Ġs', 'ony', 'Ġblack', 'Ġh', 'd', 'Ġradio', 'Ġwith', 'Ġdock', 'Ġfor', 'Ġip', 'od', 'Ġand', 'Ġ', 'iph', 'one', 'Ġx', 'd', 'rs', '10', 'hd', 'ip', 'Ġip', 'od', 'Ġand', 'Ġ', 'iph', 'one', 'Ġdock', 'Ġclear', 'Ġstatic', '-', 'free', 'Ġh', 'd', 'Ġdigital', 'Ġradio', 'Ġreception', 'Ġf', 'm', 'Ġmultic', 'asting', 'Ġno', 'Ġmonthly', 'Ġsubscription', 'Ġfees', 'Ġback', 'lit', 'Ġl', 'cd', 'Ġdisplay', 'Ġdigital', 'Ġtuning', 'Ġclock', 'Ġwith', 'Ġalarm', 'Ġtime', 'Ġsetting', 'Ġwireless', 'Ġremote', 'Ġcontrol', 'Ġstereo', 'Ġspeakers', 'Ġwith', 'Ġbass', 'Ġreflex', 'Ġsound', 'Ġsystem', 'Ġblack', 'Ġfinish', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ', 'Ġ', '</s>', '</s>', 'COL', 'Ġname', 'ĠVAL', 'Ġs', 'ony', 'Ġip', 'od', '/', 'phone', 'Ġdock', 'Ġclock', 'Ġradio', 'Ġblack', 'Ġnic', 'Ġic', 'fc', '1', 'ip', 'mk', '2', 'bl', 'k', 'ĠCOL', 'Ġdescription', 'ĠVAL', 'Ġ', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ80', '.', '25', 'Ġ', '</s>']
is_heads: [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
y: 0
tags: 0
mask: tensor([1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1])
seqlen: 138
task_name: Textual/Abt-Buy
=======================
step: 0, task: Textual/Abt-Buy, loss: 0.0012923479080200195
step: 10, task: Textual/Abt-Buy, loss: 0.0027819648385047913
step: 20, task: Textual/Abt-Buy, loss: 0.004227817058563232
step: 30, task: Textual/Abt-Buy, loss: 0.00591026246547699
step: 40, task: Textual/Abt-Buy, loss: 0.0008928030729293823
step: 50, task: Textual/Abt-Buy, loss: 0.007694818079471588
step: 60, task: Textual/Abt-Buy, loss: 0.10451288521289825
step: 70, task: Textual/Abt-Buy, loss: 0.0005721449851989746
step: 80, task: Textual/Abt-Buy, loss: 0.0003963261842727661
step: 90, task: Textual/Abt-Buy, loss: 0.0010129958391189575
step: 100, task: Textual/Abt-Buy, loss: 0.0006224513053894043
step: 110, task: Textual/Abt-Buy, loss: 0.013293962925672531
Gradient overflow.  Skipping step, loss scaler 0 reducing loss scale to 8192.0
step: 120, task: Textual/Abt-Buy, loss: 0.0006514936685562134
step: 130, task: Textual/Abt-Buy, loss: 0.13937795162200928
step: 140, task: Textual/Abt-Buy, loss: 0.09247544407844543
step: 150, task: Textual/Abt-Buy, loss: 0.015367910265922546
step: 160, task: Textual/Abt-Buy, loss: 0.0006503462791442871
step: 170, task: Textual/Abt-Buy, loss: 0.008300397545099258
step: 180, task: Textual/Abt-Buy, loss: 0.0008736252784729004
step: 190, task: Textual/Abt-Buy, loss: 0.0010308623313903809
step: 200, task: Textual/Abt-Buy, loss: 0.0003504753112792969
step: 210, task: Textual/Abt-Buy, loss: 0.0032614395022392273
step: 220, task: Textual/Abt-Buy, loss: 0.0018590539693832397
step: 230, task: Textual/Abt-Buy, loss: 0.019446488469839096
step: 240, task: Textual/Abt-Buy, loss: 0.005729839205741882
step: 250, task: Textual/Abt-Buy, loss: 0.005051910877227783
step: 260, task: Textual/Abt-Buy, loss: 0.0009619593620300293
step: 270, task: Textual/Abt-Buy, loss: 0.000761076807975769
step: 280, task: Textual/Abt-Buy, loss: 0.1578354388475418
step: 290, task: Textual/Abt-Buy, loss: 0.013492796570062637
step: 300, task: Textual/Abt-Buy, loss: 0.0018766820430755615
step: 310, task: Textual/Abt-Buy, loss: 0.004647150635719299
step: 320, task: Textual/Abt-Buy, loss: 0.006968580186367035
step: 330, task: Textual/Abt-Buy, loss: 0.08324602246284485
step: 340, task: Textual/Abt-Buy, loss: 0.00048516690731048584
step: 350, task: Textual/Abt-Buy, loss: 0.003872483968734741
=========eval at epoch=6=========
Validation:
=============Textual/Abt-Buy==================
accuracy=0.909
precision=0.970
recall=0.155
f1=0.268
======================================
Test:
=============Textual/Abt-Buy==================
accuracy=0.906
precision=1.000
recall=0.121
f1=0.216
======================================
=====sanity check======
words: COL name VAL panasonic viera 42 ' plasma flat panel hdtv in black th42px80u COL description VAL panasonic viera 42 ' plasma flat panel hdtv in black th42px80u 720p display 1024 x 768 native resolution color purity optimizer surround sound anti-reflective filter viera link hdavi control built-in ntsc/atsc/qam tuners 3 hdmi inputs built-in galleryplayer capable sd card memory slot pedestal stand included black finish COL price VAL   [SEP] COL name VAL panasonic viera th-42px80u 42 ' plasma tv COL description VAL 42 ' atsc , ntsc 16:9 1024 x 768 surround hdtv COL price VAL 749.0 
x: [    0 18047   766 27445  5730 38703   748 16432  3330   128 29051  3269
  2798  1368   417 18724    11   909  3553  3714 38740  2940   257 14857
  8194 27445  5730 38703   748 16432  3330   128 29051  3269  2798  1368
   417 18724    11   909  3553  3714 38740  2940   257 26180   642  2332
 46959  3023 43751  3763  3547  3195 32195 17775  6315 21104  2369  1475
    12 39878  2088 14929   748 16432  3104  1368   417 11132   797  1490
    12   179   295  1872   438    73  2923   438    73  1343   424 27115
   268   155  1368   417  5408 16584  1490    12   179  7294 23233  4453
 46409  1886  3783  8534 38238   337  1413  1165   909  2073 14857   425
 27445  1437  1437     2     2 18047   766 27445  5730 38703   748 16432
  3553    12  3714 38740  2940   257  3330   128 29051 30016 14857  8194
 27445  3330   128    23  3866  2156   295  1872   438   545    35   466
 46959  3023 43751 21104  1368   417 18724 14857   425 27445   262  3414
     4   288  1437     2]
tokens: ['<s>', 'COL', 'Ġname', 'ĠVAL', 'Ġpan', 'asonic', 'Ġv', 'iera', 'Ġ42', "Ġ'", 'Ġplasma', 'Ġflat', 'Ġpanel', 'Ġh', 'd', 'tv', 'Ġin', 'Ġblack', 'Ġth', '42', 'px', '80', 'u', 'ĠCOL', 'Ġdescription', 'ĠVAL', 'Ġpan', 'asonic', 'Ġv', 'iera', 'Ġ42', "Ġ'", 'Ġplasma', 'Ġflat', 'Ġpanel', 'Ġh', 'd', 'tv', 'Ġin', 'Ġblack', 'Ġth', '42', 'px', '80', 'u', 'Ġ720', 'p', 'Ġdisplay', 'Ġ1024', 'Ġx', 'Ġ768', 'Ġnative', 'Ġresolution', 'Ġcolor', 'Ġpurity', 'Ġoptim', 'izer', 'Ġsurround', 'Ġsound', 'Ġanti', '-', 'reflect', 'ive', 'Ġfilter', 'Ġv', 'iera', 'Ġlink', 'Ġh', 'd', 'avi', 'Ġcontrol', 'Ġbuilt', '-', 'in', 'Ġn', 'ts', 'c', '/', 'ats', 'c', '/', 'q', 'am', 'Ġtun', 'ers', 'Ġ3', 'Ġh', 'd', 'mi', 'Ġinputs', 'Ġbuilt', '-', 'in', 'Ġgallery', 'player', 'Ġcapable', 'Ġsd', 'Ġcard', 'Ġmemory', 'Ġslot', 'Ġpedest', 'al', 'Ġstand', 'Ġincluded', 'Ġblack', 'Ġfinish', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ', 'Ġ', '</s>', '</s>', 'COL', 'Ġname', 'ĠVAL', 'Ġpan', 'asonic', 'Ġv', 'iera', 'Ġth', '-', '42', 'px', '80', 'u', 'Ġ42', "Ġ'", 'Ġplasma', 'Ġtv', 'ĠCOL', 'Ġdescription', 'ĠVAL', 'Ġ42', "Ġ'", 'Ġat', 'sc', 'Ġ,', 'Ġn', 'ts', 'c', 'Ġ16', ':', '9', 'Ġ1024', 'Ġx', 'Ġ768', 'Ġsurround', 'Ġh', 'd', 'tv', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ7', '49', '.', '0', 'Ġ', '</s>']
is_heads: [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
y: 1
tags: 1
mask: tensor([1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1])
seqlen: 160
task_name: Textual/Abt-Buy
=======================
step: 0, task: Textual/Abt-Buy, loss: 0.051241353154182434
step: 10, task: Textual/Abt-Buy, loss: 0.06706050038337708
step: 20, task: Textual/Abt-Buy, loss: 0.007868319749832153
step: 30, task: Textual/Abt-Buy, loss: 0.016084037721157074
step: 40, task: Textual/Abt-Buy, loss: 0.0002697110176086426
step: 50, task: Textual/Abt-Buy, loss: 0.19105616211891174
step: 60, task: Textual/Abt-Buy, loss: 0.0006331652402877808
step: 70, task: Textual/Abt-Buy, loss: 0.0008456259965896606
step: 80, task: Textual/Abt-Buy, loss: 0.011172980070114136
step: 90, task: Textual/Abt-Buy, loss: 0.004354052245616913
step: 100, task: Textual/Abt-Buy, loss: 0.004294738173484802
step: 110, task: Textual/Abt-Buy, loss: 0.022489171475172043
step: 120, task: Textual/Abt-Buy, loss: 0.006330430507659912
step: 130, task: Textual/Abt-Buy, loss: 0.00039646029472351074
step: 140, task: Textual/Abt-Buy, loss: 0.002090178430080414
step: 150, task: Textual/Abt-Buy, loss: 0.2518209218978882
step: 160, task: Textual/Abt-Buy, loss: 0.0011100396513938904
step: 170, task: Textual/Abt-Buy, loss: 0.00035315752029418945
step: 180, task: Textual/Abt-Buy, loss: 0.0008083730936050415
step: 190, task: Textual/Abt-Buy, loss: 0.01321384310722351
step: 200, task: Textual/Abt-Buy, loss: 0.00024037063121795654
step: 210, task: Textual/Abt-Buy, loss: 0.0002135634422302246
step: 220, task: Textual/Abt-Buy, loss: 0.0002375096082687378
step: 230, task: Textual/Abt-Buy, loss: 0.0019139572978019714
step: 240, task: Textual/Abt-Buy, loss: 0.007074184715747833
step: 250, task: Textual/Abt-Buy, loss: 0.003031797707080841
step: 260, task: Textual/Abt-Buy, loss: 0.002026602625846863
step: 270, task: Textual/Abt-Buy, loss: 0.0001621842384338379
step: 280, task: Textual/Abt-Buy, loss: 0.002056017518043518
step: 290, task: Textual/Abt-Buy, loss: 0.013186361640691757
step: 300, task: Textual/Abt-Buy, loss: 0.014952875673770905
step: 310, task: Textual/Abt-Buy, loss: 0.004627317190170288
step: 320, task: Textual/Abt-Buy, loss: 0.001448802649974823
step: 330, task: Textual/Abt-Buy, loss: 0.0008340775966644287
step: 340, task: Textual/Abt-Buy, loss: 0.0004726201295852661
step: 350, task: Textual/Abt-Buy, loss: 0.0003940165042877197
=========eval at epoch=7=========
Validation:
=============Textual/Abt-Buy==================
accuracy=0.901
precision=0.944
recall=0.083
f1=0.152
======================================
Test:
=============Textual/Abt-Buy==================
accuracy=0.904
precision=0.960
recall=0.117
f1=0.208
======================================
=====sanity check======
words: COL name VAL panasonic expandable digital cordless dect 6.0 answering system in silver kxtg1034s COL description VAL panasonic expandable digital cordless dect 6.0 answering system in silver kxtg1034s 4 handsets extended talk time reduced interference all-digital answering system up to 17 hours of talk time expandable up to 6 handsets up to 3-way conference capability built-in clock with alarm digital speakerphone on handset silver finish COL price VAL   [SEP] COL name VAL panasonic kx-tg4324b 5.8 ghz expandable digital cordless phone COL description VAL 1 x phone line ( s ) black COL price VAL 78.33 
x: [    0 18047   766 27445  5730 38703  3003   868  1778 13051  1672   263
  3894   231     4   288 15635   467    11  4334   449 11483   571   698
  3079    29 14857  8194 27445  5730 38703  3003   868  1778 13051  1672
   263  3894   231     4   288 15635   467    11  4334   449 11483   571
   698  3079    29   204  1420  2580  3112  1067    86  2906  8149    70
    12 29563 15635   467    62     7   601   722     9  1067    86  3003
   868    62     7   231  1420  2580    62     7   155    12  1970  1019
  9388  1490    12   179  6700    19  8054  1778  5385 17283    15 17621
  4334  2073 14857   425 27445  1437  1437     2     2 18047   766 27445
  5730 38703   449  1178    12 42698  3897  1978   428   195     4   398
 34648   329  3003   868  1778 13051  1672  1028 14857  8194 27445   112
  3023  1028   516    36   579  4839   909 14857   425 27445  7004     4
  3103  1437     2]
tokens: ['<s>', 'COL', 'Ġname', 'ĠVAL', 'Ġpan', 'asonic', 'Ġexpand', 'able', 'Ġdigital', 'Ġcord', 'less', 'Ġde', 'ct', 'Ġ6', '.', '0', 'Ġanswering', 'Ġsystem', 'Ġin', 'Ġsilver', 'Ġk', 'xt', 'g', '10', '34', 's', 'ĠCOL', 'Ġdescription', 'ĠVAL', 'Ġpan', 'asonic', 'Ġexpand', 'able', 'Ġdigital', 'Ġcord', 'less', 'Ġde', 'ct', 'Ġ6', '.', '0', 'Ġanswering', 'Ġsystem', 'Ġin', 'Ġsilver', 'Ġk', 'xt', 'g', '10', '34', 's', 'Ġ4', 'Ġhands', 'ets', 'Ġextended', 'Ġtalk', 'Ġtime', 'Ġreduced', 'Ġinterference', 'Ġall', '-', 'digital', 'Ġanswering', 'Ġsystem', 'Ġup', 'Ġto', 'Ġ17', 'Ġhours', 'Ġof', 'Ġtalk', 'Ġtime', 'Ġexpand', 'able', 'Ġup', 'Ġto', 'Ġ6', 'Ġhands', 'ets', 'Ġup', 'Ġto', 'Ġ3', '-', 'way', 'Ġconference', 'Ġcapability', 'Ġbuilt', '-', 'in', 'Ġclock', 'Ġwith', 'Ġalarm', 'Ġdigital', 'Ġspeaker', 'phone', 'Ġon', 'Ġhandset', 'Ġsilver', 'Ġfinish', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ', 'Ġ', '</s>', '</s>', 'COL', 'Ġname', 'ĠVAL', 'Ġpan', 'asonic', 'Ġk', 'x', '-', 'tg', '43', '24', 'b', 'Ġ5', '.', '8', 'Ġgh', 'z', 'Ġexpand', 'able', 'Ġdigital', 'Ġcord', 'less', 'Ġphone', 'ĠCOL', 'Ġdescription', 'ĠVAL', 'Ġ1', 'Ġx', 'Ġphone', 'Ġline', 'Ġ(', 'Ġs', 'Ġ)', 'Ġblack', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ78', '.', '33', 'Ġ', '</s>']
is_heads: [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
y: 0
tags: 0
mask: tensor([1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1])
seqlen: 147
task_name: Textual/Abt-Buy
=======================
step: 0, task: Textual/Abt-Buy, loss: 0.026830866932868958
step: 10, task: Textual/Abt-Buy, loss: 0.000570833683013916
step: 20, task: Textual/Abt-Buy, loss: 0.0027848854660987854
step: 30, task: Textual/Abt-Buy, loss: 0.0003793686628341675
step: 40, task: Textual/Abt-Buy, loss: 0.00023005902767181396
step: 50, task: Textual/Abt-Buy, loss: 0.021961122751235962
step: 60, task: Textual/Abt-Buy, loss: 0.0002646893262863159
step: 70, task: Textual/Abt-Buy, loss: 0.00048778951168060303
step: 80, task: Textual/Abt-Buy, loss: 0.0018842443823814392
step: 90, task: Textual/Abt-Buy, loss: 0.0006936639547348022
step: 100, task: Textual/Abt-Buy, loss: 0.000530928373336792
step: 110, task: Textual/Abt-Buy, loss: 0.006350554525852203
step: 120, task: Textual/Abt-Buy, loss: 0.005285289138555527
step: 130, task: Textual/Abt-Buy, loss: 0.002506159245967865
step: 140, task: Textual/Abt-Buy, loss: 0.0021252110600471497
step: 150, task: Textual/Abt-Buy, loss: 0.004770420491695404
step: 160, task: Textual/Abt-Buy, loss: 0.0002577453851699829
step: 170, task: Textual/Abt-Buy, loss: 0.022492097690701485
step: 180, task: Textual/Abt-Buy, loss: 0.21233779191970825
step: 190, task: Textual/Abt-Buy, loss: 0.0004157125949859619
step: 200, task: Textual/Abt-Buy, loss: 0.0032435059547424316
step: 210, task: Textual/Abt-Buy, loss: 0.0003571361303329468
step: 220, task: Textual/Abt-Buy, loss: 0.0027750059962272644
step: 230, task: Textual/Abt-Buy, loss: 0.0057547204196453094
step: 240, task: Textual/Abt-Buy, loss: 0.0022794678807258606
step: 250, task: Textual/Abt-Buy, loss: 0.0023352131247520447
step: 260, task: Textual/Abt-Buy, loss: 0.0031014159321784973
step: 270, task: Textual/Abt-Buy, loss: 0.0017517060041427612
step: 280, task: Textual/Abt-Buy, loss: 0.00016811490058898926
step: 290, task: Textual/Abt-Buy, loss: 0.0002400130033493042
step: 300, task: Textual/Abt-Buy, loss: 0.0010801851749420166
step: 310, task: Textual/Abt-Buy, loss: 0.0007475465536117554
step: 320, task: Textual/Abt-Buy, loss: 0.02231597900390625
step: 330, task: Textual/Abt-Buy, loss: 0.0005615651607513428
step: 340, task: Textual/Abt-Buy, loss: 0.02504982054233551
step: 350, task: Textual/Abt-Buy, loss: 0.00850597769021988
=========eval at epoch=8=========
Validation:
=============Textual/Abt-Buy==================
accuracy=0.903
precision=1.000
recall=0.102
f1=0.185
======================================
Test:
=============Textual/Abt-Buy==================
accuracy=0.904
precision=1.000
recall=0.107
f1=0.193
======================================
Selected optimization level O2:  FP16 training with FP32 batchnorm and FP32 master weights.

Defaults for this optimization level are:
enabled                : True
opt_level              : O2
cast_model_type        : torch.float16
patch_torch_functions  : False
keep_batchnorm_fp32    : True
master_weights         : True
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O2
cast_model_type        : torch.float16
patch_torch_functions  : False
keep_batchnorm_fp32    : True
master_weights         : True
loss_scale             : dynamic
Warning:  multi_tensor_applier fused unscale kernel is unavailable, possibly because apex was installed without --cuda_ext --cpp_ext. Using Python fallback.  Original ImportError was: ModuleNotFoundError("No module named 'amp_C'")
Gradient overflow.  Skipping step, loss scaler 0 reducing loss scale to 32768.0
=====sanity check======
words: COL name VAL d-link wireless n usb adapter dwa130 COL description VAL d-link wireless n usb adapter dwa130 complies with draft 802.11 n standards and is backward compatible with 802.11 b/g up to 300 mbps data transfer rates , delivers up to 12x the speed and 4x the range of wireless-g led lights include link and activity wep ( wired equivalent privacy ) , wpa and wpa2 ( wi-fi protected access ) usb 2.0 COL price VAL   [SEP] COL name VAL linksys wireless-g wusb54gc compact usb adapter COL description VAL  COL price VAL  
x: [    0 18047   766 27445   385    12 12139  6955   295 49030 36007   385
  2739 11343 14857  8194 27445   385    12 12139  6955   295 49030 36007
   385  2739 11343 13000   918    19  2479 31551     4  1225   295  2820
     8    16 18173 16632    19 31551     4  1225   741    73   571    62
     7  2993   475 27072   414  2937  1162  2156  8806    62     7   316
  1178     5  2078     8   204  1178     5  1186     9  6955    12   571
   669  4666   680  3104     8  1940    52   642    36 26977  6305  4144
  4839  2156   885  6709     8   885  6709   176    36 33755    12  9169
  4371   899  4839 49030   132     4   288 14857   425 27445  1437  1437
     2     2 18047   766 27445  5678  2459  6955    12   571   885 47358
  4283 42406 12549 49030 36007 14857  8194 27445  1437 14857   425 27445
  1437  1437     2]
tokens: ['<s>', 'COL', 'Ġname', 'ĠVAL', 'Ġd', '-', 'link', 'Ġwireless', 'Ġn', 'Ġusb', 'Ġadapter', 'Ġd', 'wa', '130', 'ĠCOL', 'Ġdescription', 'ĠVAL', 'Ġd', '-', 'link', 'Ġwireless', 'Ġn', 'Ġusb', 'Ġadapter', 'Ġd', 'wa', '130', 'Ġcompl', 'ies', 'Ġwith', 'Ġdraft', 'Ġ802', '.', '11', 'Ġn', 'Ġstandards', 'Ġand', 'Ġis', 'Ġbackward', 'Ġcompatible', 'Ġwith', 'Ġ802', '.', '11', 'Ġb', '/', 'g', 'Ġup', 'Ġto', 'Ġ300', 'Ġm', 'bps', 'Ġdata', 'Ġtransfer', 'Ġrates', 'Ġ,', 'Ġdelivers', 'Ġup', 'Ġto', 'Ġ12', 'x', 'Ġthe', 'Ġspeed', 'Ġand', 'Ġ4', 'x', 'Ġthe', 'Ġrange', 'Ġof', 'Ġwireless', '-', 'g', 'Ġled', 'Ġlights', 'Ġinclude', 'Ġlink', 'Ġand', 'Ġactivity', 'Ġwe', 'p', 'Ġ(', 'Ġwired', 'Ġequivalent', 'Ġprivacy', 'Ġ)', 'Ġ,', 'Ġw', 'pa', 'Ġand', 'Ġw', 'pa', '2', 'Ġ(', 'Ġwi', '-', 'fi', 'Ġprotected', 'Ġaccess', 'Ġ)', 'Ġusb', 'Ġ2', '.', '0', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ', 'Ġ', '</s>', '</s>', 'COL', 'Ġname', 'ĠVAL', 'Ġlinks', 'ys', 'Ġwireless', '-', 'g', 'Ġw', 'usb', '54', 'gc', 'Ġcompact', 'Ġusb', 'Ġadapter', 'ĠCOL', 'Ġdescription', 'ĠVAL', 'Ġ', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ', 'Ġ', '</s>']
is_heads: [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
y: 0
tags: 0
mask: tensor([1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1])
seqlen: 135
task_name: Textual/Abt-Buy
=======================
step: 0, task: Textual/Abt-Buy, loss: 0.6712083220481873
Gradient overflow.  Skipping step, loss scaler 0 reducing loss scale to 16384.0
Gradient overflow.  Skipping step, loss scaler 0 reducing loss scale to 8192.0
step: 10, task: Textual/Abt-Buy, loss: 0.6717856526374817
step: 20, task: Textual/Abt-Buy, loss: 0.6027259230613708
step: 30, task: Textual/Abt-Buy, loss: 0.4916442036628723
step: 40, task: Textual/Abt-Buy, loss: 0.4099211096763611
step: 50, task: Textual/Abt-Buy, loss: 0.3894282281398773
step: 60, task: Textual/Abt-Buy, loss: 0.6897903084754944
step: 70, task: Textual/Abt-Buy, loss: 0.47977522015571594
step: 80, task: Textual/Abt-Buy, loss: 0.25790220499038696
step: 90, task: Textual/Abt-Buy, loss: 0.5198374390602112
step: 100, task: Textual/Abt-Buy, loss: 0.4375264346599579
step: 110, task: Textual/Abt-Buy, loss: 0.4632168114185333
step: 120, task: Textual/Abt-Buy, loss: 0.2288864254951477
step: 130, task: Textual/Abt-Buy, loss: 0.2127477526664734
step: 140, task: Textual/Abt-Buy, loss: 0.23380988836288452
step: 150, task: Textual/Abt-Buy, loss: 0.07612410187721252
step: 160, task: Textual/Abt-Buy, loss: 0.2438298463821411
step: 170, task: Textual/Abt-Buy, loss: 0.3366831839084625
step: 180, task: Textual/Abt-Buy, loss: 0.7101191282272339
step: 190, task: Textual/Abt-Buy, loss: 0.21813443303108215
step: 200, task: Textual/Abt-Buy, loss: 0.2373659312725067
step: 210, task: Textual/Abt-Buy, loss: 0.2437201887369156
step: 220, task: Textual/Abt-Buy, loss: 0.5459108948707581
step: 230, task: Textual/Abt-Buy, loss: 0.04292645305395126
step: 240, task: Textual/Abt-Buy, loss: 0.4091561436653137
step: 250, task: Textual/Abt-Buy, loss: 0.26658421754837036
step: 260, task: Textual/Abt-Buy, loss: 0.9385891556739807
step: 270, task: Textual/Abt-Buy, loss: 0.2297508716583252
step: 280, task: Textual/Abt-Buy, loss: 0.2870776653289795
step: 290, task: Textual/Abt-Buy, loss: 0.2106323093175888
step: 300, task: Textual/Abt-Buy, loss: 0.08635809272527695
step: 310, task: Textual/Abt-Buy, loss: 0.2578555941581726
step: 320, task: Textual/Abt-Buy, loss: 0.1298995465040207
step: 330, task: Textual/Abt-Buy, loss: 0.12442631274461746
step: 340, task: Textual/Abt-Buy, loss: 0.1914840042591095
step: 350, task: Textual/Abt-Buy, loss: 0.1781984269618988
=========eval at epoch=1=========
Validation:
=============Textual/Abt-Buy==================
accuracy=0.908
precision=0.841
recall=0.180
f1=0.296
======================================
Test:
=============Textual/Abt-Buy==================
accuracy=0.902
precision=0.702
recall=0.160
f1=0.261
======================================
/w/246/tianyu2020/miniconda2/envs/ditto/lib/python3.7/site-packages/apex/amp/_initialize.py:24: UserWarning: An input tensor was not cuda.
  warnings.warn("An input tensor was not cuda.")
/w/246/tianyu2020/miniconda2/envs/ditto/lib/python3.7/site-packages/torch/optim/lr_scheduler.py:122: UserWarning: Detected call of `lr_scheduler.step()` before `optimizer.step()`. In PyTorch 1.1.0 and later, you should call them in the opposite order: `optimizer.step()` before `lr_scheduler.step()`.  Failure to do this will result in PyTorch skipping the first value of the learning rate schedule. See more details at https://pytorch.org/docs/stable/optim.html#how-to-adjust-learning-rate
  "https://pytorch.org/docs/stable/optim.html#how-to-adjust-learning-rate", UserWarning)
=====sanity check======
words: COL name VAL canon deluxe black digital camera case 2595b002 COL description VAL canon deluxe black digital camera case 2595b002 soft nylon case flip-down cover belt loop attachment for hands-free convenience compatible with canon powershot a series black finish COL price VAL 13.99  [SEP] COL name VAL canon fs10 digital camcorder 2686b001 COL description VAL canon fs10 dual flash memory camcorder COL price VAL 341.72 
x: [    0 18047   766 27445 32839  2424 39210   909  1778  2280   403   564
  4015   428 19130 14857  8194 27445 32839  2424 39210   909  1778  2280
   403   564  4015   428 19130  3793 38874   403 11113    12  3955  1719
  7494 14018 26350    13  1420    12  3743  9742 16632    19 32839  4361
 10120    10   651   909  2073 14857   425 27445   508     4  2831  1437
     2     2 18047   766 27445 32839 48415   698  1778 11021   438 10337
   973  5334   428 19089 14857  8194 27445 32839 48415   698  6594  7462
  3783 11021   438 10337 14857   425 27445 41179     4  4956  1437     2]
tokens: ['<s>', 'COL', 'Ġname', 'ĠVAL', 'Ġcanon', 'Ġdel', 'uxe', 'Ġblack', 'Ġdigital', 'Ġcamera', 'Ġcase', 'Ġ25', '95', 'b', '002', 'ĠCOL', 'Ġdescription', 'ĠVAL', 'Ġcanon', 'Ġdel', 'uxe', 'Ġblack', 'Ġdigital', 'Ġcamera', 'Ġcase', 'Ġ25', '95', 'b', '002', 'Ġsoft', 'Ġnylon', 'Ġcase', 'Ġflip', '-', 'down', 'Ġcover', 'Ġbelt', 'Ġloop', 'Ġattachment', 'Ġfor', 'Ġhands', '-', 'free', 'Ġconvenience', 'Ġcompatible', 'Ġwith', 'Ġcanon', 'Ġpowers', 'hot', 'Ġa', 'Ġseries', 'Ġblack', 'Ġfinish', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ13', '.', '99', 'Ġ', '</s>', '</s>', 'COL', 'Ġname', 'ĠVAL', 'Ġcanon', 'Ġfs', '10', 'Ġdigital', 'Ġcam', 'c', 'order', 'Ġ26', '86', 'b', '001', 'ĠCOL', 'Ġdescription', 'ĠVAL', 'Ġcanon', 'Ġfs', '10', 'Ġdual', 'Ġflash', 'Ġmemory', 'Ġcam', 'c', 'order', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ341', '.', '72', 'Ġ', '</s>']
is_heads: [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
y: 0
tags: 0
mask: tensor([1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1])
seqlen: 96
task_name: Textual/Abt-Buy
=======================
step: 0, task: Textual/Abt-Buy, loss: 0.11546743661165237
step: 10, task: Textual/Abt-Buy, loss: 0.11908881366252899
step: 20, task: Textual/Abt-Buy, loss: 0.38181400299072266
step: 30, task: Textual/Abt-Buy, loss: 0.1521681696176529
step: 40, task: Textual/Abt-Buy, loss: 0.3529497981071472
step: 50, task: Textual/Abt-Buy, loss: 0.28437340259552
step: 60, task: Textual/Abt-Buy, loss: 0.08696343749761581
step: 70, task: Textual/Abt-Buy, loss: 0.026191622018814087
step: 80, task: Textual/Abt-Buy, loss: 0.07742446660995483
step: 90, task: Textual/Abt-Buy, loss: 0.25373148918151855
step: 100, task: Textual/Abt-Buy, loss: 0.08916250616312027
step: 110, task: Textual/Abt-Buy, loss: 0.13727112114429474
step: 120, task: Textual/Abt-Buy, loss: 0.021296225488185883
step: 130, task: Textual/Abt-Buy, loss: 0.17879632115364075
step: 140, task: Textual/Abt-Buy, loss: 0.02118370682001114
step: 150, task: Textual/Abt-Buy, loss: 0.11254101246595383
step: 160, task: Textual/Abt-Buy, loss: 0.1907888948917389
step: 170, task: Textual/Abt-Buy, loss: 0.0921550989151001
step: 180, task: Textual/Abt-Buy, loss: 0.052314642816782
step: 190, task: Textual/Abt-Buy, loss: 0.1660764515399933
step: 200, task: Textual/Abt-Buy, loss: 0.09614183753728867
step: 210, task: Textual/Abt-Buy, loss: 0.29486262798309326
step: 220, task: Textual/Abt-Buy, loss: 0.110474593937397
step: 230, task: Textual/Abt-Buy, loss: 0.13290637731552124
step: 240, task: Textual/Abt-Buy, loss: 0.00957806408405304
step: 250, task: Textual/Abt-Buy, loss: 0.02120814472436905
step: 260, task: Textual/Abt-Buy, loss: 0.08861040323972702
step: 270, task: Textual/Abt-Buy, loss: 0.1252504289150238
step: 280, task: Textual/Abt-Buy, loss: 0.06852602958679199
step: 290, task: Textual/Abt-Buy, loss: 0.07335888594388962
step: 300, task: Textual/Abt-Buy, loss: 0.38496774435043335
step: 310, task: Textual/Abt-Buy, loss: 0.03201545402407646
step: 320, task: Textual/Abt-Buy, loss: 0.06475704163312912
step: 330, task: Textual/Abt-Buy, loss: 0.007384687662124634
step: 340, task: Textual/Abt-Buy, loss: 0.2385586053133011
step: 350, task: Textual/Abt-Buy, loss: 0.08581767976284027
=========eval at epoch=2=========
Validation:
=============Textual/Abt-Buy==================
accuracy=0.914
precision=0.784
recall=0.282
f1=0.414
======================================
Test:
=============Textual/Abt-Buy==================
accuracy=0.919
precision=0.831
recall=0.311
f1=0.452
======================================
=====sanity check======
words: COL name VAL panasonic black dect 6.0 cordless telephone kxtg9333t COL description VAL panasonic black dect 6.0 cordless telephone kxtg9333t 1 base and 2 handsets extended talk time reduced interference all-digital answering system up to 17 hours of talk time expandable up to 6 handsets up to 3-way conference capability built-in clock with alarm digital speakerphone on handset black finish COL price VAL   [SEP] COL name VAL panasonic kx-tga670b cordless handset COL description VAL panasonic kx-tga670b additional handset for pankxtg6700b COL price VAL  
x: [    0 18047   766 27445  5730 38703   909   263  3894   231     4   288
 13051  1672  7377   449 11483   571   466 25631    90 14857  8194 27445
  5730 38703   909   263  3894   231     4   288 13051  1672  7377   449
 11483   571   466 25631    90   112  1542     8   132  1420  2580  3112
  1067    86  2906  8149    70    12 29563 15635   467    62     7   601
   722     9  1067    86  3003   868    62     7   231  1420  2580    62
     7   155    12  1970  1019  9388  1490    12   179  6700    19  8054
  1778  5385 17283    15 17621   909  2073 14857   425 27445  1437  1437
     2     2 18047   766 27445  5730 38703   449  1178    12    90  2538
 34148   428 13051  1672 17621 14857  8194 27445  5730 38703   449  1178
    12    90  2538 34148   428   943 17621    13   181  3153 11483   571
  4111   612   428 14857   425 27445  1437  1437     2]
tokens: ['<s>', 'COL', 'Ġname', 'ĠVAL', 'Ġpan', 'asonic', 'Ġblack', 'Ġde', 'ct', 'Ġ6', '.', '0', 'Ġcord', 'less', 'Ġtelephone', 'Ġk', 'xt', 'g', '9', '333', 't', 'ĠCOL', 'Ġdescription', 'ĠVAL', 'Ġpan', 'asonic', 'Ġblack', 'Ġde', 'ct', 'Ġ6', '.', '0', 'Ġcord', 'less', 'Ġtelephone', 'Ġk', 'xt', 'g', '9', '333', 't', 'Ġ1', 'Ġbase', 'Ġand', 'Ġ2', 'Ġhands', 'ets', 'Ġextended', 'Ġtalk', 'Ġtime', 'Ġreduced', 'Ġinterference', 'Ġall', '-', 'digital', 'Ġanswering', 'Ġsystem', 'Ġup', 'Ġto', 'Ġ17', 'Ġhours', 'Ġof', 'Ġtalk', 'Ġtime', 'Ġexpand', 'able', 'Ġup', 'Ġto', 'Ġ6', 'Ġhands', 'ets', 'Ġup', 'Ġto', 'Ġ3', '-', 'way', 'Ġconference', 'Ġcapability', 'Ġbuilt', '-', 'in', 'Ġclock', 'Ġwith', 'Ġalarm', 'Ġdigital', 'Ġspeaker', 'phone', 'Ġon', 'Ġhandset', 'Ġblack', 'Ġfinish', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ', 'Ġ', '</s>', '</s>', 'COL', 'Ġname', 'ĠVAL', 'Ġpan', 'asonic', 'Ġk', 'x', '-', 't', 'ga', '670', 'b', 'Ġcord', 'less', 'Ġhandset', 'ĠCOL', 'Ġdescription', 'ĠVAL', 'Ġpan', 'asonic', 'Ġk', 'x', '-', 't', 'ga', '670', 'b', 'Ġadditional', 'Ġhandset', 'Ġfor', 'Ġp', 'ank', 'xt', 'g', '67', '00', 'b', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ', 'Ġ', '</s>']
is_heads: [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
y: 0
tags: 0
mask: tensor([1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1])
seqlen: 141
task_name: Textual/Abt-Buy
=======================
step: 0, task: Textual/Abt-Buy, loss: 0.01470433920621872
step: 10, task: Textual/Abt-Buy, loss: 0.10967478156089783
step: 20, task: Textual/Abt-Buy, loss: 0.030114978551864624
step: 30, task: Textual/Abt-Buy, loss: 0.15608735382556915
step: 40, task: Textual/Abt-Buy, loss: 0.1460353583097458
step: 50, task: Textual/Abt-Buy, loss: 0.03257144242525101
step: 60, task: Textual/Abt-Buy, loss: 0.18617893755435944
step: 70, task: Textual/Abt-Buy, loss: 0.2605516016483307
step: 80, task: Textual/Abt-Buy, loss: 0.05623718723654747
step: 90, task: Textual/Abt-Buy, loss: 0.06742115318775177
step: 100, task: Textual/Abt-Buy, loss: 0.013039752840995789
step: 110, task: Textual/Abt-Buy, loss: 0.022306226193904877
step: 120, task: Textual/Abt-Buy, loss: 0.1935460865497589
step: 130, task: Textual/Abt-Buy, loss: 0.00048738718032836914
step: 140, task: Textual/Abt-Buy, loss: 0.0002682209014892578
step: 150, task: Textual/Abt-Buy, loss: 0.5391088724136353
step: 160, task: Textual/Abt-Buy, loss: 0.02797110378742218
step: 170, task: Textual/Abt-Buy, loss: 0.26995518803596497
step: 180, task: Textual/Abt-Buy, loss: 0.0494166761636734
step: 190, task: Textual/Abt-Buy, loss: 0.0019709765911102295
step: 200, task: Textual/Abt-Buy, loss: 0.06665121763944626
step: 210, task: Textual/Abt-Buy, loss: 0.011641383171081543
step: 220, task: Textual/Abt-Buy, loss: 0.21877816319465637
step: 230, task: Textual/Abt-Buy, loss: 0.09221581369638443
step: 240, task: Textual/Abt-Buy, loss: 0.07135525345802307
step: 250, task: Textual/Abt-Buy, loss: 0.011861108243465424
step: 260, task: Textual/Abt-Buy, loss: 0.0163709819316864
step: 270, task: Textual/Abt-Buy, loss: 0.01110820472240448
step: 280, task: Textual/Abt-Buy, loss: 0.030209556221961975
step: 290, task: Textual/Abt-Buy, loss: 0.05283692479133606
step: 300, task: Textual/Abt-Buy, loss: 0.008580751717090607
step: 310, task: Textual/Abt-Buy, loss: 0.016236208379268646
step: 320, task: Textual/Abt-Buy, loss: 0.053606756031513214
step: 330, task: Textual/Abt-Buy, loss: 0.011273667216300964
step: 340, task: Textual/Abt-Buy, loss: 0.030689306557178497
step: 350, task: Textual/Abt-Buy, loss: 0.038584426045417786
=========eval at epoch=3=========
Validation:
=============Textual/Abt-Buy==================
accuracy=0.897
precision=1.000
recall=0.044
f1=0.084
======================================
Test:
=============Textual/Abt-Buy==================
accuracy=0.897
precision=1.000
recall=0.044
f1=0.084
======================================
=====sanity check======
words: COL name VAL canon cyan photo ink cartridge cyan cli8pc COL description VAL canon cyan photo ink cartridge cli8pc compatible with the pixma ip6600d printer COL price VAL 16.0  [SEP] COL name VAL canon kp 36ip print cartridge paper kit 7737a001 COL description VAL 36 page 4 ' x 6 ' COL price VAL 9.99 
x: [    0 18047   766 27445 32839 39493  1345 16019 41785 39493  3741   118
   398 17426 14857  8194 27445 32839 39493  1345 16019 41785  3741   118
   398 17426 16632    19     5   181  3181  1916 36180  4280   612   417
 24079 14857   425 27445   545     4   288  1437     2     2 18047   766
 27445 32839   449   642  2491  1588  5780 41785  2225 10549  6791  3272
   102 19089 14857  8194 27445  2491  1842   204   128  3023   231   128
 14857   425 27445   361     4  2831  1437     2]
tokens: ['<s>', 'COL', 'Ġname', 'ĠVAL', 'Ġcanon', 'Ġcyan', 'Ġphoto', 'Ġink', 'Ġcartridge', 'Ġcyan', 'Ġcl', 'i', '8', 'pc', 'ĠCOL', 'Ġdescription', 'ĠVAL', 'Ġcanon', 'Ġcyan', 'Ġphoto', 'Ġink', 'Ġcartridge', 'Ġcl', 'i', '8', 'pc', 'Ġcompatible', 'Ġwith', 'Ġthe', 'Ġp', 'ix', 'ma', 'Ġip', '66', '00', 'd', 'Ġprinter', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ16', '.', '0', 'Ġ', '</s>', '</s>', 'COL', 'Ġname', 'ĠVAL', 'Ġcanon', 'Ġk', 'p', 'Ġ36', 'ip', 'Ġprint', 'Ġcartridge', 'Ġpaper', 'Ġkit', 'Ġ77', '37', 'a', '001', 'ĠCOL', 'Ġdescription', 'ĠVAL', 'Ġ36', 'Ġpage', 'Ġ4', "Ġ'", 'Ġx', 'Ġ6', "Ġ'", 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ9', '.', '99', 'Ġ', '</s>']
is_heads: [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
y: 0
tags: 0
mask: tensor([1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1])
seqlen: 80
task_name: Textual/Abt-Buy
=======================
step: 0, task: Textual/Abt-Buy, loss: 0.011503070592880249
step: 10, task: Textual/Abt-Buy, loss: 0.005320563912391663
step: 20, task: Textual/Abt-Buy, loss: 0.003671519458293915
step: 30, task: Textual/Abt-Buy, loss: 0.0004256516695022583
step: 40, task: Textual/Abt-Buy, loss: 0.021929122507572174
step: 50, task: Textual/Abt-Buy, loss: 0.028488192707300186
step: 60, task: Textual/Abt-Buy, loss: 0.031102165579795837
step: 70, task: Textual/Abt-Buy, loss: 0.1102142333984375
step: 80, task: Textual/Abt-Buy, loss: 0.0024955421686172485
step: 90, task: Textual/Abt-Buy, loss: 0.0024752020835876465
step: 100, task: Textual/Abt-Buy, loss: 0.02051985263824463
step: 110, task: Textual/Abt-Buy, loss: 0.037673141807317734
step: 120, task: Textual/Abt-Buy, loss: 0.0950586199760437
step: 130, task: Textual/Abt-Buy, loss: 0.0048401132225990295
step: 140, task: Textual/Abt-Buy, loss: 0.013601534068584442
step: 150, task: Textual/Abt-Buy, loss: 0.055619977414608
step: 160, task: Textual/Abt-Buy, loss: 0.0014096498489379883
step: 170, task: Textual/Abt-Buy, loss: 0.02264787256717682
step: 180, task: Textual/Abt-Buy, loss: 0.045995257794857025
step: 190, task: Textual/Abt-Buy, loss: 0.2538694143295288
step: 200, task: Textual/Abt-Buy, loss: 0.019664674997329712
step: 210, task: Textual/Abt-Buy, loss: 0.0010757148265838623
step: 220, task: Textual/Abt-Buy, loss: 0.1184018924832344
step: 230, task: Textual/Abt-Buy, loss: 0.0127912238240242
step: 240, task: Textual/Abt-Buy, loss: 0.03572321683168411
step: 250, task: Textual/Abt-Buy, loss: 0.046535372734069824
step: 260, task: Textual/Abt-Buy, loss: 0.036178916692733765
step: 270, task: Textual/Abt-Buy, loss: 0.06684429943561554
step: 280, task: Textual/Abt-Buy, loss: 0.06387976557016373
step: 290, task: Textual/Abt-Buy, loss: 0.03052445501089096
step: 300, task: Textual/Abt-Buy, loss: 0.029261529445648193
step: 310, task: Textual/Abt-Buy, loss: 0.027966804802417755
step: 320, task: Textual/Abt-Buy, loss: 0.0012905150651931763
step: 330, task: Textual/Abt-Buy, loss: 0.14646685123443604
step: 340, task: Textual/Abt-Buy, loss: 0.0667775422334671
step: 350, task: Textual/Abt-Buy, loss: 0.0733744204044342
=========eval at epoch=4=========
Validation:
=============Textual/Abt-Buy==================
accuracy=0.900
precision=0.941
recall=0.078
f1=0.143
======================================
Test:
=============Textual/Abt-Buy==================
accuracy=0.900
precision=0.941
recall=0.078
f1=0.143
======================================
=====sanity check======
words: COL name VAL samsung l200 black 10.2 megapixel digital camera ecl200zbba COL description VAL samsung l200 black 10.2 megapixel digital camera ecl200zbba 2.5 ' intelligent lcd screen 1/2 .33 ' high resolution ccd sensor 3x optical zoom lens dis ( digital image stabilization ) face detection function black finish COL price VAL   [SEP] COL name VAL samsung nv30 digital camera silver ec-nv30zsba / us COL description VAL samsung nv30 8 megapixel digital camera with schneider lens , dual image stabilization , smart touch , and face detection silver COL price VAL 139.0 
x: [    0 18047   766 27445   579 48545   784  2619   909   158     4   176
 10721 21424  1778  2280   364  3998  2619 19831  3178 14857  8194 27445
   579 48545   784  2619   909   158     4   176 10721 21424  1778  2280
   364  3998  2619 19831  3178   132     4   245   128 12038   784 28690
  2441   112    73   176   479  3103   128   239  3547   740 28690  9626
   155  1178 17547 21762 10373  2982    36  1778  2274 29632  4839   652
 12673  5043   909  2073 14857   425 27445  1437  1437     2     2 18047
   766 27445   579 48545   295   705   541  1778  2280  4334 20508    12
 37594   541   329    29  3178  1589   201 14857  8194 27445   579 48545
   295   705   541   290 10721 21424  1778  2280    19  8447   858  5326
 10373  2156  6594  2274 29632  2156  2793  2842  2156     8   652 12673
  4334 14857   425 27445 24404     4   288  1437     2]
tokens: ['<s>', 'COL', 'Ġname', 'ĠVAL', 'Ġs', 'amsung', 'Ġl', '200', 'Ġblack', 'Ġ10', '.', '2', 'Ġmeg', 'apixel', 'Ġdigital', 'Ġcamera', 'Ġe', 'cl', '200', 'zb', 'ba', 'ĠCOL', 'Ġdescription', 'ĠVAL', 'Ġs', 'amsung', 'Ġl', '200', 'Ġblack', 'Ġ10', '.', '2', 'Ġmeg', 'apixel', 'Ġdigital', 'Ġcamera', 'Ġe', 'cl', '200', 'zb', 'ba', 'Ġ2', '.', '5', "Ġ'", 'Ġintelligent', 'Ġl', 'cd', 'Ġscreen', 'Ġ1', '/', '2', 'Ġ.', '33', "Ġ'", 'Ġhigh', 'Ġresolution', 'Ġc', 'cd', 'Ġsensor', 'Ġ3', 'x', 'Ġoptical', 'Ġzoom', 'Ġlens', 'Ġdis', 'Ġ(', 'Ġdigital', 'Ġimage', 'Ġstabilization', 'Ġ)', 'Ġface', 'Ġdetection', 'Ġfunction', 'Ġblack', 'Ġfinish', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ', 'Ġ', '</s>', '</s>', 'COL', 'Ġname', 'ĠVAL', 'Ġs', 'amsung', 'Ġn', 'v', '30', 'Ġdigital', 'Ġcamera', 'Ġsilver', 'Ġec', '-', 'nv', '30', 'z', 's', 'ba', 'Ġ/', 'Ġus', 'ĠCOL', 'Ġdescription', 'ĠVAL', 'Ġs', 'amsung', 'Ġn', 'v', '30', 'Ġ8', 'Ġmeg', 'apixel', 'Ġdigital', 'Ġcamera', 'Ġwith', 'Ġsch', 'ne', 'ider', 'Ġlens', 'Ġ,', 'Ġdual', 'Ġimage', 'Ġstabilization', 'Ġ,', 'Ġsmart', 'Ġtouch', 'Ġ,', 'Ġand', 'Ġface', 'Ġdetection', 'Ġsilver', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ139', '.', '0', 'Ġ', '</s>']
is_heads: [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
y: 0
tags: 0
mask: tensor([1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1])
seqlen: 141
task_name: Textual/Abt-Buy
=======================
step: 0, task: Textual/Abt-Buy, loss: 0.005717121064662933
step: 10, task: Textual/Abt-Buy, loss: 0.0010606944561004639
step: 20, task: Textual/Abt-Buy, loss: 0.000502854585647583
step: 30, task: Textual/Abt-Buy, loss: 0.0006295740604400635
step: 40, task: Textual/Abt-Buy, loss: 0.11374735087156296
step: 50, task: Textual/Abt-Buy, loss: 0.0044259801506996155
step: 60, task: Textual/Abt-Buy, loss: 0.0006193965673446655
step: 70, task: Textual/Abt-Buy, loss: 0.005974270403385162
step: 80, task: Textual/Abt-Buy, loss: 0.14668461680412292
step: 90, task: Textual/Abt-Buy, loss: 0.00028787553310394287
step: 100, task: Textual/Abt-Buy, loss: 0.0004542917013168335
step: 110, task: Textual/Abt-Buy, loss: 0.37698009610176086
step: 120, task: Textual/Abt-Buy, loss: 0.04308848828077316
step: 130, task: Textual/Abt-Buy, loss: 0.06487368047237396
step: 140, task: Textual/Abt-Buy, loss: 0.0030287355184555054
step: 150, task: Textual/Abt-Buy, loss: 0.018569886684417725
step: 160, task: Textual/Abt-Buy, loss: 0.19107291102409363
step: 170, task: Textual/Abt-Buy, loss: 0.0005081743001937866
step: 180, task: Textual/Abt-Buy, loss: 0.017708592116832733
step: 190, task: Textual/Abt-Buy, loss: 0.002291373908519745
step: 200, task: Textual/Abt-Buy, loss: 0.17529678344726562
step: 210, task: Textual/Abt-Buy, loss: 0.0004124194383621216
step: 220, task: Textual/Abt-Buy, loss: 0.22073516249656677
step: 230, task: Textual/Abt-Buy, loss: 0.003175675868988037
step: 240, task: Textual/Abt-Buy, loss: 0.05544506013393402
step: 250, task: Textual/Abt-Buy, loss: 0.055569831281900406
step: 260, task: Textual/Abt-Buy, loss: 0.014379620552062988
step: 270, task: Textual/Abt-Buy, loss: 0.03215520828962326
step: 280, task: Textual/Abt-Buy, loss: 0.0002171844244003296
step: 290, task: Textual/Abt-Buy, loss: 0.06655141711235046
step: 300, task: Textual/Abt-Buy, loss: 0.016015298664569855
step: 310, task: Textual/Abt-Buy, loss: 0.11473923921585083
step: 320, task: Textual/Abt-Buy, loss: 0.02792639285326004
step: 330, task: Textual/Abt-Buy, loss: 0.19230598211288452
step: 340, task: Textual/Abt-Buy, loss: 0.03375561162829399
step: 350, task: Textual/Abt-Buy, loss: 0.001076921820640564
=========eval at epoch=5=========
Validation:
=============Textual/Abt-Buy==================
accuracy=0.910
precision=0.946
recall=0.170
f1=0.288
======================================
Test:
=============Textual/Abt-Buy==================
accuracy=0.913
precision=0.935
recall=0.209
f1=0.341
======================================
=====sanity check======
words: COL name VAL sony black component home theater system ht7200dh COL description VAL sony black component home theater system ht7200dh 900 watts 5.1 channels hdmi 1080p output dvd player hdmi active intellegence av receiver 5 satellite speakers xm ready black finish COL price VAL 499.0  [SEP] COL name VAL denon dht-fs3 2-piece home theater audio system COL description VAL  COL price VAL  
x: [    0 18047   766 27445   579  6119   909  7681   184  7364   467  1368
    90   406  2619 16593 14857  8194 27445   579  6119   909  7681   184
  7364   467  1368    90   406  2619 16593 10742 42574   195     4   134
  6237  1368   417  5408 21083   642  4195   385 40311   869  1368   417
  5408  2171 33238  4308  4086  6402  4797   195  7595  6864  3023   119
  1227   909  2073 14857   425 27445 43071     4   288  1437     2     2
 18047   766 27445  3069   261   385  6083    12 17884   246   132    12
 10449   184  7364  6086   467 14857  8194 27445  1437 14857   425 27445
  1437  1437     2]
tokens: ['<s>', 'COL', 'Ġname', 'ĠVAL', 'Ġs', 'ony', 'Ġblack', 'Ġcomponent', 'Ġhome', 'Ġtheater', 'Ġsystem', 'Ġh', 't', '7', '200', 'dh', 'ĠCOL', 'Ġdescription', 'ĠVAL', 'Ġs', 'ony', 'Ġblack', 'Ġcomponent', 'Ġhome', 'Ġtheater', 'Ġsystem', 'Ġh', 't', '7', '200', 'dh', 'Ġ900', 'Ġwatts', 'Ġ5', '.', '1', 'Ġchannels', 'Ġh', 'd', 'mi', 'Ġ1080', 'p', 'Ġoutput', 'Ġd', 'vd', 'Ġplayer', 'Ġh', 'd', 'mi', 'Ġactive', 'Ġintel', 'leg', 'ence', 'Ġav', 'Ġreceiver', 'Ġ5', 'Ġsatellite', 'Ġspeakers', 'Ġx', 'm', 'Ġready', 'Ġblack', 'Ġfinish', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ499', '.', '0', 'Ġ', '</s>', '</s>', 'COL', 'Ġname', 'ĠVAL', 'Ġden', 'on', 'Ġd', 'ht', '-', 'fs', '3', 'Ġ2', '-', 'piece', 'Ġhome', 'Ġtheater', 'Ġaudio', 'Ġsystem', 'ĠCOL', 'Ġdescription', 'ĠVAL', 'Ġ', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ', 'Ġ', '</s>']
is_heads: [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
y: 0
tags: 0
mask: tensor([1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1])
seqlen: 99
task_name: Textual/Abt-Buy
=======================
step: 0, task: Textual/Abt-Buy, loss: 0.00022254884243011475
step: 10, task: Textual/Abt-Buy, loss: 0.0789666399359703
step: 20, task: Textual/Abt-Buy, loss: 0.00028443336486816406
step: 30, task: Textual/Abt-Buy, loss: 0.024063333868980408
step: 40, task: Textual/Abt-Buy, loss: 0.03941531479358673
step: 50, task: Textual/Abt-Buy, loss: 0.03161494433879852
step: 60, task: Textual/Abt-Buy, loss: 0.0001808255910873413
step: 70, task: Textual/Abt-Buy, loss: 0.01669590175151825
step: 80, task: Textual/Abt-Buy, loss: 0.001577816903591156
step: 90, task: Textual/Abt-Buy, loss: 0.000775560736656189
step: 100, task: Textual/Abt-Buy, loss: 0.03490894287824631
step: 110, task: Textual/Abt-Buy, loss: 0.00022552907466888428
step: 120, task: Textual/Abt-Buy, loss: 0.029925815761089325
step: 130, task: Textual/Abt-Buy, loss: 0.0007987022399902344
step: 140, task: Textual/Abt-Buy, loss: 0.021677255630493164
step: 150, task: Textual/Abt-Buy, loss: 0.00022295117378234863
step: 160, task: Textual/Abt-Buy, loss: 0.17607784271240234
step: 170, task: Textual/Abt-Buy, loss: 0.008740834891796112
step: 180, task: Textual/Abt-Buy, loss: 0.0001614391803741455
step: 190, task: Textual/Abt-Buy, loss: 0.0004514157772064209
step: 200, task: Textual/Abt-Buy, loss: 0.0011896491050720215
step: 210, task: Textual/Abt-Buy, loss: 0.00024574995040893555
step: 220, task: Textual/Abt-Buy, loss: 0.0918407142162323
step: 230, task: Textual/Abt-Buy, loss: 0.0012850761413574219
step: 240, task: Textual/Abt-Buy, loss: 0.003244467079639435
step: 250, task: Textual/Abt-Buy, loss: 0.00022400915622711182
step: 260, task: Textual/Abt-Buy, loss: 0.016045689582824707
step: 270, task: Textual/Abt-Buy, loss: 0.014310982078313828
step: 280, task: Textual/Abt-Buy, loss: 0.03221525624394417
step: 290, task: Textual/Abt-Buy, loss: 0.00021363794803619385
step: 300, task: Textual/Abt-Buy, loss: 0.0001312345266342163
step: 310, task: Textual/Abt-Buy, loss: 0.008752167224884033
step: 320, task: Textual/Abt-Buy, loss: 0.0008846074342727661
step: 330, task: Textual/Abt-Buy, loss: 0.0009330213069915771
step: 340, task: Textual/Abt-Buy, loss: 0.10772114992141724
step: 350, task: Textual/Abt-Buy, loss: 0.0008523464202880859
=========eval at epoch=6=========
Validation:
=============Textual/Abt-Buy==================
accuracy=0.914
precision=0.920
recall=0.223
f1=0.359
======================================
Test:
=============Textual/Abt-Buy==================
accuracy=0.919
precision=0.946
recall=0.257
f1=0.405
======================================
=====sanity check======
words: COL name VAL panasonic black expandable digital cordless dect 6.0 phone system kxtg9348t COL description VAL panasonic black expandable digital cordless dect 6.0 phone system kxtg9348t automatic clarity booster 5 hours talk time 11 days standby white backlit lcd 6-step speakerphone volume 1 drop & splash resistant phone 1.9 ghz frequency range night mode black finish COL price VAL   [SEP] COL name VAL panasonic kx-tg4323b 5.8 ghz expandable digital cordless phone COL description VAL 1 x phone line ( s ) black COL price VAL  
x: [    0 18047   766 27445  5730 38703   909  3003   868  1778 13051  1672
   263  3894   231     4   288  1028   467   449 11483   571   466 27765
    90 14857  8194 27445  5730 38703   909  3003   868  1778 13051  1672
   263  3894   231     4   288  1028   467   449 11483   571   466 27765
    90  8408 10498 27028   195   722  1067    86   365   360 28611  1104
   124 13534   784 28690   231    12 13975  5385 17283  3149   112  1874
   359 17158 19152  1028   112     4   466 34648   329 13135  1186   363
  5745   909  2073 14857   425 27445  1437  1437     2     2 18047   766
 27445  5730 38703   449  1178    12 42698  3897  1922   428   195     4
   398 34648   329  3003   868  1778 13051  1672  1028 14857  8194 27445
   112  3023  1028   516    36   579  4839   909 14857   425 27445  1437
  1437     2]
tokens: ['<s>', 'COL', 'Ġname', 'ĠVAL', 'Ġpan', 'asonic', 'Ġblack', 'Ġexpand', 'able', 'Ġdigital', 'Ġcord', 'less', 'Ġde', 'ct', 'Ġ6', '.', '0', 'Ġphone', 'Ġsystem', 'Ġk', 'xt', 'g', '9', '348', 't', 'ĠCOL', 'Ġdescription', 'ĠVAL', 'Ġpan', 'asonic', 'Ġblack', 'Ġexpand', 'able', 'Ġdigital', 'Ġcord', 'less', 'Ġde', 'ct', 'Ġ6', '.', '0', 'Ġphone', 'Ġsystem', 'Ġk', 'xt', 'g', '9', '348', 't', 'Ġautomatic', 'Ġclarity', 'Ġbooster', 'Ġ5', 'Ġhours', 'Ġtalk', 'Ġtime', 'Ġ11', 'Ġdays', 'Ġstandby', 'Ġwhite', 'Ġback', 'lit', 'Ġl', 'cd', 'Ġ6', '-', 'step', 'Ġspeaker', 'phone', 'Ġvolume', 'Ġ1', 'Ġdrop', 'Ġ&', 'Ġsplash', 'Ġresistant', 'Ġphone', 'Ġ1', '.', '9', 'Ġgh', 'z', 'Ġfrequency', 'Ġrange', 'Ġnight', 'Ġmode', 'Ġblack', 'Ġfinish', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ', 'Ġ', '</s>', '</s>', 'COL', 'Ġname', 'ĠVAL', 'Ġpan', 'asonic', 'Ġk', 'x', '-', 'tg', '43', '23', 'b', 'Ġ5', '.', '8', 'Ġgh', 'z', 'Ġexpand', 'able', 'Ġdigital', 'Ġcord', 'less', 'Ġphone', 'ĠCOL', 'Ġdescription', 'ĠVAL', 'Ġ1', 'Ġx', 'Ġphone', 'Ġline', 'Ġ(', 'Ġs', 'Ġ)', 'Ġblack', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ', 'Ġ', '</s>']
is_heads: [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
y: 0
tags: 0
mask: tensor([1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1])
seqlen: 134
task_name: Textual/Abt-Buy
=======================
step: 0, task: Textual/Abt-Buy, loss: 0.006965115666389465
step: 10, task: Textual/Abt-Buy, loss: 0.00026988983154296875
step: 20, task: Textual/Abt-Buy, loss: 0.03066522628068924
step: 30, task: Textual/Abt-Buy, loss: 0.001991093158721924
step: 40, task: Textual/Abt-Buy, loss: 0.00959806889295578
step: 50, task: Textual/Abt-Buy, loss: 0.009172901511192322
step: 60, task: Textual/Abt-Buy, loss: 0.000856354832649231
step: 70, task: Textual/Abt-Buy, loss: 0.0001926422119140625
step: 80, task: Textual/Abt-Buy, loss: 0.04150703549385071
step: 90, task: Textual/Abt-Buy, loss: 0.0020979195833206177
step: 100, task: Textual/Abt-Buy, loss: 0.0009854882955551147
step: 110, task: Textual/Abt-Buy, loss: 0.006153509020805359
step: 120, task: Textual/Abt-Buy, loss: 0.00021824240684509277
step: 130, task: Textual/Abt-Buy, loss: 0.2822674810886383
Gradient overflow.  Skipping step, loss scaler 0 reducing loss scale to 8192.0
step: 140, task: Textual/Abt-Buy, loss: 0.15175053477287292
step: 150, task: Textual/Abt-Buy, loss: 0.009044148027896881
step: 160, task: Textual/Abt-Buy, loss: 0.00010979175567626953
step: 170, task: Textual/Abt-Buy, loss: 0.00044871866703033447
step: 180, task: Textual/Abt-Buy, loss: 0.0016486048698425293
step: 190, task: Textual/Abt-Buy, loss: 0.0019930079579353333
step: 200, task: Textual/Abt-Buy, loss: 8.717179298400879e-05
step: 210, task: Textual/Abt-Buy, loss: 0.00017787516117095947
step: 220, task: Textual/Abt-Buy, loss: 0.0002945512533187866
step: 230, task: Textual/Abt-Buy, loss: 0.00022593140602111816
step: 240, task: Textual/Abt-Buy, loss: 8.133053779602051e-05
step: 250, task: Textual/Abt-Buy, loss: 7.31348991394043e-05
step: 260, task: Textual/Abt-Buy, loss: 0.0001379251480102539
step: 270, task: Textual/Abt-Buy, loss: 0.0001563727855682373
step: 280, task: Textual/Abt-Buy, loss: 0.0012854337692260742
step: 290, task: Textual/Abt-Buy, loss: 0.00022712349891662598
step: 300, task: Textual/Abt-Buy, loss: 0.0037881284952163696
step: 310, task: Textual/Abt-Buy, loss: 0.00020547211170196533
step: 320, task: Textual/Abt-Buy, loss: 8.51750373840332e-05
step: 330, task: Textual/Abt-Buy, loss: 0.0010668039321899414
step: 340, task: Textual/Abt-Buy, loss: 0.0010295212268829346
step: 350, task: Textual/Abt-Buy, loss: 0.032738327980041504
=========eval at epoch=7=========
Validation:
=============Textual/Abt-Buy==================
accuracy=0.909
precision=0.919
recall=0.165
f1=0.280
======================================
Test:
=============Textual/Abt-Buy==================
accuracy=0.909
precision=0.944
recall=0.165
f1=0.281
======================================
=====sanity check======
words: COL name VAL samsung 55 ' series 9 lcd black flat panel hdtv ln55a950 COL description VAL samsung 55 ' series 9 lcd black flat panel hdtv ln55a950 touch of color design full 1080p high definition resolution 2,000,000:1 dynamic contrast ratio auto motion plus 120hz built-in digital tuner ( ntsc/atsc/clear qam ) 4ms response time srs trusurround xt down firing speakers picture-in-picture ( pip ) integrated woofer wide color gamut led backlight black finish COL price VAL   [SEP] COL name VAL samsung ln32a450 32 ' 720p lcd hdtv COL description VAL  COL price VAL  
x: [    0 18047   766 27445   579 48545  3490   128   651   361   784 28690
   909  3269  2798  1368   417 18724   784   282  3118   102 24378 14857
  8194 27445   579 48545  3490   128   651   361   784 28690   909  3269
  2798  1368   417 18724   784   282  3118   102 24378  2842     9  3195
  1521   455 21083   642   239  8515  3547   132     6   151     6   151
    35   134  6878  5709  1750  4485  4298  2704  5962 39569  1490    12
   179  1778 27115   254    36   295  1872   438    73  2923   438    73
 18763  2231   424  4839   204  4339  1263    86   579  4926  2664   687
   710  3431  1437 11483   159  5834  6864  2170    12   179    12 37587
    36 35209  4839  6818 19958 20779  1810  3195 20577  1182   669   124
  6991   909  2073 14857   425 27445  1437  1437     2     2 18047   766
 27445   579 48545   784   282  2881   102 13872  2107   128 26180   642
   784 28690  1368   417 18724 14857  8194 27445  1437 14857   425 27445
  1437  1437     2]
tokens: ['<s>', 'COL', 'Ġname', 'ĠVAL', 'Ġs', 'amsung', 'Ġ55', "Ġ'", 'Ġseries', 'Ġ9', 'Ġl', 'cd', 'Ġblack', 'Ġflat', 'Ġpanel', 'Ġh', 'd', 'tv', 'Ġl', 'n', '55', 'a', '950', 'ĠCOL', 'Ġdescription', 'ĠVAL', 'Ġs', 'amsung', 'Ġ55', "Ġ'", 'Ġseries', 'Ġ9', 'Ġl', 'cd', 'Ġblack', 'Ġflat', 'Ġpanel', 'Ġh', 'd', 'tv', 'Ġl', 'n', '55', 'a', '950', 'Ġtouch', 'Ġof', 'Ġcolor', 'Ġdesign', 'Ġfull', 'Ġ1080', 'p', 'Ġhigh', 'Ġdefinition', 'Ġresolution', 'Ġ2', ',', '000', ',', '000', ':', '1', 'Ġdynamic', 'Ġcontrast', 'Ġratio', 'Ġauto', 'Ġmotion', 'Ġplus', 'Ġ120', 'hz', 'Ġbuilt', '-', 'in', 'Ġdigital', 'Ġtun', 'er', 'Ġ(', 'Ġn', 'ts', 'c', '/', 'ats', 'c', '/', 'clear', 'Ġq', 'am', 'Ġ)', 'Ġ4', 'ms', 'Ġresponse', 'Ġtime', 'Ġs', 'rs', 'Ġtr', 'us', 'ur', 'round', 'Ġ', 'xt', 'Ġdown', 'Ġfiring', 'Ġspeakers', 'Ġpicture', '-', 'in', '-', 'picture', 'Ġ(', 'Ġpip', 'Ġ)', 'Ġintegrated', 'Ġwo', 'ofer', 'Ġwide', 'Ġcolor', 'Ġgam', 'ut', 'Ġled', 'Ġback', 'light', 'Ġblack', 'Ġfinish', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ', 'Ġ', '</s>', '</s>', 'COL', 'Ġname', 'ĠVAL', 'Ġs', 'amsung', 'Ġl', 'n', '32', 'a', '450', 'Ġ32', "Ġ'", 'Ġ720', 'p', 'Ġl', 'cd', 'Ġh', 'd', 'tv', 'ĠCOL', 'Ġdescription', 'ĠVAL', 'Ġ', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ', 'Ġ', '</s>']
is_heads: [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
y: 0
tags: 0
mask: tensor([1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1])
seqlen: 159
task_name: Textual/Abt-Buy
=======================
step: 0, task: Textual/Abt-Buy, loss: 0.00011816620826721191
step: 10, task: Textual/Abt-Buy, loss: 0.00042578577995300293
step: 20, task: Textual/Abt-Buy, loss: 0.0002552717924118042
step: 30, task: Textual/Abt-Buy, loss: 0.1357990950345993
step: 40, task: Textual/Abt-Buy, loss: 5.7071447372436523e-05
step: 50, task: Textual/Abt-Buy, loss: 0.0020150765776634216
step: 60, task: Textual/Abt-Buy, loss: 0.00038760900497436523
step: 70, task: Textual/Abt-Buy, loss: 0.004909127950668335
step: 80, task: Textual/Abt-Buy, loss: 0.004899129271507263
step: 90, task: Textual/Abt-Buy, loss: 0.060867249965667725
step: 100, task: Textual/Abt-Buy, loss: 0.002395421266555786
step: 110, task: Textual/Abt-Buy, loss: 0.00032551586627960205
step: 120, task: Textual/Abt-Buy, loss: 0.0006112009286880493
step: 130, task: Textual/Abt-Buy, loss: 0.0020885169506073
step: 140, task: Textual/Abt-Buy, loss: 0.0001386404037475586
step: 150, task: Textual/Abt-Buy, loss: 0.0018011629581451416
step: 160, task: Textual/Abt-Buy, loss: 0.0006358474493026733
step: 170, task: Textual/Abt-Buy, loss: 0.00011904537677764893
step: 180, task: Textual/Abt-Buy, loss: 0.011328369379043579
step: 190, task: Textual/Abt-Buy, loss: 0.0001255720853805542
step: 200, task: Textual/Abt-Buy, loss: 0.0012060701847076416
step: 210, task: Textual/Abt-Buy, loss: 0.0012592002749443054
step: 220, task: Textual/Abt-Buy, loss: 0.0003127157688140869
step: 230, task: Textual/Abt-Buy, loss: 0.027060270309448242
step: 240, task: Textual/Abt-Buy, loss: 0.00034037232398986816
step: 250, task: Textual/Abt-Buy, loss: 0.00022237002849578857
step: 260, task: Textual/Abt-Buy, loss: 7.444620132446289e-05
step: 270, task: Textual/Abt-Buy, loss: 0.00011008977890014648
step: 280, task: Textual/Abt-Buy, loss: 0.0007203072309494019
step: 290, task: Textual/Abt-Buy, loss: 0.002446785569190979
step: 300, task: Textual/Abt-Buy, loss: 8.448958396911621e-05
step: 310, task: Textual/Abt-Buy, loss: 6.702542304992676e-05
step: 320, task: Textual/Abt-Buy, loss: 0.002446494996547699
step: 330, task: Textual/Abt-Buy, loss: 0.003580428659915924
step: 340, task: Textual/Abt-Buy, loss: 0.00017815828323364258
step: 350, task: Textual/Abt-Buy, loss: 0.0006333291530609131
=========eval at epoch=8=========
Validation:
=============Textual/Abt-Buy==================
accuracy=0.912
precision=0.932
recall=0.199
f1=0.328
======================================
Test:
=============Textual/Abt-Buy==================
accuracy=0.910
precision=0.884
recall=0.184
f1=0.305
======================================
Selected optimization level O2:  FP16 training with FP32 batchnorm and FP32 master weights.

Defaults for this optimization level are:
enabled                : True
opt_level              : O2
cast_model_type        : torch.float16
patch_torch_functions  : False
keep_batchnorm_fp32    : True
master_weights         : True
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O2
cast_model_type        : torch.float16
patch_torch_functions  : False
keep_batchnorm_fp32    : True
master_weights         : True
loss_scale             : dynamic
Warning:  multi_tensor_applier fused unscale kernel is unavailable, possibly because apex was installed without --cuda_ext --cpp_ext. Using Python fallback.  Original ImportError was: ModuleNotFoundError("No module named 'amp_C'")
Gradient overflow.  Skipping step, loss scaler 0 reducing loss scale to 32768.0
=====sanity check======
words: COL name VAL panasonic integrated telephone system kxts108w COL description VAL panasonic integrated telephone system kxts108w 16 digit lcd with clock hands free speakerphone built-in data port 10-station one-touch dialing 3-step ringer volume white finish COL price VAL 44.0  [SEP] COL name VAL panasonic sc-pt760 home theater system COL description VAL panasonic sc-pt760 premium sound dvd home theater system with kelton subwoofer COL price VAL 319.97 
x: [    0 18047   766 27445  5730 38703  6818  7377   467   449 11483    29
 18844   605 14857  8194 27445  5730 38703  6818  7377   467   449 11483
    29 18844   605   545 16808   784 28690    19  6700  1420   481  5385
 17283  1490    12   179   414  4103   158    12 30650    65    12 26673
 11481   154   155    12 13975   910  6082  3149  1104  2073 14857   425
 27445  3550     4   288  1437     2     2 18047   766 27445  5730 38703
  2850    12  3320 31222   184  7364   467 14857  8194 27445  5730 38703
  2850    12  3320 31222  4549  2369   385 40311   184  7364   467    19
  7321   462  1054  2849 14869 20779 14857   425 27445 37964     4  6750
  1437     2]
tokens: ['<s>', 'COL', 'Ġname', 'ĠVAL', 'Ġpan', 'asonic', 'Ġintegrated', 'Ġtelephone', 'Ġsystem', 'Ġk', 'xt', 's', '108', 'w', 'ĠCOL', 'Ġdescription', 'ĠVAL', 'Ġpan', 'asonic', 'Ġintegrated', 'Ġtelephone', 'Ġsystem', 'Ġk', 'xt', 's', '108', 'w', 'Ġ16', 'Ġdigit', 'Ġl', 'cd', 'Ġwith', 'Ġclock', 'Ġhands', 'Ġfree', 'Ġspeaker', 'phone', 'Ġbuilt', '-', 'in', 'Ġdata', 'Ġport', 'Ġ10', '-', 'station', 'Ġone', '-', 'touch', 'Ġdial', 'ing', 'Ġ3', '-', 'step', 'Ġr', 'inger', 'Ġvolume', 'Ġwhite', 'Ġfinish', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ44', '.', '0', 'Ġ', '</s>', '</s>', 'COL', 'Ġname', 'ĠVAL', 'Ġpan', 'asonic', 'Ġsc', '-', 'pt', '760', 'Ġhome', 'Ġtheater', 'Ġsystem', 'ĠCOL', 'Ġdescription', 'ĠVAL', 'Ġpan', 'asonic', 'Ġsc', '-', 'pt', '760', 'Ġpremium', 'Ġsound', 'Ġd', 'vd', 'Ġhome', 'Ġtheater', 'Ġsystem', 'Ġwith', 'Ġke', 'l', 'ton', 'Ġsub', 'wo', 'ofer', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ319', '.', '97', 'Ġ', '</s>']
is_heads: [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
y: 0
tags: 0
mask: tensor([1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1])
seqlen: 110
task_name: Textual/Abt-Buy
=======================
step: 0, task: Textual/Abt-Buy, loss: 0.7157785892486572
Gradient overflow.  Skipping step, loss scaler 0 reducing loss scale to 16384.0
Gradient overflow.  Skipping step, loss scaler 0 reducing loss scale to 8192.0
step: 10, task: Textual/Abt-Buy, loss: 0.7014616131782532
step: 20, task: Textual/Abt-Buy, loss: 0.6011276245117188
step: 30, task: Textual/Abt-Buy, loss: 0.3780982196331024
Gradient overflow.  Skipping step, loss scaler 0 reducing loss scale to 4096.0
step: 40, task: Textual/Abt-Buy, loss: 0.3417198359966278
step: 50, task: Textual/Abt-Buy, loss: 0.5378872752189636
step: 60, task: Textual/Abt-Buy, loss: 0.254209965467453
step: 70, task: Textual/Abt-Buy, loss: 0.6088681221008301
step: 80, task: Textual/Abt-Buy, loss: 0.272668719291687
step: 90, task: Textual/Abt-Buy, loss: 0.30395442247390747
step: 100, task: Textual/Abt-Buy, loss: 0.2728407680988312
step: 110, task: Textual/Abt-Buy, loss: 0.24640268087387085
step: 120, task: Textual/Abt-Buy, loss: 0.3439396619796753
step: 130, task: Textual/Abt-Buy, loss: 0.8958054184913635
step: 140, task: Textual/Abt-Buy, loss: 0.239335298538208
step: 150, task: Textual/Abt-Buy, loss: 0.39826735854148865
step: 160, task: Textual/Abt-Buy, loss: 0.19170865416526794
step: 170, task: Textual/Abt-Buy, loss: 0.28945183753967285
step: 180, task: Textual/Abt-Buy, loss: 0.5336911678314209
step: 190, task: Textual/Abt-Buy, loss: 0.25728845596313477
step: 200, task: Textual/Abt-Buy, loss: 0.22021442651748657
step: 210, task: Textual/Abt-Buy, loss: 0.3471519947052002
step: 220, task: Textual/Abt-Buy, loss: 0.8305947780609131
step: 230, task: Textual/Abt-Buy, loss: 0.14527057111263275
step: 240, task: Textual/Abt-Buy, loss: 0.48985975980758667
step: 250, task: Textual/Abt-Buy, loss: 0.5227989554405212
step: 260, task: Textual/Abt-Buy, loss: 0.27251294255256653
step: 270, task: Textual/Abt-Buy, loss: 0.6205470561981201
step: 280, task: Textual/Abt-Buy, loss: 0.5894266963005066
step: 290, task: Textual/Abt-Buy, loss: 0.17525890469551086
step: 300, task: Textual/Abt-Buy, loss: 0.0721747875213623
step: 310, task: Textual/Abt-Buy, loss: 0.6738311648368835
step: 320, task: Textual/Abt-Buy, loss: 0.20312751829624176
step: 330, task: Textual/Abt-Buy, loss: 0.5138727426528931
step: 340, task: Textual/Abt-Buy, loss: 0.45668312907218933
step: 350, task: Textual/Abt-Buy, loss: 0.5460271239280701
=========eval at epoch=1=========
Validation:
=============Textual/Abt-Buy==================
accuracy=0.892
precision=0.000
recall=0.000
f1=0.000
======================================
Test:
=============Textual/Abt-Buy==================
accuracy=0.892
precision=0.000
recall=0.000
f1=0.000
======================================
/w/246/tianyu2020/miniconda2/envs/ditto/lib/python3.7/site-packages/apex/amp/_initialize.py:24: UserWarning: An input tensor was not cuda.
  warnings.warn("An input tensor was not cuda.")
/w/246/tianyu2020/miniconda2/envs/ditto/lib/python3.7/site-packages/torch/optim/lr_scheduler.py:122: UserWarning: Detected call of `lr_scheduler.step()` before `optimizer.step()`. In PyTorch 1.1.0 and later, you should call them in the opposite order: `optimizer.step()` before `lr_scheduler.step()`.  Failure to do this will result in PyTorch skipping the first value of the learning rate schedule. See more details at https://pytorch.org/docs/stable/optim.html#how-to-adjust-learning-rate
  "https://pytorch.org/docs/stable/optim.html#how-to-adjust-learning-rate", UserWarning)
/w/246/tianyu2020/miniconda2/envs/ditto/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1221: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
=====sanity check======
words: COL name VAL speck seethru pink hard shell case for macbook air mbapnksee COL description VAL speck seethru pink hard shell case for macbook air mbapnksee thin and sleek protective case access to all ports 2-piece snap on pink finish COL price VAL   [SEP] COL name VAL speck products seethru case for apple 13 ' macbook mb13-clr-see-v2 COL description VAL plastic clear COL price VAL  
x: [    0 18047   766 27445 25227  2420   842  4774  2070  6907   543 10785
   403    13 13418  6298   935   475   428  1115   282   330  7048 14857
  8194 27445 25227  2420   842  4774  2070  6907   543 10785   403    13
 13418  6298   935   475   428  1115   282   330  7048  7174     8 19474
 11775   403   899     7    70  9507   132    12 10449  6788    15  6907
  2073 14857   425 27445  1437  1437     2     2 18047   766 27445 25227
  2420   785   842  4774  2070   403    13 15162   508   128 13418  6298
   475   428  1558    12  3998   338    12  7048    12   705   176 14857
  8194 27445  4136   699 14857   425 27445  1437  1437     2]
tokens: ['<s>', 'COL', 'Ġname', 'ĠVAL', 'Ġspe', 'ck', 'Ġse', 'eth', 'ru', 'Ġpink', 'Ġhard', 'Ġshell', 'Ġcase', 'Ġfor', 'Ġmac', 'book', 'Ġair', 'Ġm', 'b', 'ap', 'n', 'k', 'see', 'ĠCOL', 'Ġdescription', 'ĠVAL', 'Ġspe', 'ck', 'Ġse', 'eth', 'ru', 'Ġpink', 'Ġhard', 'Ġshell', 'Ġcase', 'Ġfor', 'Ġmac', 'book', 'Ġair', 'Ġm', 'b', 'ap', 'n', 'k', 'see', 'Ġthin', 'Ġand', 'Ġsleek', 'Ġprotective', 'Ġcase', 'Ġaccess', 'Ġto', 'Ġall', 'Ġports', 'Ġ2', '-', 'piece', 'Ġsnap', 'Ġon', 'Ġpink', 'Ġfinish', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ', 'Ġ', '</s>', '</s>', 'COL', 'Ġname', 'ĠVAL', 'Ġspe', 'ck', 'Ġproducts', 'Ġse', 'eth', 'ru', 'Ġcase', 'Ġfor', 'Ġapple', 'Ġ13', "Ġ'", 'Ġmac', 'book', 'Ġm', 'b', '13', '-', 'cl', 'r', '-', 'see', '-', 'v', '2', 'ĠCOL', 'Ġdescription', 'ĠVAL', 'Ġplastic', 'Ġclear', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ', 'Ġ', '</s>']
is_heads: [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
y: 0
tags: 0
mask: tensor([1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1])
seqlen: 106
task_name: Textual/Abt-Buy
=======================
step: 0, task: Textual/Abt-Buy, loss: 0.2058398425579071
step: 10, task: Textual/Abt-Buy, loss: 0.3513372838497162
step: 20, task: Textual/Abt-Buy, loss: 0.47417598962783813
step: 30, task: Textual/Abt-Buy, loss: 0.1329876184463501
step: 40, task: Textual/Abt-Buy, loss: 0.24613851308822632
step: 50, task: Textual/Abt-Buy, loss: 0.2988419532775879
step: 60, task: Textual/Abt-Buy, loss: 0.09169996529817581
step: 70, task: Textual/Abt-Buy, loss: 0.38967132568359375
step: 80, task: Textual/Abt-Buy, loss: 0.2162061184644699
step: 90, task: Textual/Abt-Buy, loss: 0.08686836063861847
step: 100, task: Textual/Abt-Buy, loss: 0.23471617698669434
step: 110, task: Textual/Abt-Buy, loss: 0.3585816025733948
step: 120, task: Textual/Abt-Buy, loss: 0.19249431788921356
step: 130, task: Textual/Abt-Buy, loss: 0.32591134309768677
step: 140, task: Textual/Abt-Buy, loss: 0.07333678752183914
step: 150, task: Textual/Abt-Buy, loss: 0.2481767237186432
step: 160, task: Textual/Abt-Buy, loss: 0.2782546877861023
step: 170, task: Textual/Abt-Buy, loss: 0.11385801434516907
step: 180, task: Textual/Abt-Buy, loss: 0.34407952427864075
step: 190, task: Textual/Abt-Buy, loss: 0.2829608619213104
step: 200, task: Textual/Abt-Buy, loss: 0.34894490242004395
step: 210, task: Textual/Abt-Buy, loss: 0.24616213142871857
step: 220, task: Textual/Abt-Buy, loss: 0.5170634984970093
step: 230, task: Textual/Abt-Buy, loss: 0.3228391408920288
step: 240, task: Textual/Abt-Buy, loss: 0.3593575954437256
step: 250, task: Textual/Abt-Buy, loss: 0.29577362537384033
step: 260, task: Textual/Abt-Buy, loss: 0.37425941228866577
step: 270, task: Textual/Abt-Buy, loss: 0.01107323169708252
step: 280, task: Textual/Abt-Buy, loss: 0.09424787759780884
step: 290, task: Textual/Abt-Buy, loss: 0.39183947443962097
step: 300, task: Textual/Abt-Buy, loss: 0.132377028465271
step: 310, task: Textual/Abt-Buy, loss: 0.03702123463153839
step: 320, task: Textual/Abt-Buy, loss: 0.28990817070007324
step: 330, task: Textual/Abt-Buy, loss: 0.3746401369571686
step: 340, task: Textual/Abt-Buy, loss: 0.14063894748687744
step: 350, task: Textual/Abt-Buy, loss: 0.09725750982761383
=========eval at epoch=1=========
Validation:
=============Textual/Abt-Buy==================
accuracy=0.868
precision=0.425
recall=0.631
f1=0.508
======================================
Test:
=============Textual/Abt-Buy==================
accuracy=0.866
precision=0.421
recall=0.646
f1=0.510
======================================
=====sanity check======
words: COL name VAL onkyo black 7.1-channel home theater system hts5100b COL description VAL onkyo hts5100 black 7.1-channel home theater system hts5100b connect up to 3 hdmi-enabled sources audio playback from your ipod music optimizer corrects room distortion compatible with sirius satellite radio 4 digital inputs advanced 32-bit processing dsp chip double bass function ipod dock included black finish COL price VAL   [SEP] COL name VAL yamaha yht-390bl home theater system yht-390bl COL description VAL , 5.1 speakers progressive scan 600w rms black COL price VAL 319.96 
x: [    0 18047   766 27445    15  4122   139   909   262     4   134    12
 27681   184  7364   467  1368  1872   245  1866   428 14857  8194 27445
    15  4122   139  1368  1872   245  1866   909   262     4   134    12
 27681   184  7364   467  1368  1872   245  1866   428  4686    62     7
   155  1368   417  5408    12 23949  1715  6086 20083    31   110 36180
  1630   930 17775  6315  4577    29   929 36075 16632    19 21958  6125
  7595  3188   204  1778 16584  3319  2107    12  5881  5774   385  4182
  6638  1457  9590  5043 36180  1630 15261  1165   909  2073 14857   425
 27445  1437  1437     2     2 18047   766 27445  1423   424 11695  1423
  6083    12 27873  3662   184  7364   467  1423  6083    12 27873  3662
 14857  8194 27445  2156   195     4   134  6864  8212 14194  5594   605
   910  4339   909 14857   425 27445 37964     4  5607  1437     2]
tokens: ['<s>', 'COL', 'Ġname', 'ĠVAL', 'Ġon', 'ky', 'o', 'Ġblack', 'Ġ7', '.', '1', '-', 'channel', 'Ġhome', 'Ġtheater', 'Ġsystem', 'Ġh', 'ts', '5', '100', 'b', 'ĠCOL', 'Ġdescription', 'ĠVAL', 'Ġon', 'ky', 'o', 'Ġh', 'ts', '5', '100', 'Ġblack', 'Ġ7', '.', '1', '-', 'channel', 'Ġhome', 'Ġtheater', 'Ġsystem', 'Ġh', 'ts', '5', '100', 'b', 'Ġconnect', 'Ġup', 'Ġto', 'Ġ3', 'Ġh', 'd', 'mi', '-', 'enabled', 'Ġsources', 'Ġaudio', 'Ġplayback', 'Ġfrom', 'Ġyour', 'Ġip', 'od', 'Ġmusic', 'Ġoptim', 'izer', 'Ġcorrect', 's', 'Ġroom', 'Ġdistortion', 'Ġcompatible', 'Ġwith', 'Ġsir', 'ius', 'Ġsatellite', 'Ġradio', 'Ġ4', 'Ġdigital', 'Ġinputs', 'Ġadvanced', 'Ġ32', '-', 'bit', 'Ġprocessing', 'Ġd', 'sp', 'Ġchip', 'Ġdouble', 'Ġbass', 'Ġfunction', 'Ġip', 'od', 'Ġdock', 'Ġincluded', 'Ġblack', 'Ġfinish', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ', 'Ġ', '</s>', '</s>', 'COL', 'Ġname', 'ĠVAL', 'Ġy', 'am', 'aha', 'Ġy', 'ht', '-', '390', 'bl', 'Ġhome', 'Ġtheater', 'Ġsystem', 'Ġy', 'ht', '-', '390', 'bl', 'ĠCOL', 'Ġdescription', 'ĠVAL', 'Ġ,', 'Ġ5', '.', '1', 'Ġspeakers', 'Ġprogressive', 'Ġscan', 'Ġ600', 'w', 'Ġr', 'ms', 'Ġblack', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ319', '.', '96', 'Ġ', '</s>']
is_heads: [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
y: 0
tags: 0
mask: tensor([1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1])
seqlen: 143
task_name: Textual/Abt-Buy
=======================
step: 0, task: Textual/Abt-Buy, loss: 0.11148174852132797
step: 10, task: Textual/Abt-Buy, loss: 0.12177131325006485
step: 20, task: Textual/Abt-Buy, loss: 0.04096751660108566
step: 30, task: Textual/Abt-Buy, loss: 0.03329937160015106
step: 40, task: Textual/Abt-Buy, loss: 0.3349158763885498
step: 50, task: Textual/Abt-Buy, loss: 0.2685728967189789
step: 60, task: Textual/Abt-Buy, loss: 0.10358013957738876
step: 70, task: Textual/Abt-Buy, loss: 0.1061544418334961
step: 80, task: Textual/Abt-Buy, loss: 0.4841826558113098
step: 90, task: Textual/Abt-Buy, loss: 0.11716458946466446
step: 100, task: Textual/Abt-Buy, loss: 0.05744563043117523
step: 110, task: Textual/Abt-Buy, loss: 0.17882657051086426
step: 120, task: Textual/Abt-Buy, loss: 0.22686022520065308
step: 130, task: Textual/Abt-Buy, loss: 0.029160361737012863
step: 140, task: Textual/Abt-Buy, loss: 0.10155116766691208
step: 150, task: Textual/Abt-Buy, loss: 0.09013521671295166
step: 160, task: Textual/Abt-Buy, loss: 0.13615049421787262
step: 170, task: Textual/Abt-Buy, loss: 0.0649847686290741
step: 180, task: Textual/Abt-Buy, loss: 0.05738275498151779
step: 190, task: Textual/Abt-Buy, loss: 0.12083019316196442
step: 200, task: Textual/Abt-Buy, loss: 0.005561307072639465
step: 210, task: Textual/Abt-Buy, loss: 0.0075211673974990845
step: 220, task: Textual/Abt-Buy, loss: 0.12498930841684341
step: 230, task: Textual/Abt-Buy, loss: 0.12673377990722656
step: 240, task: Textual/Abt-Buy, loss: 0.03732714802026749
step: 250, task: Textual/Abt-Buy, loss: 0.10798311233520508
step: 260, task: Textual/Abt-Buy, loss: 0.17681311070919037
step: 270, task: Textual/Abt-Buy, loss: 0.15169279277324677
step: 280, task: Textual/Abt-Buy, loss: 0.029253512620925903
step: 290, task: Textual/Abt-Buy, loss: 0.3160706162452698
step: 300, task: Textual/Abt-Buy, loss: 0.07653376460075378
step: 310, task: Textual/Abt-Buy, loss: 0.03181465342640877
step: 320, task: Textual/Abt-Buy, loss: 0.10354143381118774
step: 330, task: Textual/Abt-Buy, loss: 0.036160245537757874
step: 340, task: Textual/Abt-Buy, loss: 0.40698546171188354
step: 350, task: Textual/Abt-Buy, loss: 0.13267433643341064
=========eval at epoch=2=========
Validation:
=============Textual/Abt-Buy==================
accuracy=0.897
precision=1.000
recall=0.039
f1=0.075
======================================
Test:
=============Textual/Abt-Buy==================
accuracy=0.898
precision=0.923
recall=0.058
f1=0.110
======================================
=====sanity check======
words: COL name VAL samsung 40 ' series 5 lcd black flat panel hdtv ln40a550 COL description VAL samsung 40 ' series 5 lcd black flat panel hdtv ln40a550 full 1080p high definition resolution 16:9 widescreen aspect ratio 30,000:1 dynamic contrast ratio 5ms response time srs trusurround xt audio built-in digital tuner ( atsc/clear qam ) picture-in-picture sound leveler 3 hdmi slots swivel stand black finish COL price VAL   [SEP] COL name VAL samsung ln46a550 46 ' lcd tv COL description VAL samsung ln46a550 46 ' widescreen 1080p lcd hdtv 30,000:1 dynamic contrast ratio 5ms response time piano black COL price VAL 1143.99 
x: [    0 18047   766 27445   579 48545   843   128   651   195   784 28690
   909  3269  2798  1368   417 18724   784   282  1749   102 17953 14857
  8194 27445   579 48545   843   128   651   195   784 28690   909  3269
  2798  1368   417 18724   784   282  1749   102 17953   455 21083   642
   239  8515  3547   545    35   466   885  4376 37346  6659  1750   389
     6   151    35   134  6878  5709  1750   195  4339  1263    86   579
  4926  2664   687   710  3431  1437 11483  6086  1490    12   179  1778
 27115   254    36    23  3866    73 18763  2231   424  4839  2170    12
   179    12 37587  2369   672   254   155  1368   417  5408 20063  3514
  2088   462  1413   909  2073 14857   425 27445  1437  1437     2     2
 18047   766 27445   579 48545   784   282  3761   102 17953  4059   128
   784 28690 30016 14857  8194 27445   579 48545   784   282  3761   102
 17953  4059   128   885  4376 37346 21083   642   784 28690  1368   417
 18724   389     6   151    35   134  6878  5709  1750   195  4339  1263
    86 13305   909 14857   425 27445   365  3897     4  2831  1437     2]
tokens: ['<s>', 'COL', 'Ġname', 'ĠVAL', 'Ġs', 'amsung', 'Ġ40', "Ġ'", 'Ġseries', 'Ġ5', 'Ġl', 'cd', 'Ġblack', 'Ġflat', 'Ġpanel', 'Ġh', 'd', 'tv', 'Ġl', 'n', '40', 'a', '550', 'ĠCOL', 'Ġdescription', 'ĠVAL', 'Ġs', 'amsung', 'Ġ40', "Ġ'", 'Ġseries', 'Ġ5', 'Ġl', 'cd', 'Ġblack', 'Ġflat', 'Ġpanel', 'Ġh', 'd', 'tv', 'Ġl', 'n', '40', 'a', '550', 'Ġfull', 'Ġ1080', 'p', 'Ġhigh', 'Ġdefinition', 'Ġresolution', 'Ġ16', ':', '9', 'Ġw', 'ides', 'creen', 'Ġaspect', 'Ġratio', 'Ġ30', ',', '000', ':', '1', 'Ġdynamic', 'Ġcontrast', 'Ġratio', 'Ġ5', 'ms', 'Ġresponse', 'Ġtime', 'Ġs', 'rs', 'Ġtr', 'us', 'ur', 'round', 'Ġ', 'xt', 'Ġaudio', 'Ġbuilt', '-', 'in', 'Ġdigital', 'Ġtun', 'er', 'Ġ(', 'Ġat', 'sc', '/', 'clear', 'Ġq', 'am', 'Ġ)', 'Ġpicture', '-', 'in', '-', 'picture', 'Ġsound', 'Ġlevel', 'er', 'Ġ3', 'Ġh', 'd', 'mi', 'Ġslots', 'Ġsw', 'ive', 'l', 'Ġstand', 'Ġblack', 'Ġfinish', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ', 'Ġ', '</s>', '</s>', 'COL', 'Ġname', 'ĠVAL', 'Ġs', 'amsung', 'Ġl', 'n', '46', 'a', '550', 'Ġ46', "Ġ'", 'Ġl', 'cd', 'Ġtv', 'ĠCOL', 'Ġdescription', 'ĠVAL', 'Ġs', 'amsung', 'Ġl', 'n', '46', 'a', '550', 'Ġ46', "Ġ'", 'Ġw', 'ides', 'creen', 'Ġ1080', 'p', 'Ġl', 'cd', 'Ġh', 'd', 'tv', 'Ġ30', ',', '000', ':', '1', 'Ġdynamic', 'Ġcontrast', 'Ġratio', 'Ġ5', 'ms', 'Ġresponse', 'Ġtime', 'Ġpiano', 'Ġblack', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ11', '43', '.', '99', 'Ġ', '</s>']
is_heads: [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
y: 0
tags: 0
mask: tensor([1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1])
seqlen: 180
task_name: Textual/Abt-Buy
=======================
step: 0, task: Textual/Abt-Buy, loss: 0.007396012544631958
step: 10, task: Textual/Abt-Buy, loss: 0.023635268211364746
step: 20, task: Textual/Abt-Buy, loss: 0.3013174831867218
step: 30, task: Textual/Abt-Buy, loss: 0.014730781316757202
step: 40, task: Textual/Abt-Buy, loss: 0.004776261746883392
step: 50, task: Textual/Abt-Buy, loss: 0.0011719465255737305
step: 60, task: Textual/Abt-Buy, loss: 0.27702057361602783
step: 70, task: Textual/Abt-Buy, loss: 0.025688987225294113
step: 80, task: Textual/Abt-Buy, loss: 0.008972927927970886
step: 90, task: Textual/Abt-Buy, loss: 0.010363101959228516
step: 100, task: Textual/Abt-Buy, loss: 0.0030905306339263916
step: 110, task: Textual/Abt-Buy, loss: 0.22826556861400604
step: 120, task: Textual/Abt-Buy, loss: 0.008596144616603851
step: 130, task: Textual/Abt-Buy, loss: 0.1529429405927658
step: 140, task: Textual/Abt-Buy, loss: 0.19714480638504028
step: 150, task: Textual/Abt-Buy, loss: 0.04044098034501076
step: 160, task: Textual/Abt-Buy, loss: 0.000996418297290802
step: 170, task: Textual/Abt-Buy, loss: 0.052619580179452896
step: 180, task: Textual/Abt-Buy, loss: 0.00862109661102295
step: 190, task: Textual/Abt-Buy, loss: 0.0804741308093071
step: 200, task: Textual/Abt-Buy, loss: 0.08279021829366684
step: 210, task: Textual/Abt-Buy, loss: 0.04722968861460686
step: 220, task: Textual/Abt-Buy, loss: 0.00469747930765152
step: 230, task: Textual/Abt-Buy, loss: 0.015452530235052109
step: 240, task: Textual/Abt-Buy, loss: 0.020732954144477844
step: 250, task: Textual/Abt-Buy, loss: 0.2943979501724243
step: 260, task: Textual/Abt-Buy, loss: 0.11246287822723389
step: 270, task: Textual/Abt-Buy, loss: 0.037995897233486176
step: 280, task: Textual/Abt-Buy, loss: 0.22174160182476044
step: 290, task: Textual/Abt-Buy, loss: 0.2036958485841751
step: 300, task: Textual/Abt-Buy, loss: 0.014757134020328522
step: 310, task: Textual/Abt-Buy, loss: 0.0016999393701553345
step: 320, task: Textual/Abt-Buy, loss: 0.026211611926555634
step: 330, task: Textual/Abt-Buy, loss: 0.01706550270318985
step: 340, task: Textual/Abt-Buy, loss: 0.03902650997042656
step: 350, task: Textual/Abt-Buy, loss: 0.027325879782438278
=========eval at epoch=3=========
Validation:
=============Textual/Abt-Buy==================
accuracy=0.908
precision=0.892
recall=0.160
f1=0.272
======================================
Test:
=============Textual/Abt-Buy==================
accuracy=0.911
precision=0.974
recall=0.180
f1=0.303
======================================
=====sanity check======
words: COL name VAL panasonic hands-free headset kxtca86 COL description VAL panasonic hands-free headset kxtca86 comfort fit and fold design noise cancelling microphone standard 2.5 mm connection COL price VAL 14.95  [SEP] COL name VAL panasonic kx-tga670b cordless handset COL description VAL panasonic kx-tga670b additional handset for pankxtg6700b COL price VAL  
x: [    0 18047   766 27445  5730 38703  1420    12  3743 20084   449 11483
  3245  5334 14857  8194 27445  5730 38703  1420    12  3743 20084   449
 11483  3245  5334  5863  2564     8 14789  1521  6496 21338  7633 18896
  2526   132     4   245 15408  2748 14857   425 27445   501     4  4015
  1437     2     2 18047   766 27445  5730 38703   449  1178    12    90
  2538 34148   428 13051  1672 17621 14857  8194 27445  5730 38703   449
  1178    12    90  2538 34148   428   943 17621    13   181  3153 11483
   571  4111   612   428 14857   425 27445  1437  1437     2]
tokens: ['<s>', 'COL', 'Ġname', 'ĠVAL', 'Ġpan', 'asonic', 'Ġhands', '-', 'free', 'Ġheadset', 'Ġk', 'xt', 'ca', '86', 'ĠCOL', 'Ġdescription', 'ĠVAL', 'Ġpan', 'asonic', 'Ġhands', '-', 'free', 'Ġheadset', 'Ġk', 'xt', 'ca', '86', 'Ġcomfort', 'Ġfit', 'Ġand', 'Ġfold', 'Ġdesign', 'Ġnoise', 'Ġcance', 'lling', 'Ġmicrophone', 'Ġstandard', 'Ġ2', '.', '5', 'Ġmm', 'Ġconnection', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ14', '.', '95', 'Ġ', '</s>', '</s>', 'COL', 'Ġname', 'ĠVAL', 'Ġpan', 'asonic', 'Ġk', 'x', '-', 't', 'ga', '670', 'b', 'Ġcord', 'less', 'Ġhandset', 'ĠCOL', 'Ġdescription', 'ĠVAL', 'Ġpan', 'asonic', 'Ġk', 'x', '-', 't', 'ga', '670', 'b', 'Ġadditional', 'Ġhandset', 'Ġfor', 'Ġp', 'ank', 'xt', 'g', '67', '00', 'b', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ', 'Ġ', '</s>']
is_heads: [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
y: 0
tags: 0
mask: tensor([1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1])
seqlen: 94
task_name: Textual/Abt-Buy
=======================
step: 0, task: Textual/Abt-Buy, loss: 0.028974778950214386
step: 10, task: Textual/Abt-Buy, loss: 0.006269194185733795
step: 20, task: Textual/Abt-Buy, loss: 0.0027224570512771606
step: 30, task: Textual/Abt-Buy, loss: 0.07890480756759644
step: 40, task: Textual/Abt-Buy, loss: 0.020258724689483643
step: 50, task: Textual/Abt-Buy, loss: 0.10522278398275375
step: 60, task: Textual/Abt-Buy, loss: 0.013475410640239716
step: 70, task: Textual/Abt-Buy, loss: 0.07265366613864899
step: 80, task: Textual/Abt-Buy, loss: 0.0038879960775375366
step: 90, task: Textual/Abt-Buy, loss: 0.004461854696273804
step: 100, task: Textual/Abt-Buy, loss: 0.1105092316865921
step: 110, task: Textual/Abt-Buy, loss: 0.0027513131499290466
step: 120, task: Textual/Abt-Buy, loss: 0.007646992802619934
step: 130, task: Textual/Abt-Buy, loss: 0.034446246922016144
step: 140, task: Textual/Abt-Buy, loss: 0.001642271876335144
step: 150, task: Textual/Abt-Buy, loss: 0.003259629011154175
step: 160, task: Textual/Abt-Buy, loss: 0.0004149973392486572
step: 170, task: Textual/Abt-Buy, loss: 0.011458642780780792
step: 180, task: Textual/Abt-Buy, loss: 0.018543265759944916
step: 190, task: Textual/Abt-Buy, loss: 0.0073175206780433655
step: 200, task: Textual/Abt-Buy, loss: 0.02126171812415123
step: 210, task: Textual/Abt-Buy, loss: 0.3115907311439514
step: 220, task: Textual/Abt-Buy, loss: 0.15452496707439423
step: 230, task: Textual/Abt-Buy, loss: 0.01947120577096939
step: 240, task: Textual/Abt-Buy, loss: 0.013070322573184967
step: 250, task: Textual/Abt-Buy, loss: 0.00024816393852233887
step: 260, task: Textual/Abt-Buy, loss: 0.006051905453205109
step: 270, task: Textual/Abt-Buy, loss: 0.016968265175819397
step: 280, task: Textual/Abt-Buy, loss: 0.0013336092233657837
step: 290, task: Textual/Abt-Buy, loss: 0.0038626566529273987
step: 300, task: Textual/Abt-Buy, loss: 0.04723508656024933
step: 310, task: Textual/Abt-Buy, loss: 0.006587408483028412
step: 320, task: Textual/Abt-Buy, loss: 0.18310700356960297
step: 330, task: Textual/Abt-Buy, loss: 0.032127637416124344
step: 340, task: Textual/Abt-Buy, loss: 0.07005850970745087
step: 350, task: Textual/Abt-Buy, loss: 0.0019046440720558167
=========eval at epoch=4=========
Validation:
=============Textual/Abt-Buy==================
accuracy=0.911
precision=0.949
recall=0.180
f1=0.302
======================================
Test:
=============Textual/Abt-Buy==================
accuracy=0.909
precision=0.897
recall=0.170
f1=0.286
======================================
=====sanity check======
words: COL name VAL panasonic dect 6.0 2-line digital expandable corded/cordless phone system kxtg9391t COL description VAL panasonic dect 6.0 2-line digital expandable corded/cordless phone system kxtg9391t dect 6.0 digital technology ( 1.9 ghz frequency ) expandable up to 6 total handsets wifi friendly digital answering system 50 number caller id memory 100 number phonebook digital speakerphone on handset and base light-up indicator with ringer alert white backlit 3-line lcd black finish COL price VAL 179.0  [SEP] COL name VAL panasonic kx-tg9344t expandable digital cordless phone COL description VAL 1 x phone line ( s ) COL price VAL 116.21 
x: [    0 18047   766 27445  5730 38703   263  3894   231     4   288   132
    12  1902  1778  3003   868 13051   196    73   438  3109  1672  1028
   467   449 11483   571   466 35848    90 14857  8194 27445  5730 38703
   263  3894   231     4   288   132    12  1902  1778  3003   868 13051
   196    73   438  3109  1672  1028   467   449 11483   571   466 35848
    90   263  3894   231     4   288  1778   806    36   112     4   466
 34648   329 13135  4839  3003   868    62     7   231   746  1420  2580
 42387  5192  1778 15635   467   654   346 17017 13561  3783   727   346
  1028  6298  1778  5385 17283    15 17621     8  1542  1109    12   658
  9189    19   910  6082  5439  1104   124 13534   155    12  1902   784
 28690   909  2073 14857   425 27445 29189     4   288  1437     2     2
 18047   766 27445  5730 38703   449  1178    12 42698  6478  3305    90
  3003   868  1778 13051  1672  1028 14857  8194 27445   112  3023  1028
   516    36   579  4839 14857   425 27445 15966     4  2146  1437     2]
tokens: ['<s>', 'COL', 'Ġname', 'ĠVAL', 'Ġpan', 'asonic', 'Ġde', 'ct', 'Ġ6', '.', '0', 'Ġ2', '-', 'line', 'Ġdigital', 'Ġexpand', 'able', 'Ġcord', 'ed', '/', 'c', 'ord', 'less', 'Ġphone', 'Ġsystem', 'Ġk', 'xt', 'g', '9', '391', 't', 'ĠCOL', 'Ġdescription', 'ĠVAL', 'Ġpan', 'asonic', 'Ġde', 'ct', 'Ġ6', '.', '0', 'Ġ2', '-', 'line', 'Ġdigital', 'Ġexpand', 'able', 'Ġcord', 'ed', '/', 'c', 'ord', 'less', 'Ġphone', 'Ġsystem', 'Ġk', 'xt', 'g', '9', '391', 't', 'Ġde', 'ct', 'Ġ6', '.', '0', 'Ġdigital', 'Ġtechnology', 'Ġ(', 'Ġ1', '.', '9', 'Ġgh', 'z', 'Ġfrequency', 'Ġ)', 'Ġexpand', 'able', 'Ġup', 'Ġto', 'Ġ6', 'Ġtotal', 'Ġhands', 'ets', 'Ġwifi', 'Ġfriendly', 'Ġdigital', 'Ġanswering', 'Ġsystem', 'Ġ50', 'Ġnumber', 'Ġcaller', 'Ġid', 'Ġmemory', 'Ġ100', 'Ġnumber', 'Ġphone', 'book', 'Ġdigital', 'Ġspeaker', 'phone', 'Ġon', 'Ġhandset', 'Ġand', 'Ġbase', 'Ġlight', '-', 'up', 'Ġindicator', 'Ġwith', 'Ġr', 'inger', 'Ġalert', 'Ġwhite', 'Ġback', 'lit', 'Ġ3', '-', 'line', 'Ġl', 'cd', 'Ġblack', 'Ġfinish', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ179', '.', '0', 'Ġ', '</s>', '</s>', 'COL', 'Ġname', 'ĠVAL', 'Ġpan', 'asonic', 'Ġk', 'x', '-', 'tg', '93', '44', 't', 'Ġexpand', 'able', 'Ġdigital', 'Ġcord', 'less', 'Ġphone', 'ĠCOL', 'Ġdescription', 'ĠVAL', 'Ġ1', 'Ġx', 'Ġphone', 'Ġline', 'Ġ(', 'Ġs', 'Ġ)', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ116', '.', '21', 'Ġ', '</s>']
is_heads: [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
y: 0
tags: 0
mask: tensor([1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1])
seqlen: 168
task_name: Textual/Abt-Buy
=======================
step: 0, task: Textual/Abt-Buy, loss: 0.21272863447666168
step: 10, task: Textual/Abt-Buy, loss: 0.05433652549982071
step: 20, task: Textual/Abt-Buy, loss: 0.007451370358467102
step: 30, task: Textual/Abt-Buy, loss: 0.0022975653409957886
step: 40, task: Textual/Abt-Buy, loss: 0.06603723764419556
step: 50, task: Textual/Abt-Buy, loss: 0.17592598497867584
step: 60, task: Textual/Abt-Buy, loss: 0.004817567765712738
step: 70, task: Textual/Abt-Buy, loss: 0.011683482676744461
step: 80, task: Textual/Abt-Buy, loss: 0.005945663899183273
step: 90, task: Textual/Abt-Buy, loss: 0.00783044844865799
step: 100, task: Textual/Abt-Buy, loss: 0.01509084552526474
step: 110, task: Textual/Abt-Buy, loss: 0.18358172476291656
step: 120, task: Textual/Abt-Buy, loss: 0.21887125074863434
step: 130, task: Textual/Abt-Buy, loss: 0.10280530899763107
step: 140, task: Textual/Abt-Buy, loss: 0.0013353526592254639
step: 150, task: Textual/Abt-Buy, loss: 0.12432350963354111
step: 160, task: Textual/Abt-Buy, loss: 0.0006816983222961426
step: 170, task: Textual/Abt-Buy, loss: 0.04802410677075386
step: 180, task: Textual/Abt-Buy, loss: 0.0020637139678001404
step: 190, task: Textual/Abt-Buy, loss: 0.013106923550367355
step: 200, task: Textual/Abt-Buy, loss: 0.0017254576086997986
step: 210, task: Textual/Abt-Buy, loss: 0.00024674832820892334
step: 220, task: Textual/Abt-Buy, loss: 0.1250137835741043
step: 230, task: Textual/Abt-Buy, loss: 0.1461963802576065
step: 240, task: Textual/Abt-Buy, loss: 0.10847434401512146
step: 250, task: Textual/Abt-Buy, loss: 0.026870187371969223
step: 260, task: Textual/Abt-Buy, loss: 0.0017483830451965332
step: 270, task: Textual/Abt-Buy, loss: 0.038041867315769196
step: 280, task: Textual/Abt-Buy, loss: 0.002941511571407318
step: 290, task: Textual/Abt-Buy, loss: 0.007222004234790802
step: 300, task: Textual/Abt-Buy, loss: 0.0011497512459754944
step: 310, task: Textual/Abt-Buy, loss: 0.001677386462688446
step: 320, task: Textual/Abt-Buy, loss: 0.00042034685611724854
step: 330, task: Textual/Abt-Buy, loss: 0.002265743911266327
step: 340, task: Textual/Abt-Buy, loss: 0.0007248669862747192
step: 350, task: Textual/Abt-Buy, loss: 0.001042969524860382
=========eval at epoch=5=========
Validation:
=============Textual/Abt-Buy==================
accuracy=0.904
precision=0.867
recall=0.126
f1=0.220
======================================
Test:
=============Textual/Abt-Buy==================
accuracy=0.903
precision=0.955
recall=0.102
f1=0.184
======================================
=====sanity check======
words: COL name VAL sirius stiletto 2 portable satellite radio sl2pk1 COL description VAL sirius stiletto 2 portable satellite radio sl2pk1 sirius replay controls record up to 100 hours stores up to 10 hours of individual songs 2gb internal memory personalized sports ticker srs trubass and 3d focus technologies wifi black finish COL price VAL   [SEP] COL name VAL audiovox satellite radio tuner COL description VAL terk xmrvrfm002 commandermt universal in-car xm receiver COL price VAL  
x: [    0 18047   766 27445 21958  6125  1690  1848 26187   132 15295  7595
  3188  3369   176   642   330   134 14857  8194 27445 21958  6125  1690
  1848 26187   132 15295  7595  3188  3369   176   642   330   134 21958
  6125 16462  5656   638    62     7   727   722  2326    62     7   158
   722     9  1736  3686   132 19562  3425  3783 17159  1612 10457   254
   579  4926  2664  1792  2401     8   155   417  1056  4233 42387   909
  2073 14857   425 27445  1437  1437     2     2 18047   766 27445  9818
 32822  4325  7595  3188 27115   254 14857  8194 27445  8470   330  3023
 35685 37032 40523 19130  5936  8362    90 10547    11    12  5901  3023
   119  4797 14857   425 27445  1437  1437     2]
tokens: ['<s>', 'COL', 'Ġname', 'ĠVAL', 'Ġsir', 'ius', 'Ġst', 'ile', 'tto', 'Ġ2', 'Ġportable', 'Ġsatellite', 'Ġradio', 'Ġsl', '2', 'p', 'k', '1', 'ĠCOL', 'Ġdescription', 'ĠVAL', 'Ġsir', 'ius', 'Ġst', 'ile', 'tto', 'Ġ2', 'Ġportable', 'Ġsatellite', 'Ġradio', 'Ġsl', '2', 'p', 'k', '1', 'Ġsir', 'ius', 'Ġreplay', 'Ġcontrols', 'Ġrecord', 'Ġup', 'Ġto', 'Ġ100', 'Ġhours', 'Ġstores', 'Ġup', 'Ġto', 'Ġ10', 'Ġhours', 'Ġof', 'Ġindividual', 'Ġsongs', 'Ġ2', 'gb', 'Ġinternal', 'Ġmemory', 'Ġpersonalized', 'Ġsports', 'Ġtick', 'er', 'Ġs', 'rs', 'Ġtr', 'ub', 'ass', 'Ġand', 'Ġ3', 'd', 'Ġfocus', 'Ġtechnologies', 'Ġwifi', 'Ġblack', 'Ġfinish', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ', 'Ġ', '</s>', '</s>', 'COL', 'Ġname', 'ĠVAL', 'Ġaud', 'iov', 'ox', 'Ġsatellite', 'Ġradio', 'Ġtun', 'er', 'ĠCOL', 'Ġdescription', 'ĠVAL', 'Ġter', 'k', 'Ġx', 'mr', 'vr', 'fm', '002', 'Ġcommand', 'erm', 't', 'Ġuniversal', 'Ġin', '-', 'car', 'Ġx', 'm', 'Ġreceiver', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ', 'Ġ', '</s>']
is_heads: [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
y: 0
tags: 0
mask: tensor([1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1])
seqlen: 116
task_name: Textual/Abt-Buy
=======================
step: 0, task: Textual/Abt-Buy, loss: 0.000596657395362854
step: 10, task: Textual/Abt-Buy, loss: 0.0019918903708457947
step: 20, task: Textual/Abt-Buy, loss: 0.0005203932523727417
step: 30, task: Textual/Abt-Buy, loss: 0.0009543895721435547
step: 40, task: Textual/Abt-Buy, loss: 0.17241322994232178
step: 50, task: Textual/Abt-Buy, loss: 0.0007203370332717896
step: 60, task: Textual/Abt-Buy, loss: 0.0018729418516159058
step: 70, task: Textual/Abt-Buy, loss: 0.0006478428840637207
step: 80, task: Textual/Abt-Buy, loss: 0.0003829449415206909
step: 90, task: Textual/Abt-Buy, loss: 0.008486360311508179
step: 100, task: Textual/Abt-Buy, loss: 0.010767407715320587
step: 110, task: Textual/Abt-Buy, loss: 0.0006631165742874146
step: 120, task: Textual/Abt-Buy, loss: 0.009265627712011337
step: 130, task: Textual/Abt-Buy, loss: 0.0003400444984436035
step: 140, task: Textual/Abt-Buy, loss: 0.0006338506937026978
step: 150, task: Textual/Abt-Buy, loss: 0.0004340857267379761
step: 160, task: Textual/Abt-Buy, loss: 0.0003175586462020874
step: 170, task: Textual/Abt-Buy, loss: 0.0002446174621582031
step: 180, task: Textual/Abt-Buy, loss: 0.0004356801509857178
step: 190, task: Textual/Abt-Buy, loss: 8.989870548248291e-05
step: 200, task: Textual/Abt-Buy, loss: 0.016207296401262283
step: 210, task: Textual/Abt-Buy, loss: 0.06734590977430344
step: 220, task: Textual/Abt-Buy, loss: 0.018215946853160858
step: 230, task: Textual/Abt-Buy, loss: 0.0001894831657409668
step: 240, task: Textual/Abt-Buy, loss: 0.0004213303327560425
step: 250, task: Textual/Abt-Buy, loss: 0.0005559325218200684
step: 260, task: Textual/Abt-Buy, loss: 0.00033877789974212646
step: 270, task: Textual/Abt-Buy, loss: 0.05727120488882065
step: 280, task: Textual/Abt-Buy, loss: 0.00036850571632385254
step: 290, task: Textual/Abt-Buy, loss: 0.008376672863960266
step: 300, task: Textual/Abt-Buy, loss: 0.00024987757205963135
step: 310, task: Textual/Abt-Buy, loss: 0.00034599006175994873
step: 320, task: Textual/Abt-Buy, loss: 0.0003912001848220825
step: 330, task: Textual/Abt-Buy, loss: 0.007739409804344177
step: 340, task: Textual/Abt-Buy, loss: 0.06740748882293701
step: 350, task: Textual/Abt-Buy, loss: 0.0003623366355895996
=========eval at epoch=6=========
Validation:
=============Textual/Abt-Buy==================
accuracy=0.911
precision=1.000
recall=0.175
f1=0.298
======================================
Test:
=============Textual/Abt-Buy==================
accuracy=0.907
precision=0.909
recall=0.146
f1=0.251
======================================
=====sanity check======
words: COL name VAL canon deluxe soft black camera case 0716b001 COL description VAL canon deluxe soft black camera case 0716b001 compatible with canon powershot s2 is black finish COL price VAL   [SEP] COL name VAL olympus neoprene soft camera case 202066 COL description VAL top loading neoprene black COL price VAL 11.89 
x: [    0 18047   766 27445 32839  2424 39210  3793   909  2280   403 13470
  1549   428 19089 14857  8194 27445 32839  2424 39210  3793   909  2280
   403 13470  1549   428 19089 16632    19 32839  4361 10120   579   176
    16   909  2073 14857   425 27445  1437  1437     2     2 18047   766
 27445  1021 31434   687  3087  1517 20962  3793  2280   403  2760  4280
 14857  8194 27445   299 16761  3087  1517 20962   909 14857   425 27445
   365     4  5046  1437     2]
tokens: ['<s>', 'COL', 'Ġname', 'ĠVAL', 'Ġcanon', 'Ġdel', 'uxe', 'Ġsoft', 'Ġblack', 'Ġcamera', 'Ġcase', 'Ġ07', '16', 'b', '001', 'ĠCOL', 'Ġdescription', 'ĠVAL', 'Ġcanon', 'Ġdel', 'uxe', 'Ġsoft', 'Ġblack', 'Ġcamera', 'Ġcase', 'Ġ07', '16', 'b', '001', 'Ġcompatible', 'Ġwith', 'Ġcanon', 'Ġpowers', 'hot', 'Ġs', '2', 'Ġis', 'Ġblack', 'Ġfinish', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ', 'Ġ', '</s>', '</s>', 'COL', 'Ġname', 'ĠVAL', 'Ġo', 'lymp', 'us', 'Ġne', 'op', 'rene', 'Ġsoft', 'Ġcamera', 'Ġcase', 'Ġ2020', '66', 'ĠCOL', 'Ġdescription', 'ĠVAL', 'Ġtop', 'Ġloading', 'Ġne', 'op', 'rene', 'Ġblack', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ11', '.', '89', 'Ġ', '</s>']
is_heads: [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
y: 0
tags: 0
mask: tensor([1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1])
seqlen: 77
task_name: Textual/Abt-Buy
=======================
step: 0, task: Textual/Abt-Buy, loss: 0.002699531614780426
step: 10, task: Textual/Abt-Buy, loss: 0.00033739209175109863
step: 20, task: Textual/Abt-Buy, loss: 0.0030200332403182983
step: 30, task: Textual/Abt-Buy, loss: 0.005302019417285919
step: 40, task: Textual/Abt-Buy, loss: 0.0008511990308761597
step: 50, task: Textual/Abt-Buy, loss: 0.00038310885429382324
step: 60, task: Textual/Abt-Buy, loss: 0.578761637210846
step: 70, task: Textual/Abt-Buy, loss: 0.00032024085521698
step: 80, task: Textual/Abt-Buy, loss: 0.00048704445362091064
step: 90, task: Textual/Abt-Buy, loss: 0.0003543645143508911
step: 100, task: Textual/Abt-Buy, loss: 0.012706883251667023
step: 110, task: Textual/Abt-Buy, loss: 0.0003297477960586548
step: 120, task: Textual/Abt-Buy, loss: 0.00032348930835723877
step: 130, task: Textual/Abt-Buy, loss: 0.0002111494541168213
step: 140, task: Textual/Abt-Buy, loss: 0.0010115578770637512
step: 150, task: Textual/Abt-Buy, loss: 0.00030253827571868896
step: 160, task: Textual/Abt-Buy, loss: 0.000298231840133667
step: 170, task: Textual/Abt-Buy, loss: 0.00012350082397460938
step: 180, task: Textual/Abt-Buy, loss: 0.0007119625806808472
step: 190, task: Textual/Abt-Buy, loss: 0.0005153864622116089
step: 200, task: Textual/Abt-Buy, loss: 0.00032736361026763916
step: 210, task: Textual/Abt-Buy, loss: 0.01874234899878502
step: 220, task: Textual/Abt-Buy, loss: 0.0001646578311920166
step: 230, task: Textual/Abt-Buy, loss: 0.0013413280248641968
step: 240, task: Textual/Abt-Buy, loss: 0.0020050927996635437
step: 250, task: Textual/Abt-Buy, loss: 0.0009604394435882568
step: 260, task: Textual/Abt-Buy, loss: 0.027314450591802597
step: 270, task: Textual/Abt-Buy, loss: 0.00023321807384490967
step: 280, task: Textual/Abt-Buy, loss: 0.01123008131980896
step: 290, task: Textual/Abt-Buy, loss: 0.009914368391036987
step: 300, task: Textual/Abt-Buy, loss: 0.0021908581256866455
step: 310, task: Textual/Abt-Buy, loss: 0.009606726467609406
step: 320, task: Textual/Abt-Buy, loss: 0.0003076791763305664
step: 330, task: Textual/Abt-Buy, loss: 0.0775143951177597
step: 340, task: Textual/Abt-Buy, loss: 0.0004953145980834961
step: 350, task: Textual/Abt-Buy, loss: 0.012788355350494385
=========eval at epoch=7=========
Validation:
=============Textual/Abt-Buy==================
accuracy=0.910
precision=0.946
recall=0.170
f1=0.288
======================================
Test:
=============Textual/Abt-Buy==================
accuracy=0.911
precision=0.927
recall=0.184
f1=0.308
======================================
=====sanity check======
words: COL name VAL samsung 50 ' widescreen plasma hdtv pn50a650 COL description VAL samsung 50 ' widescreen plasma hdtv pn50a650 touch of color ultra filterbright anti glare technology 1,000,000:1 dynamic contrast ratio picture-in-picture anti-burn-in technology sports/game/movie modes single integrated user interface with wheel-key remote atsc/ntsc/clear qa tuners COL price VAL   [SEP] COL name VAL th-58pz850u 58 ' plasma tv ( widescreen , 1920x1080 , 30,000:1 , hdtv ) th58pz850u COL description VAL  COL price VAL 2999.97 
x: [    0 18047   766 27445   579 48545   654   128   885  4376 37346 29051
  1368   417 18724   181   282  1096   102 16316 14857  8194 27445   579
 48545   654   128   885  4376 37346 29051  1368   417 18724   181   282
  1096   102 16316  2842     9  3195  9620 14929 23471  1475 37355   806
   112     6   151     6   151    35   134  6878  5709  1750  2170    12
   179    12 37587  1475    12  7554    12   179   806  1612    73  2670
    73 38428 19180   881  6818  3018 12332    19  5964    12  5282  6063
    23  3866    73  3999  3866    73 18763  2231   102 27115   268 14857
   425 27445  1437  1437     2     2 18047   766 27445  3553    12  4432
   642   329 19270   257  4893   128 29051 30016    36   885  4376 37346
  2156 18283  1178 41305  2156   389     6   151    35   134  2156  1368
   417 18724  4839  3553  4432   642   329 19270   257 14857  8194 27445
  1437 14857   425 27445   132 16692     4  6750  1437     2]
tokens: ['<s>', 'COL', 'Ġname', 'ĠVAL', 'Ġs', 'amsung', 'Ġ50', "Ġ'", 'Ġw', 'ides', 'creen', 'Ġplasma', 'Ġh', 'd', 'tv', 'Ġp', 'n', '50', 'a', '650', 'ĠCOL', 'Ġdescription', 'ĠVAL', 'Ġs', 'amsung', 'Ġ50', "Ġ'", 'Ġw', 'ides', 'creen', 'Ġplasma', 'Ġh', 'd', 'tv', 'Ġp', 'n', '50', 'a', '650', 'Ġtouch', 'Ġof', 'Ġcolor', 'Ġultra', 'Ġfilter', 'bright', 'Ġanti', 'Ġglare', 'Ġtechnology', 'Ġ1', ',', '000', ',', '000', ':', '1', 'Ġdynamic', 'Ġcontrast', 'Ġratio', 'Ġpicture', '-', 'in', '-', 'picture', 'Ġanti', '-', 'burn', '-', 'in', 'Ġtechnology', 'Ġsports', '/', 'game', '/', 'movie', 'Ġmodes', 'Ġsingle', 'Ġintegrated', 'Ġuser', 'Ġinterface', 'Ġwith', 'Ġwheel', '-', 'key', 'Ġremote', 'Ġat', 'sc', '/', 'nt', 'sc', '/', 'clear', 'Ġq', 'a', 'Ġtun', 'ers', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ', 'Ġ', '</s>', '</s>', 'COL', 'Ġname', 'ĠVAL', 'Ġth', '-', '58', 'p', 'z', '850', 'u', 'Ġ58', "Ġ'", 'Ġplasma', 'Ġtv', 'Ġ(', 'Ġw', 'ides', 'creen', 'Ġ,', 'Ġ1920', 'x', '1080', 'Ġ,', 'Ġ30', ',', '000', ':', '1', 'Ġ,', 'Ġh', 'd', 'tv', 'Ġ)', 'Ġth', '58', 'p', 'z', '850', 'u', 'ĠCOL', 'Ġdescription', 'ĠVAL', 'Ġ', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ2', '999', '.', '97', 'Ġ', '</s>']
is_heads: [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
y: 0
tags: 0
mask: tensor([1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1])
seqlen: 154
task_name: Textual/Abt-Buy
=======================
step: 0, task: Textual/Abt-Buy, loss: 0.00019291043281555176
step: 10, task: Textual/Abt-Buy, loss: 0.0005585998296737671
step: 20, task: Textual/Abt-Buy, loss: 0.0004932135343551636
step: 30, task: Textual/Abt-Buy, loss: 0.0003124922513961792
step: 40, task: Textual/Abt-Buy, loss: 0.00030744075775146484
step: 50, task: Textual/Abt-Buy, loss: 0.06553290784358978
step: 60, task: Textual/Abt-Buy, loss: 0.0022977739572525024
step: 70, task: Textual/Abt-Buy, loss: 0.0004928708076477051
step: 80, task: Textual/Abt-Buy, loss: 0.11234807223081589
step: 90, task: Textual/Abt-Buy, loss: 0.11231660097837448
step: 100, task: Textual/Abt-Buy, loss: 0.015194565057754517
step: 110, task: Textual/Abt-Buy, loss: 0.0002857893705368042
step: 120, task: Textual/Abt-Buy, loss: 0.00023852288722991943
step: 130, task: Textual/Abt-Buy, loss: 0.00028549134731292725
step: 140, task: Textual/Abt-Buy, loss: 0.0003112107515335083
step: 150, task: Textual/Abt-Buy, loss: 0.007579583674669266
step: 160, task: Textual/Abt-Buy, loss: 0.008159499615430832
step: 170, task: Textual/Abt-Buy, loss: 0.0017572417855262756
step: 180, task: Textual/Abt-Buy, loss: 0.0003218352794647217
step: 190, task: Textual/Abt-Buy, loss: 0.003980230540037155
step: 200, task: Textual/Abt-Buy, loss: 0.0003194063901901245
step: 210, task: Textual/Abt-Buy, loss: 0.0005036741495132446
step: 220, task: Textual/Abt-Buy, loss: 0.0006896853446960449
step: 230, task: Textual/Abt-Buy, loss: 0.006366454064846039
step: 240, task: Textual/Abt-Buy, loss: 0.0004695504903793335
step: 250, task: Textual/Abt-Buy, loss: 0.00012783706188201904
step: 260, task: Textual/Abt-Buy, loss: 0.002749502658843994
step: 270, task: Textual/Abt-Buy, loss: 0.0006615221500396729
step: 280, task: Textual/Abt-Buy, loss: 0.005635671317577362
step: 290, task: Textual/Abt-Buy, loss: 0.00039121508598327637
step: 300, task: Textual/Abt-Buy, loss: 0.014386460185050964
step: 310, task: Textual/Abt-Buy, loss: 0.04319469630718231
step: 320, task: Textual/Abt-Buy, loss: 0.21229934692382812
step: 330, task: Textual/Abt-Buy, loss: 0.001328498125076294
step: 340, task: Textual/Abt-Buy, loss: 0.007022015750408173
step: 350, task: Textual/Abt-Buy, loss: 0.0015583708882331848
=========eval at epoch=8=========
Validation:
=============Textual/Abt-Buy==================
accuracy=0.910
precision=0.902
recall=0.180
f1=0.300
======================================
Test:
=============Textual/Abt-Buy==================
accuracy=0.911
precision=0.927
recall=0.184
f1=0.308
======================================
Selected optimization level O2:  FP16 training with FP32 batchnorm and FP32 master weights.

Defaults for this optimization level are:
enabled                : True
opt_level              : O2
cast_model_type        : torch.float16
patch_torch_functions  : False
keep_batchnorm_fp32    : True
master_weights         : True
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O2
cast_model_type        : torch.float16
patch_torch_functions  : False
keep_batchnorm_fp32    : True
master_weights         : True
loss_scale             : dynamic
Warning:  multi_tensor_applier fused unscale kernel is unavailable, possibly because apex was installed without --cuda_ext --cpp_ext. Using Python fallback.  Original ImportError was: ModuleNotFoundError("No module named 'amp_C'")
Gradient overflow.  Skipping step, loss scaler 0 reducing loss scale to 32768.0
=====sanity check======
words: COL name VAL panasonic viera 42 ' plasma flat panel 1080p hdtv in black th42pz80u COL description VAL panasonic viera 42 ' plasma flat panel 1080p hdtv in black th42pz80u 1080p display 1920 x 1080 native resolution color purity optimizer surround sound anti-reflective filter viera link hdavi control built-in ntsc/atsc/qam tuners 3 hdmi inputs built-in galleryplayer capable sd card memory slot pedestal stand included black finish COL price VAL   [SEP] COL name VAL panasonic th-42pz80u 42 ' widescreen 1080p plasma hdtv 1,000,000:1 dynamic contrast ratio COL description VAL  COL price VAL 845.48 
x: [    0 18047   766 27445  5730 38703   748 16432  3330   128 29051  3269
  2798 21083   642  1368   417 18724    11   909  3553  3714   642   329
  2940   257 14857  8194 27445  5730 38703   748 16432  3330   128 29051
  3269  2798 21083   642  1368   417 18724    11   909  3553  3714   642
   329  2940   257 21083   642  2332 18283  3023 21083  3763  3547  3195
 32195 17775  6315 21104  2369  1475    12 39878  2088 14929   748 16432
  3104  1368   417 11132   797  1490    12   179   295  1872   438    73
  2923   438    73  1343   424 27115   268   155  1368   417  5408 16584
  1490    12   179  7294 23233  4453 46409  1886  3783  8534 38238   337
  1413  1165   909  2073 14857   425 27445  1437  1437     2     2 18047
   766 27445  5730 38703  3553    12  3714   642   329  2940   257  3330
   128   885  4376 37346 21083   642 29051  1368   417 18724   112     6
   151     6   151    35   134  6878  5709  1750 14857  8194 27445  1437
 14857   425 27445   290  1898     4  3818  1437     2]
tokens: ['<s>', 'COL', 'Ġname', 'ĠVAL', 'Ġpan', 'asonic', 'Ġv', 'iera', 'Ġ42', "Ġ'", 'Ġplasma', 'Ġflat', 'Ġpanel', 'Ġ1080', 'p', 'Ġh', 'd', 'tv', 'Ġin', 'Ġblack', 'Ġth', '42', 'p', 'z', '80', 'u', 'ĠCOL', 'Ġdescription', 'ĠVAL', 'Ġpan', 'asonic', 'Ġv', 'iera', 'Ġ42', "Ġ'", 'Ġplasma', 'Ġflat', 'Ġpanel', 'Ġ1080', 'p', 'Ġh', 'd', 'tv', 'Ġin', 'Ġblack', 'Ġth', '42', 'p', 'z', '80', 'u', 'Ġ1080', 'p', 'Ġdisplay', 'Ġ1920', 'Ġx', 'Ġ1080', 'Ġnative', 'Ġresolution', 'Ġcolor', 'Ġpurity', 'Ġoptim', 'izer', 'Ġsurround', 'Ġsound', 'Ġanti', '-', 'reflect', 'ive', 'Ġfilter', 'Ġv', 'iera', 'Ġlink', 'Ġh', 'd', 'avi', 'Ġcontrol', 'Ġbuilt', '-', 'in', 'Ġn', 'ts', 'c', '/', 'ats', 'c', '/', 'q', 'am', 'Ġtun', 'ers', 'Ġ3', 'Ġh', 'd', 'mi', 'Ġinputs', 'Ġbuilt', '-', 'in', 'Ġgallery', 'player', 'Ġcapable', 'Ġsd', 'Ġcard', 'Ġmemory', 'Ġslot', 'Ġpedest', 'al', 'Ġstand', 'Ġincluded', 'Ġblack', 'Ġfinish', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ', 'Ġ', '</s>', '</s>', 'COL', 'Ġname', 'ĠVAL', 'Ġpan', 'asonic', 'Ġth', '-', '42', 'p', 'z', '80', 'u', 'Ġ42', "Ġ'", 'Ġw', 'ides', 'creen', 'Ġ1080', 'p', 'Ġplasma', 'Ġh', 'd', 'tv', 'Ġ1', ',', '000', ',', '000', ':', '1', 'Ġdynamic', 'Ġcontrast', 'Ġratio', 'ĠCOL', 'Ġdescription', 'ĠVAL', 'Ġ', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ8', '45', '.', '48', 'Ġ', '</s>']
is_heads: [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
y: 1
tags: 1
mask: tensor([1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1])
seqlen: 165
task_name: Textual/Abt-Buy
=======================
step: 0, task: Textual/Abt-Buy, loss: 0.7193459868431091
Gradient overflow.  Skipping step, loss scaler 0 reducing loss scale to 16384.0
Gradient overflow.  Skipping step, loss scaler 0 reducing loss scale to 8192.0
step: 10, task: Textual/Abt-Buy, loss: 0.7084718942642212
step: 20, task: Textual/Abt-Buy, loss: 0.6325764060020447
step: 30, task: Textual/Abt-Buy, loss: 0.50652015209198
step: 40, task: Textual/Abt-Buy, loss: 0.23001649975776672
step: 50, task: Textual/Abt-Buy, loss: 0.5956702828407288
step: 60, task: Textual/Abt-Buy, loss: 0.4323863089084625
step: 70, task: Textual/Abt-Buy, loss: 0.41466623544692993
step: 80, task: Textual/Abt-Buy, loss: 0.5017589330673218
step: 90, task: Textual/Abt-Buy, loss: 0.22368475794792175
step: 100, task: Textual/Abt-Buy, loss: 0.09414586424827576
step: 110, task: Textual/Abt-Buy, loss: 0.538314700126648
step: 120, task: Textual/Abt-Buy, loss: 0.5039098262786865
step: 130, task: Textual/Abt-Buy, loss: 0.2134905755519867
step: 140, task: Textual/Abt-Buy, loss: 0.40352851152420044
step: 150, task: Textual/Abt-Buy, loss: 0.1666075587272644
step: 160, task: Textual/Abt-Buy, loss: 0.36638063192367554
step: 170, task: Textual/Abt-Buy, loss: 0.3704148828983307
step: 180, task: Textual/Abt-Buy, loss: 0.38251715898513794
step: 190, task: Textual/Abt-Buy, loss: 0.27213698625564575
step: 200, task: Textual/Abt-Buy, loss: 0.3325486183166504
step: 210, task: Textual/Abt-Buy, loss: 0.718419075012207
step: 220, task: Textual/Abt-Buy, loss: 0.5561835765838623
step: 230, task: Textual/Abt-Buy, loss: 0.253170371055603
step: 240, task: Textual/Abt-Buy, loss: 0.02544838935136795
step: 250, task: Textual/Abt-Buy, loss: 0.3558676242828369
step: 260, task: Textual/Abt-Buy, loss: 0.4197295606136322
step: 270, task: Textual/Abt-Buy, loss: 0.49633413553237915
step: 280, task: Textual/Abt-Buy, loss: 0.2247554510831833
step: 290, task: Textual/Abt-Buy, loss: 0.2292158007621765
step: 300, task: Textual/Abt-Buy, loss: 0.38432157039642334
step: 310, task: Textual/Abt-Buy, loss: 0.5439815521240234
step: 320, task: Textual/Abt-Buy, loss: 0.1582786738872528
step: 330, task: Textual/Abt-Buy, loss: 0.4460020959377289
step: 340, task: Textual/Abt-Buy, loss: 0.1321074366569519
step: 350, task: Textual/Abt-Buy, loss: 0.31369826197624207
=========eval at epoch=1=========
Validation:
=============Textual/Abt-Buy==================
accuracy=0.892
precision=0.000
recall=0.000
f1=0.000
======================================
Test:
=============Textual/Abt-Buy==================
accuracy=0.892
precision=0.000
recall=0.000
f1=0.000
======================================
/w/246/tianyu2020/miniconda2/envs/ditto/lib/python3.7/site-packages/apex/amp/_initialize.py:24: UserWarning: An input tensor was not cuda.
  warnings.warn("An input tensor was not cuda.")
/w/246/tianyu2020/miniconda2/envs/ditto/lib/python3.7/site-packages/torch/optim/lr_scheduler.py:122: UserWarning: Detected call of `lr_scheduler.step()` before `optimizer.step()`. In PyTorch 1.1.0 and later, you should call them in the opposite order: `optimizer.step()` before `lr_scheduler.step()`.  Failure to do this will result in PyTorch skipping the first value of the learning rate schedule. See more details at https://pytorch.org/docs/stable/optim.html#how-to-adjust-learning-rate
  "https://pytorch.org/docs/stable/optim.html#how-to-adjust-learning-rate", UserWarning)
/w/246/tianyu2020/miniconda2/envs/ditto/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1221: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
=====sanity check======
words: COL name VAL sony dvp-fx820 red 8 ' portable dvd player dvpfx820r COL description VAL sony dvp-fx820 red 8 ' portable dvd player dvpfx820r swivel & flip screen with dual sensor for remote control control buttons on screen bezel 12 bit video dac with 108 mhz processing removable , rechargeable battery & car adapter included red finish COL price VAL   [SEP] COL name VAL sony dvp-fx820 portable dvd player dvpfx820 COL description VAL 8 ' lcd dvd + rw , dvd-rw , dvd + r , dvd-r , cd-rw dvd video , cd-da , mp3 , jpeg playback 1 disc ( s ) black COL price VAL 158.72 
x: [    0 18047   766 27445   579  6119   385 45883    12 44830 34212  1275
   290   128 15295   385 40311   869   385 45883 44830 34212   338 14857
  8194 27445   579  6119   385 45883    12 44830 34212  1275   290   128
 15295   385 40311   869   385 45883 44830 34212   338  3514  2088   462
   359 11113  2441    19  6594  9626    13  6063   797   797 14893    15
  2441    28 10101   316   828   569   385  1043    19 13955   475 39569
  5774 37680  2156 25850   868  3822   359   512 36007  1165  1275  2073
 14857   425 27445  1437  1437     2     2 18047   766 27445   579  6119
   385 45883    12 44830 34212 15295   385 40311   869   385 45883 44830
 34212 14857  8194 27445   290   128   784 28690   385 40311  2055   910
   605  2156   385 40311    12 43926  2156   385 40311  2055   910  2156
   385 40311    12   338  2156 45584    12 43926   385 40311   569  2156
 45584    12  6106  2156 44857   246  2156  1236 41191 20083   112  9553
    36   579  4839   909 14857   425 27445 26498     4  4956  1437     2]
tokens: ['<s>', 'COL', 'Ġname', 'ĠVAL', 'Ġs', 'ony', 'Ġd', 'vp', '-', 'fx', '820', 'Ġred', 'Ġ8', "Ġ'", 'Ġportable', 'Ġd', 'vd', 'Ġplayer', 'Ġd', 'vp', 'fx', '820', 'r', 'ĠCOL', 'Ġdescription', 'ĠVAL', 'Ġs', 'ony', 'Ġd', 'vp', '-', 'fx', '820', 'Ġred', 'Ġ8', "Ġ'", 'Ġportable', 'Ġd', 'vd', 'Ġplayer', 'Ġd', 'vp', 'fx', '820', 'r', 'Ġsw', 'ive', 'l', 'Ġ&', 'Ġflip', 'Ġscreen', 'Ġwith', 'Ġdual', 'Ġsensor', 'Ġfor', 'Ġremote', 'Ġcontrol', 'Ġcontrol', 'Ġbuttons', 'Ġon', 'Ġscreen', 'Ġbe', 'zel', 'Ġ12', 'Ġbit', 'Ġvideo', 'Ġd', 'ac', 'Ġwith', 'Ġ108', 'Ġm', 'hz', 'Ġprocessing', 'Ġremovable', 'Ġ,', 'Ġrecharge', 'able', 'Ġbattery', 'Ġ&', 'Ġcar', 'Ġadapter', 'Ġincluded', 'Ġred', 'Ġfinish', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ', 'Ġ', '</s>', '</s>', 'COL', 'Ġname', 'ĠVAL', 'Ġs', 'ony', 'Ġd', 'vp', '-', 'fx', '820', 'Ġportable', 'Ġd', 'vd', 'Ġplayer', 'Ġd', 'vp', 'fx', '820', 'ĠCOL', 'Ġdescription', 'ĠVAL', 'Ġ8', "Ġ'", 'Ġl', 'cd', 'Ġd', 'vd', 'Ġ+', 'Ġr', 'w', 'Ġ,', 'Ġd', 'vd', '-', 'rw', 'Ġ,', 'Ġd', 'vd', 'Ġ+', 'Ġr', 'Ġ,', 'Ġd', 'vd', '-', 'r', 'Ġ,', 'Ġcd', '-', 'rw', 'Ġd', 'vd', 'Ġvideo', 'Ġ,', 'Ġcd', '-', 'da', 'Ġ,', 'Ġmp', '3', 'Ġ,', 'Ġj', 'peg', 'Ġplayback', 'Ġ1', 'Ġdisc', 'Ġ(', 'Ġs', 'Ġ)', 'Ġblack', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ158', '.', '72', 'Ġ', '</s>']
is_heads: [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
y: 0
tags: 0
mask: tensor([1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1])
seqlen: 168
task_name: Textual/Abt-Buy
=======================
step: 0, task: Textual/Abt-Buy, loss: 0.5111926794052124
step: 10, task: Textual/Abt-Buy, loss: 0.11797215044498444
step: 20, task: Textual/Abt-Buy, loss: 0.39643964171409607
step: 30, task: Textual/Abt-Buy, loss: 0.228296160697937
step: 40, task: Textual/Abt-Buy, loss: 0.15866726636886597
step: 50, task: Textual/Abt-Buy, loss: 0.2000705450773239
step: 60, task: Textual/Abt-Buy, loss: 0.4123895764350891
step: 70, task: Textual/Abt-Buy, loss: 0.014448724687099457
step: 80, task: Textual/Abt-Buy, loss: 0.4808889627456665
step: 90, task: Textual/Abt-Buy, loss: 0.1533348262310028
step: 100, task: Textual/Abt-Buy, loss: 0.09283246099948883
step: 110, task: Textual/Abt-Buy, loss: 0.022007018327713013
step: 120, task: Textual/Abt-Buy, loss: 0.3600461184978485
step: 130, task: Textual/Abt-Buy, loss: 0.26274582743644714
step: 140, task: Textual/Abt-Buy, loss: 0.14157049357891083
step: 150, task: Textual/Abt-Buy, loss: 0.20955662429332733
step: 160, task: Textual/Abt-Buy, loss: 0.16907906532287598
step: 170, task: Textual/Abt-Buy, loss: 0.04951497167348862
step: 180, task: Textual/Abt-Buy, loss: 0.22886313498020172
step: 190, task: Textual/Abt-Buy, loss: 0.05109558254480362
step: 200, task: Textual/Abt-Buy, loss: 0.2700646221637726
step: 210, task: Textual/Abt-Buy, loss: 0.001549839973449707
step: 220, task: Textual/Abt-Buy, loss: 0.09950676560401917
step: 230, task: Textual/Abt-Buy, loss: 0.16934257745742798
step: 240, task: Textual/Abt-Buy, loss: 0.010326504707336426
step: 250, task: Textual/Abt-Buy, loss: 0.06524555385112762
step: 260, task: Textual/Abt-Buy, loss: 0.0020669549703598022
step: 270, task: Textual/Abt-Buy, loss: 0.0544702410697937
step: 280, task: Textual/Abt-Buy, loss: 0.05213138088583946
step: 290, task: Textual/Abt-Buy, loss: 0.009322643280029297
step: 300, task: Textual/Abt-Buy, loss: 0.010663680732250214
step: 310, task: Textual/Abt-Buy, loss: 0.08634867519140244
step: 320, task: Textual/Abt-Buy, loss: 0.021365948021411896
step: 330, task: Textual/Abt-Buy, loss: 0.058359161019325256
step: 340, task: Textual/Abt-Buy, loss: 0.12791435420513153
step: 350, task: Textual/Abt-Buy, loss: 0.048784296959638596
=========eval at epoch=1=========
Validation:
=============Textual/Abt-Buy==================
accuracy=0.909
precision=0.705
recall=0.267
f1=0.387
======================================
Test:
=============Textual/Abt-Buy==================
accuracy=0.901
precision=0.631
recall=0.199
f1=0.303
======================================
=====sanity check======
words: COL name VAL sony white 8 ' portable dvd player dvpfx820w COL description VAL sony dvp-fx820 white 8 ' portable dvd player dvpfx820w swivel & flip screen with dual sensor for remote control control buttons on screen bezel 12 bit video dac with 108 mhz processing removable , rechargeable battery & car adapter included white finish COL price VAL   [SEP] COL name VAL toshiba lithium ion portable dvd player battery medb05lx COL description VAL lithium ion ( li-ion ) 7.4 v dc portable dvd player battery COL price VAL 149.99 
x: [    0 18047   766 27445   579  6119  1104   290   128 15295   385 40311
   869   385 45883 44830 34212   605 14857  8194 27445   579  6119   385
 45883    12 44830 34212  1104   290   128 15295   385 40311   869   385
 45883 44830 34212   605  3514  2088   462   359 11113  2441    19  6594
  9626    13  6063   797   797 14893    15  2441    28 10101   316   828
   569   385  1043    19 13955   475 39569  5774 37680  2156 25850   868
  3822   359   512 36007  1165  1104  2073 14857   425 27445  1437  1437
     2     2 18047   766 27445     7  1193 15577 16904 31973 15295   385
 40311   869  3822  5679   428  2546   462  1178 14857  8194 27445 16904
 31973    36 16787    12  1499  4839   262     4   306   748 46773 15295
   385 40311   869  3822 14857   425 27445 24621     4  2831  1437     2]
tokens: ['<s>', 'COL', 'Ġname', 'ĠVAL', 'Ġs', 'ony', 'Ġwhite', 'Ġ8', "Ġ'", 'Ġportable', 'Ġd', 'vd', 'Ġplayer', 'Ġd', 'vp', 'fx', '820', 'w', 'ĠCOL', 'Ġdescription', 'ĠVAL', 'Ġs', 'ony', 'Ġd', 'vp', '-', 'fx', '820', 'Ġwhite', 'Ġ8', "Ġ'", 'Ġportable', 'Ġd', 'vd', 'Ġplayer', 'Ġd', 'vp', 'fx', '820', 'w', 'Ġsw', 'ive', 'l', 'Ġ&', 'Ġflip', 'Ġscreen', 'Ġwith', 'Ġdual', 'Ġsensor', 'Ġfor', 'Ġremote', 'Ġcontrol', 'Ġcontrol', 'Ġbuttons', 'Ġon', 'Ġscreen', 'Ġbe', 'zel', 'Ġ12', 'Ġbit', 'Ġvideo', 'Ġd', 'ac', 'Ġwith', 'Ġ108', 'Ġm', 'hz', 'Ġprocessing', 'Ġremovable', 'Ġ,', 'Ġrecharge', 'able', 'Ġbattery', 'Ġ&', 'Ġcar', 'Ġadapter', 'Ġincluded', 'Ġwhite', 'Ġfinish', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ', 'Ġ', '</s>', '</s>', 'COL', 'Ġname', 'ĠVAL', 'Ġto', 'sh', 'iba', 'Ġlithium', 'Ġion', 'Ġportable', 'Ġd', 'vd', 'Ġplayer', 'Ġbattery', 'Ġmed', 'b', '05', 'l', 'x', 'ĠCOL', 'Ġdescription', 'ĠVAL', 'Ġlithium', 'Ġion', 'Ġ(', 'Ġli', '-', 'ion', 'Ġ)', 'Ġ7', '.', '4', 'Ġv', 'Ġdc', 'Ġportable', 'Ġd', 'vd', 'Ġplayer', 'Ġbattery', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ149', '.', '99', 'Ġ', '</s>']
is_heads: [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
y: 0
tags: 0
mask: tensor([1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1])
seqlen: 132
task_name: Textual/Abt-Buy
=======================
step: 0, task: Textual/Abt-Buy, loss: 0.020624250173568726
step: 10, task: Textual/Abt-Buy, loss: 0.0052260905504226685
step: 20, task: Textual/Abt-Buy, loss: 0.05062904953956604
step: 30, task: Textual/Abt-Buy, loss: 0.4805678427219391
step: 40, task: Textual/Abt-Buy, loss: 0.07373268157243729
step: 50, task: Textual/Abt-Buy, loss: 0.06139568239450455
step: 60, task: Textual/Abt-Buy, loss: 0.5278350114822388
step: 70, task: Textual/Abt-Buy, loss: 0.012545913457870483
step: 80, task: Textual/Abt-Buy, loss: 0.012154117226600647
step: 90, task: Textual/Abt-Buy, loss: 0.06071896106004715
step: 100, task: Textual/Abt-Buy, loss: 0.3561209738254547
step: 110, task: Textual/Abt-Buy, loss: 0.0038526803255081177
step: 120, task: Textual/Abt-Buy, loss: 0.0016710758209228516
step: 130, task: Textual/Abt-Buy, loss: 0.1478201001882553
step: 140, task: Textual/Abt-Buy, loss: 0.05524405837059021
step: 150, task: Textual/Abt-Buy, loss: 0.018087491393089294
step: 160, task: Textual/Abt-Buy, loss: 0.11954926699399948
step: 170, task: Textual/Abt-Buy, loss: 0.0024564117193222046
step: 180, task: Textual/Abt-Buy, loss: 0.08480297029018402
step: 190, task: Textual/Abt-Buy, loss: 0.1304963082075119
step: 200, task: Textual/Abt-Buy, loss: 0.02603927254676819
step: 210, task: Textual/Abt-Buy, loss: 0.2821783423423767
step: 220, task: Textual/Abt-Buy, loss: 0.020919091999530792
step: 230, task: Textual/Abt-Buy, loss: 0.0019285231828689575
step: 240, task: Textual/Abt-Buy, loss: 0.27469602227211
step: 250, task: Textual/Abt-Buy, loss: 0.001628980040550232
step: 260, task: Textual/Abt-Buy, loss: 0.027708232402801514
step: 270, task: Textual/Abt-Buy, loss: 0.014441460371017456
step: 280, task: Textual/Abt-Buy, loss: 0.05043655261397362
step: 290, task: Textual/Abt-Buy, loss: 0.16216091811656952
step: 300, task: Textual/Abt-Buy, loss: 0.026849918067455292
step: 310, task: Textual/Abt-Buy, loss: 0.004019990563392639
step: 320, task: Textual/Abt-Buy, loss: 0.3263191282749176
step: 330, task: Textual/Abt-Buy, loss: 0.01137746125459671
step: 340, task: Textual/Abt-Buy, loss: 0.045010775327682495
step: 350, task: Textual/Abt-Buy, loss: 0.004712559282779694
=========eval at epoch=2=========
Validation:
=============Textual/Abt-Buy==================
accuracy=0.907
precision=0.818
recall=0.175
f1=0.288
======================================
Test:
=============Textual/Abt-Buy==================
accuracy=0.911
precision=0.846
recall=0.214
f1=0.341
======================================
=====sanity check======
words: COL name VAL sony silver cyber-shot digital camera dscs750 COL description VAL sony silver cyber-shot digital camera dscs750 7.2 megapixel super had ccd 2.5 ' lcd display 3x optical zoom high sensitivity mode auto focus 22 mb internal memory face detection burst mode convenient photo modes beginner-friendly function guide silver finish COL price VAL   [SEP] COL name VAL sony lcs-twa/b cyber-shot camera case lcstwa/b COL description VAL top loading leather black COL price VAL 34.0 
x: [    0 18047   766 27445   579  6119  4334  5381    12 10393  1778  2280
   385  3866    29 10569 14857  8194 27445   579  6119  4334  5381    12
 10393  1778  2280   385  3866    29 10569   262     4   176 10721 21424
  2422    56   740 28690   132     4   245   128   784 28690  2332   155
  1178 17547 21762   239 15608  5745  4485  1056   820   475   428  3425
  3783   652 12673 10084  5745 12148  1345 19180 37239    12  6928  5043
  4704  4334  2073 14857   425 27445  1437  1437     2     2 18047   766
 27445   579  6119   784 11365    12 17137   102    73   428  5381    12
 10393  2280   403   784   438   620  2739    73   428 14857  8194 27445
   299 16761  9219   909 14857   425 27445  2631     4   288  1437     2]
tokens: ['<s>', 'COL', 'Ġname', 'ĠVAL', 'Ġs', 'ony', 'Ġsilver', 'Ġcyber', '-', 'shot', 'Ġdigital', 'Ġcamera', 'Ġd', 'sc', 's', '750', 'ĠCOL', 'Ġdescription', 'ĠVAL', 'Ġs', 'ony', 'Ġsilver', 'Ġcyber', '-', 'shot', 'Ġdigital', 'Ġcamera', 'Ġd', 'sc', 's', '750', 'Ġ7', '.', '2', 'Ġmeg', 'apixel', 'Ġsuper', 'Ġhad', 'Ġc', 'cd', 'Ġ2', '.', '5', "Ġ'", 'Ġl', 'cd', 'Ġdisplay', 'Ġ3', 'x', 'Ġoptical', 'Ġzoom', 'Ġhigh', 'Ġsensitivity', 'Ġmode', 'Ġauto', 'Ġfocus', 'Ġ22', 'Ġm', 'b', 'Ġinternal', 'Ġmemory', 'Ġface', 'Ġdetection', 'Ġburst', 'Ġmode', 'Ġconvenient', 'Ġphoto', 'Ġmodes', 'Ġbeginner', '-', 'friendly', 'Ġfunction', 'Ġguide', 'Ġsilver', 'Ġfinish', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ', 'Ġ', '</s>', '</s>', 'COL', 'Ġname', 'ĠVAL', 'Ġs', 'ony', 'Ġl', 'cs', '-', 'tw', 'a', '/', 'b', 'Ġcyber', '-', 'shot', 'Ġcamera', 'Ġcase', 'Ġl', 'c', 'st', 'wa', '/', 'b', 'ĠCOL', 'Ġdescription', 'ĠVAL', 'Ġtop', 'Ġloading', 'Ġleather', 'Ġblack', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ34', '.', '0', 'Ġ', '</s>']
is_heads: [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
y: 0
tags: 0
mask: tensor([1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1])
seqlen: 120
task_name: Textual/Abt-Buy
=======================
step: 0, task: Textual/Abt-Buy, loss: 0.02315523475408554
step: 10, task: Textual/Abt-Buy, loss: 0.025172419846057892
step: 20, task: Textual/Abt-Buy, loss: 0.060461923480033875
step: 30, task: Textual/Abt-Buy, loss: 0.003819413483142853
step: 40, task: Textual/Abt-Buy, loss: 0.09973692148923874
step: 50, task: Textual/Abt-Buy, loss: 0.005573995411396027
step: 60, task: Textual/Abt-Buy, loss: 0.005445346236228943
step: 70, task: Textual/Abt-Buy, loss: 0.056816767901182175
step: 80, task: Textual/Abt-Buy, loss: 0.0037528127431869507
step: 90, task: Textual/Abt-Buy, loss: 0.005137152969837189
step: 100, task: Textual/Abt-Buy, loss: 0.0032431036233901978
step: 110, task: Textual/Abt-Buy, loss: 0.002597302198410034
step: 120, task: Textual/Abt-Buy, loss: 0.45931923389434814
step: 130, task: Textual/Abt-Buy, loss: 0.008452147245407104
step: 140, task: Textual/Abt-Buy, loss: 0.04174987971782684
step: 150, task: Textual/Abt-Buy, loss: 0.04434823989868164
step: 160, task: Textual/Abt-Buy, loss: 0.14389631152153015
step: 170, task: Textual/Abt-Buy, loss: 0.045010849833488464
step: 180, task: Textual/Abt-Buy, loss: 0.0008564740419387817
step: 190, task: Textual/Abt-Buy, loss: 0.01821448653936386
step: 200, task: Textual/Abt-Buy, loss: 0.03675577789545059
step: 210, task: Textual/Abt-Buy, loss: 0.006994292140007019
step: 220, task: Textual/Abt-Buy, loss: 0.005045562982559204
step: 230, task: Textual/Abt-Buy, loss: 0.11638282984495163
step: 240, task: Textual/Abt-Buy, loss: 0.0011588037014007568
step: 250, task: Textual/Abt-Buy, loss: 0.003940477967262268
step: 260, task: Textual/Abt-Buy, loss: 0.01010623574256897
step: 270, task: Textual/Abt-Buy, loss: 0.0032115429639816284
step: 280, task: Textual/Abt-Buy, loss: 0.0040938109159469604
step: 290, task: Textual/Abt-Buy, loss: 0.003736823797225952
step: 300, task: Textual/Abt-Buy, loss: 0.05590836703777313
step: 310, task: Textual/Abt-Buy, loss: 0.004107438027858734
step: 320, task: Textual/Abt-Buy, loss: 0.03755747899413109
step: 330, task: Textual/Abt-Buy, loss: 0.0012217015027999878
step: 340, task: Textual/Abt-Buy, loss: 0.004483722150325775
step: 350, task: Textual/Abt-Buy, loss: 0.0025907903909683228
=========eval at epoch=3=========
Validation:
=============Textual/Abt-Buy==================
accuracy=0.913
precision=0.868
recall=0.223
f1=0.355
======================================
Test:
=============Textual/Abt-Buy==================
accuracy=0.920
precision=0.884
recall=0.296
f1=0.444
======================================
=====sanity check======
words: COL name VAL canon eos rebel xs black digital slr camera xsreb1855b COL description VAL canon eos rebel xs black digital slr camera xsreb1855b 10.1 megapixel cmos sensor digic iii image processor auto lighting optimizer 7-point af with center cross-type sensors 3.0 fps continuous shooting 2.5 ' tft lcd monitor eos integrated cleaning system dust delete data detection black finish COL price VAL   [SEP] COL name VAL canon eos rebel xsi digital slr camera with ef-s 18-55mm f/3 .5 -5.6 is lens silver 2757b003 COL description VAL canon eos rebel xsi 12 megapixel digital slr camera with 18-55mm is lens silver COL price VAL 649.88 
x: [    0 18047   766 27445 32839   364   366  8829  3023    29   909  1778
  3369   338  2280  3023    29 16552  1366  3118   428 14857  8194 27445
 32839   364   366  8829  3023    29   909  1778  3369   338  2280  3023
    29 16552  1366  3118   428   158     4   134 10721 21424 25434   366
  9626  8512   636 46814  2274 10655  4485  7526 17775  6315   262    12
  2300  9724    19  1312  2116    12 12528 10075   155     4   288 43690
 11152  1094   132     4   245   128   326  2543   784 28690  5271   364
   366  6818  8143   467  8402 17462   414 12673   909  2073 14857   425
 27445  1437  1437     2     2 18047   766 27445 32839   364   366  8829
  3023 11000  1778  3369   338  2280    19   364   506    12    29   504
    12  3118  5471   856    73   246   479   245   111   245     4   401
    16 10373  4334 25949   406   428 33490 14857  8194 27445 32839   364
   366  8829  3023 11000   316 10721 21424  1778  3369   338  2280    19
   504    12  3118  5471    16 10373  4334 14857   425 27445   231  3414
     4  4652  1437     2]
tokens: ['<s>', 'COL', 'Ġname', 'ĠVAL', 'Ġcanon', 'Ġe', 'os', 'Ġrebel', 'Ġx', 's', 'Ġblack', 'Ġdigital', 'Ġsl', 'r', 'Ġcamera', 'Ġx', 's', 'reb', '18', '55', 'b', 'ĠCOL', 'Ġdescription', 'ĠVAL', 'Ġcanon', 'Ġe', 'os', 'Ġrebel', 'Ġx', 's', 'Ġblack', 'Ġdigital', 'Ġsl', 'r', 'Ġcamera', 'Ġx', 's', 'reb', '18', '55', 'b', 'Ġ10', '.', '1', 'Ġmeg', 'apixel', 'Ġcm', 'os', 'Ġsensor', 'Ġdig', 'ic', 'Ġiii', 'Ġimage', 'Ġprocessor', 'Ġauto', 'Ġlighting', 'Ġoptim', 'izer', 'Ġ7', '-', 'point', 'Ġaf', 'Ġwith', 'Ġcenter', 'Ġcross', '-', 'type', 'Ġsensors', 'Ġ3', '.', '0', 'Ġfps', 'Ġcontinuous', 'Ġshooting', 'Ġ2', '.', '5', "Ġ'", 'Ġt', 'ft', 'Ġl', 'cd', 'Ġmonitor', 'Ġe', 'os', 'Ġintegrated', 'Ġcleaning', 'Ġsystem', 'Ġdust', 'Ġdelete', 'Ġdata', 'Ġdetection', 'Ġblack', 'Ġfinish', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ', 'Ġ', '</s>', '</s>', 'COL', 'Ġname', 'ĠVAL', 'Ġcanon', 'Ġe', 'os', 'Ġrebel', 'Ġx', 'si', 'Ġdigital', 'Ġsl', 'r', 'Ġcamera', 'Ġwith', 'Ġe', 'f', '-', 's', 'Ġ18', '-', '55', 'mm', 'Ġf', '/', '3', 'Ġ.', '5', 'Ġ-', '5', '.', '6', 'Ġis', 'Ġlens', 'Ġsilver', 'Ġ275', '7', 'b', '003', 'ĠCOL', 'Ġdescription', 'ĠVAL', 'Ġcanon', 'Ġe', 'os', 'Ġrebel', 'Ġx', 'si', 'Ġ12', 'Ġmeg', 'apixel', 'Ġdigital', 'Ġsl', 'r', 'Ġcamera', 'Ġwith', 'Ġ18', '-', '55', 'mm', 'Ġis', 'Ġlens', 'Ġsilver', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ6', '49', '.', '88', 'Ġ', '</s>']
is_heads: [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
y: 0
tags: 0
mask: tensor([1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1])
seqlen: 172
task_name: Textual/Abt-Buy
=======================
step: 0, task: Textual/Abt-Buy, loss: 0.0017386823892593384
step: 10, task: Textual/Abt-Buy, loss: 0.00238761305809021
step: 20, task: Textual/Abt-Buy, loss: 0.001993715763092041
step: 30, task: Textual/Abt-Buy, loss: 0.0037909895181655884
step: 40, task: Textual/Abt-Buy, loss: 0.023049257695674896
step: 50, task: Textual/Abt-Buy, loss: 0.0010898709297180176
step: 60, task: Textual/Abt-Buy, loss: 0.0014460086822509766
step: 70, task: Textual/Abt-Buy, loss: 0.005098134279251099
step: 80, task: Textual/Abt-Buy, loss: 0.026044443249702454
step: 90, task: Textual/Abt-Buy, loss: 0.0060463547706604
step: 100, task: Textual/Abt-Buy, loss: 0.00709918886423111
step: 110, task: Textual/Abt-Buy, loss: 0.006943926215171814
step: 120, task: Textual/Abt-Buy, loss: 0.008694179356098175
step: 130, task: Textual/Abt-Buy, loss: 0.0007849931716918945
step: 140, task: Textual/Abt-Buy, loss: 0.0008543133735656738
step: 150, task: Textual/Abt-Buy, loss: 0.007011160254478455
step: 160, task: Textual/Abt-Buy, loss: 0.13970959186553955
step: 170, task: Textual/Abt-Buy, loss: 0.005976200103759766
step: 180, task: Textual/Abt-Buy, loss: 0.0019200518727302551
step: 190, task: Textual/Abt-Buy, loss: 0.11994470655918121
Gradient overflow.  Skipping step, loss scaler 0 reducing loss scale to 4096.0
step: 200, task: Textual/Abt-Buy, loss: 0.006105192005634308
step: 210, task: Textual/Abt-Buy, loss: 0.0003976970911026001
step: 220, task: Textual/Abt-Buy, loss: 0.056876085698604584
step: 230, task: Textual/Abt-Buy, loss: 0.1235257163643837
step: 240, task: Textual/Abt-Buy, loss: 0.02100803703069687
step: 250, task: Textual/Abt-Buy, loss: 0.02562326192855835
step: 260, task: Textual/Abt-Buy, loss: 0.0787612646818161
step: 270, task: Textual/Abt-Buy, loss: 0.0018818452954292297
step: 280, task: Textual/Abt-Buy, loss: 0.023032374680042267
step: 290, task: Textual/Abt-Buy, loss: 0.11698373407125473
step: 300, task: Textual/Abt-Buy, loss: 0.0001570582389831543
step: 310, task: Textual/Abt-Buy, loss: 0.07497002929449081
step: 320, task: Textual/Abt-Buy, loss: 0.0034571215510368347
step: 330, task: Textual/Abt-Buy, loss: 0.0011807084083557129
step: 340, task: Textual/Abt-Buy, loss: 0.0002896636724472046
step: 350, task: Textual/Abt-Buy, loss: 0.04431578516960144
=========eval at epoch=4=========
Validation:
=============Textual/Abt-Buy==================
accuracy=0.916
precision=0.838
recall=0.277
f1=0.416
======================================
Test:
=============Textual/Abt-Buy==================
accuracy=0.925
precision=0.871
recall=0.359
f1=0.509
======================================
=====sanity check======
words: COL name VAL panasonic viera 42 ' plasma flat panel hdtv in black th42px80u COL description VAL panasonic viera 42 ' plasma flat panel hdtv in black th42px80u 720p display 1024 x 768 native resolution color purity optimizer surround sound anti-reflective filter viera link hdavi control built-in ntsc/atsc/qam tuners 3 hdmi inputs built-in galleryplayer capable sd card memory slot pedestal stand included black finish COL price VAL   [SEP] COL name VAL panasonic viera th-50pz850u 50 ' plasma tv COL description VAL 50 ' atsc , ntsc 16:9 1920 x 1080 hdtv COL price VAL 2096.99 
x: [    0 18047   766 27445  5730 38703   748 16432  3330   128 29051  3269
  2798  1368   417 18724    11   909  3553  3714 38740  2940   257 14857
  8194 27445  5730 38703   748 16432  3330   128 29051  3269  2798  1368
   417 18724    11   909  3553  3714 38740  2940   257 26180   642  2332
 46959  3023 43751  3763  3547  3195 32195 17775  6315 21104  2369  1475
    12 39878  2088 14929   748 16432  3104  1368   417 11132   797  1490
    12   179   295  1872   438    73  2923   438    73  1343   424 27115
   268   155  1368   417  5408 16584  1490    12   179  7294 23233  4453
 46409  1886  3783  8534 38238   337  1413  1165   909  2073 14857   425
 27445  1437  1437     2     2 18047   766 27445  5730 38703   748 16432
  3553    12  1096   642   329 19270   257   654   128 29051 30016 14857
  8194 27445   654   128    23  3866  2156   295  1872   438   545    35
   466 18283  3023 21083  1368   417 18724 14857   425 27445   291  5607
     4  2831  1437     2]
tokens: ['<s>', 'COL', 'Ġname', 'ĠVAL', 'Ġpan', 'asonic', 'Ġv', 'iera', 'Ġ42', "Ġ'", 'Ġplasma', 'Ġflat', 'Ġpanel', 'Ġh', 'd', 'tv', 'Ġin', 'Ġblack', 'Ġth', '42', 'px', '80', 'u', 'ĠCOL', 'Ġdescription', 'ĠVAL', 'Ġpan', 'asonic', 'Ġv', 'iera', 'Ġ42', "Ġ'", 'Ġplasma', 'Ġflat', 'Ġpanel', 'Ġh', 'd', 'tv', 'Ġin', 'Ġblack', 'Ġth', '42', 'px', '80', 'u', 'Ġ720', 'p', 'Ġdisplay', 'Ġ1024', 'Ġx', 'Ġ768', 'Ġnative', 'Ġresolution', 'Ġcolor', 'Ġpurity', 'Ġoptim', 'izer', 'Ġsurround', 'Ġsound', 'Ġanti', '-', 'reflect', 'ive', 'Ġfilter', 'Ġv', 'iera', 'Ġlink', 'Ġh', 'd', 'avi', 'Ġcontrol', 'Ġbuilt', '-', 'in', 'Ġn', 'ts', 'c', '/', 'ats', 'c', '/', 'q', 'am', 'Ġtun', 'ers', 'Ġ3', 'Ġh', 'd', 'mi', 'Ġinputs', 'Ġbuilt', '-', 'in', 'Ġgallery', 'player', 'Ġcapable', 'Ġsd', 'Ġcard', 'Ġmemory', 'Ġslot', 'Ġpedest', 'al', 'Ġstand', 'Ġincluded', 'Ġblack', 'Ġfinish', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ', 'Ġ', '</s>', '</s>', 'COL', 'Ġname', 'ĠVAL', 'Ġpan', 'asonic', 'Ġv', 'iera', 'Ġth', '-', '50', 'p', 'z', '850', 'u', 'Ġ50', "Ġ'", 'Ġplasma', 'Ġtv', 'ĠCOL', 'Ġdescription', 'ĠVAL', 'Ġ50', "Ġ'", 'Ġat', 'sc', 'Ġ,', 'Ġn', 'ts', 'c', 'Ġ16', ':', '9', 'Ġ1920', 'Ġx', 'Ġ1080', 'Ġh', 'd', 'tv', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ20', '96', '.', '99', 'Ġ', '</s>']
is_heads: [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
y: 0
tags: 0
mask: tensor([1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1])
seqlen: 160
task_name: Textual/Abt-Buy
=======================
step: 0, task: Textual/Abt-Buy, loss: 0.0025874897837638855
step: 10, task: Textual/Abt-Buy, loss: 0.0011771917343139648
step: 20, task: Textual/Abt-Buy, loss: 0.0040354058146476746
step: 30, task: Textual/Abt-Buy, loss: 0.18018671870231628
step: 40, task: Textual/Abt-Buy, loss: 0.0010644644498825073
step: 50, task: Textual/Abt-Buy, loss: 0.0003037303686141968
step: 60, task: Textual/Abt-Buy, loss: 0.004070192575454712
step: 70, task: Textual/Abt-Buy, loss: 0.0058081746101379395
step: 80, task: Textual/Abt-Buy, loss: 0.00823463499546051
step: 90, task: Textual/Abt-Buy, loss: 0.00010201334953308105
step: 100, task: Textual/Abt-Buy, loss: 0.04272586852312088
step: 110, task: Textual/Abt-Buy, loss: 0.019598178565502167
step: 120, task: Textual/Abt-Buy, loss: 0.0007610917091369629
step: 130, task: Textual/Abt-Buy, loss: 0.00018969178199768066
step: 140, task: Textual/Abt-Buy, loss: 0.000970005989074707
step: 150, task: Textual/Abt-Buy, loss: 0.005026072263717651
step: 160, task: Textual/Abt-Buy, loss: 0.00014251470565795898
step: 170, task: Textual/Abt-Buy, loss: 0.009206965565681458
step: 180, task: Textual/Abt-Buy, loss: 0.01642901450395584
step: 190, task: Textual/Abt-Buy, loss: 0.01766718178987503
step: 200, task: Textual/Abt-Buy, loss: 0.0027383267879486084
step: 210, task: Textual/Abt-Buy, loss: 0.010702930390834808
step: 220, task: Textual/Abt-Buy, loss: 0.0005996674299240112
step: 230, task: Textual/Abt-Buy, loss: 0.017328184098005295
step: 240, task: Textual/Abt-Buy, loss: 0.0006256252527236938
step: 250, task: Textual/Abt-Buy, loss: 0.0014028847217559814
step: 260, task: Textual/Abt-Buy, loss: 0.00043754279613494873
step: 270, task: Textual/Abt-Buy, loss: 0.0006856918334960938
step: 280, task: Textual/Abt-Buy, loss: 0.000253334641456604
step: 290, task: Textual/Abt-Buy, loss: 0.0002714693546295166
step: 300, task: Textual/Abt-Buy, loss: 0.022592436522245407
step: 310, task: Textual/Abt-Buy, loss: 0.016701586544513702
step: 320, task: Textual/Abt-Buy, loss: 0.0021072328090667725
step: 330, task: Textual/Abt-Buy, loss: 0.0002933293581008911
step: 340, task: Textual/Abt-Buy, loss: 0.000523492693901062
step: 350, task: Textual/Abt-Buy, loss: 0.0007931441068649292
=========eval at epoch=5=========
Validation:
=============Textual/Abt-Buy==================
accuracy=0.917
precision=0.927
recall=0.248
f1=0.391
======================================
Test:
=============Textual/Abt-Buy==================
accuracy=0.916
precision=0.895
recall=0.248
f1=0.388
======================================
=====sanity check======
words: COL name VAL sony 3.1 channel home theater surround system in black htct100 COL description VAL sony 3.1 channel home theater surround system in black htct100 hdmi active intelligence lpcm playback 3.1 channel s-force surround bravia ® sync digital media port black finish eta mid january 2009 COL price VAL 299.0  [SEP] COL name VAL sony bravia dav-hdx275 home theater system COL description VAL , 5.1 speakers 5 disc ( s ) progressive scan 1000w rms dolby pro logic ii COL price VAL  
x: [    0 18047   766 27445   579  6119   155     4   134  4238   184  7364
 21104   467    11   909  1368    90  3894  1866 14857  8194 27445   579
  6119   155     4   134  4238   184  7364 21104   467    11   909  1368
    90  3894  1866  1368   417  5408  2171  2316   784   642 13753 20083
   155     4   134  4238   579    12  9091 21104 35977   493 39110 22785
  1778   433  4103   909  2073  4400   102  1084 10408 16705  2338 14857
   425 27445 35768     4   288  1437     2     2 18047   766 27445   579
  6119 35977   493   385  1469    12 35905  1178 21138   184  7364   467
 14857  8194 27445  2156   195     4   134  6864   195  9553    36   579
  4839  8212 14194 10775   605   910  4339   385  1168  1409  1759 14578
 42661 14857   425 27445  1437  1437     2]
tokens: ['<s>', 'COL', 'Ġname', 'ĠVAL', 'Ġs', 'ony', 'Ġ3', '.', '1', 'Ġchannel', 'Ġhome', 'Ġtheater', 'Ġsurround', 'Ġsystem', 'Ġin', 'Ġblack', 'Ġh', 't', 'ct', '100', 'ĠCOL', 'Ġdescription', 'ĠVAL', 'Ġs', 'ony', 'Ġ3', '.', '1', 'Ġchannel', 'Ġhome', 'Ġtheater', 'Ġsurround', 'Ġsystem', 'Ġin', 'Ġblack', 'Ġh', 't', 'ct', '100', 'Ġh', 'd', 'mi', 'Ġactive', 'Ġintelligence', 'Ġl', 'p', 'cm', 'Ġplayback', 'Ġ3', '.', '1', 'Ġchannel', 'Ġs', '-', 'force', 'Ġsurround', 'Ġbrav', 'ia', 'ĠÂ®', 'Ġsync', 'Ġdigital', 'Ġmedia', 'Ġport', 'Ġblack', 'Ġfinish', 'Ġet', 'a', 'Ġmid', 'Ġjan', 'uary', 'Ġ2009', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ299', '.', '0', 'Ġ', '</s>', '</s>', 'COL', 'Ġname', 'ĠVAL', 'Ġs', 'ony', 'Ġbrav', 'ia', 'Ġd', 'av', '-', 'hd', 'x', '275', 'Ġhome', 'Ġtheater', 'Ġsystem', 'ĠCOL', 'Ġdescription', 'ĠVAL', 'Ġ,', 'Ġ5', '.', '1', 'Ġspeakers', 'Ġ5', 'Ġdisc', 'Ġ(', 'Ġs', 'Ġ)', 'Ġprogressive', 'Ġscan', 'Ġ1000', 'w', 'Ġr', 'ms', 'Ġd', 'ol', 'by', 'Ġpro', 'Ġlogic', 'Ġii', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ', 'Ġ', '</s>']
is_heads: [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
y: 0
tags: 0
mask: tensor([1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1])
seqlen: 127
task_name: Textual/Abt-Buy
=======================
step: 0, task: Textual/Abt-Buy, loss: 0.001466304063796997
step: 10, task: Textual/Abt-Buy, loss: 0.0018804222345352173
step: 20, task: Textual/Abt-Buy, loss: 0.004188805818557739
step: 30, task: Textual/Abt-Buy, loss: 0.016743246465921402
step: 40, task: Textual/Abt-Buy, loss: 0.026222996413707733
step: 50, task: Textual/Abt-Buy, loss: 0.07935214787721634
step: 60, task: Textual/Abt-Buy, loss: 0.0006064027547836304
step: 70, task: Textual/Abt-Buy, loss: 0.000578954815864563
step: 80, task: Textual/Abt-Buy, loss: 0.0006090104579925537
step: 90, task: Textual/Abt-Buy, loss: 0.002142190933227539
step: 100, task: Textual/Abt-Buy, loss: 0.00048422813415527344
step: 110, task: Textual/Abt-Buy, loss: 0.0005717575550079346
step: 120, task: Textual/Abt-Buy, loss: 0.04752650111913681
step: 130, task: Textual/Abt-Buy, loss: 0.0002685040235519409
step: 140, task: Textual/Abt-Buy, loss: 0.0004954487085342407
step: 150, task: Textual/Abt-Buy, loss: 0.00019858777523040771
step: 160, task: Textual/Abt-Buy, loss: 0.0006572157144546509
step: 170, task: Textual/Abt-Buy, loss: 0.028114017099142075
step: 180, task: Textual/Abt-Buy, loss: 0.02231922745704651
step: 190, task: Textual/Abt-Buy, loss: 0.000492393970489502
step: 200, task: Textual/Abt-Buy, loss: 0.0014687329530715942
step: 210, task: Textual/Abt-Buy, loss: 0.00034214556217193604
step: 220, task: Textual/Abt-Buy, loss: 0.004864484071731567
step: 230, task: Textual/Abt-Buy, loss: 0.00016956031322479248
step: 240, task: Textual/Abt-Buy, loss: 0.0003315359354019165
step: 250, task: Textual/Abt-Buy, loss: 0.0008935928344726562
step: 260, task: Textual/Abt-Buy, loss: 0.009510397911071777
step: 270, task: Textual/Abt-Buy, loss: 0.018665172159671783
step: 280, task: Textual/Abt-Buy, loss: 0.00014981627464294434
step: 290, task: Textual/Abt-Buy, loss: 0.25244927406311035
step: 300, task: Textual/Abt-Buy, loss: 0.27831554412841797
step: 310, task: Textual/Abt-Buy, loss: 0.0003986358642578125
step: 320, task: Textual/Abt-Buy, loss: 0.000996917486190796
step: 330, task: Textual/Abt-Buy, loss: 0.00028890371322631836
step: 340, task: Textual/Abt-Buy, loss: 0.009530104696750641
step: 350, task: Textual/Abt-Buy, loss: 0.0002885758876800537
=========eval at epoch=6=========
Validation:
=============Textual/Abt-Buy==================
accuracy=0.910
precision=0.972
recall=0.170
f1=0.289
======================================
Test:
=============Textual/Abt-Buy==================
accuracy=0.922
precision=0.983
recall=0.277
f1=0.432
======================================
=====sanity check======
words: COL name VAL apple ipod nano gray armband mb769ga COL description VAL apple ipod nano gray armband mb769ga compatible with 4th generation ipod nano has space for the nike + ipod sport kit receiver gray finish COL price VAL 29.0  [SEP] COL name VAL apple 8gb ipod nano silver ( 4th generation ) mb598ll/a COL description VAL  COL price VAL 146.75 
x: [    0 18047   766 27445 15162 36180  1630 36924 12339  4709  6648   463
   475   428   406  4563  2538 14857  8194 27445 15162 36180  1630 36924
 12339  4709  6648   463   475   428   406  4563  2538 16632    19   204
   212  2706 36180  1630 36924    34   980    13     5   295  4348  2055
 36180  1630  2414 10549  4797 12339  2073 14857   425 27445  1132     4
   288  1437     2     2 18047   766 27445 15162   290 19562 36180  1630
 36924  4334    36   204   212  2706  4839   475   428 38097   890    73
   102 14857  8194 27445  1437 14857   425 27445 24543     4  2545  1437
     2]
tokens: ['<s>', 'COL', 'Ġname', 'ĠVAL', 'Ġapple', 'Ġip', 'od', 'Ġnano', 'Ġgray', 'Ġar', 'mb', 'and', 'Ġm', 'b', '7', '69', 'ga', 'ĠCOL', 'Ġdescription', 'ĠVAL', 'Ġapple', 'Ġip', 'od', 'Ġnano', 'Ġgray', 'Ġar', 'mb', 'and', 'Ġm', 'b', '7', '69', 'ga', 'Ġcompatible', 'Ġwith', 'Ġ4', 'th', 'Ġgeneration', 'Ġip', 'od', 'Ġnano', 'Ġhas', 'Ġspace', 'Ġfor', 'Ġthe', 'Ġn', 'ike', 'Ġ+', 'Ġip', 'od', 'Ġsport', 'Ġkit', 'Ġreceiver', 'Ġgray', 'Ġfinish', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ29', '.', '0', 'Ġ', '</s>', '</s>', 'COL', 'Ġname', 'ĠVAL', 'Ġapple', 'Ġ8', 'gb', 'Ġip', 'od', 'Ġnano', 'Ġsilver', 'Ġ(', 'Ġ4', 'th', 'Ġgeneration', 'Ġ)', 'Ġm', 'b', '598', 'll', '/', 'a', 'ĠCOL', 'Ġdescription', 'ĠVAL', 'Ġ', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ146', '.', '75', 'Ġ', '</s>']
is_heads: [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
y: 0
tags: 0
mask: tensor([1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1])
seqlen: 97
task_name: Textual/Abt-Buy
=======================
step: 0, task: Textual/Abt-Buy, loss: 0.03822893649339676
step: 10, task: Textual/Abt-Buy, loss: 0.01175939291715622
step: 20, task: Textual/Abt-Buy, loss: 0.0015038996934890747
step: 30, task: Textual/Abt-Buy, loss: 0.03802508860826492
step: 40, task: Textual/Abt-Buy, loss: 0.01028362661600113
step: 50, task: Textual/Abt-Buy, loss: 0.00042609870433807373
step: 60, task: Textual/Abt-Buy, loss: 0.026142369955778122
step: 70, task: Textual/Abt-Buy, loss: 0.038624607026576996
step: 80, task: Textual/Abt-Buy, loss: 0.014416486024856567
step: 90, task: Textual/Abt-Buy, loss: 0.0004188269376754761
step: 100, task: Textual/Abt-Buy, loss: 0.012240037322044373
step: 110, task: Textual/Abt-Buy, loss: 0.006510965526103973
step: 120, task: Textual/Abt-Buy, loss: 0.043336961418390274
step: 130, task: Textual/Abt-Buy, loss: 0.008606955409049988
step: 140, task: Textual/Abt-Buy, loss: 0.0003104358911514282
step: 150, task: Textual/Abt-Buy, loss: 0.00031960010528564453
step: 160, task: Textual/Abt-Buy, loss: 0.00020328164100646973
step: 170, task: Textual/Abt-Buy, loss: 0.00039340555667877197
step: 180, task: Textual/Abt-Buy, loss: 0.0007347762584686279
step: 190, task: Textual/Abt-Buy, loss: 0.0017072930932044983
step: 200, task: Textual/Abt-Buy, loss: 0.0001980513334274292
step: 210, task: Textual/Abt-Buy, loss: 0.00023101270198822021
step: 220, task: Textual/Abt-Buy, loss: 0.0003331601619720459
step: 230, task: Textual/Abt-Buy, loss: 0.0028515979647636414
step: 240, task: Textual/Abt-Buy, loss: 0.015425905585289001
step: 250, task: Textual/Abt-Buy, loss: 0.01594562456011772
step: 260, task: Textual/Abt-Buy, loss: 0.0708407387137413
step: 270, task: Textual/Abt-Buy, loss: 0.0002437382936477661
step: 280, task: Textual/Abt-Buy, loss: 0.00019943714141845703
step: 290, task: Textual/Abt-Buy, loss: 0.0002218186855316162
step: 300, task: Textual/Abt-Buy, loss: 0.00020042061805725098
step: 310, task: Textual/Abt-Buy, loss: 0.019118010997772217
step: 320, task: Textual/Abt-Buy, loss: 0.00022827088832855225
step: 330, task: Textual/Abt-Buy, loss: 0.004413902759552002
step: 340, task: Textual/Abt-Buy, loss: 0.001448109745979309
step: 350, task: Textual/Abt-Buy, loss: 0.0012775063514709473
=========eval at epoch=7=========
Validation:
=============Textual/Abt-Buy==================
accuracy=0.921
precision=0.910
recall=0.296
f1=0.447
======================================
Test:
=============Textual/Abt-Buy==================
accuracy=0.924
precision=0.955
recall=0.306
f1=0.463
======================================
=====sanity check======
words: COL name VAL toshiba black 1080p upconversion dvd player sd6100 COL description VAL toshiba black 1080p upconversion dvd player sd6100 video upconversion up to 1080p resolution hdmi regza link multi-format playback capability black finish COL price VAL   [SEP] COL name VAL toshiba lithium ion portable dvd player battery medb05lx COL description VAL lithium ion ( li-ion ) 7.4 v dc portable dvd player battery COL price VAL 149.99 
x: [    0 18047   766 27445     7  1193 15577   909 21083   642    62  3865
 21747   385 40311   869 46409   401  1866 14857  8194 27445     7  1193
 15577   909 21083   642    62  3865 21747   385 40311   869 46409   401
  1866   569    62  3865 21747    62     7 21083   642  3547  1368   417
  5408  6701  2478  3104  3228    12 34609 20083  9388   909  2073 14857
   425 27445  1437  1437     2     2 18047   766 27445     7  1193 15577
 16904 31973 15295   385 40311   869  3822  5679   428  2546   462  1178
 14857  8194 27445 16904 31973    36 16787    12  1499  4839   262     4
   306   748 46773 15295   385 40311   869  3822 14857   425 27445 24621
     4  2831  1437     2]
tokens: ['<s>', 'COL', 'Ġname', 'ĠVAL', 'Ġto', 'sh', 'iba', 'Ġblack', 'Ġ1080', 'p', 'Ġup', 'con', 'version', 'Ġd', 'vd', 'Ġplayer', 'Ġsd', '6', '100', 'ĠCOL', 'Ġdescription', 'ĠVAL', 'Ġto', 'sh', 'iba', 'Ġblack', 'Ġ1080', 'p', 'Ġup', 'con', 'version', 'Ġd', 'vd', 'Ġplayer', 'Ġsd', '6', '100', 'Ġvideo', 'Ġup', 'con', 'version', 'Ġup', 'Ġto', 'Ġ1080', 'p', 'Ġresolution', 'Ġh', 'd', 'mi', 'Ġreg', 'za', 'Ġlink', 'Ġmulti', '-', 'format', 'Ġplayback', 'Ġcapability', 'Ġblack', 'Ġfinish', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ', 'Ġ', '</s>', '</s>', 'COL', 'Ġname', 'ĠVAL', 'Ġto', 'sh', 'iba', 'Ġlithium', 'Ġion', 'Ġportable', 'Ġd', 'vd', 'Ġplayer', 'Ġbattery', 'Ġmed', 'b', '05', 'l', 'x', 'ĠCOL', 'Ġdescription', 'ĠVAL', 'Ġlithium', 'Ġion', 'Ġ(', 'Ġli', '-', 'ion', 'Ġ)', 'Ġ7', '.', '4', 'Ġv', 'Ġdc', 'Ġportable', 'Ġd', 'vd', 'Ġplayer', 'Ġbattery', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ149', '.', '99', 'Ġ', '</s>']
is_heads: [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
y: 0
tags: 0
mask: tensor([1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1])
seqlen: 112
task_name: Textual/Abt-Buy
=======================
step: 0, task: Textual/Abt-Buy, loss: 0.014940120279788971
step: 10, task: Textual/Abt-Buy, loss: 0.002144858241081238
step: 20, task: Textual/Abt-Buy, loss: 0.16865770518779755
step: 30, task: Textual/Abt-Buy, loss: 0.001228630542755127
step: 40, task: Textual/Abt-Buy, loss: 0.0004299581050872803
step: 50, task: Textual/Abt-Buy, loss: 0.00018776953220367432
step: 60, task: Textual/Abt-Buy, loss: 0.0007079094648361206
step: 70, task: Textual/Abt-Buy, loss: 0.00028321146965026855
step: 80, task: Textual/Abt-Buy, loss: 0.13165949285030365
step: 90, task: Textual/Abt-Buy, loss: 0.00866389274597168
step: 100, task: Textual/Abt-Buy, loss: 0.00024916231632232666
step: 110, task: Textual/Abt-Buy, loss: 0.000347822904586792
step: 120, task: Textual/Abt-Buy, loss: 0.00026109814643859863
step: 130, task: Textual/Abt-Buy, loss: 0.0289415642619133
step: 140, task: Textual/Abt-Buy, loss: 0.002271503210067749
step: 150, task: Textual/Abt-Buy, loss: 0.08982457965612411
step: 160, task: Textual/Abt-Buy, loss: 0.00022839009761810303
step: 170, task: Textual/Abt-Buy, loss: 0.00022411346435546875
step: 180, task: Textual/Abt-Buy, loss: 0.000855371356010437
step: 190, task: Textual/Abt-Buy, loss: 0.0005769878625869751
step: 200, task: Textual/Abt-Buy, loss: 0.021852567791938782
step: 210, task: Textual/Abt-Buy, loss: 0.00018933415412902832
step: 220, task: Textual/Abt-Buy, loss: 0.0003914833068847656
step: 230, task: Textual/Abt-Buy, loss: 0.00063323974609375
step: 240, task: Textual/Abt-Buy, loss: 0.0001900196075439453
step: 250, task: Textual/Abt-Buy, loss: 0.0024204999208450317
step: 260, task: Textual/Abt-Buy, loss: 0.0024988576769828796
step: 270, task: Textual/Abt-Buy, loss: 0.0003921985626220703
step: 280, task: Textual/Abt-Buy, loss: 0.0017473548650741577
step: 290, task: Textual/Abt-Buy, loss: 0.0004096031188964844
step: 300, task: Textual/Abt-Buy, loss: 0.0013259649276733398
step: 310, task: Textual/Abt-Buy, loss: 0.00035844743251800537
step: 320, task: Textual/Abt-Buy, loss: 0.02641211822628975
step: 330, task: Textual/Abt-Buy, loss: 0.0017469599843025208
step: 340, task: Textual/Abt-Buy, loss: 0.022908225655555725
step: 350, task: Textual/Abt-Buy, loss: 0.00038914382457733154
=========eval at epoch=8=========
Validation:
=============Textual/Abt-Buy==================
accuracy=0.919
precision=0.947
recall=0.262
f1=0.411
======================================
Test:
=============Textual/Abt-Buy==================
accuracy=0.926
precision=0.922
recall=0.345
f1=0.502
======================================
Traceback (most recent call last):
  File "train_ditto.py", line 60, in <module>
    summarizer = Summarizer(config, lm=hp.lm)
  File "/w/246/tianyu2020/ditto/ditto/summarize.py", line 31, in __init__
    self.build_index()
  File "/w/246/tianyu2020/ditto/ditto/summarize.py", line 43, in build_index
    with open(fn, encoding='utf-8') as fin:
FileNotFoundError: [Errno 2] No such file or directory: 'data/er_magellan/Textual/Company/train.txt.tfidf'
Traceback (most recent call last):
  File "train_ditto.py", line 60, in <module>
    summarizer = Summarizer(config, lm=hp.lm)
  File "/w/246/tianyu2020/ditto/ditto/summarize.py", line 31, in __init__
    self.build_index()
  File "/w/246/tianyu2020/ditto/ditto/summarize.py", line 43, in build_index
    with open(fn, encoding='utf-8') as fin:
FileNotFoundError: [Errno 2] No such file or directory: 'data/er_magellan/Textual/Company/train.txt.tfidf'
Traceback (most recent call last):
  File "train_ditto.py", line 60, in <module>
    summarizer = Summarizer(config, lm=hp.lm)
  File "/w/246/tianyu2020/ditto/ditto/summarize.py", line 31, in __init__
    self.build_index()
  File "/w/246/tianyu2020/ditto/ditto/summarize.py", line 43, in build_index
    with open(fn, encoding='utf-8') as fin:
FileNotFoundError: [Errno 2] No such file or directory: 'data/er_magellan/Textual/Company/train.txt.tfidf'
Traceback (most recent call last):
  File "train_ditto.py", line 60, in <module>
    summarizer = Summarizer(config, lm=hp.lm)
  File "/w/246/tianyu2020/ditto/ditto/summarize.py", line 31, in __init__
    self.build_index()
  File "/w/246/tianyu2020/ditto/ditto/summarize.py", line 43, in build_index
    with open(fn, encoding='utf-8') as fin:
FileNotFoundError: [Errno 2] No such file or directory: 'data/er_magellan/Textual/Company/train.txt.tfidf'
Traceback (most recent call last):
  File "train_ditto.py", line 60, in <module>
    summarizer = Summarizer(config, lm=hp.lm)
  File "/w/246/tianyu2020/ditto/ditto/summarize.py", line 31, in __init__
    self.build_index()
  File "/w/246/tianyu2020/ditto/ditto/summarize.py", line 43, in build_index
    with open(fn, encoding='utf-8') as fin:
FileNotFoundError: [Errno 2] No such file or directory: 'data/er_magellan/Textual/Company/train.txt.tfidf'
Traceback (most recent call last):
  File "train_ditto.py", line 60, in <module>
    summarizer = Summarizer(config, lm=hp.lm)
  File "/w/246/tianyu2020/ditto/ditto/summarize.py", line 31, in __init__
    self.build_index()
  File "/w/246/tianyu2020/ditto/ditto/summarize.py", line 43, in build_index
    with open(fn, encoding='utf-8') as fin:
FileNotFoundError: [Errno 2] No such file or directory: 'data/er_magellan/Textual/Company/train.txt.tfidf'
Traceback (most recent call last):
  File "train_ditto.py", line 60, in <module>
    summarizer = Summarizer(config, lm=hp.lm)
  File "/w/246/tianyu2020/ditto/ditto/summarize.py", line 31, in __init__
    self.build_index()
  File "/w/246/tianyu2020/ditto/ditto/summarize.py", line 43, in build_index
    with open(fn, encoding='utf-8') as fin:
FileNotFoundError: [Errno 2] No such file or directory: 'data/er_magellan/Textual/Company/train.txt.tfidf'
Traceback (most recent call last):
  File "train_ditto.py", line 60, in <module>
    summarizer = Summarizer(config, lm=hp.lm)
  File "/w/246/tianyu2020/ditto/ditto/summarize.py", line 31, in __init__
    self.build_index()
  File "/w/246/tianyu2020/ditto/ditto/summarize.py", line 43, in build_index
    with open(fn, encoding='utf-8') as fin:
FileNotFoundError: [Errno 2] No such file or directory: 'data/er_magellan/Textual/Company/train.txt.tfidf'
Traceback (most recent call last):
  File "train_ditto.py", line 60, in <module>
    summarizer = Summarizer(config, lm=hp.lm)
  File "/w/246/tianyu2020/ditto/ditto/summarize.py", line 31, in __init__
    self.build_index()
  File "/w/246/tianyu2020/ditto/ditto/summarize.py", line 43, in build_index
    with open(fn, encoding='utf-8') as fin:
FileNotFoundError: [Errno 2] No such file or directory: 'data/er_magellan/Textual/Company/train.txt.tfidf'
Traceback (most recent call last):
  File "train_ditto.py", line 60, in <module>
    summarizer = Summarizer(config, lm=hp.lm)
  File "/w/246/tianyu2020/ditto/ditto/summarize.py", line 31, in __init__
    self.build_index()
  File "/w/246/tianyu2020/ditto/ditto/summarize.py", line 43, in build_index
    with open(fn, encoding='utf-8') as fin:
FileNotFoundError: [Errno 2] No such file or directory: 'data/er_magellan/Textual/Company/train.txt.tfidf'
Traceback (most recent call last):
  File "train_ditto.py", line 60, in <module>
    summarizer = Summarizer(config, lm=hp.lm)
  File "/w/246/tianyu2020/ditto/ditto/summarize.py", line 31, in __init__
    self.build_index()
  File "/w/246/tianyu2020/ditto/ditto/summarize.py", line 43, in build_index
    with open(fn, encoding='utf-8') as fin:
FileNotFoundError: [Errno 2] No such file or directory: 'data/er_magellan/Textual/Company/train.txt.tfidf'
Traceback (most recent call last):
  File "train_ditto.py", line 60, in <module>
    summarizer = Summarizer(config, lm=hp.lm)
  File "/w/246/tianyu2020/ditto/ditto/summarize.py", line 31, in __init__
    self.build_index()
  File "/w/246/tianyu2020/ditto/ditto/summarize.py", line 43, in build_index
    with open(fn, encoding='utf-8') as fin:
FileNotFoundError: [Errno 2] No such file or directory: 'data/er_magellan/Textual/Company/train.txt.tfidf'
Traceback (most recent call last):
  File "train_ditto.py", line 60, in <module>
    summarizer = Summarizer(config, lm=hp.lm)
  File "/w/246/tianyu2020/ditto/ditto/summarize.py", line 31, in __init__
    self.build_index()
  File "/w/246/tianyu2020/ditto/ditto/summarize.py", line 43, in build_index
    with open(fn, encoding='utf-8') as fin:
FileNotFoundError: [Errno 2] No such file or directory: 'data/er_magellan/Textual/Company/train.txt.tfidf'
Traceback (most recent call last):
  File "train_ditto.py", line 60, in <module>
    summarizer = Summarizer(config, lm=hp.lm)
  File "/w/246/tianyu2020/ditto/ditto/summarize.py", line 31, in __init__
    self.build_index()
  File "/w/246/tianyu2020/ditto/ditto/summarize.py", line 43, in build_index
    with open(fn, encoding='utf-8') as fin:
FileNotFoundError: [Errno 2] No such file or directory: 'data/er_magellan/Textual/Company/train.txt.tfidf'
Traceback (most recent call last):
  File "train_ditto.py", line 60, in <module>
    summarizer = Summarizer(config, lm=hp.lm)
  File "/w/246/tianyu2020/ditto/ditto/summarize.py", line 31, in __init__
    self.build_index()
  File "/w/246/tianyu2020/ditto/ditto/summarize.py", line 43, in build_index
    with open(fn, encoding='utf-8') as fin:
FileNotFoundError: [Errno 2] No such file or directory: 'data/er_magellan/Textual/Company/train.txt.tfidf'
Traceback (most recent call last):
  File "train_ditto.py", line 60, in <module>
    summarizer = Summarizer(config, lm=hp.lm)
  File "/w/246/tianyu2020/ditto/ditto/summarize.py", line 31, in __init__
    self.build_index()
  File "/w/246/tianyu2020/ditto/ditto/summarize.py", line 43, in build_index
    with open(fn, encoding='utf-8') as fin:
FileNotFoundError: [Errno 2] No such file or directory: 'data/er_magellan/Textual/Company/train.txt.tfidf'
Traceback (most recent call last):
  File "train_ditto.py", line 60, in <module>
    summarizer = Summarizer(config, lm=hp.lm)
  File "/w/246/tianyu2020/ditto/ditto/summarize.py", line 31, in __init__
    self.build_index()
  File "/w/246/tianyu2020/ditto/ditto/summarize.py", line 43, in build_index
    with open(fn, encoding='utf-8') as fin:
FileNotFoundError: [Errno 2] No such file or directory: 'data/er_magellan/Textual/Company/train.txt.tfidf'
Traceback (most recent call last):
  File "train_ditto.py", line 60, in <module>
    summarizer = Summarizer(config, lm=hp.lm)
  File "/w/246/tianyu2020/ditto/ditto/summarize.py", line 31, in __init__
    self.build_index()
  File "/w/246/tianyu2020/ditto/ditto/summarize.py", line 43, in build_index
    with open(fn, encoding='utf-8') as fin:
FileNotFoundError: [Errno 2] No such file or directory: 'data/er_magellan/Textual/Company/train.txt.tfidf'
Traceback (most recent call last):
  File "train_ditto.py", line 60, in <module>
    summarizer = Summarizer(config, lm=hp.lm)
  File "/w/246/tianyu2020/ditto/ditto/summarize.py", line 31, in __init__
    self.build_index()
  File "/w/246/tianyu2020/ditto/ditto/summarize.py", line 43, in build_index
    with open(fn, encoding='utf-8') as fin:
FileNotFoundError: [Errno 2] No such file or directory: 'data/er_magellan/Textual/Company/train.txt.tfidf'
Traceback (most recent call last):
  File "train_ditto.py", line 60, in <module>
    summarizer = Summarizer(config, lm=hp.lm)
  File "/w/246/tianyu2020/ditto/ditto/summarize.py", line 31, in __init__
    self.build_index()
  File "/w/246/tianyu2020/ditto/ditto/summarize.py", line 43, in build_index
    with open(fn, encoding='utf-8') as fin:
FileNotFoundError: [Errno 2] No such file or directory: 'data/er_magellan/Textual/Company/train.txt.tfidf'
Traceback (most recent call last):
  File "train_ditto.py", line 60, in <module>
    summarizer = Summarizer(config, lm=hp.lm)
  File "/w/246/tianyu2020/ditto/ditto/summarize.py", line 31, in __init__
    self.build_index()
  File "/w/246/tianyu2020/ditto/ditto/summarize.py", line 43, in build_index
    with open(fn, encoding='utf-8') as fin:
FileNotFoundError: [Errno 2] No such file or directory: 'data/er_magellan/Textual/Company/train.txt.tfidf'
Traceback (most recent call last):
  File "train_ditto.py", line 60, in <module>
    summarizer = Summarizer(config, lm=hp.lm)
  File "/w/246/tianyu2020/ditto/ditto/summarize.py", line 31, in __init__
    self.build_index()
  File "/w/246/tianyu2020/ditto/ditto/summarize.py", line 43, in build_index
    with open(fn, encoding='utf-8') as fin:
FileNotFoundError: [Errno 2] No such file or directory: 'data/er_magellan/Textual/Company/train.txt.tfidf'
Traceback (most recent call last):
  File "train_ditto.py", line 60, in <module>
    summarizer = Summarizer(config, lm=hp.lm)
  File "/w/246/tianyu2020/ditto/ditto/summarize.py", line 31, in __init__
    self.build_index()
  File "/w/246/tianyu2020/ditto/ditto/summarize.py", line 43, in build_index
    with open(fn, encoding='utf-8') as fin:
FileNotFoundError: [Errno 2] No such file or directory: 'data/er_magellan/Textual/Company/train.txt.tfidf'
Traceback (most recent call last):
  File "train_ditto.py", line 60, in <module>
    summarizer = Summarizer(config, lm=hp.lm)
  File "/w/246/tianyu2020/ditto/ditto/summarize.py", line 31, in __init__
    self.build_index()
  File "/w/246/tianyu2020/ditto/ditto/summarize.py", line 43, in build_index
    with open(fn, encoding='utf-8') as fin:
FileNotFoundError: [Errno 2] No such file or directory: 'data/er_magellan/Textual/Company/train.txt.tfidf'
Traceback (most recent call last):
  File "train_ditto.py", line 60, in <module>
    summarizer = Summarizer(config, lm=hp.lm)
  File "/w/246/tianyu2020/ditto/ditto/summarize.py", line 31, in __init__
    self.build_index()
  File "/w/246/tianyu2020/ditto/ditto/summarize.py", line 43, in build_index
    with open(fn, encoding='utf-8') as fin:
FileNotFoundError: [Errno 2] No such file or directory: 'data/er_magellan/Textual/Company/train.txt.tfidf'
Selected optimization level O2:  FP16 training with FP32 batchnorm and FP32 master weights.

Defaults for this optimization level are:
enabled                : True
opt_level              : O2
cast_model_type        : torch.float16
patch_torch_functions  : False
keep_batchnorm_fp32    : True
master_weights         : True
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O2
cast_model_type        : torch.float16
patch_torch_functions  : False
keep_batchnorm_fp32    : True
master_weights         : True
loss_scale             : dynamic
Warning:  multi_tensor_applier fused unscale kernel is unavailable, possibly because apex was installed without --cuda_ext --cpp_ext. Using Python fallback.  Original ImportError was: ModuleNotFoundError("No module named 'amp_C'")
Gradient overflow.  Skipping step, loss scaler 0 reducing loss scale to 32768.0
=====sanity check======
words: COL title VAL gear head wireless optical tilt-wheel mouse red mice gear head 19.88 COL category VAL  COL brand VAL  COL modelno VAL mpt3200red COL price VAL   [SEP] COL title VAL gear head 2.4 ghz wireless optical nano mouse - red black usb mp2750red-cp10 gear head mp2750red-cp10 13.66 COL category VAL mice COL brand VAL  COL modelno VAL  COL price VAL  
x: [    0 18047  1270 27445  6351   471  6955 17547 22136    12 13630 18292
  1275 15540  6351   471   753     4  4652 14857  4120 27445  1437 14857
  1518 27445  1437 14857  1421  2362 27445   475  3320   246  2619  2050
 14857   425 27445  1437  1437     2     2 18047  1270 27445  6351   471
   132     4   306 34648   329  6955 17547 36924 18292   111  1275   909
 49030 44857  2518  1096  2050    12 30216   698  6351   471 44857  2518
  1096  2050    12 30216   698   508     4  4280 14857  4120 27445 15540
 14857  1518 27445  1437 14857  1421  2362 27445  1437 14857   425 27445
  1437  1437     2]
tokens: ['<s>', 'COL', 'Ġtitle', 'ĠVAL', 'Ġgear', 'Ġhead', 'Ġwireless', 'Ġoptical', 'Ġtilt', '-', 'wheel', 'Ġmouse', 'Ġred', 'Ġmice', 'Ġgear', 'Ġhead', 'Ġ19', '.', '88', 'ĠCOL', 'Ġcategory', 'ĠVAL', 'Ġ', 'ĠCOL', 'Ġbrand', 'ĠVAL', 'Ġ', 'ĠCOL', 'Ġmodel', 'no', 'ĠVAL', 'Ġm', 'pt', '3', '200', 'red', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ', 'Ġ', '</s>', '</s>', 'COL', 'Ġtitle', 'ĠVAL', 'Ġgear', 'Ġhead', 'Ġ2', '.', '4', 'Ġgh', 'z', 'Ġwireless', 'Ġoptical', 'Ġnano', 'Ġmouse', 'Ġ-', 'Ġred', 'Ġblack', 'Ġusb', 'Ġmp', '27', '50', 'red', '-', 'cp', '10', 'Ġgear', 'Ġhead', 'Ġmp', '27', '50', 'red', '-', 'cp', '10', 'Ġ13', '.', '66', 'ĠCOL', 'Ġcategory', 'ĠVAL', 'Ġmice', 'ĠCOL', 'Ġbrand', 'ĠVAL', 'Ġ', 'ĠCOL', 'Ġmodel', 'no', 'ĠVAL', 'Ġ', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ', 'Ġ', '</s>']
is_heads: [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
y: 0
tags: 0
mask: tensor([1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1])
seqlen: 99
task_name: Dirty/Walmart-Amazon
=======================
step: 0, task: Dirty/Walmart-Amazon, loss: 0.7281635403633118
Gradient overflow.  Skipping step, loss scaler 0 reducing loss scale to 16384.0
Gradient overflow.  Skipping step, loss scaler 0 reducing loss scale to 8192.0
step: 10, task: Dirty/Walmart-Amazon, loss: 0.7376013994216919
step: 20, task: Dirty/Walmart-Amazon, loss: 0.6700842976570129
step: 30, task: Dirty/Walmart-Amazon, loss: 0.5657615065574646
step: 40, task: Dirty/Walmart-Amazon, loss: 0.4539264440536499
step: 50, task: Dirty/Walmart-Amazon, loss: 0.11332961916923523
Gradient overflow.  Skipping step, loss scaler 0 reducing loss scale to 4096.0
step: 60, task: Dirty/Walmart-Amazon, loss: 0.08711657673120499
step: 70, task: Dirty/Walmart-Amazon, loss: 0.6042894124984741
step: 80, task: Dirty/Walmart-Amazon, loss: 0.19838844239711761
step: 90, task: Dirty/Walmart-Amazon, loss: 0.24266183376312256
step: 100, task: Dirty/Walmart-Amazon, loss: 0.07980325073003769
step: 110, task: Dirty/Walmart-Amazon, loss: 0.4063556492328644
step: 120, task: Dirty/Walmart-Amazon, loss: 0.3189851939678192
step: 130, task: Dirty/Walmart-Amazon, loss: 0.10822215676307678
step: 140, task: Dirty/Walmart-Amazon, loss: 0.2647320330142975
step: 150, task: Dirty/Walmart-Amazon, loss: 0.2153816521167755
step: 160, task: Dirty/Walmart-Amazon, loss: 0.3723145127296448
step: 170, task: Dirty/Walmart-Amazon, loss: 0.10331819951534271
step: 180, task: Dirty/Walmart-Amazon, loss: 0.2862977981567383
step: 190, task: Dirty/Walmart-Amazon, loss: 0.6708309650421143
step: 200, task: Dirty/Walmart-Amazon, loss: 0.13954763114452362
step: 210, task: Dirty/Walmart-Amazon, loss: 0.5013364553451538
step: 220, task: Dirty/Walmart-Amazon, loss: 0.2395339459180832
step: 230, task: Dirty/Walmart-Amazon, loss: 0.19842834770679474
step: 240, task: Dirty/Walmart-Amazon, loss: 0.4603719711303711
step: 250, task: Dirty/Walmart-Amazon, loss: 0.23063015937805176
step: 260, task: Dirty/Walmart-Amazon, loss: 0.18568602204322815
step: 270, task: Dirty/Walmart-Amazon, loss: 0.16982844471931458
step: 280, task: Dirty/Walmart-Amazon, loss: 0.6177647709846497
step: 290, task: Dirty/Walmart-Amazon, loss: 0.10406303405761719
step: 300, task: Dirty/Walmart-Amazon, loss: 0.23339766263961792
step: 310, task: Dirty/Walmart-Amazon, loss: 0.113532155752182
step: 320, task: Dirty/Walmart-Amazon, loss: 0.2032867819070816
step: 330, task: Dirty/Walmart-Amazon, loss: 0.08852767199277878
step: 340, task: Dirty/Walmart-Amazon, loss: 0.18398451805114746
step: 350, task: Dirty/Walmart-Amazon, loss: 0.794830858707428
step: 360, task: Dirty/Walmart-Amazon, loss: 0.2719056010246277
step: 370, task: Dirty/Walmart-Amazon, loss: 0.4848989248275757
step: 380, task: Dirty/Walmart-Amazon, loss: 0.1966763436794281
=========eval at epoch=1=========
Validation:
=============Dirty/Walmart-Amazon==================
accuracy=0.906
precision=0.000
recall=0.000
f1=0.000
======================================
Test:
=============Dirty/Walmart-Amazon==================
accuracy=0.906
precision=0.000
recall=0.000
f1=0.000
======================================
/w/246/tianyu2020/miniconda2/envs/ditto/lib/python3.7/site-packages/apex/amp/_initialize.py:24: UserWarning: An input tensor was not cuda.
  warnings.warn("An input tensor was not cuda.")
/w/246/tianyu2020/miniconda2/envs/ditto/lib/python3.7/site-packages/torch/optim/lr_scheduler.py:122: UserWarning: Detected call of `lr_scheduler.step()` before `optimizer.step()`. In PyTorch 1.1.0 and later, you should call them in the opposite order: `optimizer.step()` before `lr_scheduler.step()`.  Failure to do this will result in PyTorch skipping the first value of the learning rate schedule. See more details at https://pytorch.org/docs/stable/optim.html#how-to-adjust-learning-rate
  "https://pytorch.org/docs/stable/optim.html#how-to-adjust-learning-rate", UserWarning)
/w/246/tianyu2020/miniconda2/envs/ditto/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1221: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
=====sanity check======
words: COL title VAL expo dry erase eraserxl with replaceable pad felt 10w x 2d stationery & office machinery 12.19 COL category VAL  COL brand VAL expo COL modelno VAL  COL price VAL   [SEP] COL title VAL new-expo 8474 - dry erase eraserxl with replaceable pad felt 10w x 2d - san8474 COL category VAL radios COL brand VAL expo COL modelno VAL  COL price VAL 23.0 
x: [    0 18047  1270 27445  4553   139  3841 24300  3335 12425  1178   462
    19  3190   868 11212  1299   158   605  3023   132   417  1992  4270
   359   558 13922   316     4  1646 14857  4120 27445  1437 14857  1518
 27445  4553   139 14857  1421  2362 27445  1437 14857   425 27445  1437
  1437     2     2 18047  1270 27445    92    12  3463  5873   290 35761
   111  3841 24300  3335 12425  1178   462    19  3190   868 11212  1299
   158   605  3023   132   417   111 15610   398 35761 14857  4120 27445
 34442 14857  1518 27445  4553   139 14857  1421  2362 27445  1437 14857
   425 27445   883     4   288  1437     2]
tokens: ['<s>', 'COL', 'Ġtitle', 'ĠVAL', 'Ġexp', 'o', 'Ġdry', 'Ġerase', 'Ġer', 'aser', 'x', 'l', 'Ġwith', 'Ġreplace', 'able', 'Ġpad', 'Ġfelt', 'Ġ10', 'w', 'Ġx', 'Ġ2', 'd', 'Ġstation', 'ery', 'Ġ&', 'Ġoffice', 'Ġmachinery', 'Ġ12', '.', '19', 'ĠCOL', 'Ġcategory', 'ĠVAL', 'Ġ', 'ĠCOL', 'Ġbrand', 'ĠVAL', 'Ġexp', 'o', 'ĠCOL', 'Ġmodel', 'no', 'ĠVAL', 'Ġ', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ', 'Ġ', '</s>', '</s>', 'COL', 'Ġtitle', 'ĠVAL', 'Ġnew', '-', 'ex', 'po', 'Ġ8', '474', 'Ġ-', 'Ġdry', 'Ġerase', 'Ġer', 'aser', 'x', 'l', 'Ġwith', 'Ġreplace', 'able', 'Ġpad', 'Ġfelt', 'Ġ10', 'w', 'Ġx', 'Ġ2', 'd', 'Ġ-', 'Ġsan', '8', '474', 'ĠCOL', 'Ġcategory', 'ĠVAL', 'Ġradios', 'ĠCOL', 'Ġbrand', 'ĠVAL', 'Ġexp', 'o', 'ĠCOL', 'Ġmodel', 'no', 'ĠVAL', 'Ġ', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ23', '.', '0', 'Ġ', '</s>']
is_heads: [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
y: 1
tags: 1
mask: tensor([1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1])
seqlen: 103
task_name: Dirty/Walmart-Amazon
=======================
step: 0, task: Dirty/Walmart-Amazon, loss: 0.37872791290283203
step: 10, task: Dirty/Walmart-Amazon, loss: 0.2697114050388336
step: 20, task: Dirty/Walmart-Amazon, loss: 0.41227757930755615
step: 30, task: Dirty/Walmart-Amazon, loss: 0.02693212777376175
step: 40, task: Dirty/Walmart-Amazon, loss: 0.04445207118988037
step: 50, task: Dirty/Walmart-Amazon, loss: 0.014837563037872314
step: 60, task: Dirty/Walmart-Amazon, loss: 0.29817014932632446
step: 70, task: Dirty/Walmart-Amazon, loss: 0.29024577140808105
step: 80, task: Dirty/Walmart-Amazon, loss: 0.10650701820850372
step: 90, task: Dirty/Walmart-Amazon, loss: 0.18233001232147217
step: 100, task: Dirty/Walmart-Amazon, loss: 0.08601965010166168
step: 110, task: Dirty/Walmart-Amazon, loss: 0.015468500554561615
step: 120, task: Dirty/Walmart-Amazon, loss: 0.12760207056999207
step: 130, task: Dirty/Walmart-Amazon, loss: 0.09762836992740631
step: 140, task: Dirty/Walmart-Amazon, loss: 0.03461845964193344
step: 150, task: Dirty/Walmart-Amazon, loss: 0.00756131112575531
step: 160, task: Dirty/Walmart-Amazon, loss: 0.1657019704580307
step: 170, task: Dirty/Walmart-Amazon, loss: 0.3494930863380432
step: 180, task: Dirty/Walmart-Amazon, loss: 0.05690029263496399
step: 190, task: Dirty/Walmart-Amazon, loss: 0.01801389455795288
step: 200, task: Dirty/Walmart-Amazon, loss: 0.021612532436847687
step: 210, task: Dirty/Walmart-Amazon, loss: 0.11127841472625732
step: 220, task: Dirty/Walmart-Amazon, loss: 0.03570212423801422
step: 230, task: Dirty/Walmart-Amazon, loss: 0.036762334406375885
step: 240, task: Dirty/Walmart-Amazon, loss: 0.019434146583080292
step: 250, task: Dirty/Walmart-Amazon, loss: 0.19727638363838196
step: 260, task: Dirty/Walmart-Amazon, loss: 0.25000375509262085
step: 270, task: Dirty/Walmart-Amazon, loss: 0.061481572687625885
step: 280, task: Dirty/Walmart-Amazon, loss: 0.02513861656188965
step: 290, task: Dirty/Walmart-Amazon, loss: 0.012684695422649384
step: 300, task: Dirty/Walmart-Amazon, loss: 0.021504878997802734
step: 310, task: Dirty/Walmart-Amazon, loss: 0.039402518421411514
step: 320, task: Dirty/Walmart-Amazon, loss: 0.014628574252128601
step: 330, task: Dirty/Walmart-Amazon, loss: 0.12156389653682709
step: 340, task: Dirty/Walmart-Amazon, loss: 0.009404845535755157
step: 350, task: Dirty/Walmart-Amazon, loss: 0.020117342472076416
step: 360, task: Dirty/Walmart-Amazon, loss: 0.22372330725193024
step: 370, task: Dirty/Walmart-Amazon, loss: 0.10752324759960175
step: 380, task: Dirty/Walmart-Amazon, loss: 0.04462895542383194
=========eval at epoch=1=========
Validation:
=============Dirty/Walmart-Amazon==================
accuracy=0.906
precision=1.000
recall=0.005
f1=0.010
======================================
Test:
=============Dirty/Walmart-Amazon==================
accuracy=0.906
precision=0.667
recall=0.010
f1=0.020
======================================
=====sanity check======
words: COL title VAL sony 30mm 37mm wide end conversion lens photography - general sony COL category VAL  COL brand VAL  COL modelno VAL vclhge08b COL price VAL 75.38  [SEP] COL title VAL sony vclhge08b wide-end conversion lens for 37mm 30mm camcorders professional video accessories vclhge08b 60.0 COL category VAL  COL brand VAL sony COL modelno VAL  COL price VAL  
x: [    0 18047  1270 27445   579  6119   389  5471  2908  5471  1810   253
 10012 10373 11075   111   937   579  6119 14857  4120 27445  1437 14857
  1518 27445  1437 14857  1421  2362 27445   748  3998   298  1899  3669
   428 14857   425 27445  3337     4  3170  1437     2     2 18047  1270
 27445   579  6119   748  3998   298  1899  3669   428  1810    12  1397
 10012 10373    13  2908  5471   389  5471 11021   438 28436  2038   569
 10131   748  3998   298  1899  3669   428  1191     4   288 14857  4120
 27445  1437 14857  1518 27445   579  6119 14857  1421  2362 27445  1437
 14857   425 27445  1437  1437     2]
tokens: ['<s>', 'COL', 'Ġtitle', 'ĠVAL', 'Ġs', 'ony', 'Ġ30', 'mm', 'Ġ37', 'mm', 'Ġwide', 'Ġend', 'Ġconversion', 'Ġlens', 'Ġphotography', 'Ġ-', 'Ġgeneral', 'Ġs', 'ony', 'ĠCOL', 'Ġcategory', 'ĠVAL', 'Ġ', 'ĠCOL', 'Ġbrand', 'ĠVAL', 'Ġ', 'ĠCOL', 'Ġmodel', 'no', 'ĠVAL', 'Ġv', 'cl', 'h', 'ge', '08', 'b', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ75', '.', '38', 'Ġ', '</s>', '</s>', 'COL', 'Ġtitle', 'ĠVAL', 'Ġs', 'ony', 'Ġv', 'cl', 'h', 'ge', '08', 'b', 'Ġwide', '-', 'end', 'Ġconversion', 'Ġlens', 'Ġfor', 'Ġ37', 'mm', 'Ġ30', 'mm', 'Ġcam', 'c', 'orders', 'Ġprofessional', 'Ġvideo', 'Ġaccessories', 'Ġv', 'cl', 'h', 'ge', '08', 'b', 'Ġ60', '.', '0', 'ĠCOL', 'Ġcategory', 'ĠVAL', 'Ġ', 'ĠCOL', 'Ġbrand', 'ĠVAL', 'Ġs', 'ony', 'ĠCOL', 'Ġmodel', 'no', 'ĠVAL', 'Ġ', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ', 'Ġ', '</s>']
is_heads: [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
y: 1
tags: 1
mask: tensor([1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1])
seqlen: 102
task_name: Dirty/Walmart-Amazon
=======================
step: 0, task: Dirty/Walmart-Amazon, loss: 0.02240830659866333
step: 10, task: Dirty/Walmart-Amazon, loss: 0.0635773167014122
step: 20, task: Dirty/Walmart-Amazon, loss: 0.019556231796741486
step: 30, task: Dirty/Walmart-Amazon, loss: 0.010169439017772675
step: 40, task: Dirty/Walmart-Amazon, loss: 0.009002499282360077
step: 50, task: Dirty/Walmart-Amazon, loss: 0.005986616015434265
step: 60, task: Dirty/Walmart-Amazon, loss: 0.08707623183727264
step: 70, task: Dirty/Walmart-Amazon, loss: 0.08269233256578445
step: 80, task: Dirty/Walmart-Amazon, loss: 0.013768583536148071
step: 90, task: Dirty/Walmart-Amazon, loss: 0.014980234205722809
step: 100, task: Dirty/Walmart-Amazon, loss: 0.2595289945602417
step: 110, task: Dirty/Walmart-Amazon, loss: 0.4114413261413574
step: 120, task: Dirty/Walmart-Amazon, loss: 0.010089807212352753
step: 130, task: Dirty/Walmart-Amazon, loss: 0.017512783408164978
step: 140, task: Dirty/Walmart-Amazon, loss: 0.01143435388803482
step: 150, task: Dirty/Walmart-Amazon, loss: 0.34072184562683105
step: 160, task: Dirty/Walmart-Amazon, loss: 0.09801127016544342
step: 170, task: Dirty/Walmart-Amazon, loss: 0.06947851181030273
step: 180, task: Dirty/Walmart-Amazon, loss: 0.004837363958358765
step: 190, task: Dirty/Walmart-Amazon, loss: 0.0056473612785339355
step: 200, task: Dirty/Walmart-Amazon, loss: 0.06647717952728271
step: 210, task: Dirty/Walmart-Amazon, loss: 0.028483182191848755
step: 220, task: Dirty/Walmart-Amazon, loss: 0.03424903750419617
step: 230, task: Dirty/Walmart-Amazon, loss: 0.11640439927577972
step: 240, task: Dirty/Walmart-Amazon, loss: 0.004293069243431091
step: 250, task: Dirty/Walmart-Amazon, loss: 0.01383490115404129
step: 260, task: Dirty/Walmart-Amazon, loss: 0.04168947786092758
step: 270, task: Dirty/Walmart-Amazon, loss: 0.08851757645606995
step: 280, task: Dirty/Walmart-Amazon, loss: 0.005475766956806183
step: 290, task: Dirty/Walmart-Amazon, loss: 0.04661979526281357
step: 300, task: Dirty/Walmart-Amazon, loss: 0.3412550091743469
step: 310, task: Dirty/Walmart-Amazon, loss: 0.26915526390075684
step: 320, task: Dirty/Walmart-Amazon, loss: 0.018229052424430847
step: 330, task: Dirty/Walmart-Amazon, loss: 0.041444458067417145
step: 340, task: Dirty/Walmart-Amazon, loss: 0.002099260687828064
step: 350, task: Dirty/Walmart-Amazon, loss: 0.4501098394393921
step: 360, task: Dirty/Walmart-Amazon, loss: 0.014981798827648163
step: 370, task: Dirty/Walmart-Amazon, loss: 0.010007008910179138
step: 380, task: Dirty/Walmart-Amazon, loss: 0.008276611566543579
=========eval at epoch=2=========
Validation:
=============Dirty/Walmart-Amazon==================
accuracy=0.907
precision=1.000
recall=0.010
f1=0.021
======================================
Test:
=============Dirty/Walmart-Amazon==================
accuracy=0.907
precision=1.000
recall=0.016
f1=0.031
======================================
=====sanity check======
words: COL title VAL griffin ipod touch 4g formfit case black clear COL category VAL mp3 accessories COL brand VAL arkon COL modelno VAL gb01957 COL price VAL 17.13  [SEP] COL title VAL philips silicone case two-pack for ipod touch 4g black clear cases dla4217/17 COL category VAL  COL brand VAL philips COL modelno VAL  COL price VAL 13.03 
x: [    0 18047  1270 27445  4435 31570 36180  1630  2842   204   571  1026
 14307   403   909   699 14857  4120 27445 44857   246 10131 14857  1518
 27445  4709   330   261 14857  1421  2362 27445   821   428 36632  4390
 14857   425 27445   601     4  1558  1437     2     2 18047  1270 27445
 43091  7418 35453   403    80    12 12486    13 36180  1630  2842   204
   571   909   699  1200   385  2560  3714  1360    73  1360 14857  4120
 27445  1437 14857  1518 27445 43091  7418 14857  1421  2362 27445  1437
 14857   425 27445   508     4  3933  1437     2]
tokens: ['<s>', 'COL', 'Ġtitle', 'ĠVAL', 'Ġgr', 'iffin', 'Ġip', 'od', 'Ġtouch', 'Ġ4', 'g', 'Ġform', 'fit', 'Ġcase', 'Ġblack', 'Ġclear', 'ĠCOL', 'Ġcategory', 'ĠVAL', 'Ġmp', '3', 'Ġaccessories', 'ĠCOL', 'Ġbrand', 'ĠVAL', 'Ġar', 'k', 'on', 'ĠCOL', 'Ġmodel', 'no', 'ĠVAL', 'Ġg', 'b', '019', '57', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ17', '.', '13', 'Ġ', '</s>', '</s>', 'COL', 'Ġtitle', 'ĠVAL', 'Ġphil', 'ips', 'Ġsilicone', 'Ġcase', 'Ġtwo', '-', 'pack', 'Ġfor', 'Ġip', 'od', 'Ġtouch', 'Ġ4', 'g', 'Ġblack', 'Ġclear', 'Ġcases', 'Ġd', 'la', '42', '17', '/', '17', 'ĠCOL', 'Ġcategory', 'ĠVAL', 'Ġ', 'ĠCOL', 'Ġbrand', 'ĠVAL', 'Ġphil', 'ips', 'ĠCOL', 'Ġmodel', 'no', 'ĠVAL', 'Ġ', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ13', '.', '03', 'Ġ', '</s>']
is_heads: [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
y: 0
tags: 0
mask: tensor([1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1])
seqlen: 92
task_name: Dirty/Walmart-Amazon
=======================
step: 0, task: Dirty/Walmart-Amazon, loss: 0.010757572948932648
step: 10, task: Dirty/Walmart-Amazon, loss: 0.0010271668434143066
step: 20, task: Dirty/Walmart-Amazon, loss: 0.005515247583389282
step: 30, task: Dirty/Walmart-Amazon, loss: 0.0005663484334945679
step: 40, task: Dirty/Walmart-Amazon, loss: 0.057974208146333694
step: 50, task: Dirty/Walmart-Amazon, loss: 0.06107714772224426
step: 60, task: Dirty/Walmart-Amazon, loss: 0.016232870519161224
step: 70, task: Dirty/Walmart-Amazon, loss: 0.02198297530412674
step: 80, task: Dirty/Walmart-Amazon, loss: 0.008108995854854584
step: 90, task: Dirty/Walmart-Amazon, loss: 0.0056056976318359375
step: 100, task: Dirty/Walmart-Amazon, loss: 0.044544413685798645
step: 110, task: Dirty/Walmart-Amazon, loss: 0.03566967695951462
step: 120, task: Dirty/Walmart-Amazon, loss: 0.002989038825035095
step: 130, task: Dirty/Walmart-Amazon, loss: 0.0051728710532188416
step: 140, task: Dirty/Walmart-Amazon, loss: 0.04667823016643524
step: 150, task: Dirty/Walmart-Amazon, loss: 0.03978949040174484
step: 160, task: Dirty/Walmart-Amazon, loss: 0.03351730480790138
step: 170, task: Dirty/Walmart-Amazon, loss: 0.006197676062583923
step: 180, task: Dirty/Walmart-Amazon, loss: 0.013175815343856812
step: 190, task: Dirty/Walmart-Amazon, loss: 0.2502284049987793
step: 200, task: Dirty/Walmart-Amazon, loss: 0.013048015534877777
step: 210, task: Dirty/Walmart-Amazon, loss: 0.026557795703411102
step: 220, task: Dirty/Walmart-Amazon, loss: 0.04579285532236099
step: 230, task: Dirty/Walmart-Amazon, loss: 0.0077154263854026794
step: 240, task: Dirty/Walmart-Amazon, loss: 0.04943142086267471
step: 250, task: Dirty/Walmart-Amazon, loss: 0.08472706377506256
step: 260, task: Dirty/Walmart-Amazon, loss: 0.01672762632369995
step: 270, task: Dirty/Walmart-Amazon, loss: 0.001943543553352356
step: 280, task: Dirty/Walmart-Amazon, loss: 0.005122125148773193
step: 290, task: Dirty/Walmart-Amazon, loss: 0.004345044493675232
step: 300, task: Dirty/Walmart-Amazon, loss: 0.008133605122566223
step: 310, task: Dirty/Walmart-Amazon, loss: 0.0009520053863525391
step: 320, task: Dirty/Walmart-Amazon, loss: 0.0030990689992904663
step: 330, task: Dirty/Walmart-Amazon, loss: 0.007114432752132416
step: 340, task: Dirty/Walmart-Amazon, loss: 0.4613434076309204
step: 350, task: Dirty/Walmart-Amazon, loss: 0.04822128266096115
step: 360, task: Dirty/Walmart-Amazon, loss: 0.01253288984298706
step: 370, task: Dirty/Walmart-Amazon, loss: 0.009007222950458527
step: 380, task: Dirty/Walmart-Amazon, loss: 0.018869325518608093
=========eval at epoch=3=========
Validation:
=============Dirty/Walmart-Amazon==================
accuracy=0.912
precision=0.800
recall=0.083
f1=0.150
======================================
Test:
=============Dirty/Walmart-Amazon==================
accuracy=0.912
precision=0.875
recall=0.073
f1=0.134
======================================
=====sanity check======
words: COL title VAL lexmark x644a11a black toner print cartridge COL category VAL stationery & office machinery COL brand VAL lexmark COL modelno VAL x644a11a COL price VAL 326.24  [SEP] COL title VAL lexmark 32 black print cartridge twin pack 18c0533 18c0532 COL category VAL inkjet printer ink COL brand VAL lexmark COL modelno VAL  COL price VAL 39.12 
x: [    0 18047  1270 27445 36912  6920  3023 36520   102  1225   102   909
  4866   254  5780 41785 14857  4120 27445  1992  4270   359   558 13922
 14857  1518 27445 36912  6920 14857  1421  2362 27445  3023 36520   102
  1225   102 14857   425 27445 36871     4  1978  1437     2     2 18047
  1270 27445 36912  6920  2107   909  5780 41785  9544  6356   504   438
  2546  3103   504   438  2546  2881 14857  4120 27445 16019  6622 24079
 16019 14857  1518 27445 36912  6920 14857  1421  2362 27445  1437 14857
   425 27445  3191     4  1092  1437     2]
tokens: ['<s>', 'COL', 'Ġtitle', 'ĠVAL', 'Ġlex', 'mark', 'Ġx', '644', 'a', '11', 'a', 'Ġblack', 'Ġton', 'er', 'Ġprint', 'Ġcartridge', 'ĠCOL', 'Ġcategory', 'ĠVAL', 'Ġstation', 'ery', 'Ġ&', 'Ġoffice', 'Ġmachinery', 'ĠCOL', 'Ġbrand', 'ĠVAL', 'Ġlex', 'mark', 'ĠCOL', 'Ġmodel', 'no', 'ĠVAL', 'Ġx', '644', 'a', '11', 'a', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ326', '.', '24', 'Ġ', '</s>', '</s>', 'COL', 'Ġtitle', 'ĠVAL', 'Ġlex', 'mark', 'Ġ32', 'Ġblack', 'Ġprint', 'Ġcartridge', 'Ġtwin', 'Ġpack', 'Ġ18', 'c', '05', '33', 'Ġ18', 'c', '05', '32', 'ĠCOL', 'Ġcategory', 'ĠVAL', 'Ġink', 'jet', 'Ġprinter', 'Ġink', 'ĠCOL', 'Ġbrand', 'ĠVAL', 'Ġlex', 'mark', 'ĠCOL', 'Ġmodel', 'no', 'ĠVAL', 'Ġ', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ39', '.', '12', 'Ġ', '</s>']
is_heads: [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
y: 0
tags: 0
mask: tensor([1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1])
seqlen: 91
task_name: Dirty/Walmart-Amazon
=======================
step: 0, task: Dirty/Walmart-Amazon, loss: 0.0029738545417785645
step: 10, task: Dirty/Walmart-Amazon, loss: 0.052060566842556
step: 20, task: Dirty/Walmart-Amazon, loss: 0.0030220001935958862
step: 30, task: Dirty/Walmart-Amazon, loss: 0.07288721203804016
step: 40, task: Dirty/Walmart-Amazon, loss: 0.005041062831878662
step: 50, task: Dirty/Walmart-Amazon, loss: 0.18385709822177887
step: 60, task: Dirty/Walmart-Amazon, loss: 0.009349599480628967
step: 70, task: Dirty/Walmart-Amazon, loss: 0.0002589672803878784
step: 80, task: Dirty/Walmart-Amazon, loss: 0.0020134001970291138
step: 90, task: Dirty/Walmart-Amazon, loss: 0.0068118274211883545
step: 100, task: Dirty/Walmart-Amazon, loss: 0.0015334635972976685
step: 110, task: Dirty/Walmart-Amazon, loss: 0.02412155270576477
step: 120, task: Dirty/Walmart-Amazon, loss: 0.01894131302833557
step: 130, task: Dirty/Walmart-Amazon, loss: 0.004697456955909729
step: 140, task: Dirty/Walmart-Amazon, loss: 0.004377968609333038
step: 150, task: Dirty/Walmart-Amazon, loss: 0.4575561285018921
step: 160, task: Dirty/Walmart-Amazon, loss: 0.12575125694274902
step: 170, task: Dirty/Walmart-Amazon, loss: 0.0025921612977981567
step: 180, task: Dirty/Walmart-Amazon, loss: 0.00180034339427948
step: 190, task: Dirty/Walmart-Amazon, loss: 0.00683380663394928
step: 200, task: Dirty/Walmart-Amazon, loss: 0.006808936595916748
step: 210, task: Dirty/Walmart-Amazon, loss: 0.003379605710506439
step: 220, task: Dirty/Walmart-Amazon, loss: 0.003275543451309204
step: 230, task: Dirty/Walmart-Amazon, loss: 0.06480596959590912
step: 240, task: Dirty/Walmart-Amazon, loss: 0.03245534002780914
step: 250, task: Dirty/Walmart-Amazon, loss: 0.009227372705936432
step: 260, task: Dirty/Walmart-Amazon, loss: 0.0016449689865112305
step: 270, task: Dirty/Walmart-Amazon, loss: 0.012657985091209412
step: 280, task: Dirty/Walmart-Amazon, loss: 0.005668766796588898
step: 290, task: Dirty/Walmart-Amazon, loss: 0.008080430328845978
step: 300, task: Dirty/Walmart-Amazon, loss: 0.22256654500961304
step: 310, task: Dirty/Walmart-Amazon, loss: 0.001212581992149353
step: 320, task: Dirty/Walmart-Amazon, loss: 0.0097593292593956
step: 330, task: Dirty/Walmart-Amazon, loss: 0.007241062819957733
step: 340, task: Dirty/Walmart-Amazon, loss: 0.0031735673546791077
step: 350, task: Dirty/Walmart-Amazon, loss: 0.0017749220132827759
step: 360, task: Dirty/Walmart-Amazon, loss: 0.0490797683596611
step: 370, task: Dirty/Walmart-Amazon, loss: 0.026662342250347137
step: 380, task: Dirty/Walmart-Amazon, loss: 0.023804932832717896
=========eval at epoch=4=========
Validation:
=============Dirty/Walmart-Amazon==================
accuracy=0.912
precision=0.875
recall=0.073
f1=0.134
======================================
Test:
=============Dirty/Walmart-Amazon==================
accuracy=0.911
precision=0.857
recall=0.062
f1=0.116
======================================
=====sanity check======
words: COL title VAL panasonic slimz over-ear headphone black pink rp-hx40-pk panasonic COL category VAL electronics - general COL brand VAL  COL modelno VAL rp-hx40-pk COL price VAL 34.88  [SEP] COL title VAL panasonic rp-hje350-p slimz in-ear earbud headphones pink headphones panasonic COL category VAL  COL brand VAL  COL modelno VAL rp-hje350-p COL price VAL 17.19 
x: [    0 18047  1270 27445  5730 38703 11875   329    81    12  4352 27671
   909  6907   910   642    12   298  1178  1749    12   642   330  5730
 38703 14857  4120 27445  8917   111   937 14857  1518 27445  1437 14857
  1421  2362 27445   910   642    12   298  1178  1749    12   642   330
 14857   425 27445  2631     4  4652  1437     2     2 18047  1270 27445
  5730 38703   910   642    12   298  2359 10056    12   642 11875   329
    11    12  4352  5567   428  1906 15684  6907 15684  5730 38703 14857
  4120 27445  1437 14857  1518 27445  1437 14857  1421  2362 27445   910
   642    12   298  2359 10056    12   642 14857   425 27445   601     4
  1646  1437     2]
tokens: ['<s>', 'COL', 'Ġtitle', 'ĠVAL', 'Ġpan', 'asonic', 'Ġslim', 'z', 'Ġover', '-', 'ear', 'Ġheadphone', 'Ġblack', 'Ġpink', 'Ġr', 'p', '-', 'h', 'x', '40', '-', 'p', 'k', 'Ġpan', 'asonic', 'ĠCOL', 'Ġcategory', 'ĠVAL', 'Ġelectronics', 'Ġ-', 'Ġgeneral', 'ĠCOL', 'Ġbrand', 'ĠVAL', 'Ġ', 'ĠCOL', 'Ġmodel', 'no', 'ĠVAL', 'Ġr', 'p', '-', 'h', 'x', '40', '-', 'p', 'k', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ34', '.', '88', 'Ġ', '</s>', '</s>', 'COL', 'Ġtitle', 'ĠVAL', 'Ġpan', 'asonic', 'Ġr', 'p', '-', 'h', 'je', '350', '-', 'p', 'Ġslim', 'z', 'Ġin', '-', 'ear', 'Ġear', 'b', 'ud', 'Ġheadphones', 'Ġpink', 'Ġheadphones', 'Ġpan', 'asonic', 'ĠCOL', 'Ġcategory', 'ĠVAL', 'Ġ', 'ĠCOL', 'Ġbrand', 'ĠVAL', 'Ġ', 'ĠCOL', 'Ġmodel', 'no', 'ĠVAL', 'Ġr', 'p', '-', 'h', 'je', '350', '-', 'p', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ17', '.', '19', 'Ġ', '</s>']
is_heads: [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
y: 0
tags: 0
mask: tensor([1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1])
seqlen: 111
task_name: Dirty/Walmart-Amazon
=======================
step: 0, task: Dirty/Walmart-Amazon, loss: 0.009333401918411255
step: 10, task: Dirty/Walmart-Amazon, loss: 0.0036952048540115356
step: 20, task: Dirty/Walmart-Amazon, loss: 0.0030013322830200195
step: 30, task: Dirty/Walmart-Amazon, loss: 0.0005122721195220947
step: 40, task: Dirty/Walmart-Amazon, loss: 0.006215624511241913
step: 50, task: Dirty/Walmart-Amazon, loss: 0.014200598001480103
step: 60, task: Dirty/Walmart-Amazon, loss: 0.004530481994152069
step: 70, task: Dirty/Walmart-Amazon, loss: 0.0010780692100524902
step: 80, task: Dirty/Walmart-Amazon, loss: 0.003117501735687256
step: 90, task: Dirty/Walmart-Amazon, loss: 0.0012348592281341553
step: 100, task: Dirty/Walmart-Amazon, loss: 0.012891001999378204
step: 110, task: Dirty/Walmart-Amazon, loss: 0.00102292001247406
step: 120, task: Dirty/Walmart-Amazon, loss: 0.000906720757484436
step: 130, task: Dirty/Walmart-Amazon, loss: 0.0007134079933166504
step: 140, task: Dirty/Walmart-Amazon, loss: 0.0003328472375869751
step: 150, task: Dirty/Walmart-Amazon, loss: 0.0019912272691726685
step: 160, task: Dirty/Walmart-Amazon, loss: 0.002485230565071106
step: 170, task: Dirty/Walmart-Amazon, loss: 0.0005524754524230957
step: 180, task: Dirty/Walmart-Amazon, loss: 0.0017593801021575928
Gradient overflow.  Skipping step, loss scaler 0 reducing loss scale to 4096.0
step: 190, task: Dirty/Walmart-Amazon, loss: 0.00145016610622406
step: 200, task: Dirty/Walmart-Amazon, loss: 0.0008689165115356445
step: 210, task: Dirty/Walmart-Amazon, loss: 0.0012595504522323608
step: 220, task: Dirty/Walmart-Amazon, loss: 0.002078816294670105
step: 230, task: Dirty/Walmart-Amazon, loss: 0.00046181678771972656
step: 240, task: Dirty/Walmart-Amazon, loss: 0.11911104619503021
step: 250, task: Dirty/Walmart-Amazon, loss: 0.07184681296348572
step: 260, task: Dirty/Walmart-Amazon, loss: 0.002242058515548706
step: 270, task: Dirty/Walmart-Amazon, loss: 0.003465026617050171
step: 280, task: Dirty/Walmart-Amazon, loss: 0.0036809295415878296
step: 290, task: Dirty/Walmart-Amazon, loss: 0.13997523486614227
step: 300, task: Dirty/Walmart-Amazon, loss: 0.1445913463830948
step: 310, task: Dirty/Walmart-Amazon, loss: 0.005422115325927734
step: 320, task: Dirty/Walmart-Amazon, loss: 0.012788169085979462
step: 330, task: Dirty/Walmart-Amazon, loss: 0.004436396062374115
step: 340, task: Dirty/Walmart-Amazon, loss: 0.007492385804653168
step: 350, task: Dirty/Walmart-Amazon, loss: 0.013038069009780884
step: 360, task: Dirty/Walmart-Amazon, loss: 0.003403864800930023
step: 370, task: Dirty/Walmart-Amazon, loss: 0.0017841160297393799
step: 380, task: Dirty/Walmart-Amazon, loss: 0.10855956375598907
=========eval at epoch=5=========
Validation:
=============Dirty/Walmart-Amazon==================
accuracy=0.913
precision=0.800
recall=0.104
f1=0.183
======================================
Test:
=============Dirty/Walmart-Amazon==================
accuracy=0.916
precision=0.769
recall=0.155
f1=0.259
======================================
=====sanity check======
words: COL title VAL lexar media lsd4gbasbna 4gb secure digital high capacity sdhc card lsd4gbasbna COL category VAL usb drives COL brand VAL lexar media COL modelno VAL  COL price VAL 14.88  [SEP] COL title VAL v7 4gb sd card secure digital high capacity 4 gb memory card memory cards COL category VAL  COL brand VAL v7 COL modelno VAL vasdh4gcl4r-1n COL price VAL 9.99 
x: [    0 18047  1270 27445 36912   271   433   784 28045   306   571 15609
   428  2133   204 19562  2823  1778   239  2148   579 16593   438  1886
   784 28045   306   571 15609   428  2133 14857  4120 27445 49030  6790
 14857  1518 27445 36912   271   433 14857  1421  2362 27445  1437 14857
   425 27445   501     4  4652  1437     2     2 18047  1270 27445   748
   406   204 19562 46409  1886  2823  1778   239  2148   204   821   428
  3783  1886  3783  3591 14857  4120 27445  1437 14857  1518 27445   748
   406 14857  1421  2362 27445 37345 16593   306   571  3998   306   338
    12   134   282 14857   425 27445   361     4  2831  1437     2]
tokens: ['<s>', 'COL', 'Ġtitle', 'ĠVAL', 'Ġlex', 'ar', 'Ġmedia', 'Ġl', 'sd', '4', 'g', 'bas', 'b', 'na', 'Ġ4', 'gb', 'Ġsecure', 'Ġdigital', 'Ġhigh', 'Ġcapacity', 'Ġs', 'dh', 'c', 'Ġcard', 'Ġl', 'sd', '4', 'g', 'bas', 'b', 'na', 'ĠCOL', 'Ġcategory', 'ĠVAL', 'Ġusb', 'Ġdrives', 'ĠCOL', 'Ġbrand', 'ĠVAL', 'Ġlex', 'ar', 'Ġmedia', 'ĠCOL', 'Ġmodel', 'no', 'ĠVAL', 'Ġ', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ14', '.', '88', 'Ġ', '</s>', '</s>', 'COL', 'Ġtitle', 'ĠVAL', 'Ġv', '7', 'Ġ4', 'gb', 'Ġsd', 'Ġcard', 'Ġsecure', 'Ġdigital', 'Ġhigh', 'Ġcapacity', 'Ġ4', 'Ġg', 'b', 'Ġmemory', 'Ġcard', 'Ġmemory', 'Ġcards', 'ĠCOL', 'Ġcategory', 'ĠVAL', 'Ġ', 'ĠCOL', 'Ġbrand', 'ĠVAL', 'Ġv', '7', 'ĠCOL', 'Ġmodel', 'no', 'ĠVAL', 'Ġvas', 'dh', '4', 'g', 'cl', '4', 'r', '-', '1', 'n', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ9', '.', '99', 'Ġ', '</s>']
is_heads: [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
y: 0
tags: 0
mask: tensor([1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1])
seqlen: 107
task_name: Dirty/Walmart-Amazon
=======================
step: 0, task: Dirty/Walmart-Amazon, loss: 0.06781607866287231
step: 10, task: Dirty/Walmart-Amazon, loss: 0.0026684924960136414
step: 20, task: Dirty/Walmart-Amazon, loss: 0.0013195127248764038
step: 30, task: Dirty/Walmart-Amazon, loss: 0.001413583755493164
step: 40, task: Dirty/Walmart-Amazon, loss: 0.003106914460659027
step: 50, task: Dirty/Walmart-Amazon, loss: 0.0036271512508392334
step: 60, task: Dirty/Walmart-Amazon, loss: 0.0044947341084480286
step: 70, task: Dirty/Walmart-Amazon, loss: 0.0009363889694213867
step: 80, task: Dirty/Walmart-Amazon, loss: 0.0007510930299758911
step: 90, task: Dirty/Walmart-Amazon, loss: 0.00018323957920074463
step: 100, task: Dirty/Walmart-Amazon, loss: 0.08693521469831467
step: 110, task: Dirty/Walmart-Amazon, loss: 0.0010367333889007568
step: 120, task: Dirty/Walmart-Amazon, loss: 0.001131102442741394
step: 130, task: Dirty/Walmart-Amazon, loss: 0.016262754797935486
step: 140, task: Dirty/Walmart-Amazon, loss: 0.0007233321666717529
step: 150, task: Dirty/Walmart-Amazon, loss: 0.0011431872844696045
step: 160, task: Dirty/Walmart-Amazon, loss: 0.002445504069328308
step: 170, task: Dirty/Walmart-Amazon, loss: 0.0010108202695846558
step: 180, task: Dirty/Walmart-Amazon, loss: 0.0019012391567230225
step: 190, task: Dirty/Walmart-Amazon, loss: 0.0029032453894615173
step: 200, task: Dirty/Walmart-Amazon, loss: 0.0011538416147232056
step: 210, task: Dirty/Walmart-Amazon, loss: 0.0015142560005187988
step: 220, task: Dirty/Walmart-Amazon, loss: 0.0039005279541015625
step: 230, task: Dirty/Walmart-Amazon, loss: 0.0019833892583847046
step: 240, task: Dirty/Walmart-Amazon, loss: 0.0030616000294685364
step: 250, task: Dirty/Walmart-Amazon, loss: 0.000953972339630127
step: 260, task: Dirty/Walmart-Amazon, loss: 0.004150688648223877
step: 270, task: Dirty/Walmart-Amazon, loss: 0.0002839714288711548
step: 280, task: Dirty/Walmart-Amazon, loss: 0.0010295510292053223
step: 290, task: Dirty/Walmart-Amazon, loss: 0.00099259614944458
step: 300, task: Dirty/Walmart-Amazon, loss: 0.0001771003007888794
step: 310, task: Dirty/Walmart-Amazon, loss: 0.00032323598861694336
step: 320, task: Dirty/Walmart-Amazon, loss: 0.0002151578664779663
step: 330, task: Dirty/Walmart-Amazon, loss: 0.002152577042579651
step: 340, task: Dirty/Walmart-Amazon, loss: 0.0004523545503616333
step: 350, task: Dirty/Walmart-Amazon, loss: 0.031125761568546295
step: 360, task: Dirty/Walmart-Amazon, loss: 0.000279352068901062
step: 370, task: Dirty/Walmart-Amazon, loss: 0.013664402067661285
step: 380, task: Dirty/Walmart-Amazon, loss: 0.005896821618080139
=========eval at epoch=6=========
Validation:
=============Dirty/Walmart-Amazon==================
accuracy=0.909
precision=0.818
recall=0.047
f1=0.088
======================================
Test:
=============Dirty/Walmart-Amazon==================
accuracy=0.910
precision=1.000
recall=0.047
f1=0.089
======================================
=====sanity check======
words: COL title VAL kodak easyshare c195 red 14.0 mp digital camera w bonus case bundle 5x optical zoom 3.0 lcd smart capture w 50 bonus prints digital cameras COL category VAL  COL brand VAL kodak COL modelno VAL c195 red bndle COL price VAL 79.0  [SEP] COL title VAL kodak easyshare c183 14mp digital camera w 3x optical zoom 3.0 inch lcd black kodak 79.99 COL category VAL point shoot digital cameras COL brand VAL  COL modelno VAL  COL price VAL  
x: [    0 18047  1270 27445   449  1630   677 29521  2459 33719   740 23688
  1275   501     4   288 44857  1778  2280   885  7944   403 19489   195
  1178 17547 21762   155     4   288   784 28690  2793  5604   885   654
  7944 19553  1778  4387 14857  4120 27445  1437 14857  1518 27445   449
  1630   677 14857  1421  2362 27445   740 23688  1275   741  1187   459
 14857   425 27445  7589     4   288  1437     2     2 18047  1270 27445
   449  1630   677 29521  2459 33719   740 30662   501  6195  1778  2280
   885   155  1178 17547 21762   155     4   288 10468   784 28690   909
   449  1630   677  7589     4  2831 14857  4120 27445   477  4511  1778
  4387 14857  1518 27445  1437 14857  1421  2362 27445  1437 14857   425
 27445  1437  1437     2]
tokens: ['<s>', 'COL', 'Ġtitle', 'ĠVAL', 'Ġk', 'od', 'ak', 'Ġeas', 'ys', 'hare', 'Ġc', '195', 'Ġred', 'Ġ14', '.', '0', 'Ġmp', 'Ġdigital', 'Ġcamera', 'Ġw', 'Ġbonus', 'Ġcase', 'Ġbundle', 'Ġ5', 'x', 'Ġoptical', 'Ġzoom', 'Ġ3', '.', '0', 'Ġl', 'cd', 'Ġsmart', 'Ġcapture', 'Ġw', 'Ġ50', 'Ġbonus', 'Ġprints', 'Ġdigital', 'Ġcameras', 'ĠCOL', 'Ġcategory', 'ĠVAL', 'Ġ', 'ĠCOL', 'Ġbrand', 'ĠVAL', 'Ġk', 'od', 'ak', 'ĠCOL', 'Ġmodel', 'no', 'ĠVAL', 'Ġc', '195', 'Ġred', 'Ġb', 'nd', 'le', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ79', '.', '0', 'Ġ', '</s>', '</s>', 'COL', 'Ġtitle', 'ĠVAL', 'Ġk', 'od', 'ak', 'Ġeas', 'ys', 'hare', 'Ġc', '183', 'Ġ14', 'mp', 'Ġdigital', 'Ġcamera', 'Ġw', 'Ġ3', 'x', 'Ġoptical', 'Ġzoom', 'Ġ3', '.', '0', 'Ġinch', 'Ġl', 'cd', 'Ġblack', 'Ġk', 'od', 'ak', 'Ġ79', '.', '99', 'ĠCOL', 'Ġcategory', 'ĠVAL', 'Ġpoint', 'Ġshoot', 'Ġdigital', 'Ġcameras', 'ĠCOL', 'Ġbrand', 'ĠVAL', 'Ġ', 'ĠCOL', 'Ġmodel', 'no', 'ĠVAL', 'Ġ', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ', 'Ġ', '</s>']
is_heads: [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
y: 0
tags: 0
mask: tensor([1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1])
seqlen: 124
task_name: Dirty/Walmart-Amazon
=======================
step: 0, task: Dirty/Walmart-Amazon, loss: 0.004418179392814636
step: 10, task: Dirty/Walmart-Amazon, loss: 0.013293042778968811
step: 20, task: Dirty/Walmart-Amazon, loss: 0.001041695475578308
step: 30, task: Dirty/Walmart-Amazon, loss: 0.003457799553871155
step: 40, task: Dirty/Walmart-Amazon, loss: 0.007750563323497772
step: 50, task: Dirty/Walmart-Amazon, loss: 0.0018159449100494385
step: 60, task: Dirty/Walmart-Amazon, loss: 0.35152414441108704
step: 70, task: Dirty/Walmart-Amazon, loss: 0.012244723737239838
step: 80, task: Dirty/Walmart-Amazon, loss: 0.0006391257047653198
step: 90, task: Dirty/Walmart-Amazon, loss: 0.0008370727300643921
step: 100, task: Dirty/Walmart-Amazon, loss: 0.009072378277778625
step: 110, task: Dirty/Walmart-Amazon, loss: 0.0009113103151321411
step: 120, task: Dirty/Walmart-Amazon, loss: 0.3007858693599701
step: 130, task: Dirty/Walmart-Amazon, loss: 0.024952314794063568
step: 140, task: Dirty/Walmart-Amazon, loss: 0.0008788555860519409
step: 150, task: Dirty/Walmart-Amazon, loss: 0.001146569848060608
step: 160, task: Dirty/Walmart-Amazon, loss: 0.0012029707431793213
step: 170, task: Dirty/Walmart-Amazon, loss: 0.00460459291934967
step: 180, task: Dirty/Walmart-Amazon, loss: 0.0005860328674316406
step: 190, task: Dirty/Walmart-Amazon, loss: 0.0017805099487304688
step: 200, task: Dirty/Walmart-Amazon, loss: 0.00028468668460845947
step: 210, task: Dirty/Walmart-Amazon, loss: 0.0057562366127967834
step: 220, task: Dirty/Walmart-Amazon, loss: 0.00037436187267303467
step: 230, task: Dirty/Walmart-Amazon, loss: 0.0012514740228652954
step: 240, task: Dirty/Walmart-Amazon, loss: 0.04831486940383911
step: 250, task: Dirty/Walmart-Amazon, loss: 0.003942519426345825
step: 260, task: Dirty/Walmart-Amazon, loss: 0.0006428509950637817
step: 270, task: Dirty/Walmart-Amazon, loss: 0.000425189733505249
step: 280, task: Dirty/Walmart-Amazon, loss: 0.0021821558475494385
step: 290, task: Dirty/Walmart-Amazon, loss: 0.00400938093662262
step: 300, task: Dirty/Walmart-Amazon, loss: 0.0008769184350967407
step: 310, task: Dirty/Walmart-Amazon, loss: 0.0005657076835632324
step: 320, task: Dirty/Walmart-Amazon, loss: 0.0034446418285369873
step: 330, task: Dirty/Walmart-Amazon, loss: 0.009713247418403625
step: 340, task: Dirty/Walmart-Amazon, loss: 0.0017910301685333252
step: 350, task: Dirty/Walmart-Amazon, loss: 0.0006028115749359131
step: 360, task: Dirty/Walmart-Amazon, loss: 0.0009526908397674561
step: 370, task: Dirty/Walmart-Amazon, loss: 0.057219356298446655
step: 380, task: Dirty/Walmart-Amazon, loss: 0.0011258721351623535
=========eval at epoch=7=========
Validation:
=============Dirty/Walmart-Amazon==================
accuracy=0.912
precision=0.929
recall=0.067
f1=0.126
======================================
Test:
=============Dirty/Walmart-Amazon==================
accuracy=0.911
precision=0.923
recall=0.062
f1=0.117
======================================
=====sanity check======
words: COL title VAL logitech m315 wireless optical mouse blue mice COL category VAL  COL brand VAL logitech COL modelno VAL m315 COL price VAL 19.88  [SEP] COL title VAL verbatim 97593 ergo wireless desktop optical mouse blue mice 24.02 COL category VAL  COL brand VAL verbatim COL modelno VAL 97593 COL price VAL  
x: [    0 18047  1270 27445  7425 30051   475 28355  6955 17547 18292  2440
 15540 14857  4120 27445  1437 14857  1518 27445  7425 30051 14857  1421
  2362 27445   475 28355 14857   425 27445   753     4  4652  1437     2
     2 18047  1270 27445  4342 12161   757   361  2545  6478  3335  2977
  6955 14050 17547 18292  2440 15540   706     4  4197 14857  4120 27445
  1437 14857  1518 27445  4342 12161   757 14857  1421  2362 27445   361
  2545  6478 14857   425 27445  1437  1437     2]
tokens: ['<s>', 'COL', 'Ġtitle', 'ĠVAL', 'Ġlog', 'itech', 'Ġm', '315', 'Ġwireless', 'Ġoptical', 'Ġmouse', 'Ġblue', 'Ġmice', 'ĠCOL', 'Ġcategory', 'ĠVAL', 'Ġ', 'ĠCOL', 'Ġbrand', 'ĠVAL', 'Ġlog', 'itech', 'ĠCOL', 'Ġmodel', 'no', 'ĠVAL', 'Ġm', '315', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ19', '.', '88', 'Ġ', '</s>', '</s>', 'COL', 'Ġtitle', 'ĠVAL', 'Ġver', 'bat', 'im', 'Ġ9', '75', '93', 'Ġer', 'go', 'Ġwireless', 'Ġdesktop', 'Ġoptical', 'Ġmouse', 'Ġblue', 'Ġmice', 'Ġ24', '.', '02', 'ĠCOL', 'Ġcategory', 'ĠVAL', 'Ġ', 'ĠCOL', 'Ġbrand', 'ĠVAL', 'Ġver', 'bat', 'im', 'ĠCOL', 'Ġmodel', 'no', 'ĠVAL', 'Ġ9', '75', '93', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ', 'Ġ', '</s>']
is_heads: [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
y: 0
tags: 0
mask: tensor([1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1])
seqlen: 80
task_name: Dirty/Walmart-Amazon
=======================
step: 0, task: Dirty/Walmart-Amazon, loss: 0.06136263161897659
step: 10, task: Dirty/Walmart-Amazon, loss: 0.0019198805093765259
step: 20, task: Dirty/Walmart-Amazon, loss: 0.010109871625900269
step: 30, task: Dirty/Walmart-Amazon, loss: 0.0049273669719696045
step: 40, task: Dirty/Walmart-Amazon, loss: 8.055567741394043e-05
step: 50, task: Dirty/Walmart-Amazon, loss: 0.0011189579963684082
step: 60, task: Dirty/Walmart-Amazon, loss: 0.0014793574810028076
step: 70, task: Dirty/Walmart-Amazon, loss: 0.0004755258560180664
step: 80, task: Dirty/Walmart-Amazon, loss: 0.000210493803024292
step: 90, task: Dirty/Walmart-Amazon, loss: 0.05959291011095047
step: 100, task: Dirty/Walmart-Amazon, loss: 0.0002714991569519043
step: 110, task: Dirty/Walmart-Amazon, loss: 0.0010426491498947144
step: 120, task: Dirty/Walmart-Amazon, loss: 0.009788036346435547
step: 130, task: Dirty/Walmart-Amazon, loss: 0.0008979737758636475
step: 140, task: Dirty/Walmart-Amazon, loss: 0.0022261440753936768
step: 150, task: Dirty/Walmart-Amazon, loss: 0.0004035085439682007
step: 160, task: Dirty/Walmart-Amazon, loss: 0.009115450084209442
step: 170, task: Dirty/Walmart-Amazon, loss: 0.4740629494190216
step: 180, task: Dirty/Walmart-Amazon, loss: 0.00012063980102539062
step: 190, task: Dirty/Walmart-Amazon, loss: 0.00024102628231048584
step: 200, task: Dirty/Walmart-Amazon, loss: 0.0015161335468292236
step: 210, task: Dirty/Walmart-Amazon, loss: 0.0012287646532058716
step: 220, task: Dirty/Walmart-Amazon, loss: 0.00116710364818573
step: 230, task: Dirty/Walmart-Amazon, loss: 0.0006611496210098267
step: 240, task: Dirty/Walmart-Amazon, loss: 8.949637413024902e-05
step: 250, task: Dirty/Walmart-Amazon, loss: 0.0009486675262451172
step: 260, task: Dirty/Walmart-Amazon, loss: 0.00047257542610168457
step: 270, task: Dirty/Walmart-Amazon, loss: 0.0019994229078292847
step: 280, task: Dirty/Walmart-Amazon, loss: 0.002100348472595215
step: 290, task: Dirty/Walmart-Amazon, loss: 0.004428640007972717
step: 300, task: Dirty/Walmart-Amazon, loss: 0.002345256507396698
step: 310, task: Dirty/Walmart-Amazon, loss: 0.00010423362255096436
step: 320, task: Dirty/Walmart-Amazon, loss: 0.0007577687501907349
step: 330, task: Dirty/Walmart-Amazon, loss: 0.06789551675319672
step: 340, task: Dirty/Walmart-Amazon, loss: 0.000680580735206604
step: 350, task: Dirty/Walmart-Amazon, loss: 0.0030155032873153687
step: 360, task: Dirty/Walmart-Amazon, loss: 0.0005633682012557983
step: 370, task: Dirty/Walmart-Amazon, loss: 0.008676551282405853
step: 380, task: Dirty/Walmart-Amazon, loss: 0.011489994823932648
=========eval at epoch=8=========
Validation:
=============Dirty/Walmart-Amazon==================
accuracy=0.909
precision=0.818
recall=0.047
f1=0.088
======================================
Test:
=============Dirty/Walmart-Amazon==================
accuracy=0.909
precision=0.818
recall=0.047
f1=0.088
======================================
Selected optimization level O2:  FP16 training with FP32 batchnorm and FP32 master weights.

Defaults for this optimization level are:
enabled                : True
opt_level              : O2
cast_model_type        : torch.float16
patch_torch_functions  : False
keep_batchnorm_fp32    : True
master_weights         : True
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O2
cast_model_type        : torch.float16
patch_torch_functions  : False
keep_batchnorm_fp32    : True
master_weights         : True
loss_scale             : dynamic
Warning:  multi_tensor_applier fused unscale kernel is unavailable, possibly because apex was installed without --cuda_ext --cpp_ext. Using Python fallback.  Original ImportError was: ModuleNotFoundError("No module named 'amp_C'")
Gradient overflow.  Skipping step, loss scaler 0 reducing loss scale to 32768.0
=====sanity check======
words: COL title VAL smead recycled end tab fastener folders straight cut 11pt legal manila 50 box stationery & office machinery 37160 COL category VAL  COL brand VAL  COL modelno VAL  COL price VAL 41.18  [SEP] COL title VAL new-smead 19813 - kraft k style fastener folders straight cut top tab legal brown 50 box - smd19813 laminating supplies smead 59.0 COL category VAL  COL brand VAL  COL modelno VAL  COL price VAL  
x: [    0 18047  1270 27445  5278 19928 18505   253 12207  1769  5777 39301
  1359   847   365  3320  1030   313  4882   654  2233  1992  4270   359
   558 13922  2908 13726 14857  4120 27445  1437 14857  1518 27445  1437
 14857  1421  2362 27445  1437 14857   425 27445  3492     4  1366  1437
     2     2 18047  1270 27445    92    12    29  1794   625 30858  1558
   111   449 13001   449  2496  1769  5777 39301  1359   847   299 12207
  1030  6219   654  2233   111  5278   417 28773  1558   784 13941  1295
  4217  5278 19928  5169     4   288 14857  4120 27445  1437 14857  1518
 27445  1437 14857  1421  2362 27445  1437 14857   425 27445  1437  1437
     2]
tokens: ['<s>', 'COL', 'Ġtitle', 'ĠVAL', 'Ġsm', 'ead', 'Ġrecycled', 'Ġend', 'Ġtab', 'Ġfast', 'ener', 'Ġfolders', 'Ġstraight', 'Ġcut', 'Ġ11', 'pt', 'Ġlegal', 'Ġman', 'ila', 'Ġ50', 'Ġbox', 'Ġstation', 'ery', 'Ġ&', 'Ġoffice', 'Ġmachinery', 'Ġ37', '160', 'ĠCOL', 'Ġcategory', 'ĠVAL', 'Ġ', 'ĠCOL', 'Ġbrand', 'ĠVAL', 'Ġ', 'ĠCOL', 'Ġmodel', 'no', 'ĠVAL', 'Ġ', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ41', '.', '18', 'Ġ', '</s>', '</s>', 'COL', 'Ġtitle', 'ĠVAL', 'Ġnew', '-', 's', 'me', 'ad', 'Ġ198', '13', 'Ġ-', 'Ġk', 'raft', 'Ġk', 'Ġstyle', 'Ġfast', 'ener', 'Ġfolders', 'Ġstraight', 'Ġcut', 'Ġtop', 'Ġtab', 'Ġlegal', 'Ġbrown', 'Ġ50', 'Ġbox', 'Ġ-', 'Ġsm', 'd', '198', '13', 'Ġl', 'amin', 'ating', 'Ġsupplies', 'Ġsm', 'ead', 'Ġ59', '.', '0', 'ĠCOL', 'Ġcategory', 'ĠVAL', 'Ġ', 'ĠCOL', 'Ġbrand', 'ĠVAL', 'Ġ', 'ĠCOL', 'Ġmodel', 'no', 'ĠVAL', 'Ġ', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ', 'Ġ', '</s>']
is_heads: [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
y: 0
tags: 0
mask: tensor([1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1])
seqlen: 109
task_name: Dirty/Walmart-Amazon
=======================
step: 0, task: Dirty/Walmart-Amazon, loss: 0.7794582843780518
Gradient overflow.  Skipping step, loss scaler 0 reducing loss scale to 16384.0
Gradient overflow.  Skipping step, loss scaler 0 reducing loss scale to 8192.0
Gradient overflow.  Skipping step, loss scaler 0 reducing loss scale to 4096.0
step: 10, task: Dirty/Walmart-Amazon, loss: 0.8422589898109436
step: 20, task: Dirty/Walmart-Amazon, loss: 0.7511045932769775
step: 30, task: Dirty/Walmart-Amazon, loss: 0.6033685803413391
step: 40, task: Dirty/Walmart-Amazon, loss: 0.1628388911485672
step: 50, task: Dirty/Walmart-Amazon, loss: 0.25272873044013977
step: 60, task: Dirty/Walmart-Amazon, loss: 0.2579067647457123
step: 70, task: Dirty/Walmart-Amazon, loss: 0.25698670744895935
step: 80, task: Dirty/Walmart-Amazon, loss: 0.09518440067768097
step: 90, task: Dirty/Walmart-Amazon, loss: 0.390447199344635
step: 100, task: Dirty/Walmart-Amazon, loss: 0.34438031911849976
step: 110, task: Dirty/Walmart-Amazon, loss: 0.45418766140937805
step: 120, task: Dirty/Walmart-Amazon, loss: 0.5142199993133545
step: 130, task: Dirty/Walmart-Amazon, loss: 0.0764746218919754
step: 140, task: Dirty/Walmart-Amazon, loss: 0.501633882522583
step: 150, task: Dirty/Walmart-Amazon, loss: 0.3502342402935028
step: 160, task: Dirty/Walmart-Amazon, loss: 0.11094477027654648
step: 170, task: Dirty/Walmart-Amazon, loss: 0.06338608264923096
step: 180, task: Dirty/Walmart-Amazon, loss: 0.08769097179174423
step: 190, task: Dirty/Walmart-Amazon, loss: 0.14906173944473267
step: 200, task: Dirty/Walmart-Amazon, loss: 0.5693626403808594
step: 210, task: Dirty/Walmart-Amazon, loss: 0.2677629888057709
step: 220, task: Dirty/Walmart-Amazon, loss: 0.1301967203617096
step: 230, task: Dirty/Walmart-Amazon, loss: 0.39896339178085327
step: 240, task: Dirty/Walmart-Amazon, loss: 0.6469775438308716
step: 250, task: Dirty/Walmart-Amazon, loss: 0.5311117172241211
step: 260, task: Dirty/Walmart-Amazon, loss: 0.7590113282203674
step: 270, task: Dirty/Walmart-Amazon, loss: 0.5350956320762634
step: 280, task: Dirty/Walmart-Amazon, loss: 0.2576456069946289
step: 290, task: Dirty/Walmart-Amazon, loss: 0.09514312446117401
step: 300, task: Dirty/Walmart-Amazon, loss: 0.2703399956226349
step: 310, task: Dirty/Walmart-Amazon, loss: 0.2483728677034378
step: 320, task: Dirty/Walmart-Amazon, loss: 0.22740688920021057
step: 330, task: Dirty/Walmart-Amazon, loss: 0.14957398176193237
step: 340, task: Dirty/Walmart-Amazon, loss: 0.20613205432891846
step: 350, task: Dirty/Walmart-Amazon, loss: 0.05860487371683121
step: 360, task: Dirty/Walmart-Amazon, loss: 0.5375434160232544
step: 370, task: Dirty/Walmart-Amazon, loss: 0.23598197102546692
step: 380, task: Dirty/Walmart-Amazon, loss: 0.39768490195274353
=========eval at epoch=1=========
Validation:
=============Dirty/Walmart-Amazon==================
accuracy=0.906
precision=0.000
recall=0.000
f1=0.000
======================================
Test:
=============Dirty/Walmart-Amazon==================
accuracy=0.906
precision=0.000
recall=0.000
f1=0.000
======================================
/w/246/tianyu2020/miniconda2/envs/ditto/lib/python3.7/site-packages/apex/amp/_initialize.py:24: UserWarning: An input tensor was not cuda.
  warnings.warn("An input tensor was not cuda.")
/w/246/tianyu2020/miniconda2/envs/ditto/lib/python3.7/site-packages/torch/optim/lr_scheduler.py:122: UserWarning: Detected call of `lr_scheduler.step()` before `optimizer.step()`. In PyTorch 1.1.0 and later, you should call them in the opposite order: `optimizer.step()` before `lr_scheduler.step()`.  Failure to do this will result in PyTorch skipping the first value of the learning rate schedule. See more details at https://pytorch.org/docs/stable/optim.html#how-to-adjust-learning-rate
  "https://pytorch.org/docs/stable/optim.html#how-to-adjust-learning-rate", UserWarning)
/w/246/tianyu2020/miniconda2/envs/ditto/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1221: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
=====sanity check======
words: COL title VAL startech.com pci420usb usb adapter card pci420usb 14.88 COL category VAL electronics - general COL brand VAL startech COL modelno VAL  COL price VAL   [SEP] COL title VAL startech.com 2 port pci superspeed usb 3.0 card adapter pciusb3s2 pciusb3s2 51.0 COL category VAL hubs COL brand VAL startech COL modelno VAL  COL price VAL  
x: [    0 18047  1270 27445   386  7529     4   175 49899 23537 47358 49030
 36007  1886 49899 23537 47358   501     4  4652 14857  4120 27445  8917
   111   937 14857  1518 27445   386  7529 14857  1421  2362 27445  1437
 14857   425 27445  1437  1437     2     2 18047  1270 27445   386  7529
     4   175   132  4103 49899 31716 39640 49030   155     4   288  1886
 36007   181 40271   428   246    29   176   181 40271   428   246    29
   176  4074     4   288 14857  4120 27445 22350 14857  1518 27445   386
  7529 14857  1421  2362 27445  1437 14857   425 27445  1437  1437     2]
tokens: ['<s>', 'COL', 'Ġtitle', 'ĠVAL', 'Ġstart', 'ech', '.', 'com', 'Ġpci', '420', 'usb', 'Ġusb', 'Ġadapter', 'Ġcard', 'Ġpci', '420', 'usb', 'Ġ14', '.', '88', 'ĠCOL', 'Ġcategory', 'ĠVAL', 'Ġelectronics', 'Ġ-', 'Ġgeneral', 'ĠCOL', 'Ġbrand', 'ĠVAL', 'Ġstart', 'ech', 'ĠCOL', 'Ġmodel', 'no', 'ĠVAL', 'Ġ', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ', 'Ġ', '</s>', '</s>', 'COL', 'Ġtitle', 'ĠVAL', 'Ġstart', 'ech', '.', 'com', 'Ġ2', 'Ġport', 'Ġpci', 'Ġsupers', 'peed', 'Ġusb', 'Ġ3', '.', '0', 'Ġcard', 'Ġadapter', 'Ġp', 'cius', 'b', '3', 's', '2', 'Ġp', 'cius', 'b', '3', 's', '2', 'Ġ51', '.', '0', 'ĠCOL', 'Ġcategory', 'ĠVAL', 'Ġhubs', 'ĠCOL', 'Ġbrand', 'ĠVAL', 'Ġstart', 'ech', 'ĠCOL', 'Ġmodel', 'no', 'ĠVAL', 'Ġ', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ', 'Ġ', '</s>']
is_heads: [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
y: 0
tags: 0
mask: tensor([1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1])
seqlen: 96
task_name: Dirty/Walmart-Amazon
=======================
step: 0, task: Dirty/Walmart-Amazon, loss: 0.5538995265960693
step: 10, task: Dirty/Walmart-Amazon, loss: 0.12105368077754974
step: 20, task: Dirty/Walmart-Amazon, loss: 0.10391771048307419
step: 30, task: Dirty/Walmart-Amazon, loss: 0.2972661852836609
step: 40, task: Dirty/Walmart-Amazon, loss: 0.08233048766851425
step: 50, task: Dirty/Walmart-Amazon, loss: 0.004855230450630188
step: 60, task: Dirty/Walmart-Amazon, loss: 0.08081091940402985
step: 70, task: Dirty/Walmart-Amazon, loss: 0.38412490487098694
step: 80, task: Dirty/Walmart-Amazon, loss: 0.38218915462493896
step: 90, task: Dirty/Walmart-Amazon, loss: 0.8288764953613281
step: 100, task: Dirty/Walmart-Amazon, loss: 0.2793468236923218
step: 110, task: Dirty/Walmart-Amazon, loss: 0.12653186917304993
step: 120, task: Dirty/Walmart-Amazon, loss: 0.027517244219779968
step: 130, task: Dirty/Walmart-Amazon, loss: 0.16153107583522797
step: 140, task: Dirty/Walmart-Amazon, loss: 0.12459605932235718
step: 150, task: Dirty/Walmart-Amazon, loss: 0.31466174125671387
step: 160, task: Dirty/Walmart-Amazon, loss: 0.03165719658136368
step: 170, task: Dirty/Walmart-Amazon, loss: 0.163967102766037
step: 180, task: Dirty/Walmart-Amazon, loss: 0.09804318100214005
step: 190, task: Dirty/Walmart-Amazon, loss: 0.11669620871543884
step: 200, task: Dirty/Walmart-Amazon, loss: 0.1441051959991455
step: 210, task: Dirty/Walmart-Amazon, loss: 0.14271731674671173
step: 220, task: Dirty/Walmart-Amazon, loss: 0.283149391412735
step: 230, task: Dirty/Walmart-Amazon, loss: 0.4352104067802429
step: 240, task: Dirty/Walmart-Amazon, loss: 0.1684480607509613
step: 250, task: Dirty/Walmart-Amazon, loss: 0.0037797242403030396
step: 260, task: Dirty/Walmart-Amazon, loss: 0.061435766518116
step: 270, task: Dirty/Walmart-Amazon, loss: 0.04292810708284378
step: 280, task: Dirty/Walmart-Amazon, loss: 0.016985371708869934
step: 290, task: Dirty/Walmart-Amazon, loss: 0.017941728234291077
step: 300, task: Dirty/Walmart-Amazon, loss: 0.15240155160427094
step: 310, task: Dirty/Walmart-Amazon, loss: 0.061037369072437286
step: 320, task: Dirty/Walmart-Amazon, loss: 0.02748025953769684
step: 330, task: Dirty/Walmart-Amazon, loss: 0.01912429928779602
step: 340, task: Dirty/Walmart-Amazon, loss: 0.0036841630935668945
step: 350, task: Dirty/Walmart-Amazon, loss: 0.12868396937847137
step: 360, task: Dirty/Walmart-Amazon, loss: 0.08043486624956131
step: 370, task: Dirty/Walmart-Amazon, loss: 0.20742648839950562
step: 380, task: Dirty/Walmart-Amazon, loss: 0.10238964855670929
=========eval at epoch=1=========
Validation:
=============Dirty/Walmart-Amazon==================
accuracy=0.908
precision=1.000
recall=0.021
f1=0.041
======================================
Test:
=============Dirty/Walmart-Amazon==================
accuracy=0.906
precision=0.000
recall=0.000
f1=0.000
======================================
=====sanity check======
words: COL title VAL memorex 52x write-once cd-r with lightscribe technology - 10 pack slim jewel case mp3 accessories COL category VAL  COL brand VAL memorex COL modelno VAL  COL price VAL 8.88  [SEP] COL title VAL memorex 40x write-once cd-r for audio - 5 pack jewel cases COL category VAL  COL brand VAL memorex COL modelno VAL  COL price VAL 9.09 
x: [    0 18047  1270 27445 26012  1688  1178  3135  1178  3116    12 25252
 45584    12   338    19  1109 36037   806   111   158  6356 11875 24693
   403 44857   246 10131 14857  4120 27445  1437 14857  1518 27445 26012
  1688  1178 14857  1421  2362 27445  1437 14857   425 27445   290     4
  4652  1437     2     2 18047  1270 27445 26012  1688  1178   843  1178
  3116    12 25252 45584    12   338    13  6086   111   195  6356 24693
  1200 14857  4120 27445  1437 14857  1518 27445 26012  1688  1178 14857
  1421  2362 27445  1437 14857   425 27445   361     4  3546  1437     2]
tokens: ['<s>', 'COL', 'Ġtitle', 'ĠVAL', 'Ġmem', 'ore', 'x', 'Ġ52', 'x', 'Ġwrite', '-', 'once', 'Ġcd', '-', 'r', 'Ġwith', 'Ġlight', 'scribe', 'Ġtechnology', 'Ġ-', 'Ġ10', 'Ġpack', 'Ġslim', 'Ġjewel', 'Ġcase', 'Ġmp', '3', 'Ġaccessories', 'ĠCOL', 'Ġcategory', 'ĠVAL', 'Ġ', 'ĠCOL', 'Ġbrand', 'ĠVAL', 'Ġmem', 'ore', 'x', 'ĠCOL', 'Ġmodel', 'no', 'ĠVAL', 'Ġ', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ8', '.', '88', 'Ġ', '</s>', '</s>', 'COL', 'Ġtitle', 'ĠVAL', 'Ġmem', 'ore', 'x', 'Ġ40', 'x', 'Ġwrite', '-', 'once', 'Ġcd', '-', 'r', 'Ġfor', 'Ġaudio', 'Ġ-', 'Ġ5', 'Ġpack', 'Ġjewel', 'Ġcases', 'ĠCOL', 'Ġcategory', 'ĠVAL', 'Ġ', 'ĠCOL', 'Ġbrand', 'ĠVAL', 'Ġmem', 'ore', 'x', 'ĠCOL', 'Ġmodel', 'no', 'ĠVAL', 'Ġ', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ9', '.', '09', 'Ġ', '</s>']
is_heads: [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
y: 0
tags: 0
mask: tensor([1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1])
seqlen: 96
task_name: Dirty/Walmart-Amazon
=======================
step: 0, task: Dirty/Walmart-Amazon, loss: 0.23347625136375427
step: 10, task: Dirty/Walmart-Amazon, loss: 0.006496906280517578
step: 20, task: Dirty/Walmart-Amazon, loss: 0.02584526687860489
step: 30, task: Dirty/Walmart-Amazon, loss: 0.22419720888137817
step: 40, task: Dirty/Walmart-Amazon, loss: 0.055994391441345215
step: 50, task: Dirty/Walmart-Amazon, loss: 0.11930140852928162
step: 60, task: Dirty/Walmart-Amazon, loss: 0.005695804953575134
step: 70, task: Dirty/Walmart-Amazon, loss: 0.006029754877090454
step: 80, task: Dirty/Walmart-Amazon, loss: 0.0020265430212020874
step: 90, task: Dirty/Walmart-Amazon, loss: 0.15901009738445282
step: 100, task: Dirty/Walmart-Amazon, loss: 0.551983118057251
step: 110, task: Dirty/Walmart-Amazon, loss: 0.06365418434143066
step: 120, task: Dirty/Walmart-Amazon, loss: 0.13450302183628082
step: 130, task: Dirty/Walmart-Amazon, loss: 0.0029638856649398804
step: 140, task: Dirty/Walmart-Amazon, loss: 0.0837046429514885
step: 150, task: Dirty/Walmart-Amazon, loss: 0.09129735827445984
step: 160, task: Dirty/Walmart-Amazon, loss: 0.07622689008712769
step: 170, task: Dirty/Walmart-Amazon, loss: 0.011227160692214966
step: 180, task: Dirty/Walmart-Amazon, loss: 0.15884903073310852
step: 190, task: Dirty/Walmart-Amazon, loss: 0.0016393959522247314
step: 200, task: Dirty/Walmart-Amazon, loss: 0.31049925088882446
step: 210, task: Dirty/Walmart-Amazon, loss: 0.015384770929813385
step: 220, task: Dirty/Walmart-Amazon, loss: 0.0850350633263588
step: 230, task: Dirty/Walmart-Amazon, loss: 0.2850579619407654
step: 240, task: Dirty/Walmart-Amazon, loss: 0.3601159155368805
step: 250, task: Dirty/Walmart-Amazon, loss: 0.4638511538505554
step: 260, task: Dirty/Walmart-Amazon, loss: 0.02754221111536026
step: 270, task: Dirty/Walmart-Amazon, loss: 0.026880599558353424
step: 280, task: Dirty/Walmart-Amazon, loss: 0.02114080637693405
step: 290, task: Dirty/Walmart-Amazon, loss: 0.22473648190498352
step: 300, task: Dirty/Walmart-Amazon, loss: 0.004604220390319824
step: 310, task: Dirty/Walmart-Amazon, loss: 0.0029862821102142334
step: 320, task: Dirty/Walmart-Amazon, loss: 0.03503204882144928
step: 330, task: Dirty/Walmart-Amazon, loss: 0.0063680559396743774
step: 340, task: Dirty/Walmart-Amazon, loss: 0.0020796507596969604
step: 350, task: Dirty/Walmart-Amazon, loss: 0.03082706406712532
step: 360, task: Dirty/Walmart-Amazon, loss: 0.019528828561306
step: 370, task: Dirty/Walmart-Amazon, loss: 0.017149731516838074
step: 380, task: Dirty/Walmart-Amazon, loss: 0.03785925358533859
=========eval at epoch=2=========
Validation:
=============Dirty/Walmart-Amazon==================
accuracy=0.919
precision=0.966
recall=0.145
f1=0.252
======================================
Test:
=============Dirty/Walmart-Amazon==================
accuracy=0.911
precision=0.824
recall=0.073
f1=0.133
======================================
=====sanity check======
words: COL title VAL roocase executive portfolio leather case w 2 screen protector for blackberry playbook electronics - general COL category VAL  COL brand VAL roocase COL modelno VAL 220761 COL price VAL 35.99  [SEP] COL title VAL blackberry playbook screen protector mybat screen protector foils COL category VAL  COL brand VAL mybat COL modelno VAL  COL price VAL 1.43 
x: [    0 18047  1270 27445  4533  1975  3175  1031  2819  9219   403   885
   132  2441 32747    13   909  8132 27190  8917   111   937 14857  4120
 27445  1437 14857  1518 27445  4533  1975  3175 14857  1421  2362 27445
 14576  5067   134 14857   425 27445  1718     4  2831  1437     2     2
 18047  1270 27445   909  8132 27190  2441 32747   127 12161  2441 32747
  9565  5290 14857  4120 27445  1437 14857  1518 27445   127 12161 14857
  1421  2362 27445  1437 14857   425 27445   112     4  3897  1437     2]
tokens: ['<s>', 'COL', 'Ġtitle', 'ĠVAL', 'Ġro', 'oc', 'ase', 'Ġexecutive', 'Ġportfolio', 'Ġleather', 'Ġcase', 'Ġw', 'Ġ2', 'Ġscreen', 'Ġprotector', 'Ġfor', 'Ġblack', 'berry', 'Ġplaybook', 'Ġelectronics', 'Ġ-', 'Ġgeneral', 'ĠCOL', 'Ġcategory', 'ĠVAL', 'Ġ', 'ĠCOL', 'Ġbrand', 'ĠVAL', 'Ġro', 'oc', 'ase', 'ĠCOL', 'Ġmodel', 'no', 'ĠVAL', 'Ġ220', '76', '1', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ35', '.', '99', 'Ġ', '</s>', '</s>', 'COL', 'Ġtitle', 'ĠVAL', 'Ġblack', 'berry', 'Ġplaybook', 'Ġscreen', 'Ġprotector', 'Ġmy', 'bat', 'Ġscreen', 'Ġprotector', 'Ġfo', 'ils', 'ĠCOL', 'Ġcategory', 'ĠVAL', 'Ġ', 'ĠCOL', 'Ġbrand', 'ĠVAL', 'Ġmy', 'bat', 'ĠCOL', 'Ġmodel', 'no', 'ĠVAL', 'Ġ', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ1', '.', '43', 'Ġ', '</s>']
is_heads: [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
y: 0
tags: 0
mask: tensor([1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1])
seqlen: 84
task_name: Dirty/Walmart-Amazon
=======================
step: 0, task: Dirty/Walmart-Amazon, loss: 0.04913097620010376
step: 10, task: Dirty/Walmart-Amazon, loss: 0.06888216733932495
step: 20, task: Dirty/Walmart-Amazon, loss: 0.1616237759590149
step: 30, task: Dirty/Walmart-Amazon, loss: 0.0210244320333004
step: 40, task: Dirty/Walmart-Amazon, loss: 0.0035099387168884277
step: 50, task: Dirty/Walmart-Amazon, loss: 0.02610938251018524
step: 60, task: Dirty/Walmart-Amazon, loss: 0.12475854158401489
step: 70, task: Dirty/Walmart-Amazon, loss: 0.011133834719657898
step: 80, task: Dirty/Walmart-Amazon, loss: 0.0011882632970809937
step: 90, task: Dirty/Walmart-Amazon, loss: 0.00127469003200531
step: 100, task: Dirty/Walmart-Amazon, loss: 0.27165839076042175
step: 110, task: Dirty/Walmart-Amazon, loss: 0.03266187757253647
step: 120, task: Dirty/Walmart-Amazon, loss: 0.04685823991894722
step: 130, task: Dirty/Walmart-Amazon, loss: 0.02716730535030365
step: 140, task: Dirty/Walmart-Amazon, loss: 0.040010906755924225
step: 150, task: Dirty/Walmart-Amazon, loss: 0.014986895024776459
step: 160, task: Dirty/Walmart-Amazon, loss: 0.05879700183868408
step: 170, task: Dirty/Walmart-Amazon, loss: 0.07397410273551941
step: 180, task: Dirty/Walmart-Amazon, loss: 0.3632824718952179
step: 190, task: Dirty/Walmart-Amazon, loss: 0.04124486446380615
step: 200, task: Dirty/Walmart-Amazon, loss: 0.7892651557922363
step: 210, task: Dirty/Walmart-Amazon, loss: 0.02477291226387024
step: 220, task: Dirty/Walmart-Amazon, loss: 0.042378589510917664
step: 230, task: Dirty/Walmart-Amazon, loss: 0.028599433600902557
step: 240, task: Dirty/Walmart-Amazon, loss: 0.00753176212310791
step: 250, task: Dirty/Walmart-Amazon, loss: 0.3489505648612976
step: 260, task: Dirty/Walmart-Amazon, loss: 0.004886507987976074
step: 270, task: Dirty/Walmart-Amazon, loss: 0.0039780884981155396
step: 280, task: Dirty/Walmart-Amazon, loss: 0.026688598096370697
step: 290, task: Dirty/Walmart-Amazon, loss: 0.5293353796005249
step: 300, task: Dirty/Walmart-Amazon, loss: 0.006027191877365112
step: 310, task: Dirty/Walmart-Amazon, loss: 0.018787972629070282
step: 320, task: Dirty/Walmart-Amazon, loss: 0.260381281375885
step: 330, task: Dirty/Walmart-Amazon, loss: 0.10364819318056107
step: 340, task: Dirty/Walmart-Amazon, loss: 0.06315600872039795
step: 350, task: Dirty/Walmart-Amazon, loss: 0.01750796288251877
step: 360, task: Dirty/Walmart-Amazon, loss: 0.05014067143201828
step: 370, task: Dirty/Walmart-Amazon, loss: 0.0009885579347610474
step: 380, task: Dirty/Walmart-Amazon, loss: 0.4403441250324249
=========eval at epoch=3=========
Validation:
=============Dirty/Walmart-Amazon==================
accuracy=0.920
precision=0.969
recall=0.161
f1=0.276
======================================
Test:
=============Dirty/Walmart-Amazon==================
accuracy=0.918
precision=0.962
recall=0.130
f1=0.228
======================================
=====sanity check======
words: COL title VAL philips 3 high speed hdmi cable electronics - general philips 10.43 COL category VAL  COL brand VAL  COL modelno VAL swv3431w/17 COL price VAL   [SEP] COL title VAL sony dlc-he20hf flat high speed hdmi cable dlche20hf COL category VAL hdmi cables COL brand VAL sony COL modelno VAL  COL price VAL 22.41 
x: [    0 18047  1270 27445 43091  7418   155   239  2078  1368   417  5408
  6129  8917   111   937 43091  7418   158     4  3897 14857  4120 27445
  1437 14857  1518 27445  1437 14857  1421  2362 27445  3514   705  3079
  2983   605    73  1360 14857   425 27445  1437  1437     2     2 18047
  1270 27445   579  6119   385 45071    12   700   844   298   506  3269
   239  2078  1368   417  5408  6129   385   462  2871   844   298   506
 14857  4120 27445  1368   417  5408 19185 14857  1518 27445   579  6119
 14857  1421  2362 27445  1437 14857   425 27445   820     4  4006  1437
     2]
tokens: ['<s>', 'COL', 'Ġtitle', 'ĠVAL', 'Ġphil', 'ips', 'Ġ3', 'Ġhigh', 'Ġspeed', 'Ġh', 'd', 'mi', 'Ġcable', 'Ġelectronics', 'Ġ-', 'Ġgeneral', 'Ġphil', 'ips', 'Ġ10', '.', '43', 'ĠCOL', 'Ġcategory', 'ĠVAL', 'Ġ', 'ĠCOL', 'Ġbrand', 'ĠVAL', 'Ġ', 'ĠCOL', 'Ġmodel', 'no', 'ĠVAL', 'Ġsw', 'v', '34', '31', 'w', '/', '17', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ', 'Ġ', '</s>', '</s>', 'COL', 'Ġtitle', 'ĠVAL', 'Ġs', 'ony', 'Ġd', 'lc', '-', 'he', '20', 'h', 'f', 'Ġflat', 'Ġhigh', 'Ġspeed', 'Ġh', 'd', 'mi', 'Ġcable', 'Ġd', 'l', 'che', '20', 'h', 'f', 'ĠCOL', 'Ġcategory', 'ĠVAL', 'Ġh', 'd', 'mi', 'Ġcables', 'ĠCOL', 'Ġbrand', 'ĠVAL', 'Ġs', 'ony', 'ĠCOL', 'Ġmodel', 'no', 'ĠVAL', 'Ġ', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ22', '.', '41', 'Ġ', '</s>']
is_heads: [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
y: 0
tags: 0
mask: tensor([1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1])
seqlen: 97
task_name: Dirty/Walmart-Amazon
=======================
step: 0, task: Dirty/Walmart-Amazon, loss: 0.02013813704252243
step: 10, task: Dirty/Walmart-Amazon, loss: 0.03734444081783295
step: 20, task: Dirty/Walmart-Amazon, loss: 0.36503535509109497
step: 30, task: Dirty/Walmart-Amazon, loss: 0.001310974359512329
step: 40, task: Dirty/Walmart-Amazon, loss: 0.010141171514987946
step: 50, task: Dirty/Walmart-Amazon, loss: 0.0033522695302963257
step: 60, task: Dirty/Walmart-Amazon, loss: 0.011291950941085815
step: 70, task: Dirty/Walmart-Amazon, loss: 0.0021574795246124268
step: 80, task: Dirty/Walmart-Amazon, loss: 0.04235561192035675
step: 90, task: Dirty/Walmart-Amazon, loss: 0.005850434303283691
step: 100, task: Dirty/Walmart-Amazon, loss: 0.006801299750804901
step: 110, task: Dirty/Walmart-Amazon, loss: 0.0047928765416145325
step: 120, task: Dirty/Walmart-Amazon, loss: 0.040336973965168
step: 130, task: Dirty/Walmart-Amazon, loss: 0.01113651692867279
step: 140, task: Dirty/Walmart-Amazon, loss: 0.0005683749914169312
step: 150, task: Dirty/Walmart-Amazon, loss: 0.019933946430683136
step: 160, task: Dirty/Walmart-Amazon, loss: 0.001042395830154419
step: 170, task: Dirty/Walmart-Amazon, loss: 0.0144229456782341
step: 180, task: Dirty/Walmart-Amazon, loss: 0.0009913444519042969
step: 190, task: Dirty/Walmart-Amazon, loss: 0.10686048865318298
step: 200, task: Dirty/Walmart-Amazon, loss: 0.10293225198984146
step: 210, task: Dirty/Walmart-Amazon, loss: 0.058924831449985504
step: 220, task: Dirty/Walmart-Amazon, loss: 0.007725521922111511
step: 230, task: Dirty/Walmart-Amazon, loss: 0.18975034356117249
step: 240, task: Dirty/Walmart-Amazon, loss: 0.016193941235542297
step: 250, task: Dirty/Walmart-Amazon, loss: 0.007297948002815247
step: 260, task: Dirty/Walmart-Amazon, loss: 0.029813237488269806
step: 270, task: Dirty/Walmart-Amazon, loss: 0.006636627018451691
step: 280, task: Dirty/Walmart-Amazon, loss: 0.048668235540390015
step: 290, task: Dirty/Walmart-Amazon, loss: 0.0014389604330062866
step: 300, task: Dirty/Walmart-Amazon, loss: 0.004634007811546326
step: 310, task: Dirty/Walmart-Amazon, loss: 0.0029434263706207275
step: 320, task: Dirty/Walmart-Amazon, loss: 0.06020554155111313
step: 330, task: Dirty/Walmart-Amazon, loss: 0.0018406957387924194
step: 340, task: Dirty/Walmart-Amazon, loss: 0.025140054523944855
step: 350, task: Dirty/Walmart-Amazon, loss: 0.0007834434509277344
step: 360, task: Dirty/Walmart-Amazon, loss: 0.0004679560661315918
step: 370, task: Dirty/Walmart-Amazon, loss: 0.00140342116355896
step: 380, task: Dirty/Walmart-Amazon, loss: 0.44892266392707825
=========eval at epoch=4=========
Validation:
=============Dirty/Walmart-Amazon==================
accuracy=0.909
precision=1.000
recall=0.031
f1=0.060
======================================
Test:
=============Dirty/Walmart-Amazon==================
accuracy=0.908
precision=1.000
recall=0.026
f1=0.051
======================================
=====sanity check======
words: COL title VAL virginia tech hokies iphone 4 case black shell electronics - general fva3168 COL category VAL  COL brand VAL tribeca COL modelno VAL  COL price VAL 29.99  [SEP] COL title VAL chicago bulls iphone 4 case black shell COL category VAL computers accessories COL brand VAL tribeca COL modelno VAL  COL price VAL 17.99 
x: [    0 18047  1270 27445 33799   493  2903  1368  1638   918  1437 28778
  1264   204   403   909 10785  8917   111   937   856  3952   246 25676
 14857  4120 27445  1437 14857  1518 27445 28406 15366 14857  1421  2362
 27445  1437 14857   425 27445  1132     4  2831  1437     2     2 18047
  1270 27445  1855 42938 21865  1437 28778  1264   204   403   909 10785
 14857  4120 27445  7796 10131 14857  1518 27445 28406 15366 14857  1421
  2362 27445  1437 14857   425 27445   601     4  2831  1437     2]
tokens: ['<s>', 'COL', 'Ġtitle', 'ĠVAL', 'Ġvirgin', 'ia', 'Ġtech', 'Ġh', 'ok', 'ies', 'Ġ', 'iph', 'one', 'Ġ4', 'Ġcase', 'Ġblack', 'Ġshell', 'Ġelectronics', 'Ġ-', 'Ġgeneral', 'Ġf', 'va', '3', '168', 'ĠCOL', 'Ġcategory', 'ĠVAL', 'Ġ', 'ĠCOL', 'Ġbrand', 'ĠVAL', 'Ġtrib', 'eca', 'ĠCOL', 'Ġmodel', 'no', 'ĠVAL', 'Ġ', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ29', '.', '99', 'Ġ', '</s>', '</s>', 'COL', 'Ġtitle', 'ĠVAL', 'Ġch', 'icago', 'Ġbulls', 'Ġ', 'iph', 'one', 'Ġ4', 'Ġcase', 'Ġblack', 'Ġshell', 'ĠCOL', 'Ġcategory', 'ĠVAL', 'Ġcomputers', 'Ġaccessories', 'ĠCOL', 'Ġbrand', 'ĠVAL', 'Ġtrib', 'eca', 'ĠCOL', 'Ġmodel', 'no', 'ĠVAL', 'Ġ', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ17', '.', '99', 'Ġ', '</s>']
is_heads: [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
y: 0
tags: 0
mask: tensor([1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1])
seqlen: 83
task_name: Dirty/Walmart-Amazon
=======================
step: 0, task: Dirty/Walmart-Amazon, loss: 0.0011429041624069214
step: 10, task: Dirty/Walmart-Amazon, loss: 0.0008987337350845337
step: 20, task: Dirty/Walmart-Amazon, loss: 0.0012844502925872803
step: 30, task: Dirty/Walmart-Amazon, loss: 0.0021961331367492676
step: 40, task: Dirty/Walmart-Amazon, loss: 0.07392972707748413
step: 50, task: Dirty/Walmart-Amazon, loss: 0.0004659891128540039
step: 60, task: Dirty/Walmart-Amazon, loss: 0.0005388855934143066
step: 70, task: Dirty/Walmart-Amazon, loss: 0.0005302876234054565
step: 80, task: Dirty/Walmart-Amazon, loss: 0.0038816556334495544
step: 90, task: Dirty/Walmart-Amazon, loss: 0.0038401633501052856
step: 100, task: Dirty/Walmart-Amazon, loss: 0.002709895372390747
step: 110, task: Dirty/Walmart-Amazon, loss: 0.0009775906801223755
step: 120, task: Dirty/Walmart-Amazon, loss: 0.006551221013069153
step: 130, task: Dirty/Walmart-Amazon, loss: 0.015420705080032349
step: 140, task: Dirty/Walmart-Amazon, loss: 0.004754781723022461
step: 150, task: Dirty/Walmart-Amazon, loss: 0.002078115940093994
step: 160, task: Dirty/Walmart-Amazon, loss: 0.014956645667552948
step: 170, task: Dirty/Walmart-Amazon, loss: 0.0056692808866500854
step: 180, task: Dirty/Walmart-Amazon, loss: 0.001510322093963623
step: 190, task: Dirty/Walmart-Amazon, loss: 0.006394609808921814
step: 200, task: Dirty/Walmart-Amazon, loss: 0.0013469606637954712
step: 210, task: Dirty/Walmart-Amazon, loss: 0.011713296175003052
step: 220, task: Dirty/Walmart-Amazon, loss: 0.0011304914951324463
step: 230, task: Dirty/Walmart-Amazon, loss: 0.003080591559410095
step: 240, task: Dirty/Walmart-Amazon, loss: 0.0008855313062667847
step: 250, task: Dirty/Walmart-Amazon, loss: 0.0013883113861083984
step: 260, task: Dirty/Walmart-Amazon, loss: 0.01303187757730484
step: 270, task: Dirty/Walmart-Amazon, loss: 0.06908436119556427
step: 280, task: Dirty/Walmart-Amazon, loss: 0.002415478229522705
step: 290, task: Dirty/Walmart-Amazon, loss: 0.0231119766831398
step: 300, task: Dirty/Walmart-Amazon, loss: 0.0011509507894515991
step: 310, task: Dirty/Walmart-Amazon, loss: 0.0016367733478546143
step: 320, task: Dirty/Walmart-Amazon, loss: 0.0049285888671875
step: 330, task: Dirty/Walmart-Amazon, loss: 0.004679538309574127
step: 340, task: Dirty/Walmart-Amazon, loss: 0.026205889880657196
step: 350, task: Dirty/Walmart-Amazon, loss: 0.026019319891929626
step: 360, task: Dirty/Walmart-Amazon, loss: 0.08293098211288452
step: 370, task: Dirty/Walmart-Amazon, loss: 0.0009825825691223145
step: 380, task: Dirty/Walmart-Amazon, loss: 0.0005895942449569702
=========eval at epoch=5=========
Validation:
=============Dirty/Walmart-Amazon==================
accuracy=0.912
precision=1.000
recall=0.067
f1=0.126
======================================
Test:
=============Dirty/Walmart-Amazon==================
accuracy=0.908
precision=0.833
recall=0.026
f1=0.050
======================================
=====sanity check======
words: COL title VAL i-tec ipad anti-glare screen protector mp3 accessories COL category VAL  COL brand VAL i-tec electronics COL modelno VAL t6020 COL price VAL 17.88  [SEP] COL title VAL ag2 anti-glare screen protector for 10.1 widescreen netbooks rt-spf10101w / m 8.99 COL category VAL screen protectors COL brand VAL green COL modelno VAL  COL price VAL  
x: [    0 18047  1270 27445   939    12 26838 36180   625  1475    12  7210
  1322  2441 32747 44857   246 10131 14857  4120 27445  1437 14857  1518
 27445   939    12 26838  8917 14857  1421  2362 27445   326  2466   844
 14857   425 27445   601     4  4652  1437     2     2 18047  1270 27445
  5951   176  1475    12  7210  1322  2441 32747    13   158     4   134
   885  4376 37346  1161 17788   910    90    12  4182   506 12636  2663
   605  1589   475   290     4  2831 14857  4120 27445  2441  1744   994
 14857  1518 27445  2272 14857  1421  2362 27445  1437 14857   425 27445
  1437  1437     2]
tokens: ['<s>', 'COL', 'Ġtitle', 'ĠVAL', 'Ġi', '-', 'tec', 'Ġip', 'ad', 'Ġanti', '-', 'gl', 'are', 'Ġscreen', 'Ġprotector', 'Ġmp', '3', 'Ġaccessories', 'ĠCOL', 'Ġcategory', 'ĠVAL', 'Ġ', 'ĠCOL', 'Ġbrand', 'ĠVAL', 'Ġi', '-', 'tec', 'Ġelectronics', 'ĠCOL', 'Ġmodel', 'no', 'ĠVAL', 'Ġt', '60', '20', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ17', '.', '88', 'Ġ', '</s>', '</s>', 'COL', 'Ġtitle', 'ĠVAL', 'Ġag', '2', 'Ġanti', '-', 'gl', 'are', 'Ġscreen', 'Ġprotector', 'Ġfor', 'Ġ10', '.', '1', 'Ġw', 'ides', 'creen', 'Ġnet', 'books', 'Ġr', 't', '-', 'sp', 'f', '101', '01', 'w', 'Ġ/', 'Ġm', 'Ġ8', '.', '99', 'ĠCOL', 'Ġcategory', 'ĠVAL', 'Ġscreen', 'Ġprotect', 'ors', 'ĠCOL', 'Ġbrand', 'ĠVAL', 'Ġgreen', 'ĠCOL', 'Ġmodel', 'no', 'ĠVAL', 'Ġ', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ', 'Ġ', '</s>']
is_heads: [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
y: 0
tags: 0
mask: tensor([1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1])
seqlen: 99
task_name: Dirty/Walmart-Amazon
=======================
step: 0, task: Dirty/Walmart-Amazon, loss: 0.0026905983686447144
step: 10, task: Dirty/Walmart-Amazon, loss: 0.0016647428274154663
step: 20, task: Dirty/Walmart-Amazon, loss: 0.0038090720772743225
step: 30, task: Dirty/Walmart-Amazon, loss: 0.00703989714384079
step: 40, task: Dirty/Walmart-Amazon, loss: 0.00032636523246765137
step: 50, task: Dirty/Walmart-Amazon, loss: 0.0007472038269042969
step: 60, task: Dirty/Walmart-Amazon, loss: 0.0068222954869270325
step: 70, task: Dirty/Walmart-Amazon, loss: 0.16614371538162231
step: 80, task: Dirty/Walmart-Amazon, loss: 0.002932921051979065
step: 90, task: Dirty/Walmart-Amazon, loss: 0.00814010202884674
step: 100, task: Dirty/Walmart-Amazon, loss: 0.004306048154830933
step: 110, task: Dirty/Walmart-Amazon, loss: 0.007008276879787445
step: 120, task: Dirty/Walmart-Amazon, loss: 0.0038922354578971863
step: 130, task: Dirty/Walmart-Amazon, loss: 0.09256941825151443
step: 140, task: Dirty/Walmart-Amazon, loss: 0.002391129732131958
step: 150, task: Dirty/Walmart-Amazon, loss: 0.01584947109222412
step: 160, task: Dirty/Walmart-Amazon, loss: 0.0009848624467849731
step: 170, task: Dirty/Walmart-Amazon, loss: 0.00354158878326416
step: 180, task: Dirty/Walmart-Amazon, loss: 0.0022140592336654663
step: 190, task: Dirty/Walmart-Amazon, loss: 0.002899169921875
step: 200, task: Dirty/Walmart-Amazon, loss: 0.0010388940572738647
step: 210, task: Dirty/Walmart-Amazon, loss: 0.011078141629695892
step: 220, task: Dirty/Walmart-Amazon, loss: 0.1804976463317871
step: 230, task: Dirty/Walmart-Amazon, loss: 0.003979668021202087
step: 240, task: Dirty/Walmart-Amazon, loss: 0.005221441388130188
step: 250, task: Dirty/Walmart-Amazon, loss: 0.0013307780027389526
step: 260, task: Dirty/Walmart-Amazon, loss: 0.008057914674282074
step: 270, task: Dirty/Walmart-Amazon, loss: 0.0016508251428604126
step: 280, task: Dirty/Walmart-Amazon, loss: 0.0012277960777282715
step: 290, task: Dirty/Walmart-Amazon, loss: 0.0011101514101028442
step: 300, task: Dirty/Walmart-Amazon, loss: 0.001585632562637329
step: 310, task: Dirty/Walmart-Amazon, loss: 0.00819677859544754
step: 320, task: Dirty/Walmart-Amazon, loss: 0.000843539834022522
step: 330, task: Dirty/Walmart-Amazon, loss: 0.00340425968170166
step: 340, task: Dirty/Walmart-Amazon, loss: 0.00045333802700042725
step: 350, task: Dirty/Walmart-Amazon, loss: 0.004977323114871979
step: 360, task: Dirty/Walmart-Amazon, loss: 0.0086669921875
step: 370, task: Dirty/Walmart-Amazon, loss: 0.0009587109088897705
step: 380, task: Dirty/Walmart-Amazon, loss: 0.0011565834283828735
=========eval at epoch=6=========
Validation:
=============Dirty/Walmart-Amazon==================
accuracy=0.908
precision=1.000
recall=0.021
f1=0.041
======================================
Test:
=============Dirty/Walmart-Amazon==================
accuracy=0.907
precision=0.800
recall=0.021
f1=0.040
======================================
=====sanity check======
words: COL title VAL xerox 108r00676 extended-capacity maintenance kit for phaser 8550 printer printers 108r00676 151.54 COL category VAL  COL brand VAL xerox COL modelno VAL  COL price VAL   [SEP] COL title VAL ld xerox phaser 8500 8550 8560 remanufactured 108r00675 standard-capacity maintenance kit laser printer toner 89.99 COL category VAL  COL brand VAL 4inkjets COL modelno VAL  COL price VAL  
x: [    0 18047  1270 27445  3023   254  4325 13955   338   612 39071  3112
    12 25421  4861 10549    13  7843 12425  5663  1096 24079 29379 13955
   338   612 39071 25936     4  4283 14857  4120 27445  1437 14857  1518
 27445  3023   254  4325 14857  1421  2362 27445  1437 14857   425 27445
  1437  1437     2     2 18047  1270 27445   784   417  3023   254  4325
  7843 12425   290  1497 50141  4531  1096 50141  4531  2466   769 29280
  4075 13955   338 38049  2545  2526    12 25421  4861 10549 13443 24079
  4866   254  8572     4  2831 14857  4120 27445  1437 14857  1518 27445
   204  4291   267  2580 14857  1421  2362 27445  1437 14857   425 27445
  1437  1437     2]
tokens: ['<s>', 'COL', 'Ġtitle', 'ĠVAL', 'Ġx', 'er', 'ox', 'Ġ108', 'r', '00', '676', 'Ġextended', '-', 'capacity', 'Ġmaintenance', 'Ġkit', 'Ġfor', 'Ġph', 'aser', 'Ġ85', '50', 'Ġprinter', 'Ġprinters', 'Ġ108', 'r', '00', '676', 'Ġ151', '.', '54', 'ĠCOL', 'Ġcategory', 'ĠVAL', 'Ġ', 'ĠCOL', 'Ġbrand', 'ĠVAL', 'Ġx', 'er', 'ox', 'ĠCOL', 'Ġmodel', 'no', 'ĠVAL', 'Ġ', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ', 'Ġ', '</s>', '</s>', 'COL', 'Ġtitle', 'ĠVAL', 'Ġl', 'd', 'Ġx', 'er', 'ox', 'Ġph', 'aser', 'Ġ8', '500', 'Âł', '85', '50', 'Âł', '85', '60', 'Ġre', 'manufact', 'ured', 'Ġ108', 'r', '006', '75', 'Ġstandard', '-', 'capacity', 'Ġmaintenance', 'Ġkit', 'Ġlaser', 'Ġprinter', 'Ġton', 'er', 'Ġ89', '.', '99', 'ĠCOL', 'Ġcategory', 'ĠVAL', 'Ġ', 'ĠCOL', 'Ġbrand', 'ĠVAL', 'Ġ4', 'ink', 'j', 'ets', 'ĠCOL', 'Ġmodel', 'no', 'ĠVAL', 'Ġ', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ', 'Ġ', '</s>']
is_heads: [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
y: 0
tags: 0
mask: tensor([1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1])
seqlen: 111
task_name: Dirty/Walmart-Amazon
=======================
step: 0, task: Dirty/Walmart-Amazon, loss: 0.000409930944442749
step: 10, task: Dirty/Walmart-Amazon, loss: 0.0012455284595489502
step: 20, task: Dirty/Walmart-Amazon, loss: 0.0003265291452407837
step: 30, task: Dirty/Walmart-Amazon, loss: 0.00023923814296722412
step: 40, task: Dirty/Walmart-Amazon, loss: 0.00046318769454956055
step: 50, task: Dirty/Walmart-Amazon, loss: 0.3369508683681488
step: 60, task: Dirty/Walmart-Amazon, loss: 0.0003194063901901245
step: 70, task: Dirty/Walmart-Amazon, loss: 0.00045593082904815674
Gradient overflow.  Skipping step, loss scaler 0 reducing loss scale to 4096.0
step: 80, task: Dirty/Walmart-Amazon, loss: 0.000517234206199646
step: 90, task: Dirty/Walmart-Amazon, loss: 0.0009087473154067993
step: 100, task: Dirty/Walmart-Amazon, loss: 0.07057584822177887
step: 110, task: Dirty/Walmart-Amazon, loss: 0.0025219619274139404
step: 120, task: Dirty/Walmart-Amazon, loss: 0.007479168474674225
step: 130, task: Dirty/Walmart-Amazon, loss: 0.0011238455772399902
step: 140, task: Dirty/Walmart-Amazon, loss: 0.00026507675647735596
step: 150, task: Dirty/Walmart-Amazon, loss: 0.00046284496784210205
step: 160, task: Dirty/Walmart-Amazon, loss: 0.00017298758029937744
step: 170, task: Dirty/Walmart-Amazon, loss: 0.0004574805498123169
step: 180, task: Dirty/Walmart-Amazon, loss: 0.0007599890232086182
step: 190, task: Dirty/Walmart-Amazon, loss: 0.0006789565086364746
step: 200, task: Dirty/Walmart-Amazon, loss: 0.0011312514543533325
step: 210, task: Dirty/Walmart-Amazon, loss: 0.0003049224615097046
step: 220, task: Dirty/Walmart-Amazon, loss: 0.010012395679950714
step: 230, task: Dirty/Walmart-Amazon, loss: 0.015589341521263123
step: 240, task: Dirty/Walmart-Amazon, loss: 0.003471076488494873
step: 250, task: Dirty/Walmart-Amazon, loss: 0.0003137141466140747
step: 260, task: Dirty/Walmart-Amazon, loss: 0.0003531724214553833
step: 270, task: Dirty/Walmart-Amazon, loss: 0.0006128102540969849
step: 280, task: Dirty/Walmart-Amazon, loss: 0.00030972063541412354
step: 290, task: Dirty/Walmart-Amazon, loss: 0.00042501091957092285
step: 300, task: Dirty/Walmart-Amazon, loss: 0.6130907535552979
step: 310, task: Dirty/Walmart-Amazon, loss: 0.0003155618906021118
step: 320, task: Dirty/Walmart-Amazon, loss: 0.00039008259773254395
step: 330, task: Dirty/Walmart-Amazon, loss: 0.0073134079575538635
step: 340, task: Dirty/Walmart-Amazon, loss: 0.001682281494140625
step: 350, task: Dirty/Walmart-Amazon, loss: 0.000283658504486084
step: 360, task: Dirty/Walmart-Amazon, loss: 0.0002490133047103882
step: 370, task: Dirty/Walmart-Amazon, loss: 0.0004122406244277954
step: 380, task: Dirty/Walmart-Amazon, loss: 0.0004191100597381592
=========eval at epoch=7=========
Validation:
=============Dirty/Walmart-Amazon==================
accuracy=0.908
precision=1.000
recall=0.021
f1=0.041
======================================
Test:
=============Dirty/Walmart-Amazon==================
accuracy=0.908
precision=1.000
recall=0.021
f1=0.041
======================================
=====sanity check======
words: COL title VAL uniden 1360bk desktop corded phone with caller id black electronics - general 1360bk COL category VAL  COL brand VAL uniden COL modelno VAL  COL price VAL 23.98  [SEP] COL title VAL uniden 1360bk desktop corded telephone black one phone corded telephones uniden 1360bk COL category VAL  COL brand VAL  COL modelno VAL  COL price VAL 19.9 
x: [    0 18047  1270 27445   542 12145   508  2466   428   330 14050 13051
   196  1028    19 17017 13561   909  8917   111   937   508  2466   428
   330 14857  4120 27445  1437 14857  1518 27445   542 12145 14857  1421
  2362 27445  1437 14857   425 27445   883     4  5208  1437     2     2
 18047  1270 27445   542 12145   508  2466   428   330 14050 13051   196
  7377   909    65  1028 13051   196  8327 15797   542 12145   508  2466
   428   330 14857  4120 27445  1437 14857  1518 27445  1437 14857  1421
  2362 27445  1437 14857   425 27445   753     4   466  1437     2]
tokens: ['<s>', 'COL', 'Ġtitle', 'ĠVAL', 'Ġun', 'iden', 'Ġ13', '60', 'b', 'k', 'Ġdesktop', 'Ġcord', 'ed', 'Ġphone', 'Ġwith', 'Ġcaller', 'Ġid', 'Ġblack', 'Ġelectronics', 'Ġ-', 'Ġgeneral', 'Ġ13', '60', 'b', 'k', 'ĠCOL', 'Ġcategory', 'ĠVAL', 'Ġ', 'ĠCOL', 'Ġbrand', 'ĠVAL', 'Ġun', 'iden', 'ĠCOL', 'Ġmodel', 'no', 'ĠVAL', 'Ġ', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ23', '.', '98', 'Ġ', '</s>', '</s>', 'COL', 'Ġtitle', 'ĠVAL', 'Ġun', 'iden', 'Ġ13', '60', 'b', 'k', 'Ġdesktop', 'Ġcord', 'ed', 'Ġtelephone', 'Ġblack', 'Ġone', 'Ġphone', 'Ġcord', 'ed', 'Ġtele', 'phones', 'Ġun', 'iden', 'Ġ13', '60', 'b', 'k', 'ĠCOL', 'Ġcategory', 'ĠVAL', 'Ġ', 'ĠCOL', 'Ġbrand', 'ĠVAL', 'Ġ', 'ĠCOL', 'Ġmodel', 'no', 'ĠVAL', 'Ġ', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ19', '.', '9', 'Ġ', '</s>']
is_heads: [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
y: 1
tags: 1
mask: tensor([1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1])
seqlen: 95
task_name: Dirty/Walmart-Amazon
=======================
step: 0, task: Dirty/Walmart-Amazon, loss: 0.0005036890506744385
step: 10, task: Dirty/Walmart-Amazon, loss: 0.000257641077041626
step: 20, task: Dirty/Walmart-Amazon, loss: 0.01877409964799881
step: 30, task: Dirty/Walmart-Amazon, loss: 0.0011710971593856812
step: 40, task: Dirty/Walmart-Amazon, loss: 0.039899736642837524
step: 50, task: Dirty/Walmart-Amazon, loss: 0.0040071457624435425
step: 60, task: Dirty/Walmart-Amazon, loss: 0.0015415996313095093
step: 70, task: Dirty/Walmart-Amazon, loss: 0.0012468695640563965
step: 80, task: Dirty/Walmart-Amazon, loss: 0.002134189009666443
step: 90, task: Dirty/Walmart-Amazon, loss: 0.019362054765224457
step: 100, task: Dirty/Walmart-Amazon, loss: 0.00035130977630615234
step: 110, task: Dirty/Walmart-Amazon, loss: 0.000781625509262085
step: 120, task: Dirty/Walmart-Amazon, loss: 0.0003876239061355591
step: 130, task: Dirty/Walmart-Amazon, loss: 0.0005387067794799805
step: 140, task: Dirty/Walmart-Amazon, loss: 0.0005838721990585327
step: 150, task: Dirty/Walmart-Amazon, loss: 0.00031381845474243164
step: 160, task: Dirty/Walmart-Amazon, loss: 0.0006711035966873169
step: 170, task: Dirty/Walmart-Amazon, loss: 0.00035031139850616455
step: 180, task: Dirty/Walmart-Amazon, loss: 0.00041025876998901367
step: 190, task: Dirty/Walmart-Amazon, loss: 0.0005523264408111572
step: 200, task: Dirty/Walmart-Amazon, loss: 0.027854301035404205
step: 210, task: Dirty/Walmart-Amazon, loss: 0.0009050667285919189
step: 220, task: Dirty/Walmart-Amazon, loss: 0.00023774802684783936
step: 230, task: Dirty/Walmart-Amazon, loss: 0.0006488710641860962
step: 240, task: Dirty/Walmart-Amazon, loss: 0.001214340329170227
step: 250, task: Dirty/Walmart-Amazon, loss: 0.0002816915512084961
step: 260, task: Dirty/Walmart-Amazon, loss: 0.00024369359016418457
step: 270, task: Dirty/Walmart-Amazon, loss: 0.00041772425174713135
step: 280, task: Dirty/Walmart-Amazon, loss: 0.000322878360748291
step: 290, task: Dirty/Walmart-Amazon, loss: 0.002940036356449127
step: 300, task: Dirty/Walmart-Amazon, loss: 0.44497013092041016
step: 310, task: Dirty/Walmart-Amazon, loss: 0.00044499337673187256
step: 320, task: Dirty/Walmart-Amazon, loss: 0.0012810975313186646
step: 330, task: Dirty/Walmart-Amazon, loss: 0.05524665117263794
step: 340, task: Dirty/Walmart-Amazon, loss: 0.0027607232332229614
step: 350, task: Dirty/Walmart-Amazon, loss: 0.0003577619791030884
step: 360, task: Dirty/Walmart-Amazon, loss: 0.0014782249927520752
step: 370, task: Dirty/Walmart-Amazon, loss: 0.0008752197027206421
step: 380, task: Dirty/Walmart-Amazon, loss: 0.13690313696861267
=========eval at epoch=8=========
Validation:
=============Dirty/Walmart-Amazon==================
accuracy=0.909
precision=1.000
recall=0.031
f1=0.060
======================================
Test:
=============Dirty/Walmart-Amazon==================
accuracy=0.906
precision=0.667
recall=0.010
f1=0.020
======================================
Selected optimization level O2:  FP16 training with FP32 batchnorm and FP32 master weights.

Defaults for this optimization level are:
enabled                : True
opt_level              : O2
cast_model_type        : torch.float16
patch_torch_functions  : False
keep_batchnorm_fp32    : True
master_weights         : True
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O2
cast_model_type        : torch.float16
patch_torch_functions  : False
keep_batchnorm_fp32    : True
master_weights         : True
loss_scale             : dynamic
Warning:  multi_tensor_applier fused unscale kernel is unavailable, possibly because apex was installed without --cuda_ext --cpp_ext. Using Python fallback.  Original ImportError was: ModuleNotFoundError("No module named 'amp_C'")
Gradient overflow.  Skipping step, loss scaler 0 reducing loss scale to 32768.0
=====sanity check======
words: COL title VAL microsoft publisher 2010 software COL category VAL  COL brand VAL microsoft COL modelno VAL 164-06233 COL price VAL 117.54  [SEP] COL title VAL microsoft visio premium 2010 computer accessories microsoft COL category VAL  COL brand VAL  COL modelno VAL tsd-01040 COL price VAL 633.98 
x: [    0 18047  1270 27445  5177 24810 10710  1824  2257 14857  4120 27445
  1437 14857  1518 27445  5177 24810 14857  1421  2362 27445 27983    12
  4124 29291 14857   425 27445 16662     4  4283  1437     2     2 18047
  1270 27445  5177 24810 17737  1020  4549  1824  3034 10131  5177 24810
 14857  4120 27445  1437 14857  1518 27445  1437 14857  1421  2362 27445
   326 28045    12 30583  1749 14857   425 27445   231  3103     4  5208
  1437     2]
tokens: ['<s>', 'COL', 'Ġtitle', 'ĠVAL', 'Ġmicro', 'soft', 'Ġpublisher', 'Ġ2010', 'Ġsoftware', 'ĠCOL', 'Ġcategory', 'ĠVAL', 'Ġ', 'ĠCOL', 'Ġbrand', 'ĠVAL', 'Ġmicro', 'soft', 'ĠCOL', 'Ġmodel', 'no', 'ĠVAL', 'Ġ164', '-', '06', '233', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ117', '.', '54', 'Ġ', '</s>', '</s>', 'COL', 'Ġtitle', 'ĠVAL', 'Ġmicro', 'soft', 'Ġvis', 'io', 'Ġpremium', 'Ġ2010', 'Ġcomputer', 'Ġaccessories', 'Ġmicro', 'soft', 'ĠCOL', 'Ġcategory', 'ĠVAL', 'Ġ', 'ĠCOL', 'Ġbrand', 'ĠVAL', 'Ġ', 'ĠCOL', 'Ġmodel', 'no', 'ĠVAL', 'Ġt', 'sd', '-', '010', '40', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ6', '33', '.', '98', 'Ġ', '</s>']
is_heads: [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
y: 0
tags: 0
mask: tensor([1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1])
seqlen: 74
task_name: Dirty/Walmart-Amazon
=======================
step: 0, task: Dirty/Walmart-Amazon, loss: 1.334380865097046
Gradient overflow.  Skipping step, loss scaler 0 reducing loss scale to 16384.0
Gradient overflow.  Skipping step, loss scaler 0 reducing loss scale to 8192.0
Gradient overflow.  Skipping step, loss scaler 0 reducing loss scale to 4096.0
step: 10, task: Dirty/Walmart-Amazon, loss: 1.0624098777770996
step: 20, task: Dirty/Walmart-Amazon, loss: 1.0207655429840088
step: 30, task: Dirty/Walmart-Amazon, loss: 0.855495274066925
step: 40, task: Dirty/Walmart-Amazon, loss: 0.4204540550708771
step: 50, task: Dirty/Walmart-Amazon, loss: 0.5001485347747803
step: 60, task: Dirty/Walmart-Amazon, loss: 0.18739771842956543
step: 70, task: Dirty/Walmart-Amazon, loss: 0.13149280846118927
step: 80, task: Dirty/Walmart-Amazon, loss: 0.2293986976146698
step: 90, task: Dirty/Walmart-Amazon, loss: 0.582346498966217
step: 100, task: Dirty/Walmart-Amazon, loss: 0.34099385142326355
step: 110, task: Dirty/Walmart-Amazon, loss: 0.0914844423532486
step: 120, task: Dirty/Walmart-Amazon, loss: 0.6909766793251038
step: 130, task: Dirty/Walmart-Amazon, loss: 0.671705961227417
step: 140, task: Dirty/Walmart-Amazon, loss: 0.22680604457855225
step: 150, task: Dirty/Walmart-Amazon, loss: 0.09552916884422302
step: 160, task: Dirty/Walmart-Amazon, loss: 0.23825132846832275
step: 170, task: Dirty/Walmart-Amazon, loss: 0.054293230175971985
step: 180, task: Dirty/Walmart-Amazon, loss: 0.5123567581176758
step: 190, task: Dirty/Walmart-Amazon, loss: 0.571243405342102
step: 200, task: Dirty/Walmart-Amazon, loss: 0.4066852927207947
step: 210, task: Dirty/Walmart-Amazon, loss: 0.07427192479372025
step: 220, task: Dirty/Walmart-Amazon, loss: 0.10627172142267227
step: 230, task: Dirty/Walmart-Amazon, loss: 0.3372304439544678
step: 240, task: Dirty/Walmart-Amazon, loss: 0.04088693857192993
step: 250, task: Dirty/Walmart-Amazon, loss: 0.08988934010267258
step: 260, task: Dirty/Walmart-Amazon, loss: 0.5392050743103027
step: 270, task: Dirty/Walmart-Amazon, loss: 0.12276282161474228
step: 280, task: Dirty/Walmart-Amazon, loss: 0.25332868099212646
step: 290, task: Dirty/Walmart-Amazon, loss: 0.027926482260227203
step: 300, task: Dirty/Walmart-Amazon, loss: 0.223348468542099
step: 310, task: Dirty/Walmart-Amazon, loss: 0.22902637720108032
step: 320, task: Dirty/Walmart-Amazon, loss: 0.22970078885555267
step: 330, task: Dirty/Walmart-Amazon, loss: 0.03024919331073761
step: 340, task: Dirty/Walmart-Amazon, loss: 0.3703847825527191
step: 350, task: Dirty/Walmart-Amazon, loss: 0.4199311137199402
step: 360, task: Dirty/Walmart-Amazon, loss: 0.38960346579551697
step: 370, task: Dirty/Walmart-Amazon, loss: 0.026760056614875793
step: 380, task: Dirty/Walmart-Amazon, loss: 0.2524985671043396
=========eval at epoch=1=========
Validation:
=============Dirty/Walmart-Amazon==================
accuracy=0.902
precision=0.444
recall=0.145
f1=0.219
======================================
Test:
=============Dirty/Walmart-Amazon==================
accuracy=0.902
precision=0.420
recall=0.109
f1=0.173
======================================
/w/246/tianyu2020/miniconda2/envs/ditto/lib/python3.7/site-packages/apex/amp/_initialize.py:24: UserWarning: An input tensor was not cuda.
  warnings.warn("An input tensor was not cuda.")
/w/246/tianyu2020/miniconda2/envs/ditto/lib/python3.7/site-packages/torch/optim/lr_scheduler.py:122: UserWarning: Detected call of `lr_scheduler.step()` before `optimizer.step()`. In PyTorch 1.1.0 and later, you should call them in the opposite order: `optimizer.step()` before `lr_scheduler.step()`.  Failure to do this will result in PyTorch skipping the first value of the learning rate schedule. See more details at https://pytorch.org/docs/stable/optim.html#how-to-adjust-learning-rate
  "https://pytorch.org/docs/stable/optim.html#how-to-adjust-learning-rate", UserWarning)
=====sanity check======
words: COL title VAL startech 70 coaxial high resolution monitor vga cable electronics - general mxt101mmhq70 COL category VAL  COL brand VAL startech COL modelno VAL  COL price VAL 49.0  [SEP] COL title VAL startech.com 25-feet coax high resolution vga monitor cable - hd15 m m mxt101mmhq25 cables interconnects mxt101mmhq25 COL category VAL  COL brand VAL startech COL modelno VAL  COL price VAL 15.46 
x: [    0 18047  1270 27445   386  7529  1510 32698  2617   239  3547  5271
   748  2538  6129  8917   111   937   475 11483 12636  5471   298  1343
  3083 14857  4120 27445  1437 14857  1518 27445   386  7529 14857  1421
  2362 27445  1437 14857   425 27445  2766     4   288  1437     2     2
 18047  1270 27445   386  7529     4   175   564    12 22023 32698   239
  3547   748  2538  5271  6129   111  1368   417   996   475   475   475
 11483 12636  5471   298  1343  1244 19185  3222 24501    29   475 11483
 12636  5471   298  1343  1244 14857  4120 27445  1437 14857  1518 27445
   386  7529 14857  1421  2362 27445  1437 14857   425 27445   379     4
  3761  1437     2]
tokens: ['<s>', 'COL', 'Ġtitle', 'ĠVAL', 'Ġstart', 'ech', 'Ġ70', 'Ġcoax', 'ial', 'Ġhigh', 'Ġresolution', 'Ġmonitor', 'Ġv', 'ga', 'Ġcable', 'Ġelectronics', 'Ġ-', 'Ġgeneral', 'Ġm', 'xt', '101', 'mm', 'h', 'q', '70', 'ĠCOL', 'Ġcategory', 'ĠVAL', 'Ġ', 'ĠCOL', 'Ġbrand', 'ĠVAL', 'Ġstart', 'ech', 'ĠCOL', 'Ġmodel', 'no', 'ĠVAL', 'Ġ', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ49', '.', '0', 'Ġ', '</s>', '</s>', 'COL', 'Ġtitle', 'ĠVAL', 'Ġstart', 'ech', '.', 'com', 'Ġ25', '-', 'feet', 'Ġcoax', 'Ġhigh', 'Ġresolution', 'Ġv', 'ga', 'Ġmonitor', 'Ġcable', 'Ġ-', 'Ġh', 'd', '15', 'Ġm', 'Ġm', 'Ġm', 'xt', '101', 'mm', 'h', 'q', '25', 'Ġcables', 'Ġinter', 'connect', 's', 'Ġm', 'xt', '101', 'mm', 'h', 'q', '25', 'ĠCOL', 'Ġcategory', 'ĠVAL', 'Ġ', 'ĠCOL', 'Ġbrand', 'ĠVAL', 'Ġstart', 'ech', 'ĠCOL', 'Ġmodel', 'no', 'ĠVAL', 'Ġ', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ15', '.', '46', 'Ġ', '</s>']
is_heads: [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
y: 0
tags: 0
mask: tensor([1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1])
seqlen: 111
task_name: Dirty/Walmart-Amazon
=======================
step: 0, task: Dirty/Walmart-Amazon, loss: 0.01933157444000244
step: 10, task: Dirty/Walmart-Amazon, loss: 0.3663601279258728
step: 20, task: Dirty/Walmart-Amazon, loss: 0.07821739464998245
step: 30, task: Dirty/Walmart-Amazon, loss: 0.048223331570625305
step: 40, task: Dirty/Walmart-Amazon, loss: 0.10178595781326294
step: 50, task: Dirty/Walmart-Amazon, loss: 0.3809606432914734
step: 60, task: Dirty/Walmart-Amazon, loss: 0.23271068930625916
step: 70, task: Dirty/Walmart-Amazon, loss: 0.14250656962394714
step: 80, task: Dirty/Walmart-Amazon, loss: 0.05390503257513046
step: 90, task: Dirty/Walmart-Amazon, loss: 0.1484907865524292
step: 100, task: Dirty/Walmart-Amazon, loss: 0.28844618797302246
step: 110, task: Dirty/Walmart-Amazon, loss: 0.34476345777511597
step: 120, task: Dirty/Walmart-Amazon, loss: 0.15120738744735718
step: 130, task: Dirty/Walmart-Amazon, loss: 0.05459588021039963
step: 140, task: Dirty/Walmart-Amazon, loss: 0.12967441976070404
step: 150, task: Dirty/Walmart-Amazon, loss: 0.04501565918326378
step: 160, task: Dirty/Walmart-Amazon, loss: 0.01863228529691696
step: 170, task: Dirty/Walmart-Amazon, loss: 0.41683492064476013
step: 180, task: Dirty/Walmart-Amazon, loss: 0.12135449051856995
step: 190, task: Dirty/Walmart-Amazon, loss: 0.12541471421718597
step: 200, task: Dirty/Walmart-Amazon, loss: 0.0493689700961113
step: 210, task: Dirty/Walmart-Amazon, loss: 0.05033832788467407
step: 220, task: Dirty/Walmart-Amazon, loss: 0.3106303811073303
step: 230, task: Dirty/Walmart-Amazon, loss: 0.11647241562604904
step: 240, task: Dirty/Walmart-Amazon, loss: 0.006829649209976196
step: 250, task: Dirty/Walmart-Amazon, loss: 0.027365535497665405
step: 260, task: Dirty/Walmart-Amazon, loss: 0.05308457091450691
step: 270, task: Dirty/Walmart-Amazon, loss: 0.004240736365318298
step: 280, task: Dirty/Walmart-Amazon, loss: 0.05903694033622742
step: 290, task: Dirty/Walmart-Amazon, loss: 0.27267810702323914
step: 300, task: Dirty/Walmart-Amazon, loss: 0.05496787279844284
step: 310, task: Dirty/Walmart-Amazon, loss: 0.060108743607997894
step: 320, task: Dirty/Walmart-Amazon, loss: 0.056200459599494934
step: 330, task: Dirty/Walmart-Amazon, loss: 0.06047007068991661
step: 340, task: Dirty/Walmart-Amazon, loss: 0.044036053121089935
step: 350, task: Dirty/Walmart-Amazon, loss: 0.5284885168075562
step: 360, task: Dirty/Walmart-Amazon, loss: 0.14937445521354675
step: 370, task: Dirty/Walmart-Amazon, loss: 0.009193435311317444
step: 380, task: Dirty/Walmart-Amazon, loss: 0.08172119408845901
=========eval at epoch=2=========
Validation:
=============Dirty/Walmart-Amazon==================
accuracy=0.914
precision=0.743
recall=0.135
f1=0.228
======================================
Test:
=============Dirty/Walmart-Amazon==================
accuracy=0.910
precision=0.600
recall=0.124
f1=0.206
======================================
=====sanity check======
words: COL title VAL microsoft wireless desktop 800 for business 26.88 COL category VAL electronics - general COL brand VAL microsoft COL modelno VAL 5sh-00001 COL price VAL   [SEP] COL title VAL microsoft wireless desktop 800 keyboard and mouse combo keyboard mouse combos microsoft 2lf-00001 27.83 COL category VAL  COL brand VAL  COL modelno VAL  COL price VAL  
x: [    0 18047  1270 27445  5177 24810  6955 14050  5735    13   265   973
     4  4652 14857  4120 27445  8917   111   937 14857  1518 27445  5177
 24810 14857  1421  2362 27445   195  1193    12 14200   134 14857   425
 27445  1437  1437     2     2 18047  1270 27445  5177 24810  6955 14050
  5735 12722     8 18292 23358 12722 18292 44505  5177 24810   132 13491
    12 14200   134   974     4  6361 14857  4120 27445  1437 14857  1518
 27445  1437 14857  1421  2362 27445  1437 14857   425 27445  1437  1437
     2]
tokens: ['<s>', 'COL', 'Ġtitle', 'ĠVAL', 'Ġmicro', 'soft', 'Ġwireless', 'Ġdesktop', 'Ġ800', 'Ġfor', 'Ġbusiness', 'Ġ26', '.', '88', 'ĠCOL', 'Ġcategory', 'ĠVAL', 'Ġelectronics', 'Ġ-', 'Ġgeneral', 'ĠCOL', 'Ġbrand', 'ĠVAL', 'Ġmicro', 'soft', 'ĠCOL', 'Ġmodel', 'no', 'ĠVAL', 'Ġ5', 'sh', '-', '0000', '1', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ', 'Ġ', '</s>', '</s>', 'COL', 'Ġtitle', 'ĠVAL', 'Ġmicro', 'soft', 'Ġwireless', 'Ġdesktop', 'Ġ800', 'Ġkeyboard', 'Ġand', 'Ġmouse', 'Ġcombo', 'Ġkeyboard', 'Ġmouse', 'Ġcombos', 'Ġmicro', 'soft', 'Ġ2', 'lf', '-', '0000', '1', 'Ġ27', '.', '83', 'ĠCOL', 'Ġcategory', 'ĠVAL', 'Ġ', 'ĠCOL', 'Ġbrand', 'ĠVAL', 'Ġ', 'ĠCOL', 'Ġmodel', 'no', 'ĠVAL', 'Ġ', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ', 'Ġ', '</s>']
is_heads: [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
y: 0
tags: 0
mask: tensor([1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1])
seqlen: 85
task_name: Dirty/Walmart-Amazon
=======================
step: 0, task: Dirty/Walmart-Amazon, loss: 0.10136160254478455
step: 10, task: Dirty/Walmart-Amazon, loss: 0.008954405784606934
step: 20, task: Dirty/Walmart-Amazon, loss: 0.011987604200839996
step: 30, task: Dirty/Walmart-Amazon, loss: 0.3531275987625122
step: 40, task: Dirty/Walmart-Amazon, loss: 0.3558858036994934
step: 50, task: Dirty/Walmart-Amazon, loss: 0.02639329433441162
step: 60, task: Dirty/Walmart-Amazon, loss: 0.012283936142921448
step: 70, task: Dirty/Walmart-Amazon, loss: 0.10831616073846817
step: 80, task: Dirty/Walmart-Amazon, loss: 0.21818087995052338
step: 90, task: Dirty/Walmart-Amazon, loss: 0.0018786340951919556
step: 100, task: Dirty/Walmart-Amazon, loss: 0.0039929598569869995
step: 110, task: Dirty/Walmart-Amazon, loss: 0.15805847942829132
step: 120, task: Dirty/Walmart-Amazon, loss: 0.07829714566469193
step: 130, task: Dirty/Walmart-Amazon, loss: 0.012959286570549011
step: 140, task: Dirty/Walmart-Amazon, loss: 0.041969627141952515
step: 150, task: Dirty/Walmart-Amazon, loss: 0.31098562479019165
step: 160, task: Dirty/Walmart-Amazon, loss: 0.030244775116443634
step: 170, task: Dirty/Walmart-Amazon, loss: 0.051866594702005386
step: 180, task: Dirty/Walmart-Amazon, loss: 0.012062110006809235
step: 190, task: Dirty/Walmart-Amazon, loss: 0.040672071278095245
step: 200, task: Dirty/Walmart-Amazon, loss: 0.02733377367258072
step: 210, task: Dirty/Walmart-Amazon, loss: 0.015303894877433777
step: 220, task: Dirty/Walmart-Amazon, loss: 0.04169435054063797
step: 230, task: Dirty/Walmart-Amazon, loss: 0.00886477530002594
step: 240, task: Dirty/Walmart-Amazon, loss: 0.008287273347377777
step: 250, task: Dirty/Walmart-Amazon, loss: 0.015506185591220856
step: 260, task: Dirty/Walmart-Amazon, loss: 0.05594345182180405
step: 270, task: Dirty/Walmart-Amazon, loss: 0.004794470965862274
step: 280, task: Dirty/Walmart-Amazon, loss: 0.010527119040489197
step: 290, task: Dirty/Walmart-Amazon, loss: 0.017225943505764008
step: 300, task: Dirty/Walmart-Amazon, loss: 0.005223467946052551
step: 310, task: Dirty/Walmart-Amazon, loss: 0.08677468448877335
step: 320, task: Dirty/Walmart-Amazon, loss: 0.18138283491134644
step: 330, task: Dirty/Walmart-Amazon, loss: 0.038330864161252975
step: 340, task: Dirty/Walmart-Amazon, loss: 0.13677920401096344
step: 350, task: Dirty/Walmart-Amazon, loss: 0.03152156621217728
step: 360, task: Dirty/Walmart-Amazon, loss: 0.022009611129760742
step: 370, task: Dirty/Walmart-Amazon, loss: 0.3611351549625397
step: 380, task: Dirty/Walmart-Amazon, loss: 0.05264677852392197
=========eval at epoch=3=========
Validation:
=============Dirty/Walmart-Amazon==================
accuracy=0.909
precision=1.000
recall=0.031
f1=0.060
======================================
Test:
=============Dirty/Walmart-Amazon==================
accuracy=0.907
precision=1.000
recall=0.016
f1=0.031
======================================
=====sanity check======
words: COL title VAL corsair cm2x2048-6400c5 xms2 2gb pc2-6400 800mhz 240-pin ddr2 cl5 dual channel desktop memory kit memory 40.82 COL category VAL  COL brand VAL corsair COL modelno VAL cm2x2048-6400c5 COL price VAL   [SEP] COL title VAL corsair memory vs2gb667d2 2 gb pc2-5300 667mhz 240-pin ddr2 dual channel desktop memory computers accessories vs2gb667d2 22.99 COL category VAL  COL brand VAL corsair COL modelno VAL  COL price VAL  
x: [    0 18047  1270 27445   740   994  2456 25434   176  1178   844  3818
    12  4027   612   438   245  3023  4339   176   132 19562 46213   176
    12  4027   612  5735   119 39569 15452    12 10188   385 10232   176
  3741   245  6594  4238 14050  3783 10549  3783   843     4  6551 14857
  4120 27445  1437 14857  1518 27445   740   994  2456 14857  1421  2362
 27445 25434   176  1178   844  3818    12  4027   612   438   245 14857
   425 27445  1437  1437     2     2 18047  1270 27445   740   994  2456
  3783  1954   176 19562 29312   417   176   132   821   428 46213   176
    12  4540   612   231  4111   119 39569 15452    12 10188   385 10232
   176  6594  4238 14050  3783  7796 10131  1954   176 19562 29312   417
   176   820     4  2831 14857  4120 27445  1437 14857  1518 27445   740
   994  2456 14857  1421  2362 27445  1437 14857   425 27445  1437  1437
     2]
tokens: ['<s>', 'COL', 'Ġtitle', 'ĠVAL', 'Ġc', 'ors', 'air', 'Ġcm', '2', 'x', '20', '48', '-', '64', '00', 'c', '5', 'Ġx', 'ms', '2', 'Ġ2', 'gb', 'Ġpc', '2', '-', '64', '00', 'Ġ800', 'm', 'hz', 'Ġ240', '-', 'pin', 'Ġd', 'dr', '2', 'Ġcl', '5', 'Ġdual', 'Ġchannel', 'Ġdesktop', 'Ġmemory', 'Ġkit', 'Ġmemory', 'Ġ40', '.', '82', 'ĠCOL', 'Ġcategory', 'ĠVAL', 'Ġ', 'ĠCOL', 'Ġbrand', 'ĠVAL', 'Ġc', 'ors', 'air', 'ĠCOL', 'Ġmodel', 'no', 'ĠVAL', 'Ġcm', '2', 'x', '20', '48', '-', '64', '00', 'c', '5', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ', 'Ġ', '</s>', '</s>', 'COL', 'Ġtitle', 'ĠVAL', 'Ġc', 'ors', 'air', 'Ġmemory', 'Ġvs', '2', 'gb', '667', 'd', '2', 'Ġ2', 'Ġg', 'b', 'Ġpc', '2', '-', '53', '00', 'Ġ6', '67', 'm', 'hz', 'Ġ240', '-', 'pin', 'Ġd', 'dr', '2', 'Ġdual', 'Ġchannel', 'Ġdesktop', 'Ġmemory', 'Ġcomputers', 'Ġaccessories', 'Ġvs', '2', 'gb', '667', 'd', '2', 'Ġ22', '.', '99', 'ĠCOL', 'Ġcategory', 'ĠVAL', 'Ġ', 'ĠCOL', 'Ġbrand', 'ĠVAL', 'Ġc', 'ors', 'air', 'ĠCOL', 'Ġmodel', 'no', 'ĠVAL', 'Ġ', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ', 'Ġ', '</s>']
is_heads: [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
y: 0
tags: 0
mask: tensor([1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1])
seqlen: 145
task_name: Dirty/Walmart-Amazon
=======================
step: 0, task: Dirty/Walmart-Amazon, loss: 0.09536692500114441
step: 10, task: Dirty/Walmart-Amazon, loss: 0.038158878684043884
step: 20, task: Dirty/Walmart-Amazon, loss: 0.01972232013940811
step: 30, task: Dirty/Walmart-Amazon, loss: 0.10845906287431717
step: 40, task: Dirty/Walmart-Amazon, loss: 0.0010998547077178955
step: 50, task: Dirty/Walmart-Amazon, loss: 0.029194720089435577
step: 60, task: Dirty/Walmart-Amazon, loss: 0.014031782746315002
step: 70, task: Dirty/Walmart-Amazon, loss: 0.19063371419906616
step: 80, task: Dirty/Walmart-Amazon, loss: 0.01185675710439682
step: 90, task: Dirty/Walmart-Amazon, loss: 0.03660685569047928
step: 100, task: Dirty/Walmart-Amazon, loss: 0.0025697648525238037
step: 110, task: Dirty/Walmart-Amazon, loss: 0.004577726125717163
step: 120, task: Dirty/Walmart-Amazon, loss: 0.01466667652130127
step: 130, task: Dirty/Walmart-Amazon, loss: 0.009344615042209625
step: 140, task: Dirty/Walmart-Amazon, loss: 0.003725022077560425
step: 150, task: Dirty/Walmart-Amazon, loss: 0.337441623210907
step: 160, task: Dirty/Walmart-Amazon, loss: 0.011322982609272003
step: 170, task: Dirty/Walmart-Amazon, loss: 0.1631031185388565
step: 180, task: Dirty/Walmart-Amazon, loss: 0.0020399093627929688
step: 190, task: Dirty/Walmart-Amazon, loss: 0.13698279857635498
step: 200, task: Dirty/Walmart-Amazon, loss: 0.030420973896980286
step: 210, task: Dirty/Walmart-Amazon, loss: 0.41844791173934937
step: 220, task: Dirty/Walmart-Amazon, loss: 0.2502312958240509
step: 230, task: Dirty/Walmart-Amazon, loss: 0.034535858780145645
step: 240, task: Dirty/Walmart-Amazon, loss: 0.2277686446905136
step: 250, task: Dirty/Walmart-Amazon, loss: 0.3016919493675232
step: 260, task: Dirty/Walmart-Amazon, loss: 0.007998593151569366
step: 270, task: Dirty/Walmart-Amazon, loss: 0.06731948256492615
step: 280, task: Dirty/Walmart-Amazon, loss: 0.005416572093963623
step: 290, task: Dirty/Walmart-Amazon, loss: 0.11923785507678986
step: 300, task: Dirty/Walmart-Amazon, loss: 0.038569480180740356
step: 310, task: Dirty/Walmart-Amazon, loss: 0.005508005619049072
step: 320, task: Dirty/Walmart-Amazon, loss: 0.036924682557582855
step: 330, task: Dirty/Walmart-Amazon, loss: 0.42721930146217346
step: 340, task: Dirty/Walmart-Amazon, loss: 0.00740736722946167
step: 350, task: Dirty/Walmart-Amazon, loss: 0.014833010733127594
step: 360, task: Dirty/Walmart-Amazon, loss: 0.01190938800573349
step: 370, task: Dirty/Walmart-Amazon, loss: 0.020641714334487915
step: 380, task: Dirty/Walmart-Amazon, loss: 0.030434444546699524
=========eval at epoch=4=========
Validation:
=============Dirty/Walmart-Amazon==================
accuracy=0.914
precision=0.864
recall=0.098
f1=0.177
======================================
Test:
=============Dirty/Walmart-Amazon==================
accuracy=0.909
precision=0.684
recall=0.067
f1=0.123
======================================
=====sanity check======
words: COL title VAL da-lite da-glas standard rear projection screen 81 x 108 video format da-lite 27917 5391.99 COL category VAL electronics - general COL brand VAL  COL modelno VAL  COL price VAL   [SEP] COL title VAL da-lite 27639 da-glas standard rear projection screen 72 x 96 video format COL category VAL projection screens COL brand VAL da-lite COL modelno VAL  COL price VAL  
x: [    0 18047  1270 27445  2955    12 33701  2955    12 39473  2526  5081
 18144  2441  7694  3023 13955   569  7390  2955    12 33701 37191  1360
   195 35848     4  2831 14857  4120 27445  8917   111   937 14857  1518
 27445  1437 14857  1421  2362 27445  1437 14857   425 27445  1437  1437
     2     2 18047  1270 27445  2955    12 33701 36803  3416  2955    12
 39473  2526  5081 18144  2441  4801  3023  8971   569  7390 14857  4120
 27445 18144  8545 14857  1518 27445  2955    12 33701 14857  1421  2362
 27445  1437 14857   425 27445  1437  1437     2]
tokens: ['<s>', 'COL', 'Ġtitle', 'ĠVAL', 'Ġda', '-', 'lite', 'Ġda', '-', 'glas', 'Ġstandard', 'Ġrear', 'Ġprojection', 'Ġscreen', 'Ġ81', 'Ġx', 'Ġ108', 'Ġvideo', 'Ġformat', 'Ġda', '-', 'lite', 'Ġ279', '17', 'Ġ5', '391', '.', '99', 'ĠCOL', 'Ġcategory', 'ĠVAL', 'Ġelectronics', 'Ġ-', 'Ġgeneral', 'ĠCOL', 'Ġbrand', 'ĠVAL', 'Ġ', 'ĠCOL', 'Ġmodel', 'no', 'ĠVAL', 'Ġ', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ', 'Ġ', '</s>', '</s>', 'COL', 'Ġtitle', 'ĠVAL', 'Ġda', '-', 'lite', 'Ġ276', '39', 'Ġda', '-', 'glas', 'Ġstandard', 'Ġrear', 'Ġprojection', 'Ġscreen', 'Ġ72', 'Ġx', 'Ġ96', 'Ġvideo', 'Ġformat', 'ĠCOL', 'Ġcategory', 'ĠVAL', 'Ġprojection', 'Ġscreens', 'ĠCOL', 'Ġbrand', 'ĠVAL', 'Ġda', '-', 'lite', 'ĠCOL', 'Ġmodel', 'no', 'ĠVAL', 'Ġ', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ', 'Ġ', '</s>']
is_heads: [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
y: 0
tags: 0
mask: tensor([1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1])
seqlen: 92
task_name: Dirty/Walmart-Amazon
=======================
step: 0, task: Dirty/Walmart-Amazon, loss: 0.008382000029087067
step: 10, task: Dirty/Walmart-Amazon, loss: 0.06025787442922592
step: 20, task: Dirty/Walmart-Amazon, loss: 0.020118851214647293
step: 30, task: Dirty/Walmart-Amazon, loss: 0.004583828151226044
step: 40, task: Dirty/Walmart-Amazon, loss: 0.0019807517528533936
step: 50, task: Dirty/Walmart-Amazon, loss: 0.008447960019111633
step: 60, task: Dirty/Walmart-Amazon, loss: 0.0017139017581939697
step: 70, task: Dirty/Walmart-Amazon, loss: 0.011675536632537842
step: 80, task: Dirty/Walmart-Amazon, loss: 0.34578898549079895
step: 90, task: Dirty/Walmart-Amazon, loss: 0.002609744668006897
step: 100, task: Dirty/Walmart-Amazon, loss: 0.003804251551628113
step: 110, task: Dirty/Walmart-Amazon, loss: 0.0014929324388504028
step: 120, task: Dirty/Walmart-Amazon, loss: 0.027703460305929184
step: 130, task: Dirty/Walmart-Amazon, loss: 0.03401757776737213
step: 140, task: Dirty/Walmart-Amazon, loss: 0.005694523453712463
step: 150, task: Dirty/Walmart-Amazon, loss: 0.008536294102668762
step: 160, task: Dirty/Walmart-Amazon, loss: 0.05527450889348984
step: 170, task: Dirty/Walmart-Amazon, loss: 0.224015012383461
step: 180, task: Dirty/Walmart-Amazon, loss: 0.06223665177822113
step: 190, task: Dirty/Walmart-Amazon, loss: 0.003695741295814514
step: 200, task: Dirty/Walmart-Amazon, loss: 0.13441036641597748
step: 210, task: Dirty/Walmart-Amazon, loss: 0.00984993577003479
step: 220, task: Dirty/Walmart-Amazon, loss: 0.025183238089084625
step: 230, task: Dirty/Walmart-Amazon, loss: 0.056205205619335175
step: 240, task: Dirty/Walmart-Amazon, loss: 0.37331753969192505
step: 250, task: Dirty/Walmart-Amazon, loss: 0.005246870219707489
step: 260, task: Dirty/Walmart-Amazon, loss: 0.10305590182542801
step: 270, task: Dirty/Walmart-Amazon, loss: 0.022465288639068604
step: 280, task: Dirty/Walmart-Amazon, loss: 0.015924252569675446
step: 290, task: Dirty/Walmart-Amazon, loss: 0.02841542661190033
step: 300, task: Dirty/Walmart-Amazon, loss: 0.01977868378162384
step: 310, task: Dirty/Walmart-Amazon, loss: 0.03701060637831688
step: 320, task: Dirty/Walmart-Amazon, loss: 0.00115947425365448
step: 330, task: Dirty/Walmart-Amazon, loss: 0.00703662633895874
step: 340, task: Dirty/Walmart-Amazon, loss: 0.015775926411151886
step: 350, task: Dirty/Walmart-Amazon, loss: 0.018985256552696228
step: 360, task: Dirty/Walmart-Amazon, loss: 0.06966998428106308
step: 370, task: Dirty/Walmart-Amazon, loss: 0.00589810311794281
step: 380, task: Dirty/Walmart-Amazon, loss: 0.05242544412612915
=========eval at epoch=5=========
Validation:
=============Dirty/Walmart-Amazon==================
accuracy=0.908
precision=1.000
recall=0.021
f1=0.041
======================================
Test:
=============Dirty/Walmart-Amazon==================
accuracy=0.906
precision=1.000
recall=0.005
f1=0.010
======================================
=====sanity check======
words: COL title VAL verbatim 95137 16x dvd-r media 95137 COL category VAL mp3 accessories COL brand VAL verbatim COL modelno VAL  COL price VAL 19.98  [SEP] COL title VAL 16x dvd-r media COL category VAL dvd-r discs COL brand VAL imation COL modelno VAL 17340 COL price VAL 6.99 
x: [    0 18047  1270 27445  4342 12161   757  6164 25319   545  1178   385
 40311    12   338   433  6164 25319 14857  4120 27445 44857   246 10131
 14857  1518 27445  4342 12161   757 14857  1421  2362 27445  1437 14857
   425 27445   753     4  5208  1437     2     2 18047  1270 27445   545
  1178   385 40311    12   338   433 14857  4120 27445   385 40311    12
   338 34634 14857  1518 27445  4356  1258 14857  1421  2362 27445   601
 24334 14857   425 27445   231     4  2831  1437     2]
tokens: ['<s>', 'COL', 'Ġtitle', 'ĠVAL', 'Ġver', 'bat', 'im', 'Ġ95', '137', 'Ġ16', 'x', 'Ġd', 'vd', '-', 'r', 'Ġmedia', 'Ġ95', '137', 'ĠCOL', 'Ġcategory', 'ĠVAL', 'Ġmp', '3', 'Ġaccessories', 'ĠCOL', 'Ġbrand', 'ĠVAL', 'Ġver', 'bat', 'im', 'ĠCOL', 'Ġmodel', 'no', 'ĠVAL', 'Ġ', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ19', '.', '98', 'Ġ', '</s>', '</s>', 'COL', 'Ġtitle', 'ĠVAL', 'Ġ16', 'x', 'Ġd', 'vd', '-', 'r', 'Ġmedia', 'ĠCOL', 'Ġcategory', 'ĠVAL', 'Ġd', 'vd', '-', 'r', 'Ġdiscs', 'ĠCOL', 'Ġbrand', 'ĠVAL', 'Ġim', 'ation', 'ĠCOL', 'Ġmodel', 'no', 'ĠVAL', 'Ġ17', '340', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ6', '.', '99', 'Ġ', '</s>']
is_heads: [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
y: 0
tags: 0
mask: tensor([1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1])
seqlen: 81
task_name: Dirty/Walmart-Amazon
=======================
step: 0, task: Dirty/Walmart-Amazon, loss: 0.008107379078865051
step: 10, task: Dirty/Walmart-Amazon, loss: 0.0013407766819000244
step: 20, task: Dirty/Walmart-Amazon, loss: 0.002405136823654175
step: 30, task: Dirty/Walmart-Amazon, loss: 0.0017086714506149292
step: 40, task: Dirty/Walmart-Amazon, loss: 0.0024608373641967773
step: 50, task: Dirty/Walmart-Amazon, loss: 0.0055890753865242004
step: 60, task: Dirty/Walmart-Amazon, loss: 0.0007217079401016235
step: 70, task: Dirty/Walmart-Amazon, loss: 0.0009831935167312622
step: 80, task: Dirty/Walmart-Amazon, loss: 0.0013970136642456055
step: 90, task: Dirty/Walmart-Amazon, loss: 0.0032024085521698
step: 100, task: Dirty/Walmart-Amazon, loss: 0.3041263520717621
step: 110, task: Dirty/Walmart-Amazon, loss: 0.003756321966648102
step: 120, task: Dirty/Walmart-Amazon, loss: 0.10558369755744934
step: 130, task: Dirty/Walmart-Amazon, loss: 0.001576349139213562
step: 140, task: Dirty/Walmart-Amazon, loss: 0.48483216762542725
step: 150, task: Dirty/Walmart-Amazon, loss: 0.021745264530181885
step: 160, task: Dirty/Walmart-Amazon, loss: 0.01194232702255249
step: 170, task: Dirty/Walmart-Amazon, loss: 0.08990641683340073
step: 180, task: Dirty/Walmart-Amazon, loss: 0.12277456372976303
step: 190, task: Dirty/Walmart-Amazon, loss: 0.004314854741096497
step: 200, task: Dirty/Walmart-Amazon, loss: 0.1846049726009369
step: 210, task: Dirty/Walmart-Amazon, loss: 0.0015946179628372192
step: 220, task: Dirty/Walmart-Amazon, loss: 0.0008902251720428467
step: 230, task: Dirty/Walmart-Amazon, loss: 0.1307125985622406
step: 240, task: Dirty/Walmart-Amazon, loss: 0.01327873021364212
step: 250, task: Dirty/Walmart-Amazon, loss: 0.0007214397192001343
step: 260, task: Dirty/Walmart-Amazon, loss: 0.4336079955101013
step: 270, task: Dirty/Walmart-Amazon, loss: 0.007550545036792755
step: 280, task: Dirty/Walmart-Amazon, loss: 0.0010901093482971191
step: 290, task: Dirty/Walmart-Amazon, loss: 0.002408340573310852
step: 300, task: Dirty/Walmart-Amazon, loss: 0.006343916058540344
step: 310, task: Dirty/Walmart-Amazon, loss: 0.0020524263381958008
step: 320, task: Dirty/Walmart-Amazon, loss: 0.005187511444091797
step: 330, task: Dirty/Walmart-Amazon, loss: 0.039071451872587204
step: 340, task: Dirty/Walmart-Amazon, loss: 0.2525245249271393
step: 350, task: Dirty/Walmart-Amazon, loss: 0.004027634859085083
step: 360, task: Dirty/Walmart-Amazon, loss: 0.007926218211650848
step: 370, task: Dirty/Walmart-Amazon, loss: 0.052878715097904205
step: 380, task: Dirty/Walmart-Amazon, loss: 0.003621503710746765
=========eval at epoch=6=========
Validation:
=============Dirty/Walmart-Amazon==================
accuracy=0.907
precision=0.667
recall=0.021
f1=0.040
======================================
Test:
=============Dirty/Walmart-Amazon==================
accuracy=0.909
precision=1.000
recall=0.031
f1=0.060
======================================
=====sanity check======
words: COL title VAL da-lite da-glas unframed rear projection screen - 43 1 4 x 57 3 4 video format electronics - general 27602 COL category VAL  COL brand VAL da-lite COL modelno VAL  COL price VAL 920.99  [SEP] COL title VAL da lite data pro thru-the-wall rear projection screen - 45 x 80 hdtv format 23179 11772.99 COL category VAL projection screens COL brand VAL da-lite COL modelno VAL  COL price VAL  
x: [    0 18047  1270 27445  2955    12 33701  2955    12 39473  9515  4040
   196  5081 18144  2441   111  3557   112   204  3023  4981   155   204
   569  7390  8917   111   937   974 36094 14857  4120 27445  1437 14857
  1518 27445  2955    12 33701 14857  1421  2362 27445  1437 14857   425
 27445 37543     4  2831  1437     2     2 18047  1270 27445  2955   784
  1459   414  1759 34876    12   627    12 12764  5081 18144  2441   111
  2248  3023  1812  1368   417 18724  7390   883 26340   365 38949     4
  2831 14857  4120 27445 18144  8545 14857  1518 27445  2955    12 33701
 14857  1421  2362 27445  1437 14857   425 27445  1437  1437     2]
tokens: ['<s>', 'COL', 'Ġtitle', 'ĠVAL', 'Ġda', '-', 'lite', 'Ġda', '-', 'glas', 'Ġunf', 'ram', 'ed', 'Ġrear', 'Ġprojection', 'Ġscreen', 'Ġ-', 'Ġ43', 'Ġ1', 'Ġ4', 'Ġx', 'Ġ57', 'Ġ3', 'Ġ4', 'Ġvideo', 'Ġformat', 'Ġelectronics', 'Ġ-', 'Ġgeneral', 'Ġ27', '602', 'ĠCOL', 'Ġcategory', 'ĠVAL', 'Ġ', 'ĠCOL', 'Ġbrand', 'ĠVAL', 'Ġda', '-', 'lite', 'ĠCOL', 'Ġmodel', 'no', 'ĠVAL', 'Ġ', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ920', '.', '99', 'Ġ', '</s>', '</s>', 'COL', 'Ġtitle', 'ĠVAL', 'Ġda', 'Ġl', 'ite', 'Ġdata', 'Ġpro', 'Ġthru', '-', 'the', '-', 'wall', 'Ġrear', 'Ġprojection', 'Ġscreen', 'Ġ-', 'Ġ45', 'Ġx', 'Ġ80', 'Ġh', 'd', 'tv', 'Ġformat', 'Ġ23', '179', 'Ġ11', '772', '.', '99', 'ĠCOL', 'Ġcategory', 'ĠVAL', 'Ġprojection', 'Ġscreens', 'ĠCOL', 'Ġbrand', 'ĠVAL', 'Ġda', '-', 'lite', 'ĠCOL', 'Ġmodel', 'no', 'ĠVAL', 'Ġ', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ', 'Ġ', '</s>']
is_heads: [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
y: 0
tags: 0
mask: tensor([1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1])
seqlen: 107
task_name: Dirty/Walmart-Amazon
=======================
step: 0, task: Dirty/Walmart-Amazon, loss: 0.0013179630041122437
step: 10, task: Dirty/Walmart-Amazon, loss: 0.0311887189745903
step: 20, task: Dirty/Walmart-Amazon, loss: 0.01402129977941513
step: 30, task: Dirty/Walmart-Amazon, loss: 0.011167950928211212
step: 40, task: Dirty/Walmart-Amazon, loss: 0.016630172729492188
step: 50, task: Dirty/Walmart-Amazon, loss: 0.0028824210166931152
step: 60, task: Dirty/Walmart-Amazon, loss: 0.008279889822006226
step: 70, task: Dirty/Walmart-Amazon, loss: 0.002065420150756836
step: 80, task: Dirty/Walmart-Amazon, loss: 0.003195717930793762
step: 90, task: Dirty/Walmart-Amazon, loss: 0.0023804008960723877
step: 100, task: Dirty/Walmart-Amazon, loss: 0.0027679502964019775
step: 110, task: Dirty/Walmart-Amazon, loss: 0.0029914379119873047
step: 120, task: Dirty/Walmart-Amazon, loss: 0.004121668636798859
step: 130, task: Dirty/Walmart-Amazon, loss: 0.0010891854763031006
step: 140, task: Dirty/Walmart-Amazon, loss: 0.0005806088447570801
step: 150, task: Dirty/Walmart-Amazon, loss: 0.0006875544786453247
step: 160, task: Dirty/Walmart-Amazon, loss: 0.1187039464712143
step: 170, task: Dirty/Walmart-Amazon, loss: 0.0024535655975341797
step: 180, task: Dirty/Walmart-Amazon, loss: 0.0013056844472885132
step: 190, task: Dirty/Walmart-Amazon, loss: 0.0013383179903030396
step: 200, task: Dirty/Walmart-Amazon, loss: 0.0009810179471969604
step: 210, task: Dirty/Walmart-Amazon, loss: 0.0003534257411956787
step: 220, task: Dirty/Walmart-Amazon, loss: 0.03023739531636238
step: 230, task: Dirty/Walmart-Amazon, loss: 0.004195898771286011
step: 240, task: Dirty/Walmart-Amazon, loss: 0.00023190677165985107
step: 250, task: Dirty/Walmart-Amazon, loss: 0.0005994290113449097
step: 260, task: Dirty/Walmart-Amazon, loss: 0.0008539259433746338
step: 270, task: Dirty/Walmart-Amazon, loss: 0.001181572675704956
step: 280, task: Dirty/Walmart-Amazon, loss: 0.09501965343952179
step: 290, task: Dirty/Walmart-Amazon, loss: 0.0029416531324386597
step: 300, task: Dirty/Walmart-Amazon, loss: 0.0018314868211746216
step: 310, task: Dirty/Walmart-Amazon, loss: 0.00048120319843292236
step: 320, task: Dirty/Walmart-Amazon, loss: 0.0783558115363121
step: 330, task: Dirty/Walmart-Amazon, loss: 0.005904041230678558
step: 340, task: Dirty/Walmart-Amazon, loss: 0.0054207295179367065
step: 350, task: Dirty/Walmart-Amazon, loss: 0.0027487725019454956
step: 360, task: Dirty/Walmart-Amazon, loss: 0.0014225393533706665
step: 370, task: Dirty/Walmart-Amazon, loss: 0.0016654282808303833
step: 380, task: Dirty/Walmart-Amazon, loss: 0.1478445827960968
=========eval at epoch=7=========
Validation:
=============Dirty/Walmart-Amazon==================
accuracy=0.907
precision=0.667
recall=0.021
f1=0.040
======================================
Test:
=============Dirty/Walmart-Amazon==================
accuracy=0.908
precision=0.857
recall=0.031
f1=0.060
======================================
=====sanity check======
words: COL title VAL ihome wireless optical mouse black 25.56 COL category VAL mice COL brand VAL ihome COL modelno VAL ih-m821wb COL price VAL   [SEP] COL title VAL 3 button wireless optical wheel mouse red usb mp2200red COL category VAL mice COL brand VAL gear head COL modelno VAL  COL price VAL 9.43 
x: [    0 18047  1270 27445   939  8361  6955 17547 18292   909   564     4
  4419 14857  4120 27445 15540 14857  1518 27445   939  8361 14857  1421
  2362 27445   939   298    12   119   398  2146 41161 14857   425 27445
  1437  1437     2     2 18047  1270 27445   155  6148  6955 17547  5964
 18292  1275 49030 44857 41573  2050 14857  4120 27445 15540 14857  1518
 27445  6351   471 14857  1421  2362 27445  1437 14857   425 27445   361
     4  3897  1437     2]
tokens: ['<s>', 'COL', 'Ġtitle', 'ĠVAL', 'Ġi', 'home', 'Ġwireless', 'Ġoptical', 'Ġmouse', 'Ġblack', 'Ġ25', '.', '56', 'ĠCOL', 'Ġcategory', 'ĠVAL', 'Ġmice', 'ĠCOL', 'Ġbrand', 'ĠVAL', 'Ġi', 'home', 'ĠCOL', 'Ġmodel', 'no', 'ĠVAL', 'Ġi', 'h', '-', 'm', '8', '21', 'wb', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ', 'Ġ', '</s>', '</s>', 'COL', 'Ġtitle', 'ĠVAL', 'Ġ3', 'Ġbutton', 'Ġwireless', 'Ġoptical', 'Ġwheel', 'Ġmouse', 'Ġred', 'Ġusb', 'Ġmp', '2200', 'red', 'ĠCOL', 'Ġcategory', 'ĠVAL', 'Ġmice', 'ĠCOL', 'Ġbrand', 'ĠVAL', 'Ġgear', 'Ġhead', 'ĠCOL', 'Ġmodel', 'no', 'ĠVAL', 'Ġ', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ9', '.', '43', 'Ġ', '</s>']
is_heads: [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
y: 0
tags: 0
mask: tensor([1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1])
seqlen: 76
task_name: Dirty/Walmart-Amazon
=======================
step: 0, task: Dirty/Walmart-Amazon, loss: 0.0012900084257125854
step: 10, task: Dirty/Walmart-Amazon, loss: 0.0015950947999954224
step: 20, task: Dirty/Walmart-Amazon, loss: 0.0027268975973129272
step: 30, task: Dirty/Walmart-Amazon, loss: 0.0016331374645233154
step: 40, task: Dirty/Walmart-Amazon, loss: 0.0545230396091938
step: 50, task: Dirty/Walmart-Amazon, loss: 0.0018554776906967163
step: 60, task: Dirty/Walmart-Amazon, loss: 0.0014663785696029663
step: 70, task: Dirty/Walmart-Amazon, loss: 0.008063152432441711
step: 80, task: Dirty/Walmart-Amazon, loss: 0.0024807900190353394
step: 90, task: Dirty/Walmart-Amazon, loss: 0.0002821236848831177
step: 100, task: Dirty/Walmart-Amazon, loss: 0.0005089640617370605
step: 110, task: Dirty/Walmart-Amazon, loss: 0.022856205701828003
step: 120, task: Dirty/Walmart-Amazon, loss: 0.01508062332868576
step: 130, task: Dirty/Walmart-Amazon, loss: 0.001159384846687317
step: 140, task: Dirty/Walmart-Amazon, loss: 0.022034041583538055
step: 150, task: Dirty/Walmart-Amazon, loss: 0.001498490571975708
step: 160, task: Dirty/Walmart-Amazon, loss: 0.0045395344495773315
step: 170, task: Dirty/Walmart-Amazon, loss: 0.14351454377174377
step: 180, task: Dirty/Walmart-Amazon, loss: 0.002881377935409546
step: 190, task: Dirty/Walmart-Amazon, loss: 0.00026835501194000244
step: 200, task: Dirty/Walmart-Amazon, loss: 0.0016326606273651123
step: 210, task: Dirty/Walmart-Amazon, loss: 0.0019802600145339966
step: 220, task: Dirty/Walmart-Amazon, loss: 0.0030251294374465942
step: 230, task: Dirty/Walmart-Amazon, loss: 0.002374202013015747
step: 240, task: Dirty/Walmart-Amazon, loss: 0.005064733326435089
step: 250, task: Dirty/Walmart-Amazon, loss: 0.0010778754949569702
step: 260, task: Dirty/Walmart-Amazon, loss: 0.0005553066730499268
step: 270, task: Dirty/Walmart-Amazon, loss: 0.0005304962396621704
step: 280, task: Dirty/Walmart-Amazon, loss: 0.007946714758872986
step: 290, task: Dirty/Walmart-Amazon, loss: 0.0023487284779548645
step: 300, task: Dirty/Walmart-Amazon, loss: 0.000991329550743103
step: 310, task: Dirty/Walmart-Amazon, loss: 0.003858603537082672
step: 320, task: Dirty/Walmart-Amazon, loss: 0.00047856569290161133
step: 330, task: Dirty/Walmart-Amazon, loss: 0.0009732693433761597
step: 340, task: Dirty/Walmart-Amazon, loss: 0.00105363130569458
step: 350, task: Dirty/Walmart-Amazon, loss: 0.0004997551441192627
step: 360, task: Dirty/Walmart-Amazon, loss: 0.0794953852891922
step: 370, task: Dirty/Walmart-Amazon, loss: 0.0009528696537017822
step: 380, task: Dirty/Walmart-Amazon, loss: 0.0001862645149230957
=========eval at epoch=8=========
Validation:
=============Dirty/Walmart-Amazon==================
accuracy=0.907
precision=0.667
recall=0.031
f1=0.059
======================================
Test:
=============Dirty/Walmart-Amazon==================
accuracy=0.908
precision=1.000
recall=0.021
f1=0.041
======================================
Selected optimization level O2:  FP16 training with FP32 batchnorm and FP32 master weights.

Defaults for this optimization level are:
enabled                : True
opt_level              : O2
cast_model_type        : torch.float16
patch_torch_functions  : False
keep_batchnorm_fp32    : True
master_weights         : True
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O2
cast_model_type        : torch.float16
patch_torch_functions  : False
keep_batchnorm_fp32    : True
master_weights         : True
loss_scale             : dynamic
Warning:  multi_tensor_applier fused unscale kernel is unavailable, possibly because apex was installed without --cuda_ext --cpp_ext. Using Python fallback.  Original ImportError was: ModuleNotFoundError("No module named 'amp_C'")
Gradient overflow.  Skipping step, loss scaler 0 reducing loss scale to 32768.0
=====sanity check======
words: COL title VAL los angeles lakers iphone 3g duo case electronics - general tribeca fva4005 COL category VAL  COL brand VAL  COL modelno VAL  COL price VAL 24.99  [SEP] COL title VAL chicago bulls iphone 3g duo case tribeca COL category VAL computers accessories COL brand VAL  COL modelno VAL  COL price VAL 9.99 
x: [    0 18047  1270 27445  3774 20285   293   784  6650  1437 28778  1264
   155   571  6458   403  8917   111   937 28406 15366   856  3952  4017
   245 14857  4120 27445  1437 14857  1518 27445  1437 14857  1421  2362
 27445  1437 14857   425 27445   706     4  2831  1437     2     2 18047
  1270 27445  1855 42938 21865  1437 28778  1264   155   571  6458   403
 28406 15366 14857  4120 27445  7796 10131 14857  1518 27445  1437 14857
  1421  2362 27445  1437 14857   425 27445   361     4  2831  1437     2]
tokens: ['<s>', 'COL', 'Ġtitle', 'ĠVAL', 'Ġlos', 'Ġangel', 'es', 'Ġl', 'akers', 'Ġ', 'iph', 'one', 'Ġ3', 'g', 'Ġduo', 'Ġcase', 'Ġelectronics', 'Ġ-', 'Ġgeneral', 'Ġtrib', 'eca', 'Ġf', 'va', '400', '5', 'ĠCOL', 'Ġcategory', 'ĠVAL', 'Ġ', 'ĠCOL', 'Ġbrand', 'ĠVAL', 'Ġ', 'ĠCOL', 'Ġmodel', 'no', 'ĠVAL', 'Ġ', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ24', '.', '99', 'Ġ', '</s>', '</s>', 'COL', 'Ġtitle', 'ĠVAL', 'Ġch', 'icago', 'Ġbulls', 'Ġ', 'iph', 'one', 'Ġ3', 'g', 'Ġduo', 'Ġcase', 'Ġtrib', 'eca', 'ĠCOL', 'Ġcategory', 'ĠVAL', 'Ġcomputers', 'Ġaccessories', 'ĠCOL', 'Ġbrand', 'ĠVAL', 'Ġ', 'ĠCOL', 'Ġmodel', 'no', 'ĠVAL', 'Ġ', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ9', '.', '99', 'Ġ', '</s>']
is_heads: [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
y: 0
tags: 0
mask: tensor([1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1])
seqlen: 84
task_name: Dirty/Walmart-Amazon
=======================
step: 0, task: Dirty/Walmart-Amazon, loss: 0.709161102771759
Gradient overflow.  Skipping step, loss scaler 0 reducing loss scale to 16384.0
Gradient overflow.  Skipping step, loss scaler 0 reducing loss scale to 8192.0
step: 10, task: Dirty/Walmart-Amazon, loss: 0.7319315075874329
step: 20, task: Dirty/Walmart-Amazon, loss: 0.6582036018371582
step: 30, task: Dirty/Walmart-Amazon, loss: 0.5804053544998169
step: 40, task: Dirty/Walmart-Amazon, loss: 0.48853740096092224
step: 50, task: Dirty/Walmart-Amazon, loss: 0.2761878967285156
step: 60, task: Dirty/Walmart-Amazon, loss: 0.22425255179405212
step: 70, task: Dirty/Walmart-Amazon, loss: 0.5635279417037964
step: 80, task: Dirty/Walmart-Amazon, loss: 0.38770925998687744
step: 90, task: Dirty/Walmart-Amazon, loss: 0.05509757250547409
step: 100, task: Dirty/Walmart-Amazon, loss: 0.25546687841415405
step: 110, task: Dirty/Walmart-Amazon, loss: 0.24612221121788025
step: 120, task: Dirty/Walmart-Amazon, loss: 0.3615463376045227
step: 130, task: Dirty/Walmart-Amazon, loss: 0.2754541039466858
step: 140, task: Dirty/Walmart-Amazon, loss: 0.3882851004600525
step: 150, task: Dirty/Walmart-Amazon, loss: 0.20791369676589966
step: 160, task: Dirty/Walmart-Amazon, loss: 0.48345470428466797
step: 170, task: Dirty/Walmart-Amazon, loss: 0.39609384536743164
step: 180, task: Dirty/Walmart-Amazon, loss: 0.2529756426811218
step: 190, task: Dirty/Walmart-Amazon, loss: 0.4550454616546631
step: 200, task: Dirty/Walmart-Amazon, loss: 0.500057578086853
step: 210, task: Dirty/Walmart-Amazon, loss: 0.31011584401130676
step: 220, task: Dirty/Walmart-Amazon, loss: 0.08736879378557205
step: 230, task: Dirty/Walmart-Amazon, loss: 0.3951742649078369
step: 240, task: Dirty/Walmart-Amazon, loss: 0.21898368000984192
step: 250, task: Dirty/Walmart-Amazon, loss: 0.06566797941923141
step: 260, task: Dirty/Walmart-Amazon, loss: 0.05815938860177994
step: 270, task: Dirty/Walmart-Amazon, loss: 0.6185027360916138
step: 280, task: Dirty/Walmart-Amazon, loss: 0.16445428133010864
step: 290, task: Dirty/Walmart-Amazon, loss: 0.1907348334789276
step: 300, task: Dirty/Walmart-Amazon, loss: 0.23169457912445068
step: 310, task: Dirty/Walmart-Amazon, loss: 0.9500628709793091
step: 320, task: Dirty/Walmart-Amazon, loss: 0.505198061466217
step: 330, task: Dirty/Walmart-Amazon, loss: 0.0848759189248085
step: 340, task: Dirty/Walmart-Amazon, loss: 0.4235818386077881
step: 350, task: Dirty/Walmart-Amazon, loss: 0.2382800579071045
step: 360, task: Dirty/Walmart-Amazon, loss: 0.2221560776233673
step: 370, task: Dirty/Walmart-Amazon, loss: 0.2354932725429535
step: 380, task: Dirty/Walmart-Amazon, loss: 0.2801147401332855
=========eval at epoch=1=========
Validation:
=============Dirty/Walmart-Amazon==================
accuracy=0.906
precision=0.000
recall=0.000
f1=0.000
======================================
Test:
=============Dirty/Walmart-Amazon==================
accuracy=0.906
precision=0.000
recall=0.000
f1=0.000
======================================
/w/246/tianyu2020/miniconda2/envs/ditto/lib/python3.7/site-packages/apex/amp/_initialize.py:24: UserWarning: An input tensor was not cuda.
  warnings.warn("An input tensor was not cuda.")
/w/246/tianyu2020/miniconda2/envs/ditto/lib/python3.7/site-packages/torch/optim/lr_scheduler.py:122: UserWarning: Detected call of `lr_scheduler.step()` before `optimizer.step()`. In PyTorch 1.1.0 and later, you should call them in the opposite order: `optimizer.step()` before `lr_scheduler.step()`.  Failure to do this will result in PyTorch skipping the first value of the learning rate schedule. See more details at https://pytorch.org/docs/stable/optim.html#how-to-adjust-learning-rate
  "https://pytorch.org/docs/stable/optim.html#how-to-adjust-learning-rate", UserWarning)
/w/246/tianyu2020/miniconda2/envs/ditto/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1221: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
=====sanity check======
words: COL title VAL logitech corded mouse black logitech 17.82 COL category VAL mice COL brand VAL  COL modelno VAL 910001830 COL price VAL   [SEP] COL title VAL logitech wireless mouse m305 black logitech 910-001752 20.59 COL category VAL mice COL brand VAL  COL modelno VAL  COL price VAL  
x: [    0 18047  1270 27445  7425 30051 13051   196 18292   909  7425 30051
   601     4  6551 14857  4120 27445 15540 14857  1518 27445  1437 14857
  1421  2362 27445   361  1866 33352   541 14857   425 27445  1437  1437
     2     2 18047  1270 27445  7425 30051  6955 18292   475 27062   909
  7425 30051   361   698    12   612  1360  4429   291     4  4156 14857
  4120 27445 15540 14857  1518 27445  1437 14857  1421  2362 27445  1437
 14857   425 27445  1437  1437     2]
tokens: ['<s>', 'COL', 'Ġtitle', 'ĠVAL', 'Ġlog', 'itech', 'Ġcord', 'ed', 'Ġmouse', 'Ġblack', 'Ġlog', 'itech', 'Ġ17', '.', '82', 'ĠCOL', 'Ġcategory', 'ĠVAL', 'Ġmice', 'ĠCOL', 'Ġbrand', 'ĠVAL', 'Ġ', 'ĠCOL', 'Ġmodel', 'no', 'ĠVAL', 'Ġ9', '100', '018', '30', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ', 'Ġ', '</s>', '</s>', 'COL', 'Ġtitle', 'ĠVAL', 'Ġlog', 'itech', 'Ġwireless', 'Ġmouse', 'Ġm', '305', 'Ġblack', 'Ġlog', 'itech', 'Ġ9', '10', '-', '00', '17', '52', 'Ġ20', '.', '59', 'ĠCOL', 'Ġcategory', 'ĠVAL', 'Ġmice', 'ĠCOL', 'Ġbrand', 'ĠVAL', 'Ġ', 'ĠCOL', 'Ġmodel', 'no', 'ĠVAL', 'Ġ', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ', 'Ġ', '</s>']
is_heads: [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
y: 0
tags: 0
mask: tensor([1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1])
seqlen: 78
task_name: Dirty/Walmart-Amazon
=======================
step: 0, task: Dirty/Walmart-Amazon, loss: 0.19171825051307678
step: 10, task: Dirty/Walmart-Amazon, loss: 0.2688553035259247
step: 20, task: Dirty/Walmart-Amazon, loss: 0.02663041651248932
step: 30, task: Dirty/Walmart-Amazon, loss: 0.19497831165790558
step: 40, task: Dirty/Walmart-Amazon, loss: 0.30354008078575134
step: 50, task: Dirty/Walmart-Amazon, loss: 0.29679667949676514
step: 60, task: Dirty/Walmart-Amazon, loss: 0.07553460448980331
step: 70, task: Dirty/Walmart-Amazon, loss: 0.37163180112838745
step: 80, task: Dirty/Walmart-Amazon, loss: 0.18803995847702026
step: 90, task: Dirty/Walmart-Amazon, loss: 0.3734057545661926
step: 100, task: Dirty/Walmart-Amazon, loss: 0.3415836691856384
step: 110, task: Dirty/Walmart-Amazon, loss: 0.32675257325172424
step: 120, task: Dirty/Walmart-Amazon, loss: 0.2406432330608368
step: 130, task: Dirty/Walmart-Amazon, loss: 0.014950945973396301
step: 140, task: Dirty/Walmart-Amazon, loss: 0.1284121870994568
step: 150, task: Dirty/Walmart-Amazon, loss: 0.052989520132541656
step: 160, task: Dirty/Walmart-Amazon, loss: 0.10680711269378662
step: 170, task: Dirty/Walmart-Amazon, loss: 0.2729799747467041
step: 180, task: Dirty/Walmart-Amazon, loss: 0.0772104263305664
step: 190, task: Dirty/Walmart-Amazon, loss: 0.48381707072257996
step: 200, task: Dirty/Walmart-Amazon, loss: 0.02648167312145233
step: 210, task: Dirty/Walmart-Amazon, loss: 0.04547613859176636
step: 220, task: Dirty/Walmart-Amazon, loss: 0.01621871441602707
step: 230, task: Dirty/Walmart-Amazon, loss: 0.1716710776090622
step: 240, task: Dirty/Walmart-Amazon, loss: 0.021973274648189545
step: 250, task: Dirty/Walmart-Amazon, loss: 0.13332946598529816
step: 260, task: Dirty/Walmart-Amazon, loss: 0.1311061680316925
step: 270, task: Dirty/Walmart-Amazon, loss: 0.09369054436683655
step: 280, task: Dirty/Walmart-Amazon, loss: 0.08850325644016266
step: 290, task: Dirty/Walmart-Amazon, loss: 0.12020069360733032
step: 300, task: Dirty/Walmart-Amazon, loss: 0.01930106058716774
step: 310, task: Dirty/Walmart-Amazon, loss: 0.08175884187221527
step: 320, task: Dirty/Walmart-Amazon, loss: 0.4349031150341034
step: 330, task: Dirty/Walmart-Amazon, loss: 0.16309621930122375
step: 340, task: Dirty/Walmart-Amazon, loss: 0.051933564245700836
step: 350, task: Dirty/Walmart-Amazon, loss: 0.06462021172046661
step: 360, task: Dirty/Walmart-Amazon, loss: 0.15979081392288208
step: 370, task: Dirty/Walmart-Amazon, loss: 0.16820503771305084
step: 380, task: Dirty/Walmart-Amazon, loss: 0.04839254170656204
=========eval at epoch=1=========
Validation:
=============Dirty/Walmart-Amazon==================
accuracy=0.907
precision=1.000
recall=0.016
f1=0.031
======================================
Test:
=============Dirty/Walmart-Amazon==================
accuracy=0.906
precision=0.667
recall=0.010
f1=0.020
======================================
=====sanity check======
words: COL title VAL panasonic lumix dmc-ts3s silver 12.1 mp digital camera w 4.6 x optical zoom 2.7 lcd hd movie recording panasonic COL category VAL digital cameras COL brand VAL  COL modelno VAL panasonic dmc-ts3s COL price VAL 333.54  [SEP] COL title VAL panasonic lumix dmc-zs7 12.1 mp digital camera with 12x optical image stabilized zoom and 3.0-inch lcd silver point shoot digital cameras dmc-zs7s 399.99 COL category VAL  COL brand VAL panasonic COL modelno VAL  COL price VAL  
x: [    0 18047  1270 27445  5730 38703 31962  3181   385 29297    12  1872
   246    29  4334   316     4   134 44857  1778  2280   885   204     4
   401  3023 17547 21762   132     4   406   784 28690  1368   417  1569
  5492  5730 38703 14857  4120 27445  1778  4387 14857  1518 27445  1437
 14857  1421  2362 27445  5730 38703   385 29297    12  1872   246    29
 14857   425 27445 30242     4  4283  1437     2     2 18047  1270 27445
  5730 38703 31962  3181   385 29297    12   329    29   406   316     4
   134 44857  1778  2280    19   316  1178 17547  2274 28725 21762     8
   155     4   288    12  3796   784 28690  4334   477  4511  1778  4387
   385 29297    12   329    29   406    29 41279     4  2831 14857  4120
 27445  1437 14857  1518 27445  5730 38703 14857  1421  2362 27445  1437
 14857   425 27445  1437  1437     2]
tokens: ['<s>', 'COL', 'Ġtitle', 'ĠVAL', 'Ġpan', 'asonic', 'Ġlum', 'ix', 'Ġd', 'mc', '-', 'ts', '3', 's', 'Ġsilver', 'Ġ12', '.', '1', 'Ġmp', 'Ġdigital', 'Ġcamera', 'Ġw', 'Ġ4', '.', '6', 'Ġx', 'Ġoptical', 'Ġzoom', 'Ġ2', '.', '7', 'Ġl', 'cd', 'Ġh', 'd', 'Ġmovie', 'Ġrecording', 'Ġpan', 'asonic', 'ĠCOL', 'Ġcategory', 'ĠVAL', 'Ġdigital', 'Ġcameras', 'ĠCOL', 'Ġbrand', 'ĠVAL', 'Ġ', 'ĠCOL', 'Ġmodel', 'no', 'ĠVAL', 'Ġpan', 'asonic', 'Ġd', 'mc', '-', 'ts', '3', 's', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ333', '.', '54', 'Ġ', '</s>', '</s>', 'COL', 'Ġtitle', 'ĠVAL', 'Ġpan', 'asonic', 'Ġlum', 'ix', 'Ġd', 'mc', '-', 'z', 's', '7', 'Ġ12', '.', '1', 'Ġmp', 'Ġdigital', 'Ġcamera', 'Ġwith', 'Ġ12', 'x', 'Ġoptical', 'Ġimage', 'Ġstabilized', 'Ġzoom', 'Ġand', 'Ġ3', '.', '0', '-', 'inch', 'Ġl', 'cd', 'Ġsilver', 'Ġpoint', 'Ġshoot', 'Ġdigital', 'Ġcameras', 'Ġd', 'mc', '-', 'z', 's', '7', 's', 'Ġ399', '.', '99', 'ĠCOL', 'Ġcategory', 'ĠVAL', 'Ġ', 'ĠCOL', 'Ġbrand', 'ĠVAL', 'Ġpan', 'asonic', 'ĠCOL', 'Ġmodel', 'no', 'ĠVAL', 'Ġ', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ', 'Ġ', '</s>']
is_heads: [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
y: 0
tags: 0
mask: tensor([1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1])
seqlen: 138
task_name: Dirty/Walmart-Amazon
=======================
step: 0, task: Dirty/Walmart-Amazon, loss: 0.49003133177757263
step: 10, task: Dirty/Walmart-Amazon, loss: 0.07083724439144135
step: 20, task: Dirty/Walmart-Amazon, loss: 0.18402276933193207
step: 30, task: Dirty/Walmart-Amazon, loss: 0.02532273530960083
step: 40, task: Dirty/Walmart-Amazon, loss: 0.0025317519903182983
step: 50, task: Dirty/Walmart-Amazon, loss: 0.0362265408039093
step: 60, task: Dirty/Walmart-Amazon, loss: 0.0023112744092941284
step: 70, task: Dirty/Walmart-Amazon, loss: 0.3097999095916748
step: 80, task: Dirty/Walmart-Amazon, loss: 0.10501379519701004
step: 90, task: Dirty/Walmart-Amazon, loss: 0.16814398765563965
step: 100, task: Dirty/Walmart-Amazon, loss: 0.3794158101081848
step: 110, task: Dirty/Walmart-Amazon, loss: 0.03182319551706314
step: 120, task: Dirty/Walmart-Amazon, loss: 0.2686135768890381
step: 130, task: Dirty/Walmart-Amazon, loss: 0.055006686598062515
step: 140, task: Dirty/Walmart-Amazon, loss: 0.15383808314800262
step: 150, task: Dirty/Walmart-Amazon, loss: 0.01002918928861618
step: 160, task: Dirty/Walmart-Amazon, loss: 0.10046455264091492
step: 170, task: Dirty/Walmart-Amazon, loss: 0.01673922687768936
step: 180, task: Dirty/Walmart-Amazon, loss: 0.11010288447141647
step: 190, task: Dirty/Walmart-Amazon, loss: 0.05179253965616226
step: 200, task: Dirty/Walmart-Amazon, loss: 0.05879848822951317
step: 210, task: Dirty/Walmart-Amazon, loss: 0.026226583868265152
step: 220, task: Dirty/Walmart-Amazon, loss: 0.04630566015839577
step: 230, task: Dirty/Walmart-Amazon, loss: 0.01709890365600586
step: 240, task: Dirty/Walmart-Amazon, loss: 0.23023124039173126
step: 250, task: Dirty/Walmart-Amazon, loss: 0.07445576786994934
step: 260, task: Dirty/Walmart-Amazon, loss: 0.015399828553199768
step: 270, task: Dirty/Walmart-Amazon, loss: 0.01954621821641922
step: 280, task: Dirty/Walmart-Amazon, loss: 0.06232099235057831
step: 290, task: Dirty/Walmart-Amazon, loss: 0.01640978455543518
step: 300, task: Dirty/Walmart-Amazon, loss: 0.039931319653987885
step: 310, task: Dirty/Walmart-Amazon, loss: 0.008158653974533081
step: 320, task: Dirty/Walmart-Amazon, loss: 0.04301367700099945
step: 330, task: Dirty/Walmart-Amazon, loss: 0.03938561677932739
step: 340, task: Dirty/Walmart-Amazon, loss: 0.06709746271371841
step: 350, task: Dirty/Walmart-Amazon, loss: 0.04811948165297508
step: 360, task: Dirty/Walmart-Amazon, loss: 0.040917739272117615
step: 370, task: Dirty/Walmart-Amazon, loss: 0.04308205842971802
step: 380, task: Dirty/Walmart-Amazon, loss: 0.5292330980300903
=========eval at epoch=2=========
Validation:
=============Dirty/Walmart-Amazon==================
accuracy=0.907
precision=1.000
recall=0.016
f1=0.031
======================================
Test:
=============Dirty/Walmart-Amazon==================
accuracy=0.907
precision=1.000
recall=0.010
f1=0.021
======================================
=====sanity check======
words: COL title VAL casio exilim ex-zs10 14.1 mp digital camera black w 5x optical zoom 2.7 lcd display digital cameras casio ex-zs10bk COL category VAL  COL brand VAL  COL modelno VAL  COL price VAL 120.0  [SEP] COL title VAL casio exilim ex-z800 14.1 mp digital camera with 4x optical zoom and 2.7-inch lcd blue 108.94 COL category VAL point shoot digital cameras COL brand VAL casio COL modelno VAL ex-z800be COL price VAL  
x: [    0 18047  1270 27445  9074  1020  1931   718   757  1931    12   329
    29   698   501     4   134 44857  1778  2280   909   885   195  1178
 17547 21762   132     4   406   784 28690  2332  1778  4387  9074  1020
  1931    12   329    29   698   428   330 14857  4120 27445  1437 14857
  1518 27445  1437 14857  1421  2362 27445  1437 14857   425 27445  5962
     4   288  1437     2     2 18047  1270 27445  9074  1020  1931   718
   757  1931    12   329  3913   501     4   134 44857  1778  2280    19
   204  1178 17547 21762     8   132     4   406    12  3796   784 28690
  2440 13955     4  6405 14857  4120 27445   477  4511  1778  4387 14857
  1518 27445  9074  1020 14857  1421  2362 27445  1931    12   329  3913
  1610 14857   425 27445  1437  1437     2]
tokens: ['<s>', 'COL', 'Ġtitle', 'ĠVAL', 'Ġcas', 'io', 'Ġex', 'il', 'im', 'Ġex', '-', 'z', 's', '10', 'Ġ14', '.', '1', 'Ġmp', 'Ġdigital', 'Ġcamera', 'Ġblack', 'Ġw', 'Ġ5', 'x', 'Ġoptical', 'Ġzoom', 'Ġ2', '.', '7', 'Ġl', 'cd', 'Ġdisplay', 'Ġdigital', 'Ġcameras', 'Ġcas', 'io', 'Ġex', '-', 'z', 's', '10', 'b', 'k', 'ĠCOL', 'Ġcategory', 'ĠVAL', 'Ġ', 'ĠCOL', 'Ġbrand', 'ĠVAL', 'Ġ', 'ĠCOL', 'Ġmodel', 'no', 'ĠVAL', 'Ġ', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ120', '.', '0', 'Ġ', '</s>', '</s>', 'COL', 'Ġtitle', 'ĠVAL', 'Ġcas', 'io', 'Ġex', 'il', 'im', 'Ġex', '-', 'z', '800', 'Ġ14', '.', '1', 'Ġmp', 'Ġdigital', 'Ġcamera', 'Ġwith', 'Ġ4', 'x', 'Ġoptical', 'Ġzoom', 'Ġand', 'Ġ2', '.', '7', '-', 'inch', 'Ġl', 'cd', 'Ġblue', 'Ġ108', '.', '94', 'ĠCOL', 'Ġcategory', 'ĠVAL', 'Ġpoint', 'Ġshoot', 'Ġdigital', 'Ġcameras', 'ĠCOL', 'Ġbrand', 'ĠVAL', 'Ġcas', 'io', 'ĠCOL', 'Ġmodel', 'no', 'ĠVAL', 'Ġex', '-', 'z', '800', 'be', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ', 'Ġ', '</s>']
is_heads: [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
y: 0
tags: 0
mask: tensor([1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1])
seqlen: 127
task_name: Dirty/Walmart-Amazon
=======================
step: 0, task: Dirty/Walmart-Amazon, loss: 0.07812634110450745
step: 10, task: Dirty/Walmart-Amazon, loss: 0.09094800055027008
step: 20, task: Dirty/Walmart-Amazon, loss: 0.008023247122764587
Gradient overflow.  Skipping step, loss scaler 0 reducing loss scale to 4096.0
step: 30, task: Dirty/Walmart-Amazon, loss: 0.036689627915620804
step: 40, task: Dirty/Walmart-Amazon, loss: 0.059638604521751404
step: 50, task: Dirty/Walmart-Amazon, loss: 0.002469107508659363
step: 60, task: Dirty/Walmart-Amazon, loss: 0.06575959920883179
step: 70, task: Dirty/Walmart-Amazon, loss: 0.029796764254570007
step: 80, task: Dirty/Walmart-Amazon, loss: 0.015789568424224854
step: 90, task: Dirty/Walmart-Amazon, loss: 0.010373041033744812
step: 100, task: Dirty/Walmart-Amazon, loss: 0.014962643384933472
step: 110, task: Dirty/Walmart-Amazon, loss: 0.6559879779815674
step: 120, task: Dirty/Walmart-Amazon, loss: 0.053559161722660065
step: 130, task: Dirty/Walmart-Amazon, loss: 0.05334634333848953
step: 140, task: Dirty/Walmart-Amazon, loss: 0.0032151788473129272
step: 150, task: Dirty/Walmart-Amazon, loss: 0.007498197257518768
step: 160, task: Dirty/Walmart-Amazon, loss: 0.018529236316680908
step: 170, task: Dirty/Walmart-Amazon, loss: 0.17317861318588257
step: 180, task: Dirty/Walmart-Amazon, loss: 0.006973385810852051
step: 190, task: Dirty/Walmart-Amazon, loss: 0.005156002938747406
step: 200, task: Dirty/Walmart-Amazon, loss: 0.0013165026903152466
step: 210, task: Dirty/Walmart-Amazon, loss: 0.004002794623374939
step: 220, task: Dirty/Walmart-Amazon, loss: 0.0037881210446357727
step: 230, task: Dirty/Walmart-Amazon, loss: 0.0020014196634292603
step: 240, task: Dirty/Walmart-Amazon, loss: 0.10825444757938385
step: 250, task: Dirty/Walmart-Amazon, loss: 0.00779356062412262
step: 260, task: Dirty/Walmart-Amazon, loss: 0.09091228991746902
step: 270, task: Dirty/Walmart-Amazon, loss: 0.006421811878681183
step: 280, task: Dirty/Walmart-Amazon, loss: 0.11859960108995438
step: 290, task: Dirty/Walmart-Amazon, loss: 0.022093378007411957
step: 300, task: Dirty/Walmart-Amazon, loss: 0.07874346524477005
step: 310, task: Dirty/Walmart-Amazon, loss: 0.10630621016025543
step: 320, task: Dirty/Walmart-Amazon, loss: 0.005928799510002136
step: 330, task: Dirty/Walmart-Amazon, loss: 0.0013134926557540894
step: 340, task: Dirty/Walmart-Amazon, loss: 0.004776120185852051
step: 350, task: Dirty/Walmart-Amazon, loss: 0.003111511468887329
step: 360, task: Dirty/Walmart-Amazon, loss: 0.028300326317548752
step: 370, task: Dirty/Walmart-Amazon, loss: 0.06295508146286011
step: 380, task: Dirty/Walmart-Amazon, loss: 0.0034944862127304077
=========eval at epoch=3=========
Validation:
=============Dirty/Walmart-Amazon==================
accuracy=0.907
precision=1.000
recall=0.016
f1=0.031
======================================
Test:
=============Dirty/Walmart-Amazon==================
accuracy=0.906
precision=0.000
recall=0.000
f1=0.000
======================================
=====sanity check======
words: COL title VAL panasonic stereo earbud headphones rp-hv21 green panasonic rphv21g COL category VAL electronics - general COL brand VAL  COL modelno VAL  COL price VAL 10.49  [SEP] COL title VAL panasonic rp-htx7-r1 monitor stereo headphones headphones red headphones panasonic 29.8 COL category VAL  COL brand VAL  COL modelno VAL rp-htx7-r1 COL price VAL  
x: [    0 18047  1270 27445  5730 38703 31436  5567   428  1906 15684   910
   642    12   298   705  2146  2272  5730 38703   910  3792   705  2146
   571 14857  4120 27445  8917   111   937 14857  1518 27445  1437 14857
  1421  2362 27445  1437 14857   425 27445   158     4  3414  1437     2
     2 18047  1270 27445  5730 38703   910   642    12  6083  1178   406
    12   338   134  5271 31436 15684 15684  1275 15684  5730 38703  1132
     4   398 14857  4120 27445  1437 14857  1518 27445  1437 14857  1421
  2362 27445   910   642    12  6083  1178   406    12   338   134 14857
   425 27445  1437  1437     2]
tokens: ['<s>', 'COL', 'Ġtitle', 'ĠVAL', 'Ġpan', 'asonic', 'Ġstereo', 'Ġear', 'b', 'ud', 'Ġheadphones', 'Ġr', 'p', '-', 'h', 'v', '21', 'Ġgreen', 'Ġpan', 'asonic', 'Ġr', 'ph', 'v', '21', 'g', 'ĠCOL', 'Ġcategory', 'ĠVAL', 'Ġelectronics', 'Ġ-', 'Ġgeneral', 'ĠCOL', 'Ġbrand', 'ĠVAL', 'Ġ', 'ĠCOL', 'Ġmodel', 'no', 'ĠVAL', 'Ġ', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ10', '.', '49', 'Ġ', '</s>', '</s>', 'COL', 'Ġtitle', 'ĠVAL', 'Ġpan', 'asonic', 'Ġr', 'p', '-', 'ht', 'x', '7', '-', 'r', '1', 'Ġmonitor', 'Ġstereo', 'Ġheadphones', 'Ġheadphones', 'Ġred', 'Ġheadphones', 'Ġpan', 'asonic', 'Ġ29', '.', '8', 'ĠCOL', 'Ġcategory', 'ĠVAL', 'Ġ', 'ĠCOL', 'Ġbrand', 'ĠVAL', 'Ġ', 'ĠCOL', 'Ġmodel', 'no', 'ĠVAL', 'Ġr', 'p', '-', 'ht', 'x', '7', '-', 'r', '1', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ', 'Ġ', '</s>']
is_heads: [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
y: 0
tags: 0
mask: tensor([1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1])
seqlen: 101
task_name: Dirty/Walmart-Amazon
=======================
step: 0, task: Dirty/Walmart-Amazon, loss: 0.009542174637317657
step: 10, task: Dirty/Walmart-Amazon, loss: 0.007213756442070007
step: 20, task: Dirty/Walmart-Amazon, loss: 0.022733140736818314
step: 30, task: Dirty/Walmart-Amazon, loss: 0.019212767481803894
step: 40, task: Dirty/Walmart-Amazon, loss: 0.0021962374448776245
step: 50, task: Dirty/Walmart-Amazon, loss: 0.04055168107151985
step: 60, task: Dirty/Walmart-Amazon, loss: 0.11096899956464767
step: 70, task: Dirty/Walmart-Amazon, loss: 0.003019191324710846
step: 80, task: Dirty/Walmart-Amazon, loss: 0.07849279791116714
step: 90, task: Dirty/Walmart-Amazon, loss: 0.006762206554412842
step: 100, task: Dirty/Walmart-Amazon, loss: 0.0033245831727981567
step: 110, task: Dirty/Walmart-Amazon, loss: 0.00166340172290802
step: 120, task: Dirty/Walmart-Amazon, loss: 0.016001541167497635
step: 130, task: Dirty/Walmart-Amazon, loss: 0.05286943167448044
step: 140, task: Dirty/Walmart-Amazon, loss: 0.2251792997121811
step: 150, task: Dirty/Walmart-Amazon, loss: 0.039412397891283035
step: 160, task: Dirty/Walmart-Amazon, loss: 0.006996780633926392
step: 170, task: Dirty/Walmart-Amazon, loss: 0.008617155253887177
step: 180, task: Dirty/Walmart-Amazon, loss: 0.0023851394653320312
step: 190, task: Dirty/Walmart-Amazon, loss: 0.005257852375507355
step: 200, task: Dirty/Walmart-Amazon, loss: 0.02633749693632126
step: 210, task: Dirty/Walmart-Amazon, loss: 0.11012210696935654
step: 220, task: Dirty/Walmart-Amazon, loss: 0.021618127822875977
step: 230, task: Dirty/Walmart-Amazon, loss: 0.010599292814731598
step: 240, task: Dirty/Walmart-Amazon, loss: 0.011895261704921722
step: 250, task: Dirty/Walmart-Amazon, loss: 0.007762506604194641
step: 260, task: Dirty/Walmart-Amazon, loss: 0.008686631917953491
step: 270, task: Dirty/Walmart-Amazon, loss: 0.0037672966718673706
step: 280, task: Dirty/Walmart-Amazon, loss: 0.0016916096210479736
step: 290, task: Dirty/Walmart-Amazon, loss: 0.0035819560289382935
step: 300, task: Dirty/Walmart-Amazon, loss: 0.002815231680870056
step: 310, task: Dirty/Walmart-Amazon, loss: 0.002956762909889221
step: 320, task: Dirty/Walmart-Amazon, loss: 0.0021651089191436768
step: 330, task: Dirty/Walmart-Amazon, loss: 0.0024828165769577026
step: 340, task: Dirty/Walmart-Amazon, loss: 0.0066252052783966064
step: 350, task: Dirty/Walmart-Amazon, loss: 0.21288587152957916
step: 360, task: Dirty/Walmart-Amazon, loss: 0.02064119279384613
step: 370, task: Dirty/Walmart-Amazon, loss: 0.06592176854610443
step: 380, task: Dirty/Walmart-Amazon, loss: 0.0032319724559783936
=========eval at epoch=4=========
Validation:
=============Dirty/Walmart-Amazon==================
accuracy=0.906
precision=1.000
recall=0.005
f1=0.010
======================================
Test:
=============Dirty/Walmart-Amazon==================
accuracy=0.906
precision=0.000
recall=0.000
f1=0.000
======================================
=====sanity check======
words: COL title VAL visiontek 900252 radeon hd 4650 1 gb 128-bit gddr2 pci express 2.0 graphics card . electronics - general visiontek 900252 86.92 COL category VAL  COL brand VAL  COL modelno VAL  COL price VAL   [SEP] COL title VAL visiontek ati radeon hd 5550 1 gb ddr pci express graphics card 900331 visiontek 900331 COL category VAL computers accessories COL brand VAL  COL modelno VAL  COL price VAL 54.99 
x: [    0 18047  1270 27445  3360 28205 10742 29911   910 49042  1368   417
  4059  1096   112   821   428 13950    12  5881   821 16134   338   176
 49899  5486   132     4   288 12774  1886   479  8917   111   937  3360
 28205 10742 29911  8162     4  6617 14857  4120 27445  1437 14857  1518
 27445  1437 14857  1421  2362 27445  1437 14857   425 27445  1437  1437
     2     2 18047  1270 27445  3360 28205    23   118   910 49042  1368
   417  3490  1096   112   821   428   385 10232 49899  5486 12774  1886
 10742 34071  3360 28205 10742 34071 14857  4120 27445  7796 10131 14857
  1518 27445  1437 14857  1421  2362 27445  1437 14857   425 27445  4431
     4  2831  1437     2]
tokens: ['<s>', 'COL', 'Ġtitle', 'ĠVAL', 'Ġvision', 'tek', 'Ġ900', '252', 'Ġr', 'adeon', 'Ġh', 'd', 'Ġ46', '50', 'Ġ1', 'Ġg', 'b', 'Ġ128', '-', 'bit', 'Ġg', 'dd', 'r', '2', 'Ġpci', 'Ġexpress', 'Ġ2', '.', '0', 'Ġgraphics', 'Ġcard', 'Ġ.', 'Ġelectronics', 'Ġ-', 'Ġgeneral', 'Ġvision', 'tek', 'Ġ900', '252', 'Ġ86', '.', '92', 'ĠCOL', 'Ġcategory', 'ĠVAL', 'Ġ', 'ĠCOL', 'Ġbrand', 'ĠVAL', 'Ġ', 'ĠCOL', 'Ġmodel', 'no', 'ĠVAL', 'Ġ', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ', 'Ġ', '</s>', '</s>', 'COL', 'Ġtitle', 'ĠVAL', 'Ġvision', 'tek', 'Ġat', 'i', 'Ġr', 'adeon', 'Ġh', 'd', 'Ġ55', '50', 'Ġ1', 'Ġg', 'b', 'Ġd', 'dr', 'Ġpci', 'Ġexpress', 'Ġgraphics', 'Ġcard', 'Ġ900', '331', 'Ġvision', 'tek', 'Ġ900', '331', 'ĠCOL', 'Ġcategory', 'ĠVAL', 'Ġcomputers', 'Ġaccessories', 'ĠCOL', 'Ġbrand', 'ĠVAL', 'Ġ', 'ĠCOL', 'Ġmodel', 'no', 'ĠVAL', 'Ġ', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ54', '.', '99', 'Ġ', '</s>']
is_heads: [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
y: 0
tags: 0
mask: tensor([1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1])
seqlen: 112
task_name: Dirty/Walmart-Amazon
=======================
step: 0, task: Dirty/Walmart-Amazon, loss: 0.005018219351768494
step: 10, task: Dirty/Walmart-Amazon, loss: 0.0029569417238235474
step: 20, task: Dirty/Walmart-Amazon, loss: 0.0009402483701705933
step: 30, task: Dirty/Walmart-Amazon, loss: 0.003938756883144379
step: 40, task: Dirty/Walmart-Amazon, loss: 0.038458388298749924
step: 50, task: Dirty/Walmart-Amazon, loss: 0.2457505166530609
step: 60, task: Dirty/Walmart-Amazon, loss: 0.0014244765043258667
step: 70, task: Dirty/Walmart-Amazon, loss: 0.002523981034755707
step: 80, task: Dirty/Walmart-Amazon, loss: 0.033505018800497055
step: 90, task: Dirty/Walmart-Amazon, loss: 0.0008042454719543457
step: 100, task: Dirty/Walmart-Amazon, loss: 0.0004003196954727173
step: 110, task: Dirty/Walmart-Amazon, loss: 0.02042406052350998
step: 120, task: Dirty/Walmart-Amazon, loss: 0.0005170255899429321
step: 130, task: Dirty/Walmart-Amazon, loss: 0.0017736852169036865
step: 140, task: Dirty/Walmart-Amazon, loss: 0.004635065793991089
step: 150, task: Dirty/Walmart-Amazon, loss: 0.0939757376909256
step: 160, task: Dirty/Walmart-Amazon, loss: 0.0006626546382904053
step: 170, task: Dirty/Walmart-Amazon, loss: 0.0817568227648735
step: 180, task: Dirty/Walmart-Amazon, loss: 0.0002880692481994629
step: 190, task: Dirty/Walmart-Amazon, loss: 0.0004287213087081909
step: 200, task: Dirty/Walmart-Amazon, loss: 0.003941439092159271
step: 210, task: Dirty/Walmart-Amazon, loss: 0.0008039325475692749
step: 220, task: Dirty/Walmart-Amazon, loss: 0.0005651414394378662
step: 230, task: Dirty/Walmart-Amazon, loss: 0.16417330503463745
step: 240, task: Dirty/Walmart-Amazon, loss: 0.0013750046491622925
step: 250, task: Dirty/Walmart-Amazon, loss: 0.0008978843688964844
step: 260, task: Dirty/Walmart-Amazon, loss: 0.0008463412523269653
step: 270, task: Dirty/Walmart-Amazon, loss: 0.0016081780195236206
step: 280, task: Dirty/Walmart-Amazon, loss: 0.011905767023563385
step: 290, task: Dirty/Walmart-Amazon, loss: 0.01606307178735733
step: 300, task: Dirty/Walmart-Amazon, loss: 0.0005090236663818359
step: 310, task: Dirty/Walmart-Amazon, loss: 0.03455989807844162
step: 320, task: Dirty/Walmart-Amazon, loss: 0.00362415611743927
step: 330, task: Dirty/Walmart-Amazon, loss: 0.002380780875682831
step: 340, task: Dirty/Walmart-Amazon, loss: 0.002053394913673401
step: 350, task: Dirty/Walmart-Amazon, loss: 0.00041718780994415283
step: 360, task: Dirty/Walmart-Amazon, loss: 0.16917593777179718
step: 370, task: Dirty/Walmart-Amazon, loss: 0.0013068467378616333
step: 380, task: Dirty/Walmart-Amazon, loss: 0.0013487637042999268
=========eval at epoch=5=========
Validation:
=============Dirty/Walmart-Amazon==================
accuracy=0.908
precision=1.000
recall=0.026
f1=0.051
======================================
Test:
=============Dirty/Walmart-Amazon==================
accuracy=0.911
precision=1.000
recall=0.057
f1=0.108
======================================
=====sanity check======
words: COL title VAL sony portable handycam ac adaptor camera and camcorder accessories acl100 COL category VAL  COL brand VAL sony COL modelno VAL  COL price VAL 45.0  [SEP] COL title VAL sony ac-l100 portable handycam ac adaptor for dcr-dvd 301 dcr-vx2100 hdr-fx1 camcorders sony 19.69 COL category VAL camcorder batteries COL brand VAL  COL modelno VAL ac-l100 COL price VAL  
x: [    0 18047  1270 27445   579  6119 15295 14732 16767  4285  9037   368
  2280     8 11021   438 10337 10131    10  3998  1866 14857  4120 27445
  1437 14857  1518 27445   579  6119 14857  1421  2362 27445  1437 14857
   425 27445  2248     4   288  1437     2     2 18047  1270 27445   579
  6119  4285    12   462  1866 15295 14732 16767  4285  9037   368    13
   385  8344    12   417 40311 25895   385  8344    12   705  1178  2146
   612  1368 10232    12 44830   134 11021   438 28436   579  6119   753
     4  4563 14857  4120 27445 11021   438 10337 10535 14857  1518 27445
  1437 14857  1421  2362 27445  4285    12   462  1866 14857   425 27445
  1437  1437     2]
tokens: ['<s>', 'COL', 'Ġtitle', 'ĠVAL', 'Ġs', 'ony', 'Ġportable', 'Ġhandy', 'cam', 'Ġac', 'Ġadapt', 'or', 'Ġcamera', 'Ġand', 'Ġcam', 'c', 'order', 'Ġaccessories', 'Ġa', 'cl', '100', 'ĠCOL', 'Ġcategory', 'ĠVAL', 'Ġ', 'ĠCOL', 'Ġbrand', 'ĠVAL', 'Ġs', 'ony', 'ĠCOL', 'Ġmodel', 'no', 'ĠVAL', 'Ġ', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ45', '.', '0', 'Ġ', '</s>', '</s>', 'COL', 'Ġtitle', 'ĠVAL', 'Ġs', 'ony', 'Ġac', '-', 'l', '100', 'Ġportable', 'Ġhandy', 'cam', 'Ġac', 'Ġadapt', 'or', 'Ġfor', 'Ġd', 'cr', '-', 'd', 'vd', 'Ġ301', 'Ġd', 'cr', '-', 'v', 'x', '21', '00', 'Ġh', 'dr', '-', 'fx', '1', 'Ġcam', 'c', 'orders', 'Ġs', 'ony', 'Ġ19', '.', '69', 'ĠCOL', 'Ġcategory', 'ĠVAL', 'Ġcam', 'c', 'order', 'Ġbatteries', 'ĠCOL', 'Ġbrand', 'ĠVAL', 'Ġ', 'ĠCOL', 'Ġmodel', 'no', 'ĠVAL', 'Ġac', '-', 'l', '100', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ', 'Ġ', '</s>']
is_heads: [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
y: 1
tags: 1
mask: tensor([1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1])
seqlen: 111
task_name: Dirty/Walmart-Amazon
=======================
step: 0, task: Dirty/Walmart-Amazon, loss: 0.001789778470993042
step: 10, task: Dirty/Walmart-Amazon, loss: 0.0011945366859436035
step: 20, task: Dirty/Walmart-Amazon, loss: 0.0013286769390106201
step: 30, task: Dirty/Walmart-Amazon, loss: 0.0009767264127731323
step: 40, task: Dirty/Walmart-Amazon, loss: 0.0013266503810882568
step: 50, task: Dirty/Walmart-Amazon, loss: 0.003927692770957947
step: 60, task: Dirty/Walmart-Amazon, loss: 0.0018789619207382202
step: 70, task: Dirty/Walmart-Amazon, loss: 0.0005473941564559937
step: 80, task: Dirty/Walmart-Amazon, loss: 0.00040824711322784424
step: 90, task: Dirty/Walmart-Amazon, loss: 0.006401196122169495
step: 100, task: Dirty/Walmart-Amazon, loss: 0.000697791576385498
step: 110, task: Dirty/Walmart-Amazon, loss: 0.006989113986492157
step: 120, task: Dirty/Walmart-Amazon, loss: 0.0010676383972167969
step: 130, task: Dirty/Walmart-Amazon, loss: 0.000792086124420166
step: 140, task: Dirty/Walmart-Amazon, loss: 0.005506977438926697
step: 150, task: Dirty/Walmart-Amazon, loss: 0.0012921392917633057
step: 160, task: Dirty/Walmart-Amazon, loss: 0.025493644177913666
step: 170, task: Dirty/Walmart-Amazon, loss: 0.003519900143146515
step: 180, task: Dirty/Walmart-Amazon, loss: 0.0007032901048660278
step: 190, task: Dirty/Walmart-Amazon, loss: 0.00029850006103515625
step: 200, task: Dirty/Walmart-Amazon, loss: 0.0005714595317840576
step: 210, task: Dirty/Walmart-Amazon, loss: 0.0007670819759368896
step: 220, task: Dirty/Walmart-Amazon, loss: 0.0008946657180786133
step: 230, task: Dirty/Walmart-Amazon, loss: 0.0007656663656234741
step: 240, task: Dirty/Walmart-Amazon, loss: 0.0003180652856826782
step: 250, task: Dirty/Walmart-Amazon, loss: 0.00037010014057159424
step: 260, task: Dirty/Walmart-Amazon, loss: 0.0005921125411987305
step: 270, task: Dirty/Walmart-Amazon, loss: 0.003671787679195404
step: 280, task: Dirty/Walmart-Amazon, loss: 0.47145333886146545
step: 290, task: Dirty/Walmart-Amazon, loss: 0.0009654015302658081
step: 300, task: Dirty/Walmart-Amazon, loss: 0.0005462765693664551
step: 310, task: Dirty/Walmart-Amazon, loss: 0.0006869286298751831
step: 320, task: Dirty/Walmart-Amazon, loss: 0.004304125905036926
step: 330, task: Dirty/Walmart-Amazon, loss: 0.0062156617641448975
step: 340, task: Dirty/Walmart-Amazon, loss: 0.0004935115575790405
step: 350, task: Dirty/Walmart-Amazon, loss: 0.005153849720954895
step: 360, task: Dirty/Walmart-Amazon, loss: 0.0003597140312194824
step: 370, task: Dirty/Walmart-Amazon, loss: 0.006348006427288055
step: 380, task: Dirty/Walmart-Amazon, loss: 0.0033663734793663025
=========eval at epoch=6=========
Validation:
=============Dirty/Walmart-Amazon==================
accuracy=0.906
precision=0.500
recall=0.005
f1=0.010
======================================
Test:
=============Dirty/Walmart-Amazon==================
accuracy=0.907
precision=1.000
recall=0.010
f1=0.021
======================================
=====sanity check======
words: COL title VAL hp ce505xd black laserjet print cartridges 2pk hp hp ce505xd 258.84 COL category VAL printers COL brand VAL  COL modelno VAL  COL price VAL   [SEP] COL title VAL hp q7551x laserjet 51x black print cartridge printer ink toner hp q7551x 191.0 COL category VAL  COL brand VAL  COL modelno VAL  COL price VAL  
x: [    0 18047  1270 27445 29886  8635 35255 46140   909 13443  6622  5780
 38661   132   642   330 29886 29886  8635 35255 46140 36586     4  6232
 14857  4120 27445 29379 14857  1518 27445  1437 14857  1421  2362 27445
  1437 14857   425 27445  1437  1437     2     2 18047  1270 27445 29886
  2231  2545  4708  1178 13443  6622  4074  1178   909  5780 41785 24079
 16019  4866   254 29886  2231  2545  4708  1178 31487     4   288 14857
  4120 27445  1437 14857  1518 27445  1437 14857  1421  2362 27445  1437
 14857   425 27445  1437  1437     2]
tokens: ['<s>', 'COL', 'Ġtitle', 'ĠVAL', 'Ġhp', 'Ġce', '505', 'xd', 'Ġblack', 'Ġlaser', 'jet', 'Ġprint', 'Ġcartridges', 'Ġ2', 'p', 'k', 'Ġhp', 'Ġhp', 'Ġce', '505', 'xd', 'Ġ258', '.', '84', 'ĠCOL', 'Ġcategory', 'ĠVAL', 'Ġprinters', 'ĠCOL', 'Ġbrand', 'ĠVAL', 'Ġ', 'ĠCOL', 'Ġmodel', 'no', 'ĠVAL', 'Ġ', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ', 'Ġ', '</s>', '</s>', 'COL', 'Ġtitle', 'ĠVAL', 'Ġhp', 'Ġq', '75', '51', 'x', 'Ġlaser', 'jet', 'Ġ51', 'x', 'Ġblack', 'Ġprint', 'Ġcartridge', 'Ġprinter', 'Ġink', 'Ġton', 'er', 'Ġhp', 'Ġq', '75', '51', 'x', 'Ġ191', '.', '0', 'ĠCOL', 'Ġcategory', 'ĠVAL', 'Ġ', 'ĠCOL', 'Ġbrand', 'ĠVAL', 'Ġ', 'ĠCOL', 'Ġmodel', 'no', 'ĠVAL', 'Ġ', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ', 'Ġ', '</s>']
is_heads: [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
y: 0
tags: 0
mask: tensor([1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1])
seqlen: 90
task_name: Dirty/Walmart-Amazon
=======================
step: 0, task: Dirty/Walmart-Amazon, loss: 0.0032734423875808716
step: 10, task: Dirty/Walmart-Amazon, loss: 0.003389984369277954
step: 20, task: Dirty/Walmart-Amazon, loss: 0.0002314448356628418
step: 30, task: Dirty/Walmart-Amazon, loss: 0.0006296038627624512
step: 40, task: Dirty/Walmart-Amazon, loss: 0.0009928643703460693
step: 50, task: Dirty/Walmart-Amazon, loss: 0.0005030184984207153
step: 60, task: Dirty/Walmart-Amazon, loss: 0.0038145631551742554
step: 70, task: Dirty/Walmart-Amazon, loss: 0.00033326447010040283
step: 80, task: Dirty/Walmart-Amazon, loss: 0.0007050484418869019
step: 90, task: Dirty/Walmart-Amazon, loss: 0.0005075335502624512
step: 100, task: Dirty/Walmart-Amazon, loss: 0.0011055022478103638
step: 110, task: Dirty/Walmart-Amazon, loss: 0.002399824559688568
step: 120, task: Dirty/Walmart-Amazon, loss: 0.0008879899978637695
step: 130, task: Dirty/Walmart-Amazon, loss: 0.00033465027809143066
step: 140, task: Dirty/Walmart-Amazon, loss: 0.18111148476600647
step: 150, task: Dirty/Walmart-Amazon, loss: 0.013781137764453888
step: 160, task: Dirty/Walmart-Amazon, loss: 0.0005300343036651611
step: 170, task: Dirty/Walmart-Amazon, loss: 0.000828966498374939
step: 180, task: Dirty/Walmart-Amazon, loss: 0.0009368360042572021
step: 190, task: Dirty/Walmart-Amazon, loss: 0.00030975043773651123
step: 200, task: Dirty/Walmart-Amazon, loss: 0.00042219460010528564
step: 210, task: Dirty/Walmart-Amazon, loss: 0.0004058033227920532
step: 220, task: Dirty/Walmart-Amazon, loss: 0.0010923296213150024
step: 230, task: Dirty/Walmart-Amazon, loss: 0.0010822862386703491
step: 240, task: Dirty/Walmart-Amazon, loss: 0.0011894404888153076
step: 250, task: Dirty/Walmart-Amazon, loss: 0.003650672733783722
step: 260, task: Dirty/Walmart-Amazon, loss: 0.0002332627773284912
step: 270, task: Dirty/Walmart-Amazon, loss: 0.0007165223360061646
step: 280, task: Dirty/Walmart-Amazon, loss: 0.0011707544326782227
step: 290, task: Dirty/Walmart-Amazon, loss: 0.0013668835163116455
step: 300, task: Dirty/Walmart-Amazon, loss: 0.0007597506046295166
step: 310, task: Dirty/Walmart-Amazon, loss: 0.0004903674125671387
step: 320, task: Dirty/Walmart-Amazon, loss: 0.00028111040592193604
step: 330, task: Dirty/Walmart-Amazon, loss: 0.1051105260848999
step: 340, task: Dirty/Walmart-Amazon, loss: 0.0030189156532287598
step: 350, task: Dirty/Walmart-Amazon, loss: 0.03688416630029678
step: 360, task: Dirty/Walmart-Amazon, loss: 0.002637304365634918
step: 370, task: Dirty/Walmart-Amazon, loss: 0.0036471784114837646
step: 380, task: Dirty/Walmart-Amazon, loss: 0.0017929226160049438
=========eval at epoch=7=========
Validation:
=============Dirty/Walmart-Amazon==================
accuracy=0.907
precision=0.800
recall=0.021
f1=0.040
======================================
Test:
=============Dirty/Walmart-Amazon==================
accuracy=0.907
precision=1.000
recall=0.010
f1=0.021
======================================
=====sanity check======
words: COL title VAL boise aspen 30 office paper 92 brightness 20lb 8-1 2 x 14 5000 sheets carton stationery & office machinery 52.54 COL category VAL  COL brand VAL  COL modelno VAL 54901 COL price VAL   [SEP] COL title VAL boise mp1050 - x-9 hi-brite paper 96 brightness 20lb 8-1 2 x11 white 5000 carton uninterrupted power supply ups boise COL category VAL  COL brand VAL  COL modelno VAL  COL price VAL  
x: [    0 18047  1270 27445  5276  1496    25  9675   389   558  2225  8403
 27406   291 17243   290    12   134   132  3023   501 23221 12208  9727
   261  1992  4270   359   558 13922  3135     4  4283 14857  4120 27445
  1437 14857  1518 27445  1437 14857  1421  2362 27445   195  3414  2663
 14857   425 27445  1437  1437     2     2 18047  1270 27445  5276  1496
 44857   698  1096   111  3023    12   466 20280    12  3809  1459  2225
  8971 27406   291 17243   290    12   134   132  3023  1225  1104 23221
  9727   261 33818   476  1787 12744  5276  1496 14857  4120 27445  1437
 14857  1518 27445  1437 14857  1421  2362 27445  1437 14857   425 27445
  1437  1437     2]
tokens: ['<s>', 'COL', 'Ġtitle', 'ĠVAL', 'Ġbo', 'ise', 'Ġas', 'pen', 'Ġ30', 'Ġoffice', 'Ġpaper', 'Ġ92', 'Ġbrightness', 'Ġ20', 'lb', 'Ġ8', '-', '1', 'Ġ2', 'Ġx', 'Ġ14', 'Ġ5000', 'Ġsheets', 'Ġcart', 'on', 'Ġstation', 'ery', 'Ġ&', 'Ġoffice', 'Ġmachinery', 'Ġ52', '.', '54', 'ĠCOL', 'Ġcategory', 'ĠVAL', 'Ġ', 'ĠCOL', 'Ġbrand', 'ĠVAL', 'Ġ', 'ĠCOL', 'Ġmodel', 'no', 'ĠVAL', 'Ġ5', '49', '01', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ', 'Ġ', '</s>', '</s>', 'COL', 'Ġtitle', 'ĠVAL', 'Ġbo', 'ise', 'Ġmp', '10', '50', 'Ġ-', 'Ġx', '-', '9', 'Ġhi', '-', 'br', 'ite', 'Ġpaper', 'Ġ96', 'Ġbrightness', 'Ġ20', 'lb', 'Ġ8', '-', '1', 'Ġ2', 'Ġx', '11', 'Ġwhite', 'Ġ5000', 'Ġcart', 'on', 'Ġuninterrupted', 'Ġpower', 'Ġsupply', 'Ġups', 'Ġbo', 'ise', 'ĠCOL', 'Ġcategory', 'ĠVAL', 'Ġ', 'ĠCOL', 'Ġbrand', 'ĠVAL', 'Ġ', 'ĠCOL', 'Ġmodel', 'no', 'ĠVAL', 'Ġ', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ', 'Ġ', '</s>']
is_heads: [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
y: 0
tags: 0
mask: tensor([1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1])
seqlen: 111
task_name: Dirty/Walmart-Amazon
=======================
step: 0, task: Dirty/Walmart-Amazon, loss: 0.00038740038871765137
step: 10, task: Dirty/Walmart-Amazon, loss: 0.06821875274181366
step: 20, task: Dirty/Walmart-Amazon, loss: 0.005324535071849823
step: 30, task: Dirty/Walmart-Amazon, loss: 0.023303963243961334
step: 40, task: Dirty/Walmart-Amazon, loss: 0.0002889484167098999
step: 50, task: Dirty/Walmart-Amazon, loss: 0.0013112872838974
step: 60, task: Dirty/Walmart-Amazon, loss: 0.000546678900718689
step: 70, task: Dirty/Walmart-Amazon, loss: 0.0009019672870635986
step: 80, task: Dirty/Walmart-Amazon, loss: 0.005325846374034882
step: 90, task: Dirty/Walmart-Amazon, loss: 0.0013428479433059692
step: 100, task: Dirty/Walmart-Amazon, loss: 0.0006374269723892212
step: 110, task: Dirty/Walmart-Amazon, loss: 0.001004531979560852
step: 120, task: Dirty/Walmart-Amazon, loss: 0.0005396157503128052
step: 130, task: Dirty/Walmart-Amazon, loss: 0.0005458593368530273
step: 140, task: Dirty/Walmart-Amazon, loss: 0.000321313738822937
step: 150, task: Dirty/Walmart-Amazon, loss: 0.002620205283164978
step: 160, task: Dirty/Walmart-Amazon, loss: 0.0004968792200088501
step: 170, task: Dirty/Walmart-Amazon, loss: 0.002305939793586731
step: 180, task: Dirty/Walmart-Amazon, loss: 0.0003631860017776489
step: 190, task: Dirty/Walmart-Amazon, loss: 0.012805536389350891
step: 200, task: Dirty/Walmart-Amazon, loss: 0.0013422966003417969
step: 210, task: Dirty/Walmart-Amazon, loss: 0.0007917135953903198
step: 220, task: Dirty/Walmart-Amazon, loss: 0.000544428825378418
step: 230, task: Dirty/Walmart-Amazon, loss: 0.0002339780330657959
step: 240, task: Dirty/Walmart-Amazon, loss: 0.0003351271152496338
step: 250, task: Dirty/Walmart-Amazon, loss: 0.0009068697690963745
step: 260, task: Dirty/Walmart-Amazon, loss: 0.0019837021827697754
step: 270, task: Dirty/Walmart-Amazon, loss: 0.0037815645337104797
step: 280, task: Dirty/Walmart-Amazon, loss: 0.0022792816162109375
step: 290, task: Dirty/Walmart-Amazon, loss: 0.04828166961669922
step: 300, task: Dirty/Walmart-Amazon, loss: 0.00029180943965911865
step: 310, task: Dirty/Walmart-Amazon, loss: 0.0005014687776565552
step: 320, task: Dirty/Walmart-Amazon, loss: 0.002440027892589569
step: 330, task: Dirty/Walmart-Amazon, loss: 0.0015858709812164307
step: 340, task: Dirty/Walmart-Amazon, loss: 0.000588342547416687
step: 350, task: Dirty/Walmart-Amazon, loss: 0.0008246302604675293
step: 360, task: Dirty/Walmart-Amazon, loss: 0.00020334124565124512
step: 370, task: Dirty/Walmart-Amazon, loss: 0.00020484626293182373
step: 380, task: Dirty/Walmart-Amazon, loss: 0.00191420316696167
=========eval at epoch=8=========
Validation:
=============Dirty/Walmart-Amazon==================
accuracy=0.907
precision=1.000
recall=0.010
f1=0.021
======================================
Test:
=============Dirty/Walmart-Amazon==================
accuracy=0.906
precision=1.000
recall=0.005
f1=0.010
======================================
Selected optimization level O2:  FP16 training with FP32 batchnorm and FP32 master weights.

Defaults for this optimization level are:
enabled                : True
opt_level              : O2
cast_model_type        : torch.float16
patch_torch_functions  : False
keep_batchnorm_fp32    : True
master_weights         : True
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O2
cast_model_type        : torch.float16
patch_torch_functions  : False
keep_batchnorm_fp32    : True
master_weights         : True
loss_scale             : dynamic
Warning:  multi_tensor_applier fused unscale kernel is unavailable, possibly because apex was installed without --cuda_ext --cpp_ext. Using Python fallback.  Original ImportError was: ModuleNotFoundError("No module named 'amp_C'")
Gradient overflow.  Skipping step, loss scaler 0 reducing loss scale to 32768.0
=====sanity check======
words: COL title VAL avery shipping labels with trueblock technology 8-1 2 x 11 white 25 pack stationery & office machinery avery 8165 COL category VAL  COL brand VAL  COL modelno VAL  COL price VAL 11.94  [SEP] COL title VAL avery shipping labels for laser printers with trueblock technology 3.5 x 5 inches white box of 400 05168 avery 28.09 COL category VAL printer labels laser inkjet COL brand VAL  COL modelno VAL 05168 COL price VAL  
x: [    0 18047  1270 27445    10  5525  6738 14105    19  1528 16776   806
   290    12   134   132  3023   365  1104   564  6356  1992  4270   359
   558 13922    10  5525   290 21933 14857  4120 27445  1437 14857  1518
 27445  1437 14857  1421  2362 27445  1437 14857   425 27445   365     4
  6405  1437     2     2 18047  1270 27445    10  5525  6738 14105    13
 13443 29379    19  1528 16776   806   155     4   245  3023   195  4877
  1104  2233     9  3675 15786 25676    10  5525   971     4  3546 14857
  4120 27445 24079 14105 13443 16019  6622 14857  1518 27445  1437 14857
  1421  2362 27445 15786 25676 14857   425 27445  1437  1437     2]
tokens: ['<s>', 'COL', 'Ġtitle', 'ĠVAL', 'Ġa', 'very', 'Ġshipping', 'Ġlabels', 'Ġwith', 'Ġtrue', 'block', 'Ġtechnology', 'Ġ8', '-', '1', 'Ġ2', 'Ġx', 'Ġ11', 'Ġwhite', 'Ġ25', 'Ġpack', 'Ġstation', 'ery', 'Ġ&', 'Ġoffice', 'Ġmachinery', 'Ġa', 'very', 'Ġ8', '165', 'ĠCOL', 'Ġcategory', 'ĠVAL', 'Ġ', 'ĠCOL', 'Ġbrand', 'ĠVAL', 'Ġ', 'ĠCOL', 'Ġmodel', 'no', 'ĠVAL', 'Ġ', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ11', '.', '94', 'Ġ', '</s>', '</s>', 'COL', 'Ġtitle', 'ĠVAL', 'Ġa', 'very', 'Ġshipping', 'Ġlabels', 'Ġfor', 'Ġlaser', 'Ġprinters', 'Ġwith', 'Ġtrue', 'block', 'Ġtechnology', 'Ġ3', '.', '5', 'Ġx', 'Ġ5', 'Ġinches', 'Ġwhite', 'Ġbox', 'Ġof', 'Ġ400', 'Ġ05', '168', 'Ġa', 'very', 'Ġ28', '.', '09', 'ĠCOL', 'Ġcategory', 'ĠVAL', 'Ġprinter', 'Ġlabels', 'Ġlaser', 'Ġink', 'jet', 'ĠCOL', 'Ġbrand', 'ĠVAL', 'Ġ', 'ĠCOL', 'Ġmodel', 'no', 'ĠVAL', 'Ġ05', '168', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ', 'Ġ', '</s>']
is_heads: [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
y: 0
tags: 0
mask: tensor([1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1])
seqlen: 107
task_name: Dirty/Walmart-Amazon
=======================
step: 0, task: Dirty/Walmart-Amazon, loss: 0.35569190979003906
Gradient overflow.  Skipping step, loss scaler 0 reducing loss scale to 16384.0
step: 10, task: Dirty/Walmart-Amazon, loss: 0.3591475486755371
step: 20, task: Dirty/Walmart-Amazon, loss: 0.5241912603378296
step: 30, task: Dirty/Walmart-Amazon, loss: 0.42189866304397583
step: 40, task: Dirty/Walmart-Amazon, loss: 0.19011269509792328
step: 50, task: Dirty/Walmart-Amazon, loss: 0.6974310278892517
step: 60, task: Dirty/Walmart-Amazon, loss: 0.28145015239715576
step: 70, task: Dirty/Walmart-Amazon, loss: 0.25409284234046936
step: 80, task: Dirty/Walmart-Amazon, loss: 0.5427148342132568
step: 90, task: Dirty/Walmart-Amazon, loss: 0.09685511142015457
Gradient overflow.  Skipping step, loss scaler 0 reducing loss scale to 8192.0
step: 100, task: Dirty/Walmart-Amazon, loss: 0.17872387170791626
step: 110, task: Dirty/Walmart-Amazon, loss: 0.25014153122901917
step: 120, task: Dirty/Walmart-Amazon, loss: 0.36809253692626953
step: 130, task: Dirty/Walmart-Amazon, loss: 0.5311927795410156
step: 140, task: Dirty/Walmart-Amazon, loss: 0.10894331336021423
step: 150, task: Dirty/Walmart-Amazon, loss: 0.2120806872844696
step: 160, task: Dirty/Walmart-Amazon, loss: 0.39982375502586365
step: 170, task: Dirty/Walmart-Amazon, loss: 0.26840710639953613
step: 180, task: Dirty/Walmart-Amazon, loss: 0.4989365339279175
step: 190, task: Dirty/Walmart-Amazon, loss: 0.6234049797058105
step: 200, task: Dirty/Walmart-Amazon, loss: 0.37844887375831604
step: 210, task: Dirty/Walmart-Amazon, loss: 0.07384158670902252
step: 220, task: Dirty/Walmart-Amazon, loss: 0.4242759346961975
step: 230, task: Dirty/Walmart-Amazon, loss: 0.2704586684703827
step: 240, task: Dirty/Walmart-Amazon, loss: 0.2430666983127594
step: 250, task: Dirty/Walmart-Amazon, loss: 0.26169759035110474
step: 260, task: Dirty/Walmart-Amazon, loss: 0.6027758121490479
step: 270, task: Dirty/Walmart-Amazon, loss: 0.29762575030326843
step: 280, task: Dirty/Walmart-Amazon, loss: 0.2616710662841797
step: 290, task: Dirty/Walmart-Amazon, loss: 0.5672776699066162
step: 300, task: Dirty/Walmart-Amazon, loss: 0.38451457023620605
step: 310, task: Dirty/Walmart-Amazon, loss: 0.39724308252334595
step: 320, task: Dirty/Walmart-Amazon, loss: 0.19399915635585785
step: 330, task: Dirty/Walmart-Amazon, loss: 0.2386150062084198
step: 340, task: Dirty/Walmart-Amazon, loss: 0.4112037718296051
step: 350, task: Dirty/Walmart-Amazon, loss: 0.3928355872631073
step: 360, task: Dirty/Walmart-Amazon, loss: 0.5320223569869995
step: 370, task: Dirty/Walmart-Amazon, loss: 0.41077467799186707
step: 380, task: Dirty/Walmart-Amazon, loss: 0.6778634786605835
=========eval at epoch=1=========
Validation:
=============Dirty/Walmart-Amazon==================
accuracy=0.906
precision=0.000
recall=0.000
f1=0.000
======================================
Test:
=============Dirty/Walmart-Amazon==================
accuracy=0.906
precision=0.000
recall=0.000
f1=0.000
======================================
/w/246/tianyu2020/miniconda2/envs/ditto/lib/python3.7/site-packages/apex/amp/_initialize.py:24: UserWarning: An input tensor was not cuda.
  warnings.warn("An input tensor was not cuda.")
/w/246/tianyu2020/miniconda2/envs/ditto/lib/python3.7/site-packages/torch/optim/lr_scheduler.py:122: UserWarning: Detected call of `lr_scheduler.step()` before `optimizer.step()`. In PyTorch 1.1.0 and later, you should call them in the opposite order: `optimizer.step()` before `lr_scheduler.step()`.  Failure to do this will result in PyTorch skipping the first value of the learning rate schedule. See more details at https://pytorch.org/docs/stable/optim.html#how-to-adjust-learning-rate
  "https://pytorch.org/docs/stable/optim.html#how-to-adjust-learning-rate", UserWarning)
/w/246/tianyu2020/miniconda2/envs/ditto/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1221: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
=====sanity check======
words: COL title VAL ep 16gb usb 2.0 mobile swingdrive flash drive usb drives epsw/16gb -2.0 COL category VAL  COL brand VAL ep memory COL modelno VAL  COL price VAL 29.84  [SEP] COL title VAL ep memory 16 gb usb 2.0 mobile vault and privacy flash drive usbpd 16gb-2 .0 usbpd/16gb -2.0 COL category VAL usb flash drives COL brand VAL acp COL modelno VAL  COL price VAL 25.02 
x: [    0 18047  1270 27445 14887   545 19562 49030   132     4   288  1830
  7021 19306  7462  1305 49030  6790   364  3275   605    73  1549 19562
   111   176     4   288 14857  4120 27445  1437 14857  1518 27445 14887
  3783 14857  1421  2362 27445  1437 14857   425 27445  1132     4  6232
  1437     2     2 18047  1270 27445 14887  3783   545   821   428 49030
   132     4   288  1830 19362     8  4144  7462  1305 49030 10398   545
 19562    12   176   479   288 49030 10398    73  1549 19562   111   176
     4   288 14857  4120 27445 49030  7462  6790 14857  1518 27445  4285
   642 14857  1421  2362 27445  1437 14857   425 27445   564     4  4197
  1437     2]
tokens: ['<s>', 'COL', 'Ġtitle', 'ĠVAL', 'Ġep', 'Ġ16', 'gb', 'Ġusb', 'Ġ2', '.', '0', 'Ġmobile', 'Ġswing', 'drive', 'Ġflash', 'Ġdrive', 'Ġusb', 'Ġdrives', 'Ġe', 'ps', 'w', '/', '16', 'gb', 'Ġ-', '2', '.', '0', 'ĠCOL', 'Ġcategory', 'ĠVAL', 'Ġ', 'ĠCOL', 'Ġbrand', 'ĠVAL', 'Ġep', 'Ġmemory', 'ĠCOL', 'Ġmodel', 'no', 'ĠVAL', 'Ġ', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ29', '.', '84', 'Ġ', '</s>', '</s>', 'COL', 'Ġtitle', 'ĠVAL', 'Ġep', 'Ġmemory', 'Ġ16', 'Ġg', 'b', 'Ġusb', 'Ġ2', '.', '0', 'Ġmobile', 'Ġvault', 'Ġand', 'Ġprivacy', 'Ġflash', 'Ġdrive', 'Ġusb', 'pd', 'Ġ16', 'gb', '-', '2', 'Ġ.', '0', 'Ġusb', 'pd', '/', '16', 'gb', 'Ġ-', '2', '.', '0', 'ĠCOL', 'Ġcategory', 'ĠVAL', 'Ġusb', 'Ġflash', 'Ġdrives', 'ĠCOL', 'Ġbrand', 'ĠVAL', 'Ġac', 'p', 'ĠCOL', 'Ġmodel', 'no', 'ĠVAL', 'Ġ', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ25', '.', '02', 'Ġ', '</s>']
is_heads: [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
y: 0
tags: 0
mask: tensor([1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1])
seqlen: 110
task_name: Dirty/Walmart-Amazon
=======================
step: 0, task: Dirty/Walmart-Amazon, loss: 0.4845658540725708
step: 10, task: Dirty/Walmart-Amazon, loss: 0.3368242383003235
step: 20, task: Dirty/Walmart-Amazon, loss: 0.3996502757072449
step: 30, task: Dirty/Walmart-Amazon, loss: 0.24585013091564178
step: 40, task: Dirty/Walmart-Amazon, loss: 0.08049771934747696
step: 50, task: Dirty/Walmart-Amazon, loss: 0.3817022144794464
step: 60, task: Dirty/Walmart-Amazon, loss: 0.3405047357082367
step: 70, task: Dirty/Walmart-Amazon, loss: 0.27904778718948364
step: 80, task: Dirty/Walmart-Amazon, loss: 0.18871384859085083
step: 90, task: Dirty/Walmart-Amazon, loss: 0.25777101516723633
step: 100, task: Dirty/Walmart-Amazon, loss: 0.24775972962379456
step: 110, task: Dirty/Walmart-Amazon, loss: 0.5301643013954163
step: 120, task: Dirty/Walmart-Amazon, loss: 0.2136218249797821
step: 130, task: Dirty/Walmart-Amazon, loss: 0.3698350191116333
step: 140, task: Dirty/Walmart-Amazon, loss: 0.2582089900970459
step: 150, task: Dirty/Walmart-Amazon, loss: 0.13561399281024933
step: 160, task: Dirty/Walmart-Amazon, loss: 0.6251696348190308
step: 170, task: Dirty/Walmart-Amazon, loss: 0.707735538482666
step: 180, task: Dirty/Walmart-Amazon, loss: 0.39236903190612793
step: 190, task: Dirty/Walmart-Amazon, loss: 0.24762177467346191
step: 200, task: Dirty/Walmart-Amazon, loss: 0.6537495851516724
step: 210, task: Dirty/Walmart-Amazon, loss: 0.2805767059326172
step: 220, task: Dirty/Walmart-Amazon, loss: 0.4221528172492981
step: 230, task: Dirty/Walmart-Amazon, loss: 0.28825807571411133
step: 240, task: Dirty/Walmart-Amazon, loss: 0.2536042332649231
step: 250, task: Dirty/Walmart-Amazon, loss: 0.24802285432815552
step: 260, task: Dirty/Walmart-Amazon, loss: 0.7521495819091797
step: 270, task: Dirty/Walmart-Amazon, loss: 0.1390705704689026
step: 280, task: Dirty/Walmart-Amazon, loss: 0.4752720892429352
step: 290, task: Dirty/Walmart-Amazon, loss: 0.23110374808311462
step: 300, task: Dirty/Walmart-Amazon, loss: 0.11028549075126648
step: 310, task: Dirty/Walmart-Amazon, loss: 0.4000227451324463
step: 320, task: Dirty/Walmart-Amazon, loss: 0.31007444858551025
step: 330, task: Dirty/Walmart-Amazon, loss: 0.3824649155139923
step: 340, task: Dirty/Walmart-Amazon, loss: 0.22087420523166656
step: 350, task: Dirty/Walmart-Amazon, loss: 0.25284579396247864
step: 360, task: Dirty/Walmart-Amazon, loss: 0.6105632185935974
step: 370, task: Dirty/Walmart-Amazon, loss: 0.5298961997032166
step: 380, task: Dirty/Walmart-Amazon, loss: 0.3754846453666687
=========eval at epoch=1=========
Validation:
=============Dirty/Walmart-Amazon==================
accuracy=0.906
precision=0.000
recall=0.000
f1=0.000
======================================
Test:
=============Dirty/Walmart-Amazon==================
accuracy=0.906
precision=0.000
recall=0.000
f1=0.000
======================================
=====sanity check======
words: COL title VAL lexmark t650a11a black toner print cartridge lexmark t650a11a COL category VAL printers COL brand VAL  COL modelno VAL  COL price VAL 202.87  [SEP] COL title VAL lexmark t650 series print cartridge 7000 yield - genuine oem toner lexmark 231.99 COL category VAL laser printer toner COL brand VAL  COL modelno VAL  COL price VAL  
x: [    0 18047  1270 27445 36912  6920   326 16316   102  1225   102   909
  4866   254  5780 41785 36912  6920   326 16316   102  1225   102 14857
  4120 27445 29379 14857  1518 27445  1437 14857  1421  2362 27445  1437
 14857   425 27445 22991     4  5677  1437     2     2 18047  1270 27445
 36912  6920   326 16316   651  5780 41785 39575  3363   111  8916  1021
   991  4866   254 36912  6920 32486     4  2831 14857  4120 27445 13443
 24079  4866   254 14857  1518 27445  1437 14857  1421  2362 27445  1437
 14857   425 27445  1437  1437     2]
tokens: ['<s>', 'COL', 'Ġtitle', 'ĠVAL', 'Ġlex', 'mark', 'Ġt', '650', 'a', '11', 'a', 'Ġblack', 'Ġton', 'er', 'Ġprint', 'Ġcartridge', 'Ġlex', 'mark', 'Ġt', '650', 'a', '11', 'a', 'ĠCOL', 'Ġcategory', 'ĠVAL', 'Ġprinters', 'ĠCOL', 'Ġbrand', 'ĠVAL', 'Ġ', 'ĠCOL', 'Ġmodel', 'no', 'ĠVAL', 'Ġ', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ202', '.', '87', 'Ġ', '</s>', '</s>', 'COL', 'Ġtitle', 'ĠVAL', 'Ġlex', 'mark', 'Ġt', '650', 'Ġseries', 'Ġprint', 'Ġcartridge', 'Ġ7000', 'Ġyield', 'Ġ-', 'Ġgenuine', 'Ġo', 'em', 'Ġton', 'er', 'Ġlex', 'mark', 'Ġ231', '.', '99', 'ĠCOL', 'Ġcategory', 'ĠVAL', 'Ġlaser', 'Ġprinter', 'Ġton', 'er', 'ĠCOL', 'Ġbrand', 'ĠVAL', 'Ġ', 'ĠCOL', 'Ġmodel', 'no', 'ĠVAL', 'Ġ', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ', 'Ġ', '</s>']
is_heads: [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
y: 0
tags: 0
mask: tensor([1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1])
seqlen: 90
task_name: Dirty/Walmart-Amazon
=======================
step: 0, task: Dirty/Walmart-Amazon, loss: 0.1072753295302391
step: 10, task: Dirty/Walmart-Amazon, loss: 0.49805930256843567
step: 20, task: Dirty/Walmart-Amazon, loss: 0.4165847897529602
step: 30, task: Dirty/Walmart-Amazon, loss: 0.6264650225639343
step: 40, task: Dirty/Walmart-Amazon, loss: 0.35155442357063293
step: 50, task: Dirty/Walmart-Amazon, loss: 0.31688031554222107
step: 60, task: Dirty/Walmart-Amazon, loss: 0.270507276058197
step: 70, task: Dirty/Walmart-Amazon, loss: 0.41552749276161194
step: 80, task: Dirty/Walmart-Amazon, loss: 0.2520180940628052
step: 90, task: Dirty/Walmart-Amazon, loss: 0.23641866445541382
step: 100, task: Dirty/Walmart-Amazon, loss: 0.20780888199806213
step: 110, task: Dirty/Walmart-Amazon, loss: 0.22335132956504822
step: 120, task: Dirty/Walmart-Amazon, loss: 0.08217921108007431
step: 130, task: Dirty/Walmart-Amazon, loss: 0.34693360328674316
step: 140, task: Dirty/Walmart-Amazon, loss: 0.05922798067331314
step: 150, task: Dirty/Walmart-Amazon, loss: 0.2278953492641449
step: 160, task: Dirty/Walmart-Amazon, loss: 0.46856898069381714
step: 170, task: Dirty/Walmart-Amazon, loss: 0.2639095187187195
step: 180, task: Dirty/Walmart-Amazon, loss: 0.09171833097934723
step: 190, task: Dirty/Walmart-Amazon, loss: 0.06871569901704788
step: 200, task: Dirty/Walmart-Amazon, loss: 0.21946099400520325
step: 210, task: Dirty/Walmart-Amazon, loss: 0.3278856873512268
step: 220, task: Dirty/Walmart-Amazon, loss: 0.4237164855003357
step: 230, task: Dirty/Walmart-Amazon, loss: 0.07396980375051498
step: 240, task: Dirty/Walmart-Amazon, loss: 0.333457887172699
step: 250, task: Dirty/Walmart-Amazon, loss: 0.28711843490600586
step: 260, task: Dirty/Walmart-Amazon, loss: 0.2601967453956604
step: 270, task: Dirty/Walmart-Amazon, loss: 0.3516242206096649
step: 280, task: Dirty/Walmart-Amazon, loss: 0.1309068500995636
step: 290, task: Dirty/Walmart-Amazon, loss: 0.03725219517946243
step: 300, task: Dirty/Walmart-Amazon, loss: 0.3463081419467926
step: 310, task: Dirty/Walmart-Amazon, loss: 0.07914791256189346
step: 320, task: Dirty/Walmart-Amazon, loss: 0.08508476614952087
step: 330, task: Dirty/Walmart-Amazon, loss: 0.33623671531677246
step: 340, task: Dirty/Walmart-Amazon, loss: 0.08841496706008911
step: 350, task: Dirty/Walmart-Amazon, loss: 0.2180522382259369
step: 360, task: Dirty/Walmart-Amazon, loss: 0.0746954157948494
step: 370, task: Dirty/Walmart-Amazon, loss: 0.25300413370132446
step: 380, task: Dirty/Walmart-Amazon, loss: 0.364326536655426
=========eval at epoch=1=========
Validation:
=============Dirty/Walmart-Amazon==================
accuracy=0.906
precision=0.000
recall=0.000
f1=0.000
======================================
Test:
=============Dirty/Walmart-Amazon==================
accuracy=0.906
precision=0.000
recall=0.000
f1=0.000
======================================
=====sanity check======
words: COL title VAL razer lycosa gaming keyboard COL category VAL electronics - general COL brand VAL razer COL modelno VAL lycosa COL price VAL 67.84  [SEP] COL title VAL razer lycosa mirror gaming keyboard - special edition controllers razer rz03-00181400-r3u1 COL category VAL  COL brand VAL  COL modelno VAL  COL price VAL  
x: [    0 18047  1270 27445   910 14609 37653 16254   102  6548 12722 14857
  4120 27445  8917   111   937 14857  1518 27445   910 14609 14857  1421
  2362 27445 37653 16254   102 14857   425 27445  5545     4  6232  1437
     2     2 18047  1270 27445   910 14609 37653 16254   102  9807  6548
 12722   111   780  5403 22971   910 14609   910   329  3933    12   612
  1366  1570   612    12   338   246   257   134 14857  4120 27445  1437
 14857  1518 27445  1437 14857  1421  2362 27445  1437 14857   425 27445
  1437  1437     2]
tokens: ['<s>', 'COL', 'Ġtitle', 'ĠVAL', 'Ġr', 'azer', 'Ġly', 'cos', 'a', 'Ġgaming', 'Ġkeyboard', 'ĠCOL', 'Ġcategory', 'ĠVAL', 'Ġelectronics', 'Ġ-', 'Ġgeneral', 'ĠCOL', 'Ġbrand', 'ĠVAL', 'Ġr', 'azer', 'ĠCOL', 'Ġmodel', 'no', 'ĠVAL', 'Ġly', 'cos', 'a', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ67', '.', '84', 'Ġ', '</s>', '</s>', 'COL', 'Ġtitle', 'ĠVAL', 'Ġr', 'azer', 'Ġly', 'cos', 'a', 'Ġmirror', 'Ġgaming', 'Ġkeyboard', 'Ġ-', 'Ġspecial', 'Ġedition', 'Ġcontrollers', 'Ġr', 'azer', 'Ġr', 'z', '03', '-', '00', '18', '14', '00', '-', 'r', '3', 'u', '1', 'ĠCOL', 'Ġcategory', 'ĠVAL', 'Ġ', 'ĠCOL', 'Ġbrand', 'ĠVAL', 'Ġ', 'ĠCOL', 'Ġmodel', 'no', 'ĠVAL', 'Ġ', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ', 'Ġ', '</s>']
is_heads: [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
y: 1
tags: 1
mask: tensor([1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1])
seqlen: 87
task_name: Dirty/Walmart-Amazon
=======================
step: 0, task: Dirty/Walmart-Amazon, loss: 0.4581729769706726
step: 10, task: Dirty/Walmart-Amazon, loss: 0.30681949853897095
step: 20, task: Dirty/Walmart-Amazon, loss: 0.4029398560523987
step: 30, task: Dirty/Walmart-Amazon, loss: 0.25071632862091064
step: 40, task: Dirty/Walmart-Amazon, loss: 0.11740433424711227
step: 50, task: Dirty/Walmart-Amazon, loss: 0.40715914964675903
step: 60, task: Dirty/Walmart-Amazon, loss: 0.6621735692024231
step: 70, task: Dirty/Walmart-Amazon, loss: 0.48610132932662964
step: 80, task: Dirty/Walmart-Amazon, loss: 0.2876649796962738
step: 90, task: Dirty/Walmart-Amazon, loss: 0.10303802788257599
step: 100, task: Dirty/Walmart-Amazon, loss: 0.3790954649448395
step: 110, task: Dirty/Walmart-Amazon, loss: 0.2998119592666626
step: 120, task: Dirty/Walmart-Amazon, loss: 0.33663639426231384
step: 130, task: Dirty/Walmart-Amazon, loss: 0.24092350900173187
step: 140, task: Dirty/Walmart-Amazon, loss: 0.32924947142601013
step: 150, task: Dirty/Walmart-Amazon, loss: 0.44195473194122314
step: 160, task: Dirty/Walmart-Amazon, loss: 0.4950416684150696
step: 170, task: Dirty/Walmart-Amazon, loss: 0.2501463294029236
step: 180, task: Dirty/Walmart-Amazon, loss: 0.18411968648433685
step: 190, task: Dirty/Walmart-Amazon, loss: 0.22965553402900696
step: 200, task: Dirty/Walmart-Amazon, loss: 0.4524957835674286
step: 210, task: Dirty/Walmart-Amazon, loss: 0.22496375441551208
step: 220, task: Dirty/Walmart-Amazon, loss: 0.20098546147346497
step: 230, task: Dirty/Walmart-Amazon, loss: 0.5851426124572754
step: 240, task: Dirty/Walmart-Amazon, loss: 0.4689076840877533
step: 250, task: Dirty/Walmart-Amazon, loss: 0.06949304044246674
step: 260, task: Dirty/Walmart-Amazon, loss: 0.1586722880601883
step: 270, task: Dirty/Walmart-Amazon, loss: 0.2806069254875183
step: 280, task: Dirty/Walmart-Amazon, loss: 0.06506408005952835
step: 290, task: Dirty/Walmart-Amazon, loss: 0.40341535210609436
step: 300, task: Dirty/Walmart-Amazon, loss: 0.36448177695274353
step: 310, task: Dirty/Walmart-Amazon, loss: 0.20873761177062988
step: 320, task: Dirty/Walmart-Amazon, loss: 0.42562931776046753
step: 330, task: Dirty/Walmart-Amazon, loss: 0.3933835029602051
step: 340, task: Dirty/Walmart-Amazon, loss: 0.059230245649814606
step: 350, task: Dirty/Walmart-Amazon, loss: 0.24993452429771423
step: 360, task: Dirty/Walmart-Amazon, loss: 0.19864726066589355
step: 370, task: Dirty/Walmart-Amazon, loss: 0.10348144173622131
step: 380, task: Dirty/Walmart-Amazon, loss: 0.5918717384338379
=========eval at epoch=1=========
Validation:
=============Dirty/Walmart-Amazon==================
accuracy=0.906
precision=0.000
recall=0.000
f1=0.000
======================================
Test:
=============Dirty/Walmart-Amazon==================
accuracy=0.906
precision=0.000
recall=0.000
f1=0.000
======================================
=====sanity check======
words: COL title VAL iosafe rugged 500gb usb 3.0 portable external hard drive hard drives COL category VAL  COL brand VAL iosafe COL modelno VAL pa50500u5yr COL price VAL 299.98  [SEP] COL title VAL hewlett packard hp portable 1 tb usb 3.0 2.0 external hard drive hp 89.99 COL category VAL external data storage COL brand VAL  COL modelno VAL wdbacz0010bbk-nesn COL price VAL  
x: [    0 18047  1270 27445   939   366 20120 21937  1764 19562 49030   155
     4   288 15295  6731   543  1305   543  6790 14857  4120 27445  1437
 14857  1518 27445   939   366 20120 14857  1421  2362 27445  6044  1096
  1497   257   245  4503 14857   425 27445 35768     4  5208  1437     2
     2 18047  1270 27445    37   605  8211  6356  1120 29886 15295   112
   326   428 49030   155     4   288   132     4   288  6731   543  1305
 29886  8572     4  2831 14857  4120 27445  6731   414  3521 14857  1518
 27445  1437 14857  1421  2362 27445   885 33845  1043   329 47342 14141
   330    12  4977   282 14857   425 27445  1437  1437     2]
tokens: ['<s>', 'COL', 'Ġtitle', 'ĠVAL', 'Ġi', 'os', 'afe', 'Ġrugged', 'Ġ500', 'gb', 'Ġusb', 'Ġ3', '.', '0', 'Ġportable', 'Ġexternal', 'Ġhard', 'Ġdrive', 'Ġhard', 'Ġdrives', 'ĠCOL', 'Ġcategory', 'ĠVAL', 'Ġ', 'ĠCOL', 'Ġbrand', 'ĠVAL', 'Ġi', 'os', 'afe', 'ĠCOL', 'Ġmodel', 'no', 'ĠVAL', 'Ġpa', '50', '500', 'u', '5', 'yr', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ299', '.', '98', 'Ġ', '</s>', '</s>', 'COL', 'Ġtitle', 'ĠVAL', 'Ġhe', 'w', 'lett', 'Ġpack', 'ard', 'Ġhp', 'Ġportable', 'Ġ1', 'Ġt', 'b', 'Ġusb', 'Ġ3', '.', '0', 'Ġ2', '.', '0', 'Ġexternal', 'Ġhard', 'Ġdrive', 'Ġhp', 'Ġ89', '.', '99', 'ĠCOL', 'Ġcategory', 'ĠVAL', 'Ġexternal', 'Ġdata', 'Ġstorage', 'ĠCOL', 'Ġbrand', 'ĠVAL', 'Ġ', 'ĠCOL', 'Ġmodel', 'no', 'ĠVAL', 'Ġw', 'db', 'ac', 'z', '0010', 'bb', 'k', '-', 'nes', 'n', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ', 'Ġ', '</s>']
is_heads: [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
y: 0
tags: 0
mask: tensor([1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1])
seqlen: 106
task_name: Dirty/Walmart-Amazon
=======================
step: 0, task: Dirty/Walmart-Amazon, loss: 0.44032517075538635
step: 10, task: Dirty/Walmart-Amazon, loss: 0.3469199538230896
step: 20, task: Dirty/Walmart-Amazon, loss: 0.5235336422920227
step: 30, task: Dirty/Walmart-Amazon, loss: 0.4373300075531006
step: 40, task: Dirty/Walmart-Amazon, loss: 0.563789427280426
step: 50, task: Dirty/Walmart-Amazon, loss: 0.22484257817268372
step: 60, task: Dirty/Walmart-Amazon, loss: 0.22526641190052032
step: 70, task: Dirty/Walmart-Amazon, loss: 0.630382239818573
step: 80, task: Dirty/Walmart-Amazon, loss: 0.1761082261800766
step: 90, task: Dirty/Walmart-Amazon, loss: 0.42692217230796814
step: 100, task: Dirty/Walmart-Amazon, loss: 0.5197027921676636
step: 110, task: Dirty/Walmart-Amazon, loss: 0.2552962601184845
step: 120, task: Dirty/Walmart-Amazon, loss: 0.6332066059112549
step: 130, task: Dirty/Walmart-Amazon, loss: 0.47883522510528564
step: 140, task: Dirty/Walmart-Amazon, loss: 0.1963518112897873
step: 150, task: Dirty/Walmart-Amazon, loss: 0.23819565773010254
step: 160, task: Dirty/Walmart-Amazon, loss: 0.5157558917999268
step: 170, task: Dirty/Walmart-Amazon, loss: 0.3679918646812439
step: 180, task: Dirty/Walmart-Amazon, loss: 0.36501967906951904
step: 190, task: Dirty/Walmart-Amazon, loss: 0.08791813999414444
step: 200, task: Dirty/Walmart-Amazon, loss: 0.22742661833763123
step: 210, task: Dirty/Walmart-Amazon, loss: 0.07720114290714264
step: 220, task: Dirty/Walmart-Amazon, loss: 0.23855771124362946
step: 230, task: Dirty/Walmart-Amazon, loss: 0.4643770456314087
step: 240, task: Dirty/Walmart-Amazon, loss: 0.3678898811340332
step: 250, task: Dirty/Walmart-Amazon, loss: 0.23853901028633118
step: 260, task: Dirty/Walmart-Amazon, loss: 0.661421537399292
step: 270, task: Dirty/Walmart-Amazon, loss: 0.3629026710987091
step: 280, task: Dirty/Walmart-Amazon, loss: 0.24336276948451996
step: 290, task: Dirty/Walmart-Amazon, loss: 0.3723759055137634
step: 300, task: Dirty/Walmart-Amazon, loss: 0.21862667798995972
step: 310, task: Dirty/Walmart-Amazon, loss: 0.0824861004948616
step: 320, task: Dirty/Walmart-Amazon, loss: 0.05049203336238861
step: 330, task: Dirty/Walmart-Amazon, loss: 0.21562275290489197
step: 340, task: Dirty/Walmart-Amazon, loss: 0.20132558047771454
step: 350, task: Dirty/Walmart-Amazon, loss: 0.05986528843641281
step: 360, task: Dirty/Walmart-Amazon, loss: 0.21030256152153015
step: 370, task: Dirty/Walmart-Amazon, loss: 0.3903006613254547
step: 380, task: Dirty/Walmart-Amazon, loss: 0.5666893124580383
=========eval at epoch=1=========
Validation:
=============Dirty/Walmart-Amazon==================
accuracy=0.906
precision=0.000
recall=0.000
f1=0.000
======================================
Test:
=============Dirty/Walmart-Amazon==================
accuracy=0.906
precision=0.000
recall=0.000
f1=0.000
======================================
=====sanity check======
words: COL title VAL brother tx2511 laminated tape cartridge stationery & office machinery brother COL category VAL  COL brand VAL  COL modelno VAL tx2511 COL price VAL 34.88  [SEP] COL title VAL brother tape cartridge 0.5 in wide non-laminated black on green m731 brother 8.94 COL category VAL labeling tapes COL brand VAL  COL modelno VAL m731 COL price VAL  
x: [    0 18047  1270 27445  2138 48726  1244  1225 24160  9339  7898 41785
  1992  4270   359   558 13922  2138 14857  4120 27445  1437 14857  1518
 27445  1437 14857  1421  2362 27445 48726  1244  1225 14857   425 27445
  2631     4  4652  1437     2     2 18047  1270 27445  2138  7898 41785
   321     4   245    11  1810   786    12  5112  9339   909    15  2272
   475   406  2983  2138   290     4  6405 14857  4120 27445 27963 23335
 14857  1518 27445  1437 14857  1421  2362 27445   475   406  2983 14857
   425 27445  1437  1437     2]
tokens: ['<s>', 'COL', 'Ġtitle', 'ĠVAL', 'Ġbrother', 'Ġtx', '25', '11', 'Ġlam', 'inated', 'Ġtape', 'Ġcartridge', 'Ġstation', 'ery', 'Ġ&', 'Ġoffice', 'Ġmachinery', 'Ġbrother', 'ĠCOL', 'Ġcategory', 'ĠVAL', 'Ġ', 'ĠCOL', 'Ġbrand', 'ĠVAL', 'Ġ', 'ĠCOL', 'Ġmodel', 'no', 'ĠVAL', 'Ġtx', '25', '11', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ34', '.', '88', 'Ġ', '</s>', '</s>', 'COL', 'Ġtitle', 'ĠVAL', 'Ġbrother', 'Ġtape', 'Ġcartridge', 'Ġ0', '.', '5', 'Ġin', 'Ġwide', 'Ġnon', '-', 'lam', 'inated', 'Ġblack', 'Ġon', 'Ġgreen', 'Ġm', '7', '31', 'Ġbrother', 'Ġ8', '.', '94', 'ĠCOL', 'Ġcategory', 'ĠVAL', 'Ġlabeling', 'Ġtapes', 'ĠCOL', 'Ġbrand', 'ĠVAL', 'Ġ', 'ĠCOL', 'Ġmodel', 'no', 'ĠVAL', 'Ġm', '7', '31', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ', 'Ġ', '</s>']
is_heads: [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
y: 0
tags: 0
mask: tensor([1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1])
seqlen: 89
task_name: Dirty/Walmart-Amazon
=======================
step: 0, task: Dirty/Walmart-Amazon, loss: 0.11286799609661102
step: 10, task: Dirty/Walmart-Amazon, loss: 0.23639145493507385
step: 20, task: Dirty/Walmart-Amazon, loss: 0.46387815475463867
step: 30, task: Dirty/Walmart-Amazon, loss: 0.5853946805000305
step: 40, task: Dirty/Walmart-Amazon, loss: 0.3452056050300598
step: 50, task: Dirty/Walmart-Amazon, loss: 0.37596583366394043
step: 60, task: Dirty/Walmart-Amazon, loss: 0.3625156879425049
step: 70, task: Dirty/Walmart-Amazon, loss: 0.5479786992073059
step: 80, task: Dirty/Walmart-Amazon, loss: 0.1808847337961197
step: 90, task: Dirty/Walmart-Amazon, loss: 0.25185078382492065
step: 100, task: Dirty/Walmart-Amazon, loss: 0.20358160138130188
step: 110, task: Dirty/Walmart-Amazon, loss: 0.3602566719055176
step: 120, task: Dirty/Walmart-Amazon, loss: 0.1786743700504303
step: 130, task: Dirty/Walmart-Amazon, loss: 0.5060682892799377
step: 140, task: Dirty/Walmart-Amazon, loss: 0.2887509763240814
step: 150, task: Dirty/Walmart-Amazon, loss: 0.3044484257698059
step: 160, task: Dirty/Walmart-Amazon, loss: 0.0643375962972641
step: 170, task: Dirty/Walmart-Amazon, loss: 0.3447078466415405
step: 180, task: Dirty/Walmart-Amazon, loss: 0.09264981746673584
step: 190, task: Dirty/Walmart-Amazon, loss: 0.25125330686569214
step: 200, task: Dirty/Walmart-Amazon, loss: 0.3064364194869995
step: 210, task: Dirty/Walmart-Amazon, loss: 0.35919487476348877
step: 220, task: Dirty/Walmart-Amazon, loss: 0.33098992705345154
step: 230, task: Dirty/Walmart-Amazon, loss: 0.17452871799468994
step: 240, task: Dirty/Walmart-Amazon, loss: 0.5266991853713989
step: 250, task: Dirty/Walmart-Amazon, loss: 0.339292049407959
step: 260, task: Dirty/Walmart-Amazon, loss: 0.3397209346294403
step: 270, task: Dirty/Walmart-Amazon, loss: 0.20593738555908203
step: 280, task: Dirty/Walmart-Amazon, loss: 0.11709881573915482
step: 290, task: Dirty/Walmart-Amazon, loss: 0.5615316033363342
step: 300, task: Dirty/Walmart-Amazon, loss: 0.13060586154460907
step: 310, task: Dirty/Walmart-Amazon, loss: 0.389954537153244
step: 320, task: Dirty/Walmart-Amazon, loss: 0.1654379516839981
step: 330, task: Dirty/Walmart-Amazon, loss: 0.3334898054599762
step: 340, task: Dirty/Walmart-Amazon, loss: 0.22420534491539001
step: 350, task: Dirty/Walmart-Amazon, loss: 0.2609235644340515
step: 360, task: Dirty/Walmart-Amazon, loss: 0.5135602355003357
step: 370, task: Dirty/Walmart-Amazon, loss: 0.19530150294303894
step: 380, task: Dirty/Walmart-Amazon, loss: 0.2807369530200958
=========eval at epoch=1=========
Validation:
=============Dirty/Walmart-Amazon==================
accuracy=0.906
precision=0.000
recall=0.000
f1=0.000
======================================
Test:
=============Dirty/Walmart-Amazon==================
accuracy=0.906
precision=0.000
recall=0.000
f1=0.000
======================================
=====sanity check======
words: COL title VAL memorex color slim cd jewel cases - 50 pack electronics - general memorex 3202-1950 19.88 COL category VAL  COL brand VAL  COL modelno VAL  COL price VAL   [SEP] COL title VAL memorex 32021926 clear slim jewel cases 25-pack disc jewel cases 32021926 7.2 COL category VAL  COL brand VAL memorex COL modelno VAL  COL price VAL  
x: [    0 18047  1270 27445 26012  1688  1178  3195 11875 45584 24693  1200
   111   654  6356  8917   111   937 26012  1688  1178   155 25155    12
 43545   753     4  4652 14857  4120 27445  1437 14857  1518 27445  1437
 14857  1421  2362 27445  1437 14857   425 27445  1437  1437     2     2
 18047  1270 27445 26012  1688  1178   155 25155  1646  2481   699 11875
 24693  1200   564    12 12486  9553 24693  1200   155 25155  1646  2481
   262     4   176 14857  4120 27445  1437 14857  1518 27445 26012  1688
  1178 14857  1421  2362 27445  1437 14857   425 27445  1437  1437     2]
tokens: ['<s>', 'COL', 'Ġtitle', 'ĠVAL', 'Ġmem', 'ore', 'x', 'Ġcolor', 'Ġslim', 'Ġcd', 'Ġjewel', 'Ġcases', 'Ġ-', 'Ġ50', 'Ġpack', 'Ġelectronics', 'Ġ-', 'Ġgeneral', 'Ġmem', 'ore', 'x', 'Ġ3', '202', '-', '1950', 'Ġ19', '.', '88', 'ĠCOL', 'Ġcategory', 'ĠVAL', 'Ġ', 'ĠCOL', 'Ġbrand', 'ĠVAL', 'Ġ', 'ĠCOL', 'Ġmodel', 'no', 'ĠVAL', 'Ġ', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ', 'Ġ', '</s>', '</s>', 'COL', 'Ġtitle', 'ĠVAL', 'Ġmem', 'ore', 'x', 'Ġ3', '202', '19', '26', 'Ġclear', 'Ġslim', 'Ġjewel', 'Ġcases', 'Ġ25', '-', 'pack', 'Ġdisc', 'Ġjewel', 'Ġcases', 'Ġ3', '202', '19', '26', 'Ġ7', '.', '2', 'ĠCOL', 'Ġcategory', 'ĠVAL', 'Ġ', 'ĠCOL', 'Ġbrand', 'ĠVAL', 'Ġmem', 'ore', 'x', 'ĠCOL', 'Ġmodel', 'no', 'ĠVAL', 'Ġ', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ', 'Ġ', '</s>']
is_heads: [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
y: 0
tags: 0
mask: tensor([1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1])
seqlen: 96
task_name: Dirty/Walmart-Amazon
=======================
step: 0, task: Dirty/Walmart-Amazon, loss: 0.19989140331745148
step: 10, task: Dirty/Walmart-Amazon, loss: 0.23853211104869843
step: 20, task: Dirty/Walmart-Amazon, loss: 0.3309173583984375
step: 30, task: Dirty/Walmart-Amazon, loss: 0.06933248788118362
step: 40, task: Dirty/Walmart-Amazon, loss: 0.4287183880805969
step: 50, task: Dirty/Walmart-Amazon, loss: 0.11907909065485
step: 60, task: Dirty/Walmart-Amazon, loss: 0.3300020098686218
step: 70, task: Dirty/Walmart-Amazon, loss: 0.09971161186695099
step: 80, task: Dirty/Walmart-Amazon, loss: 0.11184704303741455
step: 90, task: Dirty/Walmart-Amazon, loss: 0.2847834825515747
step: 100, task: Dirty/Walmart-Amazon, loss: 0.5784624218940735
step: 110, task: Dirty/Walmart-Amazon, loss: 0.16934746503829956
step: 120, task: Dirty/Walmart-Amazon, loss: 0.6514158248901367
step: 130, task: Dirty/Walmart-Amazon, loss: 0.09621239453554153
step: 140, task: Dirty/Walmart-Amazon, loss: 0.3151836395263672
step: 150, task: Dirty/Walmart-Amazon, loss: 0.19404639303684235
step: 160, task: Dirty/Walmart-Amazon, loss: 0.34874120354652405
step: 170, task: Dirty/Walmart-Amazon, loss: 0.4903367757797241
step: 180, task: Dirty/Walmart-Amazon, loss: 0.41305339336395264
step: 190, task: Dirty/Walmart-Amazon, loss: 0.21598730981349945
step: 200, task: Dirty/Walmart-Amazon, loss: 0.6453746557235718
step: 210, task: Dirty/Walmart-Amazon, loss: 0.32182836532592773
step: 220, task: Dirty/Walmart-Amazon, loss: 0.22640538215637207
step: 230, task: Dirty/Walmart-Amazon, loss: 0.35907167196273804
step: 240, task: Dirty/Walmart-Amazon, loss: 0.5800125002861023
step: 250, task: Dirty/Walmart-Amazon, loss: 0.20781300961971283
step: 260, task: Dirty/Walmart-Amazon, loss: 0.3033298850059509
step: 270, task: Dirty/Walmart-Amazon, loss: 0.21848265826702118
step: 280, task: Dirty/Walmart-Amazon, loss: 0.11648034304380417
step: 290, task: Dirty/Walmart-Amazon, loss: 0.36005693674087524
step: 300, task: Dirty/Walmart-Amazon, loss: 0.2881142497062683
step: 310, task: Dirty/Walmart-Amazon, loss: 0.07384616881608963
step: 320, task: Dirty/Walmart-Amazon, loss: 0.29602158069610596
step: 330, task: Dirty/Walmart-Amazon, loss: 0.5145453810691833
step: 340, task: Dirty/Walmart-Amazon, loss: 0.214208722114563
step: 350, task: Dirty/Walmart-Amazon, loss: 0.10582297295331955
step: 360, task: Dirty/Walmart-Amazon, loss: 0.18659324944019318
step: 370, task: Dirty/Walmart-Amazon, loss: 0.30409789085388184
step: 380, task: Dirty/Walmart-Amazon, loss: 0.07873041182756424
=========eval at epoch=1=========
Validation:
=============Dirty/Walmart-Amazon==================
accuracy=0.906
precision=0.000
recall=0.000
f1=0.000
======================================
Test:
=============Dirty/Walmart-Amazon==================
accuracy=0.906
precision=0.000
recall=0.000
f1=0.000
======================================
=====sanity check======
words: COL title VAL hp 901 black inkjet cartridge twin pack 26.98 COL category VAL printers COL brand VAL hp COL modelno VAL hp cz075fn # 140 COL price VAL   [SEP] COL title VAL epson t026201 1 black and t027201 1 color ink cartridge twin pack inkjet printer ink epson COL category VAL  COL brand VAL  COL modelno VAL t026201-bcd COL price VAL 44.99 
x: [    0 18047  1270 27445 29886   361  2663   909 16019  6622 41785  9544
  6356   973     4  5208 14857  4120 27445 29379 14857  1518 27445 29886
 14857  1421  2362 27445 29886 25198 36754 42441   849  9680 14857   425
 27445  1437  1437     2     2 18047  1270 27445   364 28898   326 40521
 16295   112   909     8   326 40819 16295   112  3195 16019 41785  9544
  6356 16019  6622 24079 16019   364 28898 14857  4120 27445  1437 14857
  1518 27445  1437 14857  1421  2362 27445   326 40521 16295    12   428
 28690 14857   425 27445  3550     4  2831  1437     2]
tokens: ['<s>', 'COL', 'Ġtitle', 'ĠVAL', 'Ġhp', 'Ġ9', '01', 'Ġblack', 'Ġink', 'jet', 'Ġcartridge', 'Ġtwin', 'Ġpack', 'Ġ26', '.', '98', 'ĠCOL', 'Ġcategory', 'ĠVAL', 'Ġprinters', 'ĠCOL', 'Ġbrand', 'ĠVAL', 'Ġhp', 'ĠCOL', 'Ġmodel', 'no', 'ĠVAL', 'Ġhp', 'Ġcz', '075', 'fn', 'Ġ#', 'Ġ140', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ', 'Ġ', '</s>', '</s>', 'COL', 'Ġtitle', 'ĠVAL', 'Ġe', 'pson', 'Ġt', '026', '201', 'Ġ1', 'Ġblack', 'Ġand', 'Ġt', '027', '201', 'Ġ1', 'Ġcolor', 'Ġink', 'Ġcartridge', 'Ġtwin', 'Ġpack', 'Ġink', 'jet', 'Ġprinter', 'Ġink', 'Ġe', 'pson', 'ĠCOL', 'Ġcategory', 'ĠVAL', 'Ġ', 'ĠCOL', 'Ġbrand', 'ĠVAL', 'Ġ', 'ĠCOL', 'Ġmodel', 'no', 'ĠVAL', 'Ġt', '026', '201', '-', 'b', 'cd', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ44', '.', '99', 'Ġ', '</s>']
is_heads: [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
y: 0
tags: 0
mask: tensor([1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1])
seqlen: 93
task_name: Dirty/Walmart-Amazon
=======================
step: 0, task: Dirty/Walmart-Amazon, loss: 0.18629297614097595
step: 10, task: Dirty/Walmart-Amazon, loss: 0.185553178191185
step: 20, task: Dirty/Walmart-Amazon, loss: 0.2089720219373703
step: 30, task: Dirty/Walmart-Amazon, loss: 0.088526152074337
step: 40, task: Dirty/Walmart-Amazon, loss: 0.13873368501663208
step: 50, task: Dirty/Walmart-Amazon, loss: 0.6514804363250732
step: 60, task: Dirty/Walmart-Amazon, loss: 0.0854688286781311
step: 70, task: Dirty/Walmart-Amazon, loss: 0.24961145222187042
step: 80, task: Dirty/Walmart-Amazon, loss: 0.2972447872161865
step: 90, task: Dirty/Walmart-Amazon, loss: 0.30077680945396423
step: 100, task: Dirty/Walmart-Amazon, loss: 0.21168141067028046
step: 110, task: Dirty/Walmart-Amazon, loss: 0.3213962912559509
step: 120, task: Dirty/Walmart-Amazon, loss: 0.23209147155284882
step: 130, task: Dirty/Walmart-Amazon, loss: 0.18327587842941284
step: 140, task: Dirty/Walmart-Amazon, loss: 0.11654217541217804
step: 150, task: Dirty/Walmart-Amazon, loss: 0.05813942849636078
step: 160, task: Dirty/Walmart-Amazon, loss: 0.1956373006105423
step: 170, task: Dirty/Walmart-Amazon, loss: 0.17543059587478638
step: 180, task: Dirty/Walmart-Amazon, loss: 0.3131336271762848
step: 190, task: Dirty/Walmart-Amazon, loss: 0.4527128338813782
step: 200, task: Dirty/Walmart-Amazon, loss: 0.1783786118030548
step: 210, task: Dirty/Walmart-Amazon, loss: 0.13140350580215454
step: 220, task: Dirty/Walmart-Amazon, loss: 0.17738783359527588
step: 230, task: Dirty/Walmart-Amazon, loss: 0.3115431070327759
step: 240, task: Dirty/Walmart-Amazon, loss: 0.13567663729190826
step: 250, task: Dirty/Walmart-Amazon, loss: 0.16510216891765594
step: 260, task: Dirty/Walmart-Amazon, loss: 0.08258829265832901
step: 270, task: Dirty/Walmart-Amazon, loss: 0.1170739084482193
step: 280, task: Dirty/Walmart-Amazon, loss: 0.2734256982803345
step: 290, task: Dirty/Walmart-Amazon, loss: 0.06890878826379776
step: 300, task: Dirty/Walmart-Amazon, loss: 0.1766277402639389
step: 310, task: Dirty/Walmart-Amazon, loss: 0.09159325808286667
step: 320, task: Dirty/Walmart-Amazon, loss: 0.09261675179004669
step: 330, task: Dirty/Walmart-Amazon, loss: 0.3076450228691101
step: 340, task: Dirty/Walmart-Amazon, loss: 0.3401571214199066
step: 350, task: Dirty/Walmart-Amazon, loss: 0.043700434267520905
step: 360, task: Dirty/Walmart-Amazon, loss: 0.05243898555636406
step: 370, task: Dirty/Walmart-Amazon, loss: 0.08243447542190552
step: 380, task: Dirty/Walmart-Amazon, loss: 0.12855128943920135
=========eval at epoch=1=========
Validation:
=============Dirty/Walmart-Amazon==================
accuracy=0.906
precision=0.514
recall=0.098
f1=0.165
======================================
Test:
=============Dirty/Walmart-Amazon==================
accuracy=0.907
precision=0.535
recall=0.119
f1=0.195
======================================
=====sanity check======
words: COL title VAL pendaflex straight cut conversion folders letter manila box of 100 COL category VAL stationery & office machinery COL brand VAL  COL modelno VAL 16640 COL price VAL 33.94  [SEP] COL title VAL pendaflex 62711 - microbeguard file folders straight cut one fastener letter manila 50 box COL category VAL distribution COL brand VAL pendaflex COL modelno VAL  COL price VAL  
x: [    0 18047  1270 27445 35394  2001 14726  1359   847 10012 39301  1601
   313  4882  2233     9   727 14857  4120 27445  1992  4270   359   558
 13922 14857  1518 27445  1437 14857  1421  2362 27445 27459  1749 14857
   425 27445  2357     4  6405  1437     2     2 18047  1270 27445 35394
  2001 14726   231  2518  1225   111  5177  1610 12984  2870 39301  1359
   847    65  1769  5777  1601   313  4882   654  2233 14857  4120 27445
  3854 14857  1518 27445 35394  2001 14726 14857  1421  2362 27445  1437
 14857   425 27445  1437  1437     2]
tokens: ['<s>', 'COL', 'Ġtitle', 'ĠVAL', 'Ġpend', 'af', 'lex', 'Ġstraight', 'Ġcut', 'Ġconversion', 'Ġfolders', 'Ġletter', 'Ġman', 'ila', 'Ġbox', 'Ġof', 'Ġ100', 'ĠCOL', 'Ġcategory', 'ĠVAL', 'Ġstation', 'ery', 'Ġ&', 'Ġoffice', 'Ġmachinery', 'ĠCOL', 'Ġbrand', 'ĠVAL', 'Ġ', 'ĠCOL', 'Ġmodel', 'no', 'ĠVAL', 'Ġ166', '40', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ33', '.', '94', 'Ġ', '</s>', '</s>', 'COL', 'Ġtitle', 'ĠVAL', 'Ġpend', 'af', 'lex', 'Ġ6', '27', '11', 'Ġ-', 'Ġmicro', 'be', 'guard', 'Ġfile', 'Ġfolders', 'Ġstraight', 'Ġcut', 'Ġone', 'Ġfast', 'ener', 'Ġletter', 'Ġman', 'ila', 'Ġ50', 'Ġbox', 'ĠCOL', 'Ġcategory', 'ĠVAL', 'Ġdistribution', 'ĠCOL', 'Ġbrand', 'ĠVAL', 'Ġpend', 'af', 'lex', 'ĠCOL', 'Ġmodel', 'no', 'ĠVAL', 'Ġ', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ', 'Ġ', '</s>']
is_heads: [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
y: 0
tags: 0
mask: tensor([1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1])
seqlen: 90
task_name: Dirty/Walmart-Amazon
=======================
step: 0, task: Dirty/Walmart-Amazon, loss: 0.13060009479522705
step: 10, task: Dirty/Walmart-Amazon, loss: 0.033249419182538986
step: 20, task: Dirty/Walmart-Amazon, loss: 0.48014330863952637
step: 30, task: Dirty/Walmart-Amazon, loss: 0.1599494218826294
step: 40, task: Dirty/Walmart-Amazon, loss: 0.3743569552898407
step: 50, task: Dirty/Walmart-Amazon, loss: 0.02694617211818695
step: 60, task: Dirty/Walmart-Amazon, loss: 0.05315428227186203
step: 70, task: Dirty/Walmart-Amazon, loss: 0.10841251164674759
step: 80, task: Dirty/Walmart-Amazon, loss: 0.3778209090232849
step: 90, task: Dirty/Walmart-Amazon, loss: 0.22661583125591278
step: 100, task: Dirty/Walmart-Amazon, loss: 0.1919131577014923
step: 110, task: Dirty/Walmart-Amazon, loss: 0.2454489916563034
step: 120, task: Dirty/Walmart-Amazon, loss: 0.11034564673900604
step: 130, task: Dirty/Walmart-Amazon, loss: 0.21219664812088013
step: 140, task: Dirty/Walmart-Amazon, loss: 0.22671282291412354
step: 150, task: Dirty/Walmart-Amazon, loss: 0.19134676456451416
step: 160, task: Dirty/Walmart-Amazon, loss: 0.11000924557447433
step: 170, task: Dirty/Walmart-Amazon, loss: 0.15162791311740875
step: 180, task: Dirty/Walmart-Amazon, loss: 0.15025976300239563
Gradient overflow.  Skipping step, loss scaler 0 reducing loss scale to 8192.0
step: 190, task: Dirty/Walmart-Amazon, loss: 0.23928990960121155
step: 200, task: Dirty/Walmart-Amazon, loss: 0.04482386261224747
step: 210, task: Dirty/Walmart-Amazon, loss: 0.11814814060926437
step: 220, task: Dirty/Walmart-Amazon, loss: 0.07514721900224686
step: 230, task: Dirty/Walmart-Amazon, loss: 0.25570982694625854
step: 240, task: Dirty/Walmart-Amazon, loss: 0.04372096806764603
step: 250, task: Dirty/Walmart-Amazon, loss: 0.06499859690666199
step: 260, task: Dirty/Walmart-Amazon, loss: 0.17369197309017181
step: 270, task: Dirty/Walmart-Amazon, loss: 0.1314041018486023
step: 280, task: Dirty/Walmart-Amazon, loss: 0.10643662512302399
step: 290, task: Dirty/Walmart-Amazon, loss: 0.07971164584159851
step: 300, task: Dirty/Walmart-Amazon, loss: 0.23017998039722443
step: 310, task: Dirty/Walmart-Amazon, loss: 0.08890363574028015
step: 320, task: Dirty/Walmart-Amazon, loss: 0.08614175021648407
step: 330, task: Dirty/Walmart-Amazon, loss: 0.4166851043701172
step: 340, task: Dirty/Walmart-Amazon, loss: 0.1761300265789032
step: 350, task: Dirty/Walmart-Amazon, loss: 0.22551433742046356
step: 360, task: Dirty/Walmart-Amazon, loss: 0.0970420241355896
step: 370, task: Dirty/Walmart-Amazon, loss: 0.2707676887512207
step: 380, task: Dirty/Walmart-Amazon, loss: 0.09407364577054977
=========eval at epoch=2=========
Validation:
=============Dirty/Walmart-Amazon==================
accuracy=0.910
precision=0.622
recall=0.119
f1=0.200
======================================
Test:
=============Dirty/Walmart-Amazon==================
accuracy=0.903
precision=0.429
recall=0.078
f1=0.132
======================================
=====sanity check======
words: COL title VAL targus sport notebook backpack computers COL category VAL  COL brand VAL targus COL modelno VAL  COL price VAL 29.97  [SEP] COL title VAL dslr camera notebook backpack cases bags sumdex 59.78 COL category VAL  COL brand VAL  COL modelno VAL njc-486bk COL price VAL  
x: [    0 18047  1270 27445 47624   687  2414 27276 16907  7796 14857  4120
 27445  1437 14857  1518 27445 47624   687 14857  1421  2362 27445  1437
 14857   425 27445  1132     4  6750  1437     2     2 18047  1270 27445
   385  9996   338  2280 27276 16907  1200  5565  6797   417  3463  5169
     4  5479 14857  4120 27445  1437 14857  1518 27445  1437 14857  1421
  2362 27445   295 36699    12 37202   428   330 14857   425 27445  1437
  1437     2]
tokens: ['<s>', 'COL', 'Ġtitle', 'ĠVAL', 'Ġtarg', 'us', 'Ġsport', 'Ġnotebook', 'Ġbackpack', 'Ġcomputers', 'ĠCOL', 'Ġcategory', 'ĠVAL', 'Ġ', 'ĠCOL', 'Ġbrand', 'ĠVAL', 'Ġtarg', 'us', 'ĠCOL', 'Ġmodel', 'no', 'ĠVAL', 'Ġ', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ29', '.', '97', 'Ġ', '</s>', '</s>', 'COL', 'Ġtitle', 'ĠVAL', 'Ġd', 'sl', 'r', 'Ġcamera', 'Ġnotebook', 'Ġbackpack', 'Ġcases', 'Ġbags', 'Ġsum', 'd', 'ex', 'Ġ59', '.', '78', 'ĠCOL', 'Ġcategory', 'ĠVAL', 'Ġ', 'ĠCOL', 'Ġbrand', 'ĠVAL', 'Ġ', 'ĠCOL', 'Ġmodel', 'no', 'ĠVAL', 'Ġn', 'jc', '-', '486', 'b', 'k', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ', 'Ġ', '</s>']
is_heads: [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
y: 0
tags: 0
mask: tensor([1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1])
seqlen: 74
task_name: Dirty/Walmart-Amazon
=======================
step: 0, task: Dirty/Walmart-Amazon, loss: 0.0627894327044487
step: 10, task: Dirty/Walmart-Amazon, loss: 0.08472971618175507
step: 20, task: Dirty/Walmart-Amazon, loss: 0.09778843820095062
step: 30, task: Dirty/Walmart-Amazon, loss: 0.09683482348918915
step: 40, task: Dirty/Walmart-Amazon, loss: 0.08089044690132141
step: 50, task: Dirty/Walmart-Amazon, loss: 0.18960553407669067
step: 60, task: Dirty/Walmart-Amazon, loss: 0.11883809417486191
step: 70, task: Dirty/Walmart-Amazon, loss: 0.1989094316959381
step: 80, task: Dirty/Walmart-Amazon, loss: 0.09767423570156097
step: 90, task: Dirty/Walmart-Amazon, loss: 0.10424971580505371
step: 100, task: Dirty/Walmart-Amazon, loss: 0.057188503444194794
step: 110, task: Dirty/Walmart-Amazon, loss: 0.19860339164733887
step: 120, task: Dirty/Walmart-Amazon, loss: 0.2051105499267578
step: 130, task: Dirty/Walmart-Amazon, loss: 0.040409334003925323
step: 140, task: Dirty/Walmart-Amazon, loss: 0.028441987931728363
step: 150, task: Dirty/Walmart-Amazon, loss: 0.10766826570034027
step: 160, task: Dirty/Walmart-Amazon, loss: 0.057969145476818085
step: 170, task: Dirty/Walmart-Amazon, loss: 0.1119191125035286
step: 180, task: Dirty/Walmart-Amazon, loss: 0.10873625427484512
step: 190, task: Dirty/Walmart-Amazon, loss: 0.2007245570421219
step: 200, task: Dirty/Walmart-Amazon, loss: 0.3956674337387085
step: 210, task: Dirty/Walmart-Amazon, loss: 0.363842248916626
step: 220, task: Dirty/Walmart-Amazon, loss: 0.06585868448019028
step: 230, task: Dirty/Walmart-Amazon, loss: 0.0850328877568245
step: 240, task: Dirty/Walmart-Amazon, loss: 0.059383418411016464
step: 250, task: Dirty/Walmart-Amazon, loss: 0.22202527523040771
step: 260, task: Dirty/Walmart-Amazon, loss: 0.21668608486652374
step: 270, task: Dirty/Walmart-Amazon, loss: 0.10142194479703903
step: 280, task: Dirty/Walmart-Amazon, loss: 0.2479247748851776
step: 290, task: Dirty/Walmart-Amazon, loss: 0.4700659215450287
step: 300, task: Dirty/Walmart-Amazon, loss: 0.10053002834320068
step: 310, task: Dirty/Walmart-Amazon, loss: 0.311065137386322
step: 320, task: Dirty/Walmart-Amazon, loss: 0.08381572365760803
step: 330, task: Dirty/Walmart-Amazon, loss: 0.0930628627538681
step: 340, task: Dirty/Walmart-Amazon, loss: 0.3222278654575348
step: 350, task: Dirty/Walmart-Amazon, loss: 0.23298123478889465
step: 360, task: Dirty/Walmart-Amazon, loss: 0.21451976895332336
step: 370, task: Dirty/Walmart-Amazon, loss: 0.2765226662158966
step: 380, task: Dirty/Walmart-Amazon, loss: 0.23170320689678192
=========eval at epoch=3=========
Validation:
=============Dirty/Walmart-Amazon==================
accuracy=0.909
precision=0.600
recall=0.093
f1=0.161
======================================
Test:
=============Dirty/Walmart-Amazon==================
accuracy=0.905
precision=0.486
recall=0.093
f1=0.157
======================================
=====sanity check======
words: COL title VAL msw wireless jawbone icon bluetooth headset mesh electronics - general jawbone 72.98 COL category VAL  COL brand VAL  COL modelno VAL jbg01ms COL price VAL   [SEP] COL title VAL jawbone icon series rogue bluetooth headset jawbone jawiconrog 39.99 COL category VAL bluetooth headsets COL brand VAL  COL modelno VAL  COL price VAL  
x: [    0 18047  1270 27445   475  4184  6955 15345 18026  9360 42034 44969
 20084 22148  8917   111   937 15345 18026  4801     4  5208 14857  4120
 27445  1437 14857  1518 27445  1437 14857  1421  2362 27445  1236 35725
  2663  4339 14857   425 27445  1437  1437     2     2 18047  1270 27445
 15345 18026  9360   651 22251 42034 44969 20084 15345 18026 15345 17505
 10191  3191     4  2831 14857  4120 27445 42034 44969 30845 14857  1518
 27445  1437 14857  1421  2362 27445  1437 14857   425 27445  1437  1437
     2]
tokens: ['<s>', 'COL', 'Ġtitle', 'ĠVAL', 'Ġm', 'sw', 'Ġwireless', 'Ġjaw', 'bone', 'Ġicon', 'Ġblu', 'etooth', 'Ġheadset', 'Ġmesh', 'Ġelectronics', 'Ġ-', 'Ġgeneral', 'Ġjaw', 'bone', 'Ġ72', '.', '98', 'ĠCOL', 'Ġcategory', 'ĠVAL', 'Ġ', 'ĠCOL', 'Ġbrand', 'ĠVAL', 'Ġ', 'ĠCOL', 'Ġmodel', 'no', 'ĠVAL', 'Ġj', 'bg', '01', 'ms', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ', 'Ġ', '</s>', '</s>', 'COL', 'Ġtitle', 'ĠVAL', 'Ġjaw', 'bone', 'Ġicon', 'Ġseries', 'Ġrogue', 'Ġblu', 'etooth', 'Ġheadset', 'Ġjaw', 'bone', 'Ġjaw', 'icon', 'rog', 'Ġ39', '.', '99', 'ĠCOL', 'Ġcategory', 'ĠVAL', 'Ġblu', 'etooth', 'Ġheadsets', 'ĠCOL', 'Ġbrand', 'ĠVAL', 'Ġ', 'ĠCOL', 'Ġmodel', 'no', 'ĠVAL', 'Ġ', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ', 'Ġ', '</s>']
is_heads: [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
y: 0
tags: 0
mask: tensor([1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1])
seqlen: 85
task_name: Dirty/Walmart-Amazon
=======================
step: 0, task: Dirty/Walmart-Amazon, loss: 0.2638756036758423
step: 10, task: Dirty/Walmart-Amazon, loss: 0.08512210845947266
step: 20, task: Dirty/Walmart-Amazon, loss: 0.05130688101053238
step: 30, task: Dirty/Walmart-Amazon, loss: 0.033642612397670746
step: 40, task: Dirty/Walmart-Amazon, loss: 0.378627747297287
step: 50, task: Dirty/Walmart-Amazon, loss: 0.06511274725198746
step: 60, task: Dirty/Walmart-Amazon, loss: 0.22727327048778534
step: 70, task: Dirty/Walmart-Amazon, loss: 0.2689247131347656
step: 80, task: Dirty/Walmart-Amazon, loss: 0.030702508985996246
step: 90, task: Dirty/Walmart-Amazon, loss: 0.06885451078414917
step: 100, task: Dirty/Walmart-Amazon, loss: 0.1290701925754547
step: 110, task: Dirty/Walmart-Amazon, loss: 0.098942831158638
step: 120, task: Dirty/Walmart-Amazon, loss: 0.32902711629867554
step: 130, task: Dirty/Walmart-Amazon, loss: 0.054735325276851654
step: 140, task: Dirty/Walmart-Amazon, loss: 0.24872633814811707
step: 150, task: Dirty/Walmart-Amazon, loss: 0.1690307855606079
step: 160, task: Dirty/Walmart-Amazon, loss: 0.3244794011116028
step: 170, task: Dirty/Walmart-Amazon, loss: 0.4481167495250702
step: 180, task: Dirty/Walmart-Amazon, loss: 0.03561273217201233
step: 190, task: Dirty/Walmart-Amazon, loss: 0.05316268652677536
step: 200, task: Dirty/Walmart-Amazon, loss: 0.301399290561676
step: 210, task: Dirty/Walmart-Amazon, loss: 0.0759936049580574
step: 220, task: Dirty/Walmart-Amazon, loss: 0.06026247516274452
step: 230, task: Dirty/Walmart-Amazon, loss: 0.07767577469348907
step: 240, task: Dirty/Walmart-Amazon, loss: 0.25461021065711975
step: 250, task: Dirty/Walmart-Amazon, loss: 0.23229259252548218
step: 260, task: Dirty/Walmart-Amazon, loss: 0.13474151492118835
step: 270, task: Dirty/Walmart-Amazon, loss: 0.09709089994430542
step: 280, task: Dirty/Walmart-Amazon, loss: 0.27579930424690247
step: 290, task: Dirty/Walmart-Amazon, loss: 0.32970482110977173
step: 300, task: Dirty/Walmart-Amazon, loss: 0.1300589144229889
step: 310, task: Dirty/Walmart-Amazon, loss: 0.2599029541015625
step: 320, task: Dirty/Walmart-Amazon, loss: 0.08917886018753052
step: 330, task: Dirty/Walmart-Amazon, loss: 0.240253746509552
step: 340, task: Dirty/Walmart-Amazon, loss: 0.07548899203538895
step: 350, task: Dirty/Walmart-Amazon, loss: 0.3050107955932617
step: 360, task: Dirty/Walmart-Amazon, loss: 0.11706893146038055
step: 370, task: Dirty/Walmart-Amazon, loss: 0.1573779284954071
step: 380, task: Dirty/Walmart-Amazon, loss: 0.09003549814224243
=========eval at epoch=4=========
Validation:
=============Dirty/Walmart-Amazon==================
accuracy=0.906
precision=0.500
recall=0.093
f1=0.157
======================================
Test:
=============Dirty/Walmart-Amazon==================
accuracy=0.911
precision=0.609
recall=0.145
f1=0.234
======================================
=====sanity check======
words: COL title VAL epson s041062 presentation paper epson 19.88 COL category VAL stationery & office machinery COL brand VAL  COL modelno VAL s041062 COL price VAL   [SEP] COL title VAL hp premium presentation paper business paper products 17.2 COL category VAL  COL brand VAL hp COL modelno VAL q5449a COL price VAL  
x: [    0 18047  1270 27445   364 28898   579  3387   698  5379  5209  2225
   364 28898   753     4  4652 14857  4120 27445  1992  4270   359   558
 13922 14857  1518 27445  1437 14857  1421  2362 27445   579  3387   698
  5379 14857   425 27445  1437  1437     2     2 18047  1270 27445 29886
  4549  5209  2225   265  2225   785   601     4   176 14857  4120 27445
  1437 14857  1518 27445 29886 14857  1421  2362 27445  2231   245 32940
   102 14857   425 27445  1437  1437     2]
tokens: ['<s>', 'COL', 'Ġtitle', 'ĠVAL', 'Ġe', 'pson', 'Ġs', '04', '10', '62', 'Ġpresentation', 'Ġpaper', 'Ġe', 'pson', 'Ġ19', '.', '88', 'ĠCOL', 'Ġcategory', 'ĠVAL', 'Ġstation', 'ery', 'Ġ&', 'Ġoffice', 'Ġmachinery', 'ĠCOL', 'Ġbrand', 'ĠVAL', 'Ġ', 'ĠCOL', 'Ġmodel', 'no', 'ĠVAL', 'Ġs', '04', '10', '62', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ', 'Ġ', '</s>', '</s>', 'COL', 'Ġtitle', 'ĠVAL', 'Ġhp', 'Ġpremium', 'Ġpresentation', 'Ġpaper', 'Ġbusiness', 'Ġpaper', 'Ġproducts', 'Ġ17', '.', '2', 'ĠCOL', 'Ġcategory', 'ĠVAL', 'Ġ', 'ĠCOL', 'Ġbrand', 'ĠVAL', 'Ġhp', 'ĠCOL', 'Ġmodel', 'no', 'ĠVAL', 'Ġq', '5', '449', 'a', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ', 'Ġ', '</s>']
is_heads: [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
y: 0
tags: 0
mask: tensor([1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1])
seqlen: 79
task_name: Dirty/Walmart-Amazon
=======================
step: 0, task: Dirty/Walmart-Amazon, loss: 0.03643309324979782
step: 10, task: Dirty/Walmart-Amazon, loss: 0.06451092660427094
step: 20, task: Dirty/Walmart-Amazon, loss: 0.10915542393922806
step: 30, task: Dirty/Walmart-Amazon, loss: 0.08106531947851181
step: 40, task: Dirty/Walmart-Amazon, loss: 0.2575380206108093
step: 50, task: Dirty/Walmart-Amazon, loss: 0.26742205023765564
step: 60, task: Dirty/Walmart-Amazon, loss: 0.25555291771888733
step: 70, task: Dirty/Walmart-Amazon, loss: 0.22064998745918274
step: 80, task: Dirty/Walmart-Amazon, loss: 0.29303044080734253
step: 90, task: Dirty/Walmart-Amazon, loss: 0.028416134417057037
step: 100, task: Dirty/Walmart-Amazon, loss: 0.3411161005496979
step: 110, task: Dirty/Walmart-Amazon, loss: 0.2769797742366791
step: 120, task: Dirty/Walmart-Amazon, loss: 0.053854800760746
step: 130, task: Dirty/Walmart-Amazon, loss: 0.2435646653175354
step: 140, task: Dirty/Walmart-Amazon, loss: 0.18236953020095825
step: 150, task: Dirty/Walmart-Amazon, loss: 0.0869935005903244
step: 160, task: Dirty/Walmart-Amazon, loss: 0.21239414811134338
step: 170, task: Dirty/Walmart-Amazon, loss: 0.2969186007976532
step: 180, task: Dirty/Walmart-Amazon, loss: 0.11555314809083939
step: 190, task: Dirty/Walmart-Amazon, loss: 0.15095986425876617
step: 200, task: Dirty/Walmart-Amazon, loss: 0.10695915669202805
step: 210, task: Dirty/Walmart-Amazon, loss: 0.18443724513053894
step: 220, task: Dirty/Walmart-Amazon, loss: 0.1362084150314331
step: 230, task: Dirty/Walmart-Amazon, loss: 0.20672710239887238
step: 240, task: Dirty/Walmart-Amazon, loss: 0.12329189479351044
step: 250, task: Dirty/Walmart-Amazon, loss: 0.2685337960720062
step: 260, task: Dirty/Walmart-Amazon, loss: 0.2730463147163391
step: 270, task: Dirty/Walmart-Amazon, loss: 0.2961016893386841
step: 280, task: Dirty/Walmart-Amazon, loss: 0.28311532735824585
step: 290, task: Dirty/Walmart-Amazon, loss: 0.09441326558589935
step: 300, task: Dirty/Walmart-Amazon, loss: 0.23714104294776917
step: 310, task: Dirty/Walmart-Amazon, loss: 0.03609953820705414
step: 320, task: Dirty/Walmart-Amazon, loss: 0.10915810614824295
step: 330, task: Dirty/Walmart-Amazon, loss: 0.05732402950525284
step: 340, task: Dirty/Walmart-Amazon, loss: 0.03040125221014023
step: 350, task: Dirty/Walmart-Amazon, loss: 0.30099737644195557
step: 360, task: Dirty/Walmart-Amazon, loss: 0.14709700644016266
step: 370, task: Dirty/Walmart-Amazon, loss: 0.05406004190444946
step: 380, task: Dirty/Walmart-Amazon, loss: 0.1729966700077057
=========eval at epoch=5=========
Validation:
=============Dirty/Walmart-Amazon==================
accuracy=0.911
precision=0.628
recall=0.140
f1=0.229
======================================
Test:
=============Dirty/Walmart-Amazon==================
accuracy=0.908
precision=0.571
recall=0.104
f1=0.175
======================================
=====sanity check======
words: COL title VAL da-lite da-glas standard rear projection screen 72 x 96 video format 27639 4448.99 COL category VAL electronics - general COL brand VAL da-lite COL modelno VAL  COL price VAL   [SEP] COL title VAL da-lite 27636 da-glas standard rear projection screen 50 1 2 x 67 1 4 video format projection screens COL category VAL  COL brand VAL da-lite COL modelno VAL  COL price VAL  
x: [    0 18047  1270 27445  2955    12 33701  2955    12 39473  2526  5081
 18144  2441  4801  3023  8971   569  7390 36803  3416   204 36246     4
  2831 14857  4120 27445  8917   111   937 14857  1518 27445  2955    12
 33701 14857  1421  2362 27445  1437 14857   425 27445  1437  1437     2
     2 18047  1270 27445  2955    12 33701 36803  3367  2955    12 39473
  2526  5081 18144  2441   654   112   132  3023  5545   112   204   569
  7390 18144  8545 14857  4120 27445  1437 14857  1518 27445  2955    12
 33701 14857  1421  2362 27445  1437 14857   425 27445  1437  1437     2]
tokens: ['<s>', 'COL', 'Ġtitle', 'ĠVAL', 'Ġda', '-', 'lite', 'Ġda', '-', 'glas', 'Ġstandard', 'Ġrear', 'Ġprojection', 'Ġscreen', 'Ġ72', 'Ġx', 'Ġ96', 'Ġvideo', 'Ġformat', 'Ġ276', '39', 'Ġ4', '448', '.', '99', 'ĠCOL', 'Ġcategory', 'ĠVAL', 'Ġelectronics', 'Ġ-', 'Ġgeneral', 'ĠCOL', 'Ġbrand', 'ĠVAL', 'Ġda', '-', 'lite', 'ĠCOL', 'Ġmodel', 'no', 'ĠVAL', 'Ġ', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ', 'Ġ', '</s>', '</s>', 'COL', 'Ġtitle', 'ĠVAL', 'Ġda', '-', 'lite', 'Ġ276', '36', 'Ġda', '-', 'glas', 'Ġstandard', 'Ġrear', 'Ġprojection', 'Ġscreen', 'Ġ50', 'Ġ1', 'Ġ2', 'Ġx', 'Ġ67', 'Ġ1', 'Ġ4', 'Ġvideo', 'Ġformat', 'Ġprojection', 'Ġscreens', 'ĠCOL', 'Ġcategory', 'ĠVAL', 'Ġ', 'ĠCOL', 'Ġbrand', 'ĠVAL', 'Ġda', '-', 'lite', 'ĠCOL', 'Ġmodel', 'no', 'ĠVAL', 'Ġ', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ', 'Ġ', '</s>']
is_heads: [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
y: 0
tags: 0
mask: tensor([1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1])
seqlen: 96
task_name: Dirty/Walmart-Amazon
=======================
step: 0, task: Dirty/Walmart-Amazon, loss: 0.06151267886161804
step: 10, task: Dirty/Walmart-Amazon, loss: 0.4684789776802063
step: 20, task: Dirty/Walmart-Amazon, loss: 0.059015389531850815
step: 30, task: Dirty/Walmart-Amazon, loss: 0.11368084698915482
step: 40, task: Dirty/Walmart-Amazon, loss: 0.12196505814790726
step: 50, task: Dirty/Walmart-Amazon, loss: 0.05483432486653328
step: 60, task: Dirty/Walmart-Amazon, loss: 0.07619889825582504
step: 70, task: Dirty/Walmart-Amazon, loss: 0.14528262615203857
step: 80, task: Dirty/Walmart-Amazon, loss: 0.11000712215900421
step: 90, task: Dirty/Walmart-Amazon, loss: 0.1202695369720459
step: 100, task: Dirty/Walmart-Amazon, loss: 0.2948911190032959
step: 110, task: Dirty/Walmart-Amazon, loss: 0.10753657668828964
step: 120, task: Dirty/Walmart-Amazon, loss: 0.05518978089094162
step: 130, task: Dirty/Walmart-Amazon, loss: 0.03607120364904404
step: 140, task: Dirty/Walmart-Amazon, loss: 0.4600667953491211
step: 150, task: Dirty/Walmart-Amazon, loss: 0.03989826887845993
step: 160, task: Dirty/Walmart-Amazon, loss: 0.2790291905403137
step: 170, task: Dirty/Walmart-Amazon, loss: 0.09802097082138062
step: 180, task: Dirty/Walmart-Amazon, loss: 0.07959392666816711
step: 190, task: Dirty/Walmart-Amazon, loss: 0.12896296381950378
step: 200, task: Dirty/Walmart-Amazon, loss: 0.2557929754257202
step: 210, task: Dirty/Walmart-Amazon, loss: 0.055031292140483856
step: 220, task: Dirty/Walmart-Amazon, loss: 0.1459115445613861
step: 230, task: Dirty/Walmart-Amazon, loss: 0.31307345628738403
step: 240, task: Dirty/Walmart-Amazon, loss: 0.17694830894470215
step: 250, task: Dirty/Walmart-Amazon, loss: 0.1358938217163086
step: 260, task: Dirty/Walmart-Amazon, loss: 0.04649047553539276
step: 270, task: Dirty/Walmart-Amazon, loss: 0.05037558078765869
step: 280, task: Dirty/Walmart-Amazon, loss: 0.11240025609731674
step: 290, task: Dirty/Walmart-Amazon, loss: 0.28584402799606323
step: 300, task: Dirty/Walmart-Amazon, loss: 0.2032444179058075
step: 310, task: Dirty/Walmart-Amazon, loss: 0.436224102973938
step: 320, task: Dirty/Walmart-Amazon, loss: 0.26437023282051086
step: 330, task: Dirty/Walmart-Amazon, loss: 0.26623862981796265
step: 340, task: Dirty/Walmart-Amazon, loss: 0.29495200514793396
step: 350, task: Dirty/Walmart-Amazon, loss: 0.3412357270717621
step: 360, task: Dirty/Walmart-Amazon, loss: 0.17782209813594818
step: 370, task: Dirty/Walmart-Amazon, loss: 0.2417854368686676
step: 380, task: Dirty/Walmart-Amazon, loss: 0.2952422797679901
=========eval at epoch=6=========
Validation:
=============Dirty/Walmart-Amazon==================
accuracy=0.908
precision=0.548
recall=0.119
f1=0.196
======================================
Test:
=============Dirty/Walmart-Amazon==================
accuracy=0.904
precision=0.455
recall=0.078
f1=0.133
======================================
=====sanity check======
words: COL title VAL targus 13.3 widescreen lcd monitor privacy screen asf133w9usz 42.07 COL category VAL electronics - general COL brand VAL targus COL modelno VAL  COL price VAL   [SEP] COL title VAL 3m privacy filter - 3m pf21 .5 w widescreen monitor privacy screen screen filters 3m 84.44 COL category VAL  COL brand VAL  COL modelno VAL pf21 .5 w COL price VAL  
x: [    0 18047  1270 27445 47624   687   508     4   246   885  4376 37346
   784 28690  5271  4144  2441    25   506 25037   605   466   687   329
  3330     4  3570 14857  4120 27445  8917   111   937 14857  1518 27445
 47624   687 14857  1421  2362 27445  1437 14857   425 27445  1437  1437
     2     2 18047  1270 27445   155   119  4144 14929   111   155   119
   181   506  2146   479   245   885   885  4376 37346  5271  4144  2441
  2441 19214   155   119  7994     4  3305 14857  4120 27445  1437 14857
  1518 27445  1437 14857  1421  2362 27445   181   506  2146   479   245
   885 14857   425 27445  1437  1437     2]
tokens: ['<s>', 'COL', 'Ġtitle', 'ĠVAL', 'Ġtarg', 'us', 'Ġ13', '.', '3', 'Ġw', 'ides', 'creen', 'Ġl', 'cd', 'Ġmonitor', 'Ġprivacy', 'Ġscreen', 'Ġas', 'f', '133', 'w', '9', 'us', 'z', 'Ġ42', '.', '07', 'ĠCOL', 'Ġcategory', 'ĠVAL', 'Ġelectronics', 'Ġ-', 'Ġgeneral', 'ĠCOL', 'Ġbrand', 'ĠVAL', 'Ġtarg', 'us', 'ĠCOL', 'Ġmodel', 'no', 'ĠVAL', 'Ġ', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ', 'Ġ', '</s>', '</s>', 'COL', 'Ġtitle', 'ĠVAL', 'Ġ3', 'm', 'Ġprivacy', 'Ġfilter', 'Ġ-', 'Ġ3', 'm', 'Ġp', 'f', '21', 'Ġ.', '5', 'Ġw', 'Ġw', 'ides', 'creen', 'Ġmonitor', 'Ġprivacy', 'Ġscreen', 'Ġscreen', 'Ġfilters', 'Ġ3', 'm', 'Ġ84', '.', '44', 'ĠCOL', 'Ġcategory', 'ĠVAL', 'Ġ', 'ĠCOL', 'Ġbrand', 'ĠVAL', 'Ġ', 'ĠCOL', 'Ġmodel', 'no', 'ĠVAL', 'Ġp', 'f', '21', 'Ġ.', '5', 'Ġw', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ', 'Ġ', '</s>']
is_heads: [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
y: 0
tags: 0
mask: tensor([1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1])
seqlen: 103
task_name: Dirty/Walmart-Amazon
=======================
step: 0, task: Dirty/Walmart-Amazon, loss: 0.08565928041934967
step: 10, task: Dirty/Walmart-Amazon, loss: 0.1746458113193512
step: 20, task: Dirty/Walmart-Amazon, loss: 0.4862089455127716
step: 30, task: Dirty/Walmart-Amazon, loss: 0.09738465398550034
step: 40, task: Dirty/Walmart-Amazon, loss: 0.26880407333374023
step: 50, task: Dirty/Walmart-Amazon, loss: 0.0765334740281105
step: 60, task: Dirty/Walmart-Amazon, loss: 0.1655195951461792
step: 70, task: Dirty/Walmart-Amazon, loss: 0.316366583108902
step: 80, task: Dirty/Walmart-Amazon, loss: 0.40120387077331543
step: 90, task: Dirty/Walmart-Amazon, loss: 0.3710232377052307
step: 100, task: Dirty/Walmart-Amazon, loss: 0.1207515299320221
step: 110, task: Dirty/Walmart-Amazon, loss: 0.1629493683576584
step: 120, task: Dirty/Walmart-Amazon, loss: 0.29130762815475464
step: 130, task: Dirty/Walmart-Amazon, loss: 0.27016153931617737
step: 140, task: Dirty/Walmart-Amazon, loss: 0.06262703239917755
step: 150, task: Dirty/Walmart-Amazon, loss: 0.32687219977378845
step: 160, task: Dirty/Walmart-Amazon, loss: 0.08385069668292999
step: 170, task: Dirty/Walmart-Amazon, loss: 0.031136363744735718
step: 180, task: Dirty/Walmart-Amazon, loss: 0.286397784948349
step: 190, task: Dirty/Walmart-Amazon, loss: 0.10112665593624115
step: 200, task: Dirty/Walmart-Amazon, loss: 0.10731461644172668
step: 210, task: Dirty/Walmart-Amazon, loss: 0.4519430696964264
step: 220, task: Dirty/Walmart-Amazon, loss: 0.1184225007891655
step: 230, task: Dirty/Walmart-Amazon, loss: 0.10237787663936615
step: 240, task: Dirty/Walmart-Amazon, loss: 0.3504500985145569
step: 250, task: Dirty/Walmart-Amazon, loss: 0.0399000346660614
step: 260, task: Dirty/Walmart-Amazon, loss: 0.3460310399532318
step: 270, task: Dirty/Walmart-Amazon, loss: 0.24395085871219635
step: 280, task: Dirty/Walmart-Amazon, loss: 0.12424521893262863
step: 290, task: Dirty/Walmart-Amazon, loss: 0.23083752393722534
step: 300, task: Dirty/Walmart-Amazon, loss: 0.17123107612133026
step: 310, task: Dirty/Walmart-Amazon, loss: 0.3387039005756378
step: 320, task: Dirty/Walmart-Amazon, loss: 0.1304396390914917
step: 330, task: Dirty/Walmart-Amazon, loss: 0.24075636267662048
step: 340, task: Dirty/Walmart-Amazon, loss: 0.06208149343729019
step: 350, task: Dirty/Walmart-Amazon, loss: 0.35120847821235657
step: 360, task: Dirty/Walmart-Amazon, loss: 0.03308567404747009
step: 370, task: Dirty/Walmart-Amazon, loss: 0.06835262477397919
step: 380, task: Dirty/Walmart-Amazon, loss: 0.19178065657615662
=========eval at epoch=7=========
Validation:
=============Dirty/Walmart-Amazon==================
accuracy=0.909
precision=0.595
recall=0.114
f1=0.191
======================================
Test:
=============Dirty/Walmart-Amazon==================
accuracy=0.906
precision=0.500
recall=0.088
f1=0.150
======================================
=====sanity check======
words: COL title VAL viewsonic pro8500 dlp projector 1518.0 COL category VAL electronics - general COL brand VAL viewsonic COL modelno VAL pro8500 COL price VAL   [SEP] COL title VAL viewsonic pro8100 full hd 1080p home theater projector viewsonic COL category VAL video projectors COL brand VAL  COL modelno VAL pro8100 COL price VAL 1849.99 
x: [    0 18047  1270 27445  1217  1478   636  1759   398  1497   385 39031
 35282   379  1366     4   288 14857  4120 27445  8917   111   937 14857
  1518 27445  1217  1478   636 14857  1421  2362 27445  1759   398  1497
 14857   425 27445  1437  1437     2     2 18047  1270 27445  1217  1478
   636  1759   398  1866   455  1368   417 21083   642   184  7364 35282
  1217  1478   636 14857  4120 27445   569   695   994 14857  1518 27445
  1437 14857  1421  2362 27445  1759   398  1866 14857   425 27445   504
  3414     4  2831  1437     2]
tokens: ['<s>', 'COL', 'Ġtitle', 'ĠVAL', 'Ġview', 'son', 'ic', 'Ġpro', '8', '500', 'Ġd', 'lp', 'Ġprojector', 'Ġ15', '18', '.', '0', 'ĠCOL', 'Ġcategory', 'ĠVAL', 'Ġelectronics', 'Ġ-', 'Ġgeneral', 'ĠCOL', 'Ġbrand', 'ĠVAL', 'Ġview', 'son', 'ic', 'ĠCOL', 'Ġmodel', 'no', 'ĠVAL', 'Ġpro', '8', '500', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ', 'Ġ', '</s>', '</s>', 'COL', 'Ġtitle', 'ĠVAL', 'Ġview', 'son', 'ic', 'Ġpro', '8', '100', 'Ġfull', 'Ġh', 'd', 'Ġ1080', 'p', 'Ġhome', 'Ġtheater', 'Ġprojector', 'Ġview', 'son', 'ic', 'ĠCOL', 'Ġcategory', 'ĠVAL', 'Ġvideo', 'Ġproject', 'ors', 'ĠCOL', 'Ġbrand', 'ĠVAL', 'Ġ', 'ĠCOL', 'Ġmodel', 'no', 'ĠVAL', 'Ġpro', '8', '100', 'ĠCOL', 'Ġprice', 'ĠVAL', 'Ġ18', '49', '.', '99', 'Ġ', '</s>']
is_heads: [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
y: 0
tags: 0
mask: tensor([1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1])
seqlen: 89
task_name: Dirty/Walmart-Amazon
=======================
step: 0, task: Dirty/Walmart-Amazon, loss: 0.0898817628622055
step: 10, task: Dirty/Walmart-Amazon, loss: 0.08467566221952438
step: 20, task: Dirty/Walmart-Amazon, loss: 0.15326693654060364
Gradient overflow.  Skipping step, loss scaler 0 reducing loss scale to 8192.0
step: 30, task: Dirty/Walmart-Amazon, loss: 0.07913157343864441
step: 40, task: Dirty/Walmart-Amazon, loss: 0.2729445695877075
step: 50, task: Dirty/Walmart-Amazon, loss: 0.043051525950431824
step: 60, task: Dirty/Walmart-Amazon, loss: 0.07627617567777634
step: 70, task: Dirty/Walmart-Amazon, loss: 0.057288143783807755
step: 80, task: Dirty/Walmart-Amazon, loss: 0.11444414407014847
step: 90, task: Dirty/Walmart-Amazon, loss: 0.06215197220444679
step: 100, task: Dirty/Walmart-Amazon, loss: 0.03975002095103264
step: 110, task: Dirty/Walmart-Amazon, loss: 0.2186395823955536
step: 120, task: Dirty/Walmart-Amazon, loss: 0.1806674301624298
step: 130, task: Dirty/Walmart-Amazon, loss: 0.08750689029693604
step: 140, task: Dirty/Walmart-Amazon, loss: 0.08960804343223572
step: 150, task: Dirty/Walmart-Amazon, loss: 0.21413162350654602
step: 160, task: Dirty/Walmart-Amazon, loss: 0.17058908939361572
step: 170, task: Dirty/Walmart-Amazon, loss: 0.1210312470793724
step: 180, task: Dirty/Walmart-Amazon, loss: 0.2663215398788452
step: 190, task: Dirty/Walmart-Amazon, loss: 0.0363912358880043
step: 200, task: Dirty/Walmart-Amazon, loss: 0.39630621671676636
step: 210, task: Dirty/Walmart-Amazon, loss: 0.17731156945228577
step: 220, task: Dirty/Walmart-Amazon, loss: 0.10421160608530045
step: 230, task: Dirty/Walmart-Amazon, loss: 0.0410446971654892
step: 240, task: Dirty/Walmart-Amazon, loss: 0.0789576917886734
step: 250, task: Dirty/Walmart-Amazon, loss: 0.11908388137817383
step: 260, task: Dirty/Walmart-Amazon, loss: 0.17216856777668
step: 270, task: Dirty/Walmart-Amazon, loss: 0.29972630739212036
step: 280, task: Dirty/Walmart-Amazon, loss: 0.2678070068359375
step: 290, task: Dirty/Walmart-Amazon, loss: 0.2322547435760498
step: 300, task: Dirty/Walmart-Amazon, loss: 0.2953684329986572
step: 310, task: Dirty/Walmart-Amazon, loss: 0.22064638137817383
step: 320, task: Dirty/Walmart-Amazon, loss: 0.08371839672327042
step: 330, task: Dirty/Walmart-Amazon, loss: 0.19082826375961304
step: 340, task: Dirty/Walmart-Amazon, loss: 0.29229241609573364
step: 350, task: Dirty/Walmart-Amazon, loss: 0.09978403151035309
step: 360, task: Dirty/Walmart-Amazon, loss: 0.12137413024902344
step: 370, task: Dirty/Walmart-Amazon, loss: 0.104326032102108
step: 380, task: Dirty/Walmart-Amazon, loss: 0.10396227240562439
=========eval at epoch=8=========
Validation:
=============Dirty/Walmart-Amazon==================
accuracy=0.910
precision=0.611
recall=0.114
f1=0.192
======================================
Test:
=============Dirty/Walmart-Amazon==================
accuracy=0.906
precision=0.500
recall=0.088
f1=0.150
======================================
